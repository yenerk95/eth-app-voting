{"ast":null,"code":"'use strict';\n\nvar _classCallCheck = require(\"/Users/yenerkaraca/Documents/GitHub/eth-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/Users/yenerkaraca/Documents/GitHub/eth-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar _require = require('../../utils'),\n    sortBy = _require.sortBy;\n\nvar Entry = require('./entry');\n\nvar Wantlist = /*#__PURE__*/function () {\n  function Wantlist(stats) {\n    _classCallCheck(this, Wantlist);\n\n    this.set = new Map();\n    this._stats = stats;\n  }\n\n  _createClass(Wantlist, [{\n    key: \"add\",\n    value: function add(cid, priority, wantType) {\n      // Have to import here to avoid circular reference\n      var Message = require('../message');\n\n      var cidStr = cid.toString('base58btc');\n      var entry = this.set.get(cidStr);\n\n      if (entry) {\n        entry.inc();\n        entry.priority = priority; // We can only overwrite want-have with want-block\n\n        if (entry.wantType === Message.WantType.Have && wantType === Message.WantType.Block) {\n          entry.wantType = wantType;\n        }\n      } else {\n        this.set.set(cidStr, new Entry(cid, priority, wantType));\n\n        if (this._stats) {\n          this._stats.push(null, 'wantListSize', 1);\n        }\n      }\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(cid) {\n      var cidStr = cid.toString('base58btc');\n      var entry = this.set.get(cidStr);\n\n      if (!entry) {\n        return;\n      }\n\n      entry.dec(); // only delete when no refs are held\n\n      if (entry.hasRefs()) {\n        return;\n      }\n\n      this.set.delete(cidStr);\n\n      if (this._stats) {\n        this._stats.push(null, 'wantListSize', -1);\n      }\n    }\n  }, {\n    key: \"removeForce\",\n    value: function removeForce(cidStr) {\n      if (this.set.has(cidStr)) {\n        this.set.delete(cidStr);\n      }\n    }\n  }, {\n    key: \"forEach\",\n    value: function forEach(fn) {\n      return this.set.forEach(fn);\n    }\n  }, {\n    key: \"entries\",\n    value: function entries() {\n      return this.set.entries();\n    }\n  }, {\n    key: \"sortedEntries\",\n    value: function sortedEntries() {\n      return new Map(sortBy(function (o) {\n        return o[1].key;\n      }, Array.from(this.set.entries())));\n    }\n  }, {\n    key: \"contains\",\n    value: function contains(cid) {\n      var cidStr = cid.toString('base58btc');\n      return this.set.get(cidStr);\n    }\n  }, {\n    key: \"length\",\n    get: function get() {\n      return this.set.size;\n    }\n  }]);\n\n  return Wantlist;\n}();\n\nWantlist.Entry = Entry;\nmodule.exports = Wantlist;","map":{"version":3,"sources":["/Users/yenerkaraca/Documents/GitHub/eth-app/node_modules/ipfs-bitswap/src/types/wantlist/index.js"],"names":["require","sortBy","Entry","Wantlist","stats","set","Map","_stats","cid","priority","wantType","Message","cidStr","toString","entry","get","inc","WantType","Have","Block","push","dec","hasRefs","delete","has","fn","forEach","entries","o","key","Array","from","size","module","exports"],"mappings":"AAAA;;;;;;eAEmBA,OAAO,CAAC,aAAD,C;IAAlBC,M,YAAAA,M;;AACR,IAAMC,KAAK,GAAGF,OAAO,CAAC,SAAD,CAArB;;IAEMG,Q;AACJ,oBAAaC,KAAb,EAAoB;AAAA;;AAClB,SAAKC,GAAL,GAAW,IAAIC,GAAJ,EAAX;AACA,SAAKC,MAAL,GAAcH,KAAd;AACD;;;;wBAMII,G,EAAKC,Q,EAAUC,Q,EAAU;AAC5B;AACA,UAAMC,OAAO,GAAGX,OAAO,CAAC,YAAD,CAAvB;;AAEA,UAAMY,MAAM,GAAGJ,GAAG,CAACK,QAAJ,CAAa,WAAb,CAAf;AACA,UAAMC,KAAK,GAAG,KAAKT,GAAL,CAASU,GAAT,CAAaH,MAAb,CAAd;;AAEA,UAAIE,KAAJ,EAAW;AACTA,QAAAA,KAAK,CAACE,GAAN;AACAF,QAAAA,KAAK,CAACL,QAAN,GAAiBA,QAAjB,CAFS,CAIT;;AACA,YAAIK,KAAK,CAACJ,QAAN,KAAmBC,OAAO,CAACM,QAAR,CAAiBC,IAApC,IAA4CR,QAAQ,KAAKC,OAAO,CAACM,QAAR,CAAiBE,KAA9E,EAAqF;AACnFL,UAAAA,KAAK,CAACJ,QAAN,GAAiBA,QAAjB;AACD;AACF,OARD,MAQO;AACL,aAAKL,GAAL,CAASA,GAAT,CAAaO,MAAb,EAAqB,IAAIV,KAAJ,CAAUM,GAAV,EAAeC,QAAf,EAAyBC,QAAzB,CAArB;;AACA,YAAI,KAAKH,MAAT,EAAiB;AACf,eAAKA,MAAL,CAAYa,IAAZ,CAAiB,IAAjB,EAAuB,cAAvB,EAAuC,CAAvC;AACD;AACF;AACF;;;2BAEOZ,G,EAAK;AACX,UAAMI,MAAM,GAAGJ,GAAG,CAACK,QAAJ,CAAa,WAAb,CAAf;AACA,UAAMC,KAAK,GAAG,KAAKT,GAAL,CAASU,GAAT,CAAaH,MAAb,CAAd;;AAEA,UAAI,CAACE,KAAL,EAAY;AACV;AACD;;AAEDA,MAAAA,KAAK,CAACO,GAAN,GARW,CAUX;;AACA,UAAIP,KAAK,CAACQ,OAAN,EAAJ,EAAqB;AACnB;AACD;;AAED,WAAKjB,GAAL,CAASkB,MAAT,CAAgBX,MAAhB;;AACA,UAAI,KAAKL,MAAT,EAAiB;AACf,aAAKA,MAAL,CAAYa,IAAZ,CAAiB,IAAjB,EAAuB,cAAvB,EAAuC,CAAC,CAAxC;AACD;AACF;;;gCAEYR,M,EAAQ;AACnB,UAAI,KAAKP,GAAL,CAASmB,GAAT,CAAaZ,MAAb,CAAJ,EAA0B;AACxB,aAAKP,GAAL,CAASkB,MAAT,CAAgBX,MAAhB;AACD;AACF;;;4BAEQa,E,EAAI;AACX,aAAO,KAAKpB,GAAL,CAASqB,OAAT,CAAiBD,EAAjB,CAAP;AACD;;;8BAEU;AACT,aAAO,KAAKpB,GAAL,CAASsB,OAAT,EAAP;AACD;;;oCAEgB;AACf,aAAO,IAAIrB,GAAJ,CAAQL,MAAM,CAAC,UAAA2B,CAAC;AAAA,eAAIA,CAAC,CAAC,CAAD,CAAD,CAAKC,GAAT;AAAA,OAAF,EAAgBC,KAAK,CAACC,IAAN,CAAW,KAAK1B,GAAL,CAASsB,OAAT,EAAX,CAAhB,CAAd,CAAP;AACD;;;6BAESnB,G,EAAK;AACb,UAAMI,MAAM,GAAGJ,GAAG,CAACK,QAAJ,CAAa,WAAb,CAAf;AACA,aAAO,KAAKR,GAAL,CAASU,GAAT,CAAaH,MAAb,CAAP;AACD;;;wBArEa;AACZ,aAAO,KAAKP,GAAL,CAAS2B,IAAhB;AACD;;;;;;AAsEH7B,QAAQ,CAACD,KAAT,GAAiBA,KAAjB;AACA+B,MAAM,CAACC,OAAP,GAAiB/B,QAAjB","sourcesContent":["'use strict'\n\nconst { sortBy } = require('../../utils')\nconst Entry = require('./entry')\n\nclass Wantlist {\n  constructor (stats) {\n    this.set = new Map()\n    this._stats = stats\n  }\n\n  get length () {\n    return this.set.size\n  }\n\n  add (cid, priority, wantType) {\n    // Have to import here to avoid circular reference\n    const Message = require('../message')\n\n    const cidStr = cid.toString('base58btc')\n    const entry = this.set.get(cidStr)\n\n    if (entry) {\n      entry.inc()\n      entry.priority = priority\n\n      // We can only overwrite want-have with want-block\n      if (entry.wantType === Message.WantType.Have && wantType === Message.WantType.Block) {\n        entry.wantType = wantType\n      }\n    } else {\n      this.set.set(cidStr, new Entry(cid, priority, wantType))\n      if (this._stats) {\n        this._stats.push(null, 'wantListSize', 1)\n      }\n    }\n  }\n\n  remove (cid) {\n    const cidStr = cid.toString('base58btc')\n    const entry = this.set.get(cidStr)\n\n    if (!entry) {\n      return\n    }\n\n    entry.dec()\n\n    // only delete when no refs are held\n    if (entry.hasRefs()) {\n      return\n    }\n\n    this.set.delete(cidStr)\n    if (this._stats) {\n      this._stats.push(null, 'wantListSize', -1)\n    }\n  }\n\n  removeForce (cidStr) {\n    if (this.set.has(cidStr)) {\n      this.set.delete(cidStr)\n    }\n  }\n\n  forEach (fn) {\n    return this.set.forEach(fn)\n  }\n\n  entries () {\n    return this.set.entries()\n  }\n\n  sortedEntries () {\n    return new Map(sortBy(o => o[1].key, Array.from(this.set.entries())))\n  }\n\n  contains (cid) {\n    const cidStr = cid.toString('base58btc')\n    return this.set.get(cidStr)\n  }\n}\n\nWantlist.Entry = Entry\nmodule.exports = Wantlist\n"]},"metadata":{},"sourceType":"script"}