{"ast":null,"code":"var WriteError = require('level-errors').WriteError;\n\nvar promisify = require('./promisify');\n\nvar getCallback = require('./common').getCallback;\n\nvar getOptions = require('./common').getOptions;\n\nfunction Batch(levelup) {\n  // TODO (next major): remove this._levelup alias\n  this.db = this._levelup = levelup;\n  this.batch = levelup.db.batch();\n  this.ops = [];\n  this.length = 0;\n}\n\nBatch.prototype.put = function (key, value) {\n  try {\n    this.batch.put(key, value);\n  } catch (e) {\n    throw new WriteError(e);\n  }\n\n  this.ops.push({\n    type: 'put',\n    key: key,\n    value: value\n  });\n  this.length++;\n  return this;\n};\n\nBatch.prototype.del = function (key) {\n  try {\n    this.batch.del(key);\n  } catch (err) {\n    throw new WriteError(err);\n  }\n\n  this.ops.push({\n    type: 'del',\n    key: key\n  });\n  this.length++;\n  return this;\n};\n\nBatch.prototype.clear = function () {\n  try {\n    this.batch.clear();\n  } catch (err) {\n    throw new WriteError(err);\n  }\n\n  this.ops = [];\n  this.length = 0;\n  return this;\n};\n\nBatch.prototype.write = function (options, callback) {\n  var levelup = this._levelup;\n  var ops = this.ops;\n  var promise;\n  callback = getCallback(options, callback);\n\n  if (!callback) {\n    callback = promisify();\n    promise = callback.promise;\n  }\n\n  options = getOptions(options);\n\n  try {\n    this.batch.write(options, function (err) {\n      if (err) {\n        return callback(new WriteError(err));\n      }\n\n      levelup.emit('batch', ops);\n      callback();\n    });\n  } catch (err) {\n    throw new WriteError(err);\n  }\n\n  return promise;\n};\n\nmodule.exports = Batch;","map":{"version":3,"sources":["/Users/yenerkaraca/Documents/GitHub/eth-app/node_modules/level-packager/node_modules/levelup/lib/batch.js"],"names":["WriteError","require","promisify","getCallback","getOptions","Batch","levelup","db","_levelup","batch","ops","length","prototype","put","key","value","e","push","type","del","err","clear","write","options","callback","promise","emit","module","exports"],"mappings":"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","sourcesContent":["var WriteError = require('level-errors').WriteError\nvar promisify = require('./promisify')\nvar getCallback = require('./common').getCallback\nvar getOptions = require('./common').getOptions\n\nfunction Batch (levelup) {\n  // TODO (next major): remove this._levelup alias\n  this.db = this._levelup = levelup\n  this.batch = levelup.db.batch()\n  this.ops = []\n  this.length = 0\n}\n\nBatch.prototype.put = function (key, value) {\n  try {\n    this.batch.put(key, value)\n  } catch (e) {\n    throw new WriteError(e)\n  }\n\n  this.ops.push({ type: 'put', key: key, value: value })\n  this.length++\n\n  return this\n}\n\nBatch.prototype.del = function (key) {\n  try {\n    this.batch.del(key)\n  } catch (err) {\n    throw new WriteError(err)\n  }\n\n  this.ops.push({ type: 'del', key: key })\n  this.length++\n\n  return this\n}\n\nBatch.prototype.clear = function () {\n  try {\n    this.batch.clear()\n  } catch (err) {\n    throw new WriteError(err)\n  }\n\n  this.ops = []\n  this.length = 0\n\n  return this\n}\n\nBatch.prototype.write = function (options, callback) {\n  var levelup = this._levelup\n  var ops = this.ops\n  var promise\n\n  callback = getCallback(options, callback)\n\n  if (!callback) {\n    callback = promisify()\n    promise = callback.promise\n  }\n\n  options = getOptions(options)\n\n  try {\n    this.batch.write(options, function (err) {\n      if (err) { return callback(new WriteError(err)) }\n      levelup.emit('batch', ops)\n      callback()\n    })\n  } catch (err) {\n    throw new WriteError(err)\n  }\n\n  return promise\n}\n\nmodule.exports = Batch\n"]},"metadata":{},"sourceType":"script"}