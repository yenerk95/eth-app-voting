{"ast":null,"code":"/*!\n * poly1305.js - poly1305 for bcrypto\n * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).\n * https://github.com/bcoin-org/bcrypto\n *\n * Parts of this software are based on floodyberry/poly1305-donna:\n *   Placed into the public domain by Andrew Moon.\n *   https://github.com/floodyberry/poly1305-donna\n *\n * Resources:\n *   https://en.wikipedia.org/wiki/Poly1305\n *   https://cr.yp.to/mac.html\n *   https://tools.ietf.org/html/rfc7539#section-2.5\n *   https://github.com/floodyberry/poly1305-donna/blob/master/poly1305-donna-16.h\n */\n'use strict';\n\nvar _classCallCheck = require(\"/Users/yenerkaraca/Documents/GitHub/eth-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/Users/yenerkaraca/Documents/GitHub/eth-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar assert = require('../internal/assert');\n/**\n * Poly1305\n */\n\n\nvar Poly1305 = /*#__PURE__*/function () {\n  /**\n   * Create a Poly1305 context.\n   * @constructor\n   */\n  function Poly1305() {\n    _classCallCheck(this, Poly1305);\n\n    this.r = new Uint16Array(10);\n    this.h = new Uint16Array(10);\n    this.pad = new Uint16Array(8);\n    this.buffer = Buffer.alloc(16);\n    this.fin = -1;\n    this.leftover = 0;\n  }\n  /**\n   * Initialize poly1305 with a key.\n   * @param {Buffer} key\n   */\n\n\n  _createClass(Poly1305, [{\n    key: \"init\",\n    value: function init(key) {\n      assert(Buffer.isBuffer(key) && key.length >= 32); // r &= 0xffffffc0ffffffc0ffffffc0fffffff\n\n      var t0 = readU16(key, 0);\n      var t1 = readU16(key, 2);\n      var t2 = readU16(key, 4);\n      var t3 = readU16(key, 6);\n      var t4 = readU16(key, 8);\n      var t5 = readU16(key, 10);\n      var t6 = readU16(key, 12);\n      var t7 = readU16(key, 14);\n      this.r[0] = t0 & 0x1fff;\n      this.r[1] = (t0 >>> 13 | t1 << 3) & 0x1fff;\n      this.r[2] = (t1 >>> 10 | t2 << 6) & 0x1f03;\n      this.r[3] = (t2 >>> 7 | t3 << 9) & 0x1fff;\n      this.r[4] = (t3 >>> 4 | t4 << 12) & 0x00ff;\n      this.r[5] = t4 >>> 1 & 0x1ffe;\n      this.r[6] = (t4 >>> 14 | t5 << 2) & 0x1fff;\n      this.r[7] = (t5 >>> 11 | t6 << 5) & 0x1f81;\n      this.r[8] = (t6 >>> 8 | t7 << 8) & 0x1fff;\n      this.r[9] = t7 >>> 5 & 0x007f; // h = 0\n\n      for (var i = 0; i < 10; i++) {\n        this.h[i] = 0;\n      } // Save pad for later.\n\n\n      for (var _i = 0; _i < 8; _i++) {\n        this.pad[_i] = readU16(key, 16 + 2 * _i);\n      }\n\n      this.fin = 0;\n      this.leftover = 0;\n      return this;\n    }\n    /**\n     * Process 16 byte blocks.\n     * @private\n     * @param {Buffer} data - Blocks.\n     * @param {Number} bytes - Size.\n     * @param {Number} m - Offset pointer.\n     */\n\n  }, {\n    key: \"_blocks\",\n    value: function _blocks(data, bytes, m) {\n      var hibit = this.fin ? 0 : 1 << 11; // 1 << 128\n\n      var d = new Uint32Array(10);\n\n      while (bytes >= 16) {\n        // h += m[i]\n        var t0 = readU16(data, m + 0);\n        var t1 = readU16(data, m + 2);\n        var t2 = readU16(data, m + 4);\n        var t3 = readU16(data, m + 6);\n        var t4 = readU16(data, m + 8);\n        var t5 = readU16(data, m + 10);\n        var t6 = readU16(data, m + 12);\n        var t7 = readU16(data, m + 14);\n        this.h[0] += t0 & 0x1fff;\n        this.h[1] += (t0 >>> 13 | t1 << 3) & 0x1fff;\n        this.h[2] += (t1 >>> 10 | t2 << 6) & 0x1fff;\n        this.h[3] += (t2 >>> 7 | t3 << 9) & 0x1fff;\n        this.h[4] += (t3 >>> 4 | t4 << 12) & 0x1fff;\n        this.h[5] += t4 >>> 1 & 0x1fff;\n        this.h[6] += (t4 >>> 14 | t5 << 2) & 0x1fff;\n        this.h[7] += (t5 >>> 11 | t6 << 5) & 0x1fff;\n        this.h[8] += (t6 >>> 8 | t7 << 8) & 0x1fff;\n        this.h[9] += t7 >>> 5 | hibit; // h *= r, (partial) h %= p\n\n        var c = 0;\n\n        for (var i = 0; i < 10; i++) {\n          d[i] = c;\n\n          for (var j = 0; j < 10; j++) {\n            var a = this.h[j];\n            if (j <= i) a *= this.r[i - j];else a *= 5 * this.r[i + 10 - j];\n            d[i] += a; // Sum(h[i] * r[i] * 5) will overflow\n            // slightly above 6 products with an\n            // unclamped r, so carry at 5.\n\n            if (j === 4) {\n              c = d[i] >>> 13;\n              d[i] &= 0x1fff;\n            }\n          }\n\n          c += d[i] >>> 13;\n          d[i] &= 0x1fff;\n        }\n\n        c = (c << 2) + c; // c *= 5\n\n        c += d[0];\n        d[0] = c & 0x1fff;\n        c = c >>> 13;\n        d[1] += c;\n\n        for (var _i2 = 0; _i2 < 10; _i2++) {\n          this.h[_i2] = d[_i2];\n        }\n\n        m += 16;\n        bytes -= 16;\n      }\n    }\n    /**\n     * Update the MAC with data (will be\n     * processed as 16 byte blocks).\n     * @param {Buffer} data\n     */\n\n  }, {\n    key: \"update\",\n    value: function update(data) {\n      assert(Buffer.isBuffer(data));\n      if (this.fin === -1) throw new Error('Context is not initialized.');\n      var bytes = data.length;\n      var m = 0; // Handle leftover.\n\n      if (this.leftover) {\n        var want = 16 - this.leftover;\n        if (want > bytes) want = bytes;\n\n        for (var i = 0; i < want; i++) {\n          this.buffer[this.leftover + i] = data[m + i];\n        }\n\n        bytes -= want;\n        m += want;\n        this.leftover += want;\n        if (this.leftover < 16) return this;\n\n        this._blocks(this.buffer, 16, 0);\n\n        this.leftover = 0;\n      } // Process full blocks.\n\n\n      if (bytes >= 16) {\n        var _want = bytes & ~(16 - 1);\n\n        this._blocks(data, _want, m);\n\n        m += _want;\n        bytes -= _want;\n      } // Store leftover.\n\n\n      if (bytes) {\n        for (var _i3 = 0; _i3 < bytes; _i3++) {\n          this.buffer[this.leftover + _i3] = data[m + _i3];\n        }\n\n        this.leftover += bytes;\n      }\n\n      return this;\n    }\n    /**\n     * Finalize and return a 16-byte MAC.\n     * @returns {Buffer}\n     */\n\n  }, {\n    key: \"final\",\n    value: function final() {\n      if (this.fin === -1) throw new Error('Context is not initialized.');\n      var mac = Buffer.alloc(16);\n      var g = new Uint16Array(10); // Process the remaining block.\n\n      if (this.leftover) {\n        var i = this.leftover;\n        this.buffer[i++] = 1;\n\n        for (; i < 16; i++) {\n          this.buffer[i] = 0;\n        }\n\n        this.fin = 1;\n\n        this._blocks(this.buffer, 16, 0);\n      } // Fully carry h.\n\n\n      var c = this.h[1] >>> 13;\n      this.h[1] &= 0x1fff;\n\n      for (var _i4 = 2; _i4 < 10; _i4++) {\n        this.h[_i4] += c;\n        c = this.h[_i4] >>> 13;\n        this.h[_i4] &= 0x1fff;\n      }\n\n      this.h[0] += c * 5;\n      c = this.h[0] >>> 13;\n      this.h[0] &= 0x1fff;\n      this.h[1] += c;\n      c = this.h[1] >>> 13;\n      this.h[1] &= 0x1fff;\n      this.h[2] += c; // Compute h + -p.\n\n      g[0] = this.h[0] + 5;\n      c = g[0] >>> 13;\n      g[0] &= 0x1fff;\n\n      for (var _i5 = 1; _i5 < 10; _i5++) {\n        g[_i5] = this.h[_i5] + c;\n        c = g[_i5] >>> 13;\n        g[_i5] &= 0x1fff;\n      } // Select h if h < p, or h + -p if h >= p.\n\n\n      var mask = (c ^ 1) - 1;\n\n      for (var _i6 = 0; _i6 < 10; _i6++) {\n        g[_i6] &= mask;\n      }\n\n      mask = ~mask;\n\n      for (var _i7 = 0; _i7 < 10; _i7++) {\n        this.h[_i7] = this.h[_i7] & mask | g[_i7];\n      } // h = h % (2^128)\n\n\n      this.h[0] = (this.h[0] | this.h[1] << 13) & 0xffff;\n      this.h[1] = (this.h[1] >>> 3 | this.h[2] << 10) & 0xffff;\n      this.h[2] = (this.h[2] >>> 6 | this.h[3] << 7) & 0xffff;\n      this.h[3] = (this.h[3] >>> 9 | this.h[4] << 4) & 0xffff;\n      this.h[4] = (this.h[4] >>> 12 | this.h[5] << 1 | this.h[6] << 14) & 0xffff;\n      this.h[5] = (this.h[6] >>> 2 | this.h[7] << 11) & 0xffff;\n      this.h[6] = (this.h[7] >>> 5 | this.h[8] << 8) & 0xffff;\n      this.h[7] = (this.h[8] >>> 8 | this.h[9] << 5) & 0xffff; // mac = (h + pad) % (2^128)\n\n      var f = this.h[0] + this.pad[0];\n      this.h[0] = f;\n\n      for (var _i8 = 1; _i8 < 8; _i8++) {\n        f = this.h[_i8] + this.pad[_i8] + (f >>> 16);\n        this.h[_i8] = f;\n      }\n\n      for (var _i9 = 0; _i9 < 8; _i9++) {\n        writeU16(mac, this.h[_i9], _i9 * 2);\n      } // Zero out the state.\n\n\n      this.destroy();\n      return mac;\n    }\n    /**\n     * Destroy the context.\n     */\n\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      for (var i = 0; i < 10; i++) {\n        this.r[i] = 0;\n        this.h[i] = 0;\n      }\n\n      for (var _i10 = 0; _i10 < 8; _i10++) {\n        this.pad[_i10] = 0;\n      }\n\n      for (var _i11 = 0; _i11 < 16; _i11++) {\n        this.buffer[_i11] = 0;\n      }\n\n      this.fin = -1;\n      this.leftover = 0;\n    }\n    /**\n     * Finalize and verify MAC against tag.\n     * @param {Buffer} tag\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"verify\",\n    value: function verify(tag) {\n      assert(Buffer.isBuffer(tag));\n      assert(tag.length === 16);\n      var mac = this.final();\n      var z = 0;\n\n      for (var i = 0; i < 16; i++) {\n        z |= mac[i] ^ tag[i];\n      }\n\n      return z - 1 >>> 31 !== 0;\n    }\n  }]);\n\n  return Poly1305;\n}();\n/*\n * Static\n */\n\n\nPoly1305.native = 0;\n/*\n * Helpers\n */\n\nfunction readU16(data, off) {\n  return data[off++] + data[off] * 0x100;\n}\n\nfunction writeU16(dst, num, off) {\n  dst[off++] = num;\n  dst[off++] = num >>> 8;\n  return off;\n}\n/*\n * Expose\n */\n\n\nmodule.exports = Poly1305;","map":{"version":3,"sources":["/Users/yenerkaraca/Documents/GitHub/eth-app/node_modules/bcrypto/lib/js/poly1305.js"],"names":["assert","require","Poly1305","r","Uint16Array","h","pad","buffer","Buffer","alloc","fin","leftover","key","isBuffer","length","t0","readU16","t1","t2","t3","t4","t5","t6","t7","i","data","bytes","m","hibit","d","Uint32Array","c","j","a","Error","want","_blocks","mac","g","mask","f","writeU16","destroy","tag","final","z","native","off","dst","num","module","exports"],"mappings":"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","sourcesContent":["/*!\n * poly1305.js - poly1305 for bcrypto\n * Copyright (c) 2016-2019, Christopher Jeffrey (MIT License).\n * https://github.com/bcoin-org/bcrypto\n *\n * Parts of this software are based on floodyberry/poly1305-donna:\n *   Placed into the public domain by Andrew Moon.\n *   https://github.com/floodyberry/poly1305-donna\n *\n * Resources:\n *   https://en.wikipedia.org/wiki/Poly1305\n *   https://cr.yp.to/mac.html\n *   https://tools.ietf.org/html/rfc7539#section-2.5\n *   https://github.com/floodyberry/poly1305-donna/blob/master/poly1305-donna-16.h\n */\n\n'use strict';\n\nconst assert = require('../internal/assert');\n\n/**\n * Poly1305\n */\n\nclass Poly1305 {\n  /**\n   * Create a Poly1305 context.\n   * @constructor\n   */\n\n  constructor() {\n    this.r = new Uint16Array(10);\n    this.h = new Uint16Array(10);\n    this.pad = new Uint16Array(8);\n    this.buffer = Buffer.alloc(16);\n    this.fin = -1;\n    this.leftover = 0;\n  }\n\n  /**\n   * Initialize poly1305 with a key.\n   * @param {Buffer} key\n   */\n\n  init(key) {\n    assert(Buffer.isBuffer(key) && key.length >= 32);\n\n    // r &= 0xffffffc0ffffffc0ffffffc0fffffff\n    const t0 = readU16(key, 0);\n    const t1 = readU16(key, 2);\n    const t2 = readU16(key, 4);\n    const t3 = readU16(key, 6);\n    const t4 = readU16(key, 8);\n    const t5 = readU16(key, 10);\n    const t6 = readU16(key, 12);\n    const t7 = readU16(key, 14);\n\n    this.r[0] = t0 & 0x1fff;\n    this.r[1] = ((t0 >>> 13) | (t1 << 3)) & 0x1fff;\n    this.r[2] = ((t1 >>> 10) | (t2 << 6)) & 0x1f03;\n    this.r[3] = ((t2 >>> 7) | (t3 << 9)) & 0x1fff;\n    this.r[4] = ((t3 >>> 4) | (t4 << 12)) & 0x00ff;\n    this.r[5] = (t4 >>> 1) & 0x1ffe;\n    this.r[6] = ((t4 >>> 14) | (t5 << 2)) & 0x1fff;\n    this.r[7] = ((t5 >>> 11) | (t6 << 5)) & 0x1f81;\n    this.r[8] = ((t6 >>> 8) | (t7 << 8)) & 0x1fff;\n    this.r[9] = (t7 >>> 5) & 0x007f;\n\n    // h = 0\n    for (let i = 0; i < 10; i++)\n      this.h[i] = 0;\n\n    // Save pad for later.\n    for (let i = 0; i < 8; i++)\n      this.pad[i] = readU16(key, 16 + (2 * i));\n\n    this.fin = 0;\n    this.leftover = 0;\n\n    return this;\n  }\n\n  /**\n   * Process 16 byte blocks.\n   * @private\n   * @param {Buffer} data - Blocks.\n   * @param {Number} bytes - Size.\n   * @param {Number} m - Offset pointer.\n   */\n\n  _blocks(data, bytes, m) {\n    const hibit = this.fin ? 0 : (1 << 11); // 1 << 128\n    const d = new Uint32Array(10);\n\n    while (bytes >= 16) {\n      // h += m[i]\n      const t0 = readU16(data, m + 0);\n      const t1 = readU16(data, m + 2);\n      const t2 = readU16(data, m + 4);\n      const t3 = readU16(data, m + 6);\n      const t4 = readU16(data, m + 8);\n      const t5 = readU16(data, m + 10);\n      const t6 = readU16(data, m + 12);\n      const t7 = readU16(data, m + 14);\n\n      this.h[0] += t0 & 0x1fff;\n      this.h[1] += ((t0 >>> 13) | (t1 << 3)) & 0x1fff;\n      this.h[2] += ((t1 >>> 10) | (t2 << 6)) & 0x1fff;\n      this.h[3] += ((t2 >>> 7) | (t3 << 9)) & 0x1fff;\n      this.h[4] += ((t3 >>> 4) | (t4 << 12)) & 0x1fff;\n      this.h[5] += ((t4 >>> 1)) & 0x1fff;\n      this.h[6] += ((t4 >>> 14) | (t5 << 2)) & 0x1fff;\n      this.h[7] += ((t5 >>> 11) | (t6 << 5)) & 0x1fff;\n      this.h[8] += ((t6 >>> 8) | (t7 << 8)) & 0x1fff;\n      this.h[9] += ((t7 >>> 5)) | hibit;\n\n      // h *= r, (partial) h %= p\n      let c = 0;\n\n      for (let i = 0; i < 10; i++) {\n        d[i] = c;\n\n        for (let j = 0; j < 10; j++) {\n          let a = this.h[j];\n\n          if (j <= i)\n            a *= this.r[i - j];\n          else\n            a *= 5 * this.r[i + 10 - j];\n\n          d[i] += a;\n\n          // Sum(h[i] * r[i] * 5) will overflow\n          // slightly above 6 products with an\n          // unclamped r, so carry at 5.\n          if (j === 4) {\n            c = d[i] >>> 13;\n            d[i] &= 0x1fff;\n          }\n        }\n\n        c += d[i] >>> 13;\n        d[i] &= 0x1fff;\n      }\n\n      c = (c << 2) + c; // c *= 5\n      c += d[0];\n      d[0] = (c & 0x1fff);\n      c = c >>> 13;\n      d[1] += c;\n\n      for (let i = 0; i < 10; i++)\n        this.h[i] = d[i];\n\n      m += 16;\n      bytes -= 16;\n    }\n  }\n\n  /**\n   * Update the MAC with data (will be\n   * processed as 16 byte blocks).\n   * @param {Buffer} data\n   */\n\n  update(data) {\n    assert(Buffer.isBuffer(data));\n\n    if (this.fin === -1)\n      throw new Error('Context is not initialized.');\n\n    let bytes = data.length;\n    let m = 0;\n\n    // Handle leftover.\n    if (this.leftover) {\n      let want = 16 - this.leftover;\n\n      if (want > bytes)\n        want = bytes;\n\n      for (let i = 0; i < want; i++)\n        this.buffer[this.leftover + i] = data[m + i];\n\n      bytes -= want;\n      m += want;\n\n      this.leftover += want;\n\n      if (this.leftover < 16)\n        return this;\n\n      this._blocks(this.buffer, 16, 0);\n      this.leftover = 0;\n    }\n\n    // Process full blocks.\n    if (bytes >= 16) {\n      const want = bytes & ~(16 - 1);\n\n      this._blocks(data, want, m);\n\n      m += want;\n      bytes -= want;\n    }\n\n    // Store leftover.\n    if (bytes) {\n      for (let i = 0; i < bytes; i++)\n        this.buffer[this.leftover + i] = data[m + i];\n      this.leftover += bytes;\n    }\n\n    return this;\n  }\n\n  /**\n   * Finalize and return a 16-byte MAC.\n   * @returns {Buffer}\n   */\n\n  final() {\n    if (this.fin === -1)\n      throw new Error('Context is not initialized.');\n\n    const mac = Buffer.alloc(16);\n    const g = new Uint16Array(10);\n\n    // Process the remaining block.\n    if (this.leftover) {\n      let i = this.leftover;\n\n      this.buffer[i++] = 1;\n\n      for (; i < 16; i++)\n        this.buffer[i] = 0;\n\n      this.fin = 1;\n      this._blocks(this.buffer, 16, 0);\n    }\n\n    // Fully carry h.\n    let c = this.h[1] >>> 13;\n\n    this.h[1] &= 0x1fff;\n\n    for (let i = 2; i < 10; i++) {\n      this.h[i] += c;\n      c = this.h[i] >>> 13;\n      this.h[i] &= 0x1fff;\n    }\n\n    this.h[0] += c * 5;\n    c = this.h[0] >>> 13;\n    this.h[0] &= 0x1fff;\n    this.h[1] += c;\n    c = this.h[1] >>> 13;\n    this.h[1] &= 0x1fff;\n    this.h[2] += c;\n\n    // Compute h + -p.\n    g[0] = this.h[0] + 5;\n    c = g[0] >>> 13;\n    g[0] &= 0x1fff;\n\n    for (let i = 1; i < 10; i++) {\n      g[i] = this.h[i] + c;\n      c = g[i] >>> 13;\n      g[i] &= 0x1fff;\n    }\n\n    // Select h if h < p, or h + -p if h >= p.\n    let mask = (c ^ 1) - 1;\n\n    for (let i = 0; i < 10; i++)\n      g[i] &= mask;\n\n    mask = ~mask;\n\n    for (let i = 0; i < 10; i++)\n      this.h[i] = (this.h[i] & mask) | g[i];\n\n    // h = h % (2^128)\n    this.h[0] = ((this.h[0]) | (this.h[1] << 13)) & 0xffff;\n    this.h[1] = ((this.h[1] >>> 3) | (this.h[2] << 10)) & 0xffff;\n    this.h[2] = ((this.h[2] >>> 6) | (this.h[3] << 7)) & 0xffff;\n    this.h[3] = ((this.h[3] >>> 9) | (this.h[4] << 4)) & 0xffff;\n    this.h[4] = ((this.h[4] >>> 12)\n      | (this.h[5] << 1) | (this.h[6] << 14)) & 0xffff;\n    this.h[5] = ((this.h[6] >>> 2) | (this.h[7] << 11)) & 0xffff;\n    this.h[6] = ((this.h[7] >>> 5) | (this.h[8] << 8)) & 0xffff;\n    this.h[7] = ((this.h[8] >>> 8) | (this.h[9] << 5)) & 0xffff;\n\n    // mac = (h + pad) % (2^128)\n    let f = this.h[0] + this.pad[0];\n\n    this.h[0] = f;\n\n    for (let i = 1; i < 8; i++) {\n      f = this.h[i] + this.pad[i] + (f >>> 16);\n      this.h[i] = f;\n    }\n\n    for (let i = 0; i < 8; i++)\n      writeU16(mac, this.h[i], i * 2);\n\n    // Zero out the state.\n    this.destroy();\n\n    return mac;\n  }\n\n  /**\n   * Destroy the context.\n   */\n\n  destroy() {\n    for (let i = 0; i < 10; i++) {\n      this.r[i] = 0;\n      this.h[i] = 0;\n    }\n\n    for (let i = 0; i < 8; i++)\n      this.pad[i] = 0;\n\n    for (let i = 0; i < 16; i++)\n      this.buffer[i] = 0;\n\n    this.fin = -1;\n    this.leftover = 0;\n  }\n\n  /**\n   * Finalize and verify MAC against tag.\n   * @param {Buffer} tag\n   * @returns {Boolean}\n   */\n\n  verify(tag) {\n    assert(Buffer.isBuffer(tag));\n    assert(tag.length === 16);\n\n    const mac = this.final();\n\n    let z = 0;\n\n    for (let i = 0; i < 16; i++)\n      z |= mac[i] ^ tag[i];\n\n    return ((z - 1) >>> 31) !== 0;\n  }\n}\n\n/*\n * Static\n */\n\nPoly1305.native = 0;\n\n/*\n * Helpers\n */\n\nfunction readU16(data, off) {\n  return data[off++] + data[off] * 0x100;\n}\n\nfunction writeU16(dst, num, off) {\n  dst[off++] = num;\n  dst[off++] = num >>> 8;\n  return off;\n}\n\n/*\n * Expose\n */\n\nmodule.exports = Poly1305;\n"]},"metadata":{},"sourceType":"script"}