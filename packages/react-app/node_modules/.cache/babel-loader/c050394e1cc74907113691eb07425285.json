{"ast":null,"code":"/*!\n * bn.js - big numbers for bcrypto\n * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).\n * https://github.com/bcoin-org/bcrypto\n *\n * Parts of this software are based on indutny/bn.js:\n *   Copyright (c) 2015, Fedor Indutny (MIT License).\n *   https://github.com/indutny/bn.js\n *\n * Parts of this software are based on golang/go:\n *   Copyright (c) 2009, The Go Authors. All rights reserved.\n *   https://github.com/golang/go\n *\n * Parts of this software are based on openssl/openssl:\n *   Copyright (c) 1998-2018, The OpenSSL Project (Apache License v2.0).\n *   Copyright (c) 1995-1998, Eric A. Young, Tim J. Hudson. All rights reserved.\n *   https://github.com/openssl/openssl\n *\n * Parts of this software are based on libgmp:\n *   Copyright (c) 1991-1997, 1999-2014, Free Software Foundation, Inc.\n *   https://gmplib.org/\n *\n * Parts of this software are based on v8/v8:\n *   Copyright (c) 2017, The V8 Project Authors (BSD-Style License).\n *   https://github.com/v8/v8\n *\n * Resources:\n *   https://github.com/indutny/bn.js/blob/master/lib/bn.js\n *   https://github.com/indutny/miller-rabin/blob/master/lib/mr.js\n *   https://github.com/golang/go/blob/master/src/math/big/int.go\n *   https://github.com/golang/go/blob/master/src/math/big/nat.go\n *   https://github.com/golang/go/blob/master/src/math/big/prime.go\n *   https://github.com/openssl/openssl/tree/master/crypto/bn\n *   https://github.com/openssl/openssl/blob/master/crypto/bn/bn_kron.c\n *   https://github.com/gnutls/nettle/blob/master/mini-gmp.c\n *   https://github.com/v8/v8/blob/master/src/objects/bigint.cc\n */\n\n/* eslint valid-typeof: \"off\" */\n'use strict';\n\nconst {\n  custom\n} = require('../internal/custom');\n/*\n * Constants\n */\n\n\nconst zeros = ['', '0', '00', '000', '0000', '00000', '000000', '0000000', '00000000', '000000000', '0000000000', '00000000000', '000000000000', '0000000000000', '00000000000000', '000000000000000', '0000000000000000', '00000000000000000', '000000000000000000', '0000000000000000000', '00000000000000000000', '000000000000000000000', '0000000000000000000000', '00000000000000000000000', '000000000000000000000000', '0000000000000000000000000'];\nconst groupSizes = [0x00, 0x19, 0x10, 0x0c, 0x0b, 0x0a, 0x09, 0x08, 0x08, 0x07, 0x07, 0x07, 0x07, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05];\nconst groupBases = [0x00000000, 0x02000000, 0x0290d741, 0x01000000, 0x02e90edd, 0x039aa400, 0x0267bf47, 0x01000000, 0x0290d741, 0x00989680, 0x012959c3, 0x0222c000, 0x03bd7765, 0x0072e440, 0x00adcea1, 0x01000000, 0x01704f61, 0x0206fc40, 0x02cddcf9, 0x03d09000, 0x003e5185, 0x004ea360, 0x006235f7, 0x00798000, 0x009502f9, 0x00b54ba0, 0x00daf26b, 0x01069c00, 0x0138f9ad, 0x0172c9e0, 0x01b4d89f, 0x02000000, 0x025528a1, 0x02b54a20, 0x03216b93, 0x039aa400];\nconst primes = {\n  p192: null,\n  p224: null,\n  p521: null,\n  k256: null,\n  p25519: null,\n  p448: null\n};\nconst modes = {\n  NONE: 0,\n  QUO: 1,\n  REM: 2,\n  BOTH: 3,\n  EUCLID: 4,\n  ALL: 7\n};\nconst WND_WIDTH = 4;\nconst WND_SIZE = 1 << WND_WIDTH - 1;\nconst HAS_BIGINT = typeof BigInt === 'function';\n/**\n * BN\n */\n\nclass BN {\n  constructor(num, base, endian) {\n    this.words = [0];\n    this.length = 1;\n    this.negative = 0;\n    this.red = null;\n    this.from(num, base, endian);\n  }\n  /*\n   * Addition Engine\n   */\n\n\n  _iadd(a, b) {\n    let carry = 0;\n    let i = 0; // a.length > b.length\n\n    if (a.length < b.length) [a, b] = [b, a];\n    if (a !== this) this._alloc(a.length);\n\n    for (; i < b.length; i++) {\n      const r = (a.words[i] | 0) + (b.words[i] | 0) + carry;\n      this.words[i] = r & 0x3ffffff;\n      carry = r >>> 26;\n    }\n\n    for (; carry !== 0 && i < a.length; i++) {\n      const r = (a.words[i] | 0) + carry;\n      this.words[i] = r & 0x3ffffff;\n      carry = r >>> 26;\n    }\n\n    this.length = a.length;\n\n    if (carry !== 0) {\n      this._alloc(this.length + 1);\n\n      this.words[this.length++] = carry;\n    } else if (a !== this) {\n      // Copy the rest of the words.\n      for (; i < a.length; i++) this.words[i] = a.words[i];\n    } // Note: we shouldn't need to strip here.\n\n\n    return this;\n  }\n\n  _iaddn(num) {\n    this.words[0] += num;\n    if (this.words[0] < 0x4000000) return this; // Carry.\n\n    let i = 0;\n\n    this._alloc(this.length + 1);\n\n    this.words[this.length] = 0;\n\n    for (; i < this.length && this.words[i] >= 0x4000000; i++) {\n      this.words[i] -= 0x4000000;\n      this.words[i + 1] += 1;\n    }\n\n    this.length = Math.max(this.length, i + 1); // Note: we shouldn't need to strip here.\n\n    return this;\n  }\n  /*\n   * Addition\n   */\n\n\n  iadd(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    if (this.negative === num.negative) {\n      // x + y == x + y\n      // (-x) + (-y) == -(x + y)\n      this._iadd(this, num);\n    } else {\n      // x + (-y) == x - y == -(y - x)\n      // (-x) + y == y - x == -(x - y)\n      const cmp = this.ucmp(num); // x + (-x) == (-x) + x == 0\n\n      if (cmp === 0) {\n        this.words[0] = 0;\n        this.length = 1;\n        this.negative = 0;\n        return this;\n      }\n\n      if (cmp < 0) {\n        this._isub(num, this);\n\n        this.negative ^= 1;\n      } else {\n        this._isub(this, num);\n      }\n    }\n\n    return this;\n  }\n\n  iaddn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    const negative = num < 0 | 0;\n    if (negative) num = -num;\n\n    if (this.negative === negative) {\n      // x + y == x + y\n      // (-x) + (-y) == -(x + y)\n      this._iaddn(num);\n    } else {\n      // x + (-y) == x - y == -(y - x)\n      // (-x) + y == y - x == -(x - y)\n      if (this.length === 1 && this.words[0] < num) {\n        this.words[0] = num - this.words[0];\n        this.negative ^= 1;\n      } else {\n        this._isubn(num);\n      }\n    }\n\n    return this;\n  }\n\n  add(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    if (num.length > this.length) return num.clone().iadd(this);\n    return this.clone().iadd(num);\n  }\n\n  addn(num) {\n    return this.clone().iaddn(num);\n  }\n  /*\n   * Subtraction Engine\n   */\n\n\n  _isub(a, b) {\n    let carry = 0;\n    let i = 0; // a > b\n\n    assert(a.length >= b.length);\n    if (a !== this) this._alloc(a.length);\n\n    for (; i < b.length; i++) {\n      const r = (a.words[i] | 0) - (b.words[i] | 0) + carry;\n      carry = r >> 26;\n      this.words[i] = r & 0x3ffffff;\n    }\n\n    for (; carry !== 0 && i < a.length; i++) {\n      const r = (a.words[i] | 0) + carry;\n      carry = r >> 26;\n      this.words[i] = r & 0x3ffffff;\n    }\n\n    assert(carry === 0); // Copy rest of the words.\n\n    if (a !== this) {\n      for (; i < a.length; i++) this.words[i] = a.words[i];\n    }\n\n    this.length = Math.max(this.length, i);\n    return this._strip();\n  }\n\n  _isubn(num) {\n    this.words[0] -= num;\n    if (this.words[0] >= 0) return this._normalize();\n    assert(this.length !== 1); // Carry.\n\n    this._alloc(this.length + 1);\n\n    for (let i = 0; i < this.length && this.words[i] < 0; i++) {\n      this.words[i] += 0x4000000;\n      this.words[i + 1] -= 1;\n    }\n\n    this.words[this.length] = 0;\n    return this._strip();\n  }\n  /*\n   * Subtraction\n   */\n\n\n  isub(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    if (this.negative !== num.negative) {\n      // x - (-y) == x + y\n      // (-x) - y == -(x + y)\n      this._iadd(this, num);\n    } else {\n      // x - y == x - y == -(y - x)\n      // (-x) - (-y) == y - x == -(x - y)\n      const cmp = this.ucmp(num); // x - x == 0\n\n      if (cmp === 0) {\n        this.words[0] = 0;\n        this.length = 1;\n        this.negative = 0;\n        return this;\n      }\n\n      if (cmp < 0) {\n        this._isub(num, this);\n\n        this.negative ^= 1;\n      } else {\n        this._isub(this, num);\n      }\n    }\n\n    return this;\n  }\n\n  isubn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    const negative = num < 0 | 0;\n    if (negative) num = -num;\n\n    if (this.negative !== negative) {\n      // x - (-y) == x + y\n      // (-x) - y == -(x + y)\n      this._iaddn(num);\n    } else {\n      // x - y == x - y == -(y - x)\n      // (-x) - (-y) == y - x == -(x - y)\n      if (this.length === 1 && this.words[0] < num) {\n        this.words[0] = num - this.words[0];\n        this.negative ^= 1;\n      } else {\n        this._isubn(num);\n      }\n    }\n\n    return this;\n  }\n\n  sub(num) {\n    return this.clone().isub(num);\n  }\n\n  subn(num) {\n    return this.clone().isubn(num);\n  }\n  /*\n   * Multiplication Engine\n   */\n\n\n  _mul(num, out) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    enforce(BN.isBN(out), 'out', 'bignum');\n    if (this.length === 10 && num.length === 10) return comb10MulTo(this, num, out);\n    const len = this.length + num.length;\n    if (len < 63) return smallMulTo(this, num, out);\n    if (len < 1024) return bigMulTo(this, num, out);\n    return jumboMulTo(this, num, out);\n  }\n  /*\n   * Multiplication\n   */\n\n\n  imul(num) {\n    return this.mul(num)._move(this);\n  }\n\n  imuln(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    const neg = num < 0 | 0;\n    if (neg) num = -num; // Carry.\n\n    let carry = 0;\n\n    for (let i = 0; i < this.length; i++) {\n      const w = this.words[i] * num;\n      const lo = (w & 0x3ffffff) + (carry & 0x3ffffff);\n      carry >>= 26;\n      carry += w / 0x4000000 | 0;\n      carry += lo >>> 26;\n      this.words[i] = lo & 0x3ffffff;\n    }\n\n    this.negative ^= neg;\n\n    if (carry !== 0) {\n      this._alloc(this.length + 1);\n\n      this.words[this.length++] = carry;\n    } else {\n      this._strip();\n    }\n\n    return this;\n  }\n\n  mul(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    const len = this.length + num.length;\n    const out = new BN();\n    out.words = new Array(len);\n\n    for (let i = 0; i < len; i++) out.words[i] = 0;\n\n    return this._mul(num, out);\n  }\n\n  muln(num) {\n    return this.clone().imuln(num);\n  }\n  /*\n   * Multiplication + Shift\n   */\n\n\n  mulShift(num, bits) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    enforce(bits >>> 0 === bits, 'bits', 'uint32');\n    const r = this.mul(num);\n    const b = r.utestn(bits - 1);\n    r.iushrn(bits);\n    if (this.negative ^ num.negative) return r.isubn(b);\n    return r.iaddn(b);\n  }\n  /*\n   * Division Engine\n   */\n\n\n  _div(num, flags) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    assert((flags & modes.ALL) === flags);\n    assert(flags !== modes.NONE);\n    const a = this;\n    const b = num;\n    nonzero(!b.isZero());\n    if (a.isZero()) return [new BN(0), new BN(0)];\n    const as = a.negative;\n    const bs = b.negative;\n    a.negative = 0;\n    b.negative = 0;\n    let q = null;\n    let r = null;\n\n    if (a.ucmp(b) < 0) {\n      if (flags & modes.QUO) q = new BN(0);\n      if (flags & modes.REM) r = a.clone();\n    } else if (b.length === 1) {\n      if (flags & modes.QUO) q = a.quon(b.words[0]);\n      if (flags & modes.REM) r = a.remn(b.words[0]);\n    } else {\n      [q, r] = a._wordDiv(b, flags);\n    }\n\n    a.negative = as;\n    b.negative = bs;\n\n    if (flags & modes.QUO) {\n      q.negative = a.negative ^ b.negative;\n\n      q._normalize();\n    }\n\n    if (flags & modes.REM) {\n      r.negative = a.negative;\n\n      r._normalize();\n    }\n\n    if (flags & modes.EUCLID) {\n      if (flags & modes.QUO) {\n        assert((flags & modes.REM) !== 0);\n\n        if (r.negative !== 0) {\n          if (b.negative !== 0) q.iaddn(1);else q.isubn(1);\n        }\n      }\n\n      if (flags & modes.REM) {\n        if (r.negative !== 0) {\n          if (b.negative !== 0) r.isub(b);else r.iadd(b);\n        }\n      }\n    }\n\n    return [q, r];\n  }\n\n  _wordDiv(num, flags) {\n    let a = this.clone();\n    let b = num;\n    let q = null;\n    let hi; // Normalize.\n\n    const word = b.words[b.length - 1] | 0;\n    const shift = 26 - countBits(word);\n\n    if (shift !== 0) {\n      b = b.clone();\n      a.iushln(shift);\n      b.iushln(shift);\n      hi = b.words[b.length - 1] | 0;\n    } else {\n      hi = word;\n    } // Initialize quotient.\n\n\n    const m = a.length - b.length;\n    assert(m >= 0);\n\n    if (flags & modes.QUO) {\n      q = new BN(0);\n      q.length = m + 1;\n      q.words = new Array(q.length);\n\n      for (let i = 0; i < q.length; i++) q.words[i] = 0;\n    } // Diff.\n\n\n    const d = a.clone();\n\n    d._ishlnsubmul(b, 1, m);\n\n    if (d.negative === 0) {\n      if (q) q.words[m] = 1;\n      a = d;\n    } // Divide.\n\n\n    for (let j = m - 1; j >= 0; j--) {\n      const ahi = a.words[b.length + j];\n      const alo = a.words[b.length + j - 1];\n      const quo = (ahi * 0x4000000 + alo) / hi | 0;\n      let qj = Math.min(quo, 0x3ffffff);\n\n      a._ishlnsubmul(b, qj, j);\n\n      while (a.negative !== 0) {\n        qj -= 1;\n        a.negative = 0;\n\n        a._ishlnsubmul(b, 1, j);\n\n        a.ineg();\n      }\n\n      if (q) q.words[j] = qj;\n    } // Strip.\n\n\n    if (q) q._strip(); // Denormalize.\n    // Note: we shouldn't need to strip `a` here.\n\n    if (flags & modes.REM && shift !== 0) a.iushrn(shift);\n    return [q, a];\n  }\n\n  _ishlnsubmul(num, mul, shift) {\n    let carry = 0;\n    let i = 0;\n\n    this._expand(num.length + shift);\n\n    for (; i < num.length; i++) {\n      const k = (this.words[i + shift] | 0) + carry;\n      const r = num.words[i] * mul;\n      const w = k - (r & 0x3ffffff);\n      carry = (w >> 26) - (r / 0x4000000 | 0);\n      this.words[i + shift] = w & 0x3ffffff;\n    }\n\n    for (; i < this.length - shift; i++) {\n      const w = (this.words[i + shift] | 0) + carry;\n      carry = w >> 26;\n      this.words[i + shift] = w & 0x3ffffff;\n    }\n\n    if (carry === 0) return this._strip(); // Subtraction overflow.\n\n    assert(carry === -1);\n    carry = 0;\n\n    for (let i = 0; i < this.length; i++) {\n      const w = -(this.words[i] | 0) + carry;\n      carry = w >> 26;\n      this.words[i] = w & 0x3ffffff;\n    }\n\n    this.negative = 1;\n    return this._strip();\n  }\n  /*\n   * Truncation Division + Modulo\n   */\n\n\n  quorem(num) {\n    return this._div(num, modes.BOTH);\n  }\n  /*\n   * Truncation Division\n   */\n\n\n  iquo(num) {\n    return this.quo(num)._move(this);\n  }\n\n  iquon(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    nonzero(num !== 0);\n    const neg = num < 0 | 0;\n    if (neg) num = -num;\n    let carry = 0;\n\n    for (let i = this.length - 1; i >= 0; i--) {\n      const w = (this.words[i] | 0) + carry * 0x4000000;\n      this.words[i] = w / num | 0;\n      carry = w % num;\n    }\n\n    this.negative ^= neg;\n    return this._strip();\n  }\n\n  quo(num) {\n    return this._div(num, modes.QUO)[0];\n  }\n\n  quon(num) {\n    return this.clone().iquon(num);\n  }\n  /*\n   * Truncation Modulo\n   */\n\n\n  irem(num) {\n    return this.rem(num)._move(this);\n  }\n\n  iremn(num) {\n    let m = this.remrn(num);\n    if (m < 0) m = -m;\n    this.words[0] = m;\n    this.length = 1;\n    return this._normalize();\n  }\n\n  rem(num) {\n    return this._div(num, modes.REM)[1];\n  }\n\n  remn(num) {\n    return this.clone().iremn(num);\n  }\n\n  remrn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    nonzero(num !== 0);\n    if (num < 0) num = -num;\n    const p = (1 << 26) % num;\n    let acc = 0;\n\n    for (let i = this.length - 1; i >= 0; i--) acc = (p * acc + (this.words[i] | 0)) % num;\n\n    return this.negative !== 0 ? -acc | 0 : acc;\n  }\n  /*\n   * Euclidean Division + Modulo\n   */\n\n\n  divmod(num) {\n    return this._div(num, modes.BOTH | modes.EUCLID);\n  }\n  /*\n   * Euclidean Division\n   */\n\n\n  idiv(num) {\n    return this.div(num)._move(this);\n  }\n\n  idivn(num) {\n    if (this.negative === 0) return this.iquon(num);\n    const r = this.remrn(num);\n    this.iquon(num);\n\n    if (r < 0) {\n      if (num < 0) this.iaddn(1);else this.isubn(1);\n    }\n\n    return this;\n  }\n\n  div(num) {\n    return this._div(num, modes.BOTH | modes.EUCLID)[0];\n  }\n\n  divn(num) {\n    return this.clone().idivn(num);\n  }\n  /*\n   * Euclidean Modulo\n   */\n\n\n  imod(num) {\n    if (this.ucmp(num) < 0) {\n      if (this.negative !== 0) {\n        this._isub(num, this);\n\n        this.negative = 0;\n      }\n\n      return this;\n    }\n\n    return this.mod(num)._move(this);\n  }\n\n  imodn(num) {\n    this.words[0] = this.modrn(num);\n    this.length = 1;\n    this.negative = 0;\n    return this;\n  }\n\n  mod(num) {\n    return this._div(num, modes.REM | modes.EUCLID)[1];\n  }\n\n  modn(num) {\n    return this.clone().imodn(num);\n  }\n\n  modrn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    let r = this.remrn(num);\n\n    if (r < 0) {\n      if (num < 0) r -= num;else r += num;\n    }\n\n    return r;\n  }\n  /*\n   * Round Division\n   */\n\n\n  divRound(num) {\n    const [q, r] = this.quorem(num); // Fast case - exact division.\n\n    if (r.isZero()) return q;\n    const bit = num.words[0] & 1;\n    num.iushrn(1);\n    const cmp = r.ucmp(num);\n    num.iushln(1);\n    num.words[0] |= bit; // Round down.\n\n    if (cmp < 0 || num.isOdd() && cmp === 0) return q; // Round up.\n\n    if (this.negative ^ num.negative) return q.isubn(1);\n    return q.iaddn(1);\n  }\n  /*\n   * Exponentiation\n   */\n\n\n  ipow(num) {\n    return this.pow(num)._move(this);\n  }\n\n  ipown(num) {\n    return this.pown(num)._move(this);\n  }\n\n  pow(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    let b = countBits(num.words[num.length - 1]);\n    let r = new BN(1);\n\n    for (let i = num.length - 1; i >= 0; i--) {\n      const word = num.words[i];\n\n      for (let j = b - 1; j >= 0; j--) {\n        r = r.sqr();\n        if (word >> j & 1) r = r.mul(this);\n      }\n\n      b = 26;\n    }\n\n    return r;\n  }\n\n  pown(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    if (num < 0) num = -num;\n    if (num === 0) return new BN(1);\n    if (num === 1) return this.clone();\n    const bits = countBits(num);\n    let r = this;\n\n    for (let i = bits - 2; i >= 0; i--) {\n      r = r.sqr();\n      if (num >> i & 1) r = r.mul(this);\n    }\n\n    return r;\n  }\n\n  isqr() {\n    return this.imul(this);\n  }\n\n  sqr() {\n    return this.mul(this);\n  }\n  /*\n   * Roots Engine\n   */\n\n\n  _rootrem(pow, rem) {\n    enforce(pow >>> 0 === pow, 'num', 'uint32');\n    if (pow === 0) throw new RangeError('Zeroth root.');\n    if (~pow & this.negative) throw new RangeError('Negative with even root.');\n    if (this.ucmpn(1) <= 0) return [this.clone(), new BN(0)];\n    let u = new BN(0);\n    let t = BN.shift(1, this.bitLength() / pow + 1 | 0);\n    let v, r;\n    if (this.negative !== 0) t.ineg();\n\n    if (pow === 2) {\n      do {\n        u = t;\n        t = this.quo(u);\n        t.iadd(u);\n        t.iushrn(1);\n      } while (t.ucmp(u) < 0);\n    } else {\n      do {\n        u = t;\n        t = u.pown(pow - 1);\n        t = this.quo(t);\n        v = u.muln(pow - 1);\n        t.iadd(v);\n        t = t.quon(pow);\n      } while (t.ucmp(u) < 0);\n    }\n\n    if (rem) {\n      t = u.pown(pow);\n      r = this.sub(t);\n    }\n\n    return [u, r];\n  }\n  /*\n   * Roots\n   */\n\n\n  rootrem(pow) {\n    return this._rootrem(pow, 1);\n  }\n\n  iroot(pow) {\n    return this.root(pow)._move(this);\n  }\n\n  root(pow) {\n    return this._rootrem(pow, 0)[0];\n  }\n\n  isPower(pow) {\n    enforce(pow >>> 0 === pow, 'num', 'uint32');\n    if (pow === 0 || ~pow & this.negative) return false;\n    const [, r] = this.rootrem(pow);\n    return r.sign() === 0;\n  }\n\n  sqrtrem() {\n    return this.rootrem(2);\n  }\n\n  isqrt() {\n    return this.sqrt()._move(this);\n  }\n\n  sqrt() {\n    return this.root(2);\n  }\n\n  isSquare() {\n    return this.isPower(2);\n  }\n  /*\n   * AND\n   */\n\n\n  iand(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    let x = this;\n    let y = num;\n    if (x === y) return x;\n    if ((x.negative | y.negative) === 0) return x.iuand(y);\n\n    if ((x.negative & y.negative) === 1) {\n      // (-x) & (-y) == ~(x-1) & ~(y-1)\n      //             == ~((x-1) | (y-1))\n      //             == -(((x-1) | (y-1)) + 1)\n      x.iaddn(1);\n      y.iaddn(1);\n      x.iuor(y);\n      x.isubn(1);\n      y.isubn(1);\n      return x;\n    } // Assume x is the positive number.\n\n\n    if (x.negative !== 0) [x, y] = [y.clone(), x]; // x & (-y) == x & ~(y-1)\n    //          == x & ~(y-1)\n\n    const width = x.bitLength();\n    y.iaddn(1);\n    y.inotn(width);\n    x.iuand(y);\n    y.inotn(width);\n    y.isubn(1);\n    return x._move(this);\n  }\n\n  iandn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    if ((this.negative | num < 0) !== 0) return this.iand(new BN(num));\n    this.words[0] &= num;\n    this.length = 1;\n    return this;\n  }\n\n  and(num) {\n    return this.clone().iand(num);\n  }\n\n  andn(num) {\n    return this.clone().iandn(num);\n  }\n\n  andrn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n\n    if ((this.negative | num < 0) !== 0) {\n      const n = this.iand(new BN(num));\n      if (n.length > 1) throw new RangeError('Number exceeds 26 bits.');\n      return n.negative !== 0 ? -n.words[0] : n.words[0];\n    }\n\n    return this.words[0] & num;\n  }\n  /*\n   * Unsigned AND\n   */\n\n\n  iuand(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    this.length = Math.min(this.length, num.length);\n\n    for (let i = 0; i < this.length; i++) this.words[i] &= num.words[i];\n\n    return this._strip();\n  }\n\n  iuandn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    this.words[0] &= Math.abs(num);\n    this.length = 1;\n    return this._normalize();\n  }\n\n  uand(num) {\n    return this.clone().iuand(num);\n  }\n\n  uandn(num) {\n    return this.clone().iuandn(num);\n  }\n\n  uandrn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    const n = this.words[0] & Math.abs(num);\n    return this.negative !== 0 ? -n | 0 : n;\n  }\n  /*\n   * OR\n   */\n\n\n  ior(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    let x = this;\n    let y = num;\n    if (x === y) return x;\n    if ((x.negative | y.negative) === 0) return x.iuor(y);\n\n    if ((x.negative & y.negative) === 1) {\n      // (-x) | (-y) == ~(x-1) | ~(y-1)\n      //             == ~((x-1) & (y-1))\n      //             == -(((x-1) & (y-1)) + 1)\n      x.iaddn(1);\n      y.iaddn(1);\n      x.iuand(y);\n      x.isubn(1);\n      y.isubn(1);\n      return x;\n    } // Assume x is the positive number.\n\n\n    y = y.clone();\n    if (x.negative !== 0) [x, y] = [y, x]; // x | (-y) == x | ~(y-1)\n    //          == ~((y-1) & ~x)\n    //          == -(((y-1) & ~x) + 1)\n\n    y.iaddn(1);\n    x.inotn(y.bitLength());\n    y.iuand(x);\n    y.isubn(1);\n    return y._move(this);\n  }\n\n  iorn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    if ((this.negative | num < 0) !== 0) return this.ior(new BN(num));\n    this.words[0] |= num;\n    return this;\n  }\n\n  or(num) {\n    return this.clone().ior(num);\n  }\n\n  orn(num) {\n    return this.clone().iorn(num);\n  }\n  /*\n   * Unsigned OR\n   */\n\n\n  iuor(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    this._expand(num.length);\n\n    for (let i = 0; i < num.length; i++) this.words[i] |= num.words[i]; // Note: we shouldn't need to strip here.\n\n\n    return this;\n  }\n\n  iuorn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    this.words[0] |= Math.abs(num);\n    return this;\n  }\n\n  uor(num) {\n    return this.clone().iuor(num);\n  }\n\n  uorn(num) {\n    return this.clone().iuorn(num);\n  }\n  /*\n   * XOR\n   */\n\n\n  ixor(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    let x = this;\n    let y = num;\n\n    if (x === y) {\n      x.words[0] = 0;\n      x.length = 1;\n      x.negative = 0;\n      return x;\n    }\n\n    if ((x.negative | y.negative) === 0) return x.iuxor(y);\n\n    if ((x.negative & y.negative) === 1) {\n      // (-x) ^ (-y) == ~(x-1) ^ ~(y-1)\n      //             == (x-1) ^ (y-1)\n      x.iaddn(1);\n      y.iaddn(1);\n      x.iuxor(y);\n      x.ineg();\n      y.isubn(1);\n      return x;\n    } // Assume x is the positive number.\n\n\n    if (x.negative !== 0) [x, y] = [y.clone(), x]; // x ^ (-y) == x ^ ~(y-1)\n    //          == ~(x ^ (y-1))\n    //          == -((x ^ (y-1)) + 1)\n\n    y.iaddn(1);\n    x.iuxor(y);\n    x.iaddn(1);\n    x.ineg();\n    y.isubn(1);\n    return x._move(this);\n  }\n\n  ixorn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    if ((this.negative | num < 0) !== 0) return this.ixor(new BN(num));\n    this.words[0] ^= num;\n    return this;\n  }\n\n  xor(num) {\n    return this.clone().ixor(num);\n  }\n\n  xorn(num) {\n    return this.clone().ixorn(num);\n  }\n  /*\n   * Unsigned XOR\n   */\n\n\n  iuxor(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    let a = this;\n    let b = num;\n    if (a.length < b.length) [a, b] = [b, a];\n    let i = 0;\n\n    for (; i < b.length; i++) this.words[i] = a.words[i] ^ b.words[i];\n\n    if (a !== this) {\n      this._alloc(a.length);\n\n      for (; i < a.length; i++) this.words[i] = a.words[i];\n    }\n\n    this.length = a.length;\n    return this._strip();\n  }\n\n  iuxorn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    this.words[0] ^= Math.abs(num);\n    return this._normalize();\n  }\n\n  uxor(num) {\n    return this.clone().iuxor(num);\n  }\n\n  uxorn(num) {\n    return this.clone().iuxorn(num);\n  }\n  /*\n   * NOT\n   */\n\n\n  inot() {\n    if (this.negative !== 0) {\n      // ~(-x) == ~(~(x-1)) == x-1\n      this.ineg().isubn(1);\n    } else {\n      // ~x == -x-1 == -(x+1)\n      this.iaddn(1).ineg();\n    }\n\n    return this;\n  }\n\n  not() {\n    return this.clone().inot();\n  }\n\n  inotn(width) {\n    enforce(width >>> 0 === width, 'width', 'uint32');\n    const r = width % 26;\n    let s = Math.ceil(width / 26);\n    let i = 0; // Extend the buffer with leading zeroes.\n\n    this._expand(s);\n\n    if (r > 0) s -= 1; // Handle complete words.\n\n    for (; i < s; i++) this.words[i] ^= 0x3ffffff; // Handle the residue.\n\n\n    if (r > 0) this.words[i] ^= (1 << r) - 1; // And remove leading zeroes.\n\n    return this._strip();\n  }\n\n  notn(width) {\n    return this.clone().inotn(width);\n  }\n  /*\n   * Left Shift\n   */\n\n\n  ishl(num) {\n    enforce(BN.isBN(num), 'bits', 'bignum');\n    enforce(num.bitLength() <= 32, 'bits', 'uint32');\n    return this.ishln(num.toNumber());\n  }\n\n  ishln(bits) {\n    return this.iushln(bits);\n  }\n\n  shl(num) {\n    return this.clone().ishl(num);\n  }\n\n  shln(bits) {\n    return this.clone().ishln(bits);\n  }\n  /*\n   * Unsigned Left Shift\n   */\n\n\n  iushl(num) {\n    enforce(BN.isBN(num), 'bits', 'bignum');\n    enforce(num.bitLength() <= 32, 'bits', 'uint32');\n    return this.iushln(num.toNumber());\n  }\n\n  iushln(bits) {\n    enforce(bits >>> 0 === bits, 'bits', 'uint32');\n    const r = bits % 26;\n    const s = (bits - r) / 26;\n    const mask = (1 << r) - 1 << 26 - r;\n\n    if (r !== 0) {\n      let carry = 0;\n\n      for (let i = 0; i < this.length; i++) {\n        const ncarry = this.words[i] & mask;\n        const c = (this.words[i] | 0) - ncarry << r;\n        this.words[i] = c | carry;\n        carry = ncarry >>> 26 - r;\n      }\n\n      if (carry !== 0) {\n        this._alloc(this.length + 1);\n\n        this.words[this.length++] = carry;\n      }\n    }\n\n    if (s !== 0) {\n      this._alloc(this.length + s);\n\n      for (let i = this.length - 1; i >= 0; i--) this.words[i + s] = this.words[i];\n\n      for (let i = 0; i < s; i++) this.words[i] = 0;\n\n      this.length += s;\n    }\n\n    return this._strip();\n  }\n\n  ushl(num) {\n    return this.clone().iushl(num);\n  }\n\n  ushln(bits) {\n    return this.clone().iushln(bits);\n  }\n  /*\n   * Right Shift Engine\n   */\n\n\n  _split(bits, output) {\n    const r = bits % 26;\n    const s = Math.min((bits - r) / 26, this.length);\n    const mask = (1 << r) - 1; // Extended mode, copy masked part.\n\n    if (output) {\n      output._alloc(s);\n\n      for (let i = 0; i < s; i++) output.words[i] = this.words[i];\n\n      output.length = s;\n    }\n\n    if (s === 0) {// No-op, we should not move anything at all.\n    } else if (this.length > s) {\n      this.length -= s;\n\n      for (let i = 0; i < this.length; i++) this.words[i] = this.words[i + s];\n    } else {\n      this.words[0] = 0;\n      this.length = 1;\n    }\n\n    let carry = 0;\n\n    if (r !== 0) {\n      for (let i = this.length - 1; i >= 0; i--) {\n        const word = this.words[i] | 0;\n        this.words[i] = carry << 26 - r | word >>> r;\n        carry = word & mask;\n      }\n    } // Push carried bits as a mask.\n\n\n    if (output) {\n      if (carry !== 0) {\n        output._alloc(output.length + 1);\n\n        output.words[output.length++] = carry;\n      } else {\n        if (output.length === 0) output.words[output.length++] = 0;\n\n        output._strip();\n      }\n    }\n\n    return this._strip();\n  }\n  /*\n   * Right Shift\n   */\n\n\n  ishr(num) {\n    enforce(BN.isBN(num), 'bits', 'bignum');\n    enforce(num.bitLength() <= 32, 'bits', 'uint32');\n    return this.ishrn(num.toNumber());\n  }\n\n  ishrn(bits) {\n    enforce(bits >>> 0 === bits, 'bits', 'uint32');\n\n    if (this.negative !== 0) {\n      // (-x) >> y == ~(x-1) >> y\n      //           == ~((x-1) >> y)\n      //           == -(((x-1) >> y) + 1)\n      this.iaddn(1);\n      this.iushrn(bits);\n      this.isubn(1);\n      return this;\n    }\n\n    return this.iushrn(bits);\n  }\n\n  shr(num) {\n    return this.clone().ishr(num);\n  }\n\n  shrn(bits) {\n    return this.clone().ishrn(bits);\n  }\n  /*\n   * Unsigned Right Shift\n   */\n\n\n  iushr(num) {\n    enforce(BN.isBN(num), 'bits', 'bignum');\n    enforce(num.bitLength() <= 32, 'bits', 'uint32');\n    return this.iushrn(num.toNumber());\n  }\n\n  iushrn(bits) {\n    enforce(bits >>> 0 === bits, 'bits', 'uint32');\n    return this._split(bits, null);\n  }\n\n  ushr(num) {\n    return this.clone().iushr(num);\n  }\n\n  ushrn(bits) {\n    return this.clone().iushrn(bits);\n  }\n  /*\n   * Bit Manipulation\n   */\n\n\n  setn(bit, val) {\n    enforce(bit >>> 0 === bit, 'bit', 'uint32');\n\n    if (this.negative !== 0) {\n      this.iaddn(1);\n      this.usetn(bit, !val);\n      this.isubn(1);\n      return this;\n    }\n\n    return this.usetn(bit, val);\n  }\n\n  usetn(bit, val) {\n    enforce(bit >>> 0 === bit, 'bit', 'uint32');\n    const r = bit % 26;\n    const s = (bit - r) / 26;\n\n    this._expand(s + 1);\n\n    if (val) this.words[s] |= 1 << r;else this.words[s] &= ~(1 << r);\n    return this._strip();\n  }\n\n  testn(bit) {\n    enforce(bit >>> 0 === bit, 'bit', 'uint32');\n    const r = bit % 26;\n    const s = (bit - r) / 26; // Fast case: bit is much higher than all existing words.\n\n    if (this.length <= s) return this.negative; // Check bit and return.\n\n    const w = this.words[s];\n    const val = w >> r & 1;\n\n    if (this.negative !== 0) {\n      if (r > 0 && w & (1 << r) - 1) return val ^ 1;\n      let j = s;\n\n      while (j--) {\n        if (this.words[j] > 0) return val ^ 1;\n      }\n    }\n\n    return val;\n  }\n\n  utestn(bit) {\n    enforce(bit >>> 0 === bit, 'bit', 'uint32');\n    const r = bit % 26;\n    const s = (bit - r) / 26; // Fast case: bit is much higher than all existing words.\n\n    if (this.length <= s) return 0; // Check bit and return.\n\n    return this.words[s] >> r & 1;\n  }\n\n  imaskn(bits) {\n    enforce(bits >>> 0 === bits, 'bits', 'uint32');\n\n    if (this.negative !== 0) {\n      this.iaddn(1);\n      this.inotn(bits + 1);\n      this.ineg();\n    }\n\n    return this.iumaskn(bits);\n  }\n\n  maskn(bits) {\n    return this.clone().imaskn(bits);\n  }\n\n  iumaskn(bits) {\n    enforce(bits >>> 0 === bits, 'bits', 'uint32');\n    const r = bits % 26;\n    let s = (bits - r) / 26;\n    if (this.length <= s) return this;\n    if (r !== 0) s += 1;\n    this.length = Math.min(s, this.length);\n    if (r !== 0) this.words[this.length - 1] &= (1 << r) - 1;\n    if (this.length === 0) this.words[this.length++] = 0;\n    return this._strip();\n  }\n\n  umaskn(bits) {\n    return this.clone().iumaskn(bits);\n  }\n\n  andln(num) {\n    return this.words[0] & num;\n  }\n\n  bit(pos) {\n    return this.utestn(pos);\n  }\n\n  bits(pos, width) {\n    enforce(pos >>> 0 === pos, 'pos', 'uint32');\n    enforce(width >>> 0 === width, 'width', 'uint32');\n    enforce(width <= 26, 'width', 'width');\n    const shift = pos % 26;\n    const index = (pos - shift) / 26;\n    if (index >= this.length) return 0;\n    let bits = this.words[index] >> shift & (1 << width) - 1;\n\n    if (shift + width > 26 && index + 1 < this.length) {\n      const more = shift + width - 26;\n      const next = this.words[index + 1] & (1 << more) - 1;\n      bits |= next << 26 - shift;\n    }\n\n    return bits;\n  }\n  /*\n   * Negation\n   */\n\n\n  ineg() {\n    if (!this.isZero()) this.negative ^= 1;\n    return this;\n  }\n\n  neg() {\n    return this.clone().ineg();\n  }\n\n  iabs() {\n    this.negative = 0;\n    return this;\n  }\n\n  abs() {\n    return this.clone().iabs();\n  }\n  /*\n   * Comparison\n   */\n\n\n  cmp(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    if (this.negative !== num.negative) return num.negative - this.negative;\n    const res = this.ucmp(num);\n    if (this.negative !== 0) return -res | 0;\n    return res;\n  }\n\n  cmpn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    const negative = num < 0 | 0;\n    if (this.negative !== negative) return negative - this.negative;\n    const res = this.ucmpn(num);\n    if (this.negative !== 0) return -res | 0;\n    return res;\n  }\n\n  eq(num) {\n    return this.cmp(num) === 0;\n  }\n\n  eqn(num) {\n    return this.cmpn(num) === 0;\n  }\n\n  gt(num) {\n    return this.cmp(num) > 0;\n  }\n\n  gtn(num) {\n    return this.cmpn(num) > 0;\n  }\n\n  gte(num) {\n    return this.cmp(num) >= 0;\n  }\n\n  gten(num) {\n    return this.cmpn(num) >= 0;\n  }\n\n  lt(num) {\n    return this.cmp(num) < 0;\n  }\n\n  ltn(num) {\n    return this.cmpn(num) < 0;\n  }\n\n  lte(num) {\n    return this.cmp(num) <= 0;\n  }\n\n  lten(num) {\n    return this.cmpn(num) <= 0;\n  }\n\n  sign() {\n    if (this.negative !== 0) return -1;\n    if (this.length === 1 && this.words[0] === 0) return 0;\n    return 1;\n  }\n\n  isZero() {\n    return this.length === 1 && this.words[0] === 0;\n  }\n\n  isNeg() {\n    return this.negative !== 0;\n  }\n\n  isPos() {\n    return this.negative === 0;\n  }\n\n  isOdd() {\n    return (this.words[0] & 1) === 1;\n  }\n\n  isEven() {\n    return (this.words[0] & 1) === 0;\n  }\n  /*\n   * Unsigned Comparison\n   */\n\n\n  ucmp(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    if (this.length < num.length) return -1;\n    if (this.length > num.length) return 1;\n\n    for (let i = this.length - 1; i >= 0; i--) {\n      const a = this.words[i] | 0;\n      const b = num.words[i] | 0;\n      if (a === b) continue;\n      return (a > b) - (a < b);\n    }\n\n    return 0;\n  }\n\n  ucmpn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    if (this.length > 1) return 1;\n    const w = this.words[0] | 0;\n    if (num < 0) num = -num;\n    return (w > num) - (w < num);\n  }\n  /*\n   * Number Theoretic Functions\n   */\n\n\n  legendre(num) {\n    const red = HAS_BIGINT ? BN.red(num) : BN.mont(num);\n    return this.toRed(red).redLegendre();\n  }\n\n  jacobi(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    if (num.isZero() || num.isEven()) throw new Error('jacobi: `num` must be odd.');\n\n    let a = this._cloneNormal();\n\n    let b = num.clone();\n    let j = 1;\n\n    if (b.isNeg()) {\n      if (a.isNeg()) j = -1;\n      b.ineg();\n    }\n\n    for (;;) {\n      if (b.cmpn(1) === 0) return j;\n      if (a.isZero()) return 0;\n      a.imod(b);\n      if (a.isZero()) return 0;\n      const s = a.zeroBits();\n\n      if (s & 1) {\n        const bmod8 = b.andln(7);\n        if (bmod8 === 3 || bmod8 === 5) j = -j;\n      }\n\n      const c = a.iushrn(s);\n      if (b.andln(3) === 3 && c.andln(3) === 3) j = -j;\n      a = b;\n      b = c;\n    }\n  }\n\n  kronecker(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    const table = [0, 1, 0, -1, 0, -1, 0, 1];\n\n    let a = this._cloneNormal();\n\n    let b = num.clone();\n    let s = 1;\n    if (b.isZero()) return a.ucmpn(1) === 0 ? s : 0;\n    if (!a.isOdd() && !b.isOdd()) return 0;\n    const z = b.zeroBits();\n    b.iushrn(z);\n    if (z & 1) s = table[a.andln(7)];\n\n    if (b.isNeg()) {\n      if (a.isNeg()) s = -s;\n      b.ineg();\n    }\n\n    for (;;) {\n      if (a.isZero()) return b.cmpn(1) === 0 ? s : 0;\n      const z = a.zeroBits();\n      a.iushrn(z);\n      if (z & 1) s *= table[b.andln(7)];\n      const w = a.words[0] ^ a.negative * 0x3ffffff;\n      if (w & b.words[0] & 2) s = -s;\n      b.imod(a);\n      [a, b] = [b, a];\n      b.negative = 0;\n    }\n  }\n\n  igcd(num) {\n    return this.gcd(num)._move(this);\n  }\n\n  gcd(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    if (this.isZero()) return num.abs();\n    if (num.isZero()) return this.abs();\n    let a = this.clone();\n    let b = num.clone();\n    a.negative = 0;\n    b.negative = 0; // Remove common factor of two.\n\n    const shift = a._factor2(b);\n\n    if (shift !== 0) {\n      a.iushrn(shift);\n      b.iushrn(shift);\n    }\n\n    for (;;) {\n      const az = a.zeroBits();\n      const bz = b.zeroBits();\n      if (az !== 0) a.iushrn(az);\n      if (bz !== 0) b.iushrn(bz);\n      const cmp = a.ucmp(b);\n\n      if (cmp < 0) {\n        // a > b\n        [a, b] = [b, a];\n      } else if (cmp === 0 || b.ucmpn(1) === 0) {\n        // Break if a == b.\n        // Break if b == 1 to avoid repeated subtraction.\n        break;\n      }\n\n      a._isub(a, b);\n    }\n\n    return b.iushln(shift);\n  }\n\n  ilcm(num) {\n    return this.lcm(num)._move(this);\n  }\n\n  lcm(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    if (this.isZero() || num.isZero()) return new BN(0);\n    return this.quo(this.gcd(num)).mul(num).iabs();\n  }\n\n  egcd(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    if (this.isZero()) {\n      return [new BN(0), new BN(num.sign()), num.abs()];\n    }\n\n    if (num.isZero()) {\n      return [new BN(this.sign()), new BN(0), this.abs()];\n    }\n\n    const x = this.clone();\n    const y = num.clone();\n    x.negative = 0;\n    y.negative = 0; // A * x + B * y = x\n\n    const A = new BN(1);\n    const B = new BN(0); // C * x + D * y = y\n\n    const C = new BN(0);\n    const D = new BN(1); // Remove common factor of two.\n\n    const g = x._factor2(y);\n\n    if (g !== 0) {\n      x.iushrn(g);\n      y.iushrn(g);\n    }\n\n    const yp = y.clone();\n    const xp = x.clone();\n\n    while (!x.isZero()) {\n      let i = 0;\n\n      for (let im = 1; (x.words[0] & im) === 0 && i < 26; im <<= 1) i += 1;\n\n      if (i > 0) {\n        x.iushrn(i);\n\n        while (i > 0) {\n          if (A.isOdd() || B.isOdd()) {\n            A.iadd(yp);\n            B.isub(xp);\n          }\n\n          A.iushrn(1);\n          B.iushrn(1);\n          i -= 1;\n        }\n      }\n\n      let j = 0;\n\n      for (let jm = 1; (y.words[0] & jm) === 0 && j < 26; jm <<= 1) j += 1;\n\n      if (j > 0) {\n        y.iushrn(j);\n\n        while (j > 0) {\n          if (C.isOdd() || D.isOdd()) {\n            C.iadd(yp);\n            D.isub(xp);\n          }\n\n          C.iushrn(1);\n          D.iushrn(1);\n          j -= 1;\n        }\n      }\n\n      if (x.cmp(y) >= 0) {\n        x.isub(y);\n        A.isub(C);\n        B.isub(D);\n      } else {\n        y.isub(x);\n        C.isub(A);\n        D.isub(B);\n      }\n    }\n\n    if (this.negative !== 0) C.ineg();\n    if (num.negative !== 0) D.ineg();\n    return [C, D, y.iushln(g)];\n  }\n\n  iinvert(num) {\n    return this.invert(num)._move(this);\n  }\n\n  invert(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    range(num.sign() > 0, 'invert');\n    if (num.cmpn(1) === 0) throw new RangeError('Not invertible.');\n    const [s,, g] = this.egcd(num);\n    if (g.cmpn(1) !== 0) throw new RangeError('Not invertible.');\n    return s.imod(num);\n  }\n\n  ifermat(num) {\n    return this.fermat(num)._move(this);\n  }\n\n  fermat(num) {\n    const red = HAS_BIGINT ? BN.red(num) : BN.mont(num);\n    return this.toRed(red).redFermat().fromRed();\n  }\n\n  ipowm(y, m, mont) {\n    return this.powm(y, m, mont)._move(this);\n  }\n\n  powm(y, m, mont) {\n    const red = !HAS_BIGINT && mont ? BN.mont(m) : BN.red(m);\n    return this.toRed(red).redPow(y).fromRed();\n  }\n\n  ipowmn(y, m, mont) {\n    return this.powmn(y, m, mont)._move(this);\n  }\n\n  powmn(y, m, mont) {\n    const red = mont ? BN.mont(m) : BN.red(m);\n    return this.toRed(red).redPown(y).fromRed();\n  }\n\n  isqrtm(p) {\n    return this.sqrtm(p)._move(this);\n  }\n\n  sqrtm(p) {\n    enforce(BN.isBN(p), 'p', 'bignum');\n    let red;\n\n    if (p.andln(3) === 3 || p.andln(7) === 5) {\n      // Probably not worth the setup.\n      red = BN.red(p);\n    } else {\n      red = BN.mont(p);\n    }\n\n    return this.toRed(red).redSqrt().fromRed();\n  }\n\n  isqrtpq(p, q) {\n    return this.sqrtpq(p, q)._move(this);\n  }\n\n  sqrtpq(p, q) {\n    const sp = this.sqrtm(p);\n    const sq = this.sqrtm(q);\n    const [mp, mq] = p.egcd(q);\n    const lhs = sq.mul(mp).mul(p);\n    const rhs = sp.mul(mq).mul(q);\n    const n = p.mul(q);\n    return lhs.iadd(rhs).imod(n);\n  }\n  /*\n   * Primality Testing\n   */\n\n\n  isPrime(rng, reps, limit) {\n    enforce(reps >>> 0 === reps, 'reps', 'uint32');\n    if (!this.isPrimeMR(rng, reps + 1, true)) return false;\n    if (!this.isPrimeLucas(limit)) return false;\n    return true;\n  }\n\n  isPrimeMR(rng, reps, force2 = false) {\n    enforce(reps >>> 0 === reps, 'reps', 'uint32');\n    enforce(reps > 0, 'reps', 'integer');\n    enforce(typeof force2 === 'boolean', 'force2', 'boolean');\n    const n = this;\n\n    if (n.cmpn(7) < 0) {\n      return n.cmpn(2) === 0 || n.cmpn(3) === 0 || n.cmpn(5) === 0;\n    }\n\n    if (n.isEven()) return false;\n    const nm1 = n.subn(1);\n    const nm3 = nm1.subn(2);\n    const k = nm1.zeroBits();\n    const q = nm1.ushrn(k);\n    const red = BN.red(n);\n    const rnm1 = nm1.toRed(red);\n    const rone = new BN(1).toRed(red);\n\n    next: for (let i = 0; i < reps; i++) {\n      let x;\n\n      if (i === reps - 1 && force2) {\n        x = new BN(2);\n      } else {\n        x = BN.random(rng, 0, nm3);\n        x.iaddn(2);\n      }\n\n      let y = x.toRed(red).redPow(q);\n      if (y.cmp(rone) === 0 || y.cmp(rnm1) === 0) continue;\n\n      for (let j = 1; j < k; j++) {\n        y = y.redSqr();\n        if (y.cmp(rnm1) === 0) continue next;\n        if (y.cmp(rone) === 0) return false;\n      }\n\n      return false;\n    }\n\n    return true;\n  }\n\n  isPrimeLucas(limit = 0) {\n    enforce(limit >>> 0 === limit, 'limit', 'uint32');\n    const n = this; // Ignore 0 and 1.\n\n    if (n.cmpn(1) <= 0) return false; // Two is the only even prime.\n\n    if (n.isEven()) return n.cmpn(2) === 0;\n    let p = 3;\n\n    for (;;) {\n      if (p > 10000) {\n        // Thought to be impossible.\n        throw new Error(`Cannot find (D/n) = -1 for ${n.toString(10)}.`);\n      }\n\n      if (limit !== 0 && p > limit) {\n        // Optional DoS limit.\n        return false;\n      }\n\n      const d = new BN(p * p - 4);\n      const j = d.jacobi(n);\n      if (j === -1) break;\n      if (j === 0) return n.cmpn(p + 2) === 0;\n\n      if (p === 40) {\n        if (n.isSquare()) return false;\n      }\n\n      p += 1;\n    }\n\n    const s = n.addn(1);\n    const r = s.zeroBits();\n    const nm2 = n.subn(2);\n    let x = new BN(2);\n    let y = new BN(p);\n    s.iushrn(r);\n\n    for (let i = s.bitLength(); i >= 0; i--) {\n      if (s.utestn(i)) {\n        x = x.mul(y).iadd(n).isubn(p).imod(n);\n        y = y.sqr().iadd(nm2).imod(n);\n      } else {\n        y = y.mul(x).iadd(n).isubn(p).imod(n);\n        x = x.sqr().iadd(nm2).imod(n);\n      }\n    }\n\n    if (x.cmpn(2) === 0 || x.cmp(nm2) === 0) {\n      let a = x.muln(p);\n      let b = y.ushln(1);\n      if (a.cmp(b) < 0) [a, b] = [b, a];\n      if (a.isub(b).imod(n).isZero()) return true;\n    }\n\n    for (let t = 0; t < r - 1; t++) {\n      if (x.isZero()) return true;\n      if (x.cmpn(2) === 0) return false;\n      x = x.sqr().isubn(2).imod(n);\n    }\n\n    return false;\n  }\n  /*\n   * Twos Complement\n   */\n\n\n  toTwos(width) {\n    if (this.negative !== 0) return this.abs().inotn(width).iaddn(1);\n    return this.clone();\n  }\n\n  fromTwos(width) {\n    enforce(width >>> 0 === width, 'width', 'uint32');\n    range(width > 0, 'width');\n    if (this.testn(width - 1)) return this.notn(width).iaddn(1).ineg();\n    return this.clone();\n  }\n  /*\n   * Reduction Context\n   */\n\n\n  toRed(ctx) {\n    enforce(ctx instanceof Red, 'ctx', 'reduction context');\n    if (this.red) throw new Error('Already in reduction context.');\n    return ctx.convertTo(this);\n  }\n\n  fromRed() {\n    red(this.red, 'fromRed');\n    return this.red.convertFrom(this);\n  }\n\n  forceRed(ctx) {\n    enforce(ctx instanceof Red, 'ctx', 'reduction context');\n\n    if (this.red) {\n      if (!ctx.m.eq(this.red.m) || ctx.mont !== this.red.mont) throw new Error('Already in reduction context.');\n    } else {\n      range(this.negative === 0, 'red');\n      range(this.ucmp(ctx.m) < 0, 'red');\n    }\n\n    return this.clone()._forceRed(ctx);\n  }\n\n  redIAdd(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redIAdd');\n    return this.red.iadd(this, num);\n  }\n\n  redAdd(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redAdd');\n    return this.red.add(this, num);\n  }\n\n  redIAddn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redIAddn');\n    return this.red.iaddn(this, num);\n  }\n\n  redAddn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redAddn');\n    return this.red.addn(this, num);\n  }\n\n  redISub(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redISub');\n    return this.red.isub(this, num);\n  }\n\n  redSub(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redSub');\n    return this.red.sub(this, num);\n  }\n\n  redISubn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redISubn');\n    return this.red.isubn(this, num);\n  }\n\n  redSubn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redSubn');\n    return this.red.subn(this, num);\n  }\n\n  redIMul(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redIMul');\n    return this.red.imul(this, num);\n  }\n\n  redMul(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redMul');\n    return this.red.mul(this, num);\n  }\n\n  redIMuln(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redIMuln');\n    return this.red.imuln(this, num);\n  }\n\n  redMuln(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redMuln');\n    return this.red.muln(this, num);\n  }\n\n  redIDiv(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redIDiv');\n    return this.red.idiv(this, num);\n  }\n\n  redDiv(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redDiv');\n    return this.red.div(this, num);\n  }\n\n  redIDivn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redIDivn');\n    return this.red.idivn(this, num);\n  }\n\n  redDivn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redDivn');\n    return this.red.divn(this, num);\n  }\n\n  redIPow(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redIPow');\n    nonred(!num.red, 'redIPow');\n    return this.red.ipow(this, num);\n  }\n\n  redPow(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redPow');\n    nonred(!num.red, 'redPow');\n    return this.red.pow(this, num);\n  }\n\n  redIPown(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redIPown');\n    return this.red.ipown(this, num);\n  }\n\n  redPown(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redPown');\n    return this.red.pown(this, num);\n  }\n\n  redISqr() {\n    red(this.red, 'redISqr');\n    return this.red.isqr(this);\n  }\n\n  redSqr() {\n    red(this.red, 'redSqr');\n    return this.red.sqr(this);\n  }\n\n  redISqrt() {\n    red(this.red, 'redISqrt');\n    return this.red.isqrt(this);\n  }\n\n  redSqrt() {\n    red(this.red, 'redSqrt');\n    return this.red.sqrt(this);\n  }\n\n  redIDivSqrt(v) {\n    red(this.red, 'redIDivSqrt');\n    return this.red.idivsqrt(this, v);\n  }\n\n  redDivSqrt(v) {\n    red(this.red, 'redDivSqrt');\n    return this.red.divsqrt(this, v);\n  }\n\n  redIsSquare() {\n    red(this.red, 'redIsSquare');\n    return this.red.isSquare(this);\n  }\n\n  redIShl(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redIShl');\n    nonred(!num.red, 'redIShl');\n    return this.red.ishl(this, num);\n  }\n\n  redShl(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redShl');\n    nonred(!num.red, 'redShl');\n    return this.red.shl(this, num);\n  }\n\n  redIShln(num) {\n    enforce(num >>> 0 === num, 'num', 'uint32');\n    red(this.red, 'redIShln');\n    return this.red.ishln(this, num);\n  }\n\n  redShln(num) {\n    enforce(num >>> 0 === num, 'num', 'uint32');\n    red(this.red, 'redShln');\n    return this.red.shln(this, num);\n  }\n\n  redINeg() {\n    red(this.red, 'redINeg');\n    return this.red.ineg(this);\n  }\n\n  redNeg() {\n    red(this.red, 'redNeg');\n    return this.red.neg(this);\n  }\n\n  redEq(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redEq');\n    return this.red.eq(this, num);\n  }\n\n  redEqn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redEqn');\n    return this.red.eqn(this, num);\n  }\n\n  redIsHigh() {\n    red(this.red, 'redIsHigh');\n    return this.red.isHigh(this);\n  }\n\n  redIsLow() {\n    red(this.red, 'redIsLow');\n    return this.red.isLow(this);\n  }\n\n  redIsOdd() {\n    red(this.red, 'redIsOdd');\n    return this.red.isOdd(this);\n  }\n\n  redIsEven() {\n    red(this.red, 'redIsEven');\n    return this.red.isEven(this);\n  }\n\n  redLegendre() {\n    red(this.red, 'redLegendre');\n    return this.red.legendre(this);\n  }\n\n  redJacobi() {\n    red(this.red, 'redJacobi');\n    return this.red.jacobi(this);\n  }\n\n  redKronecker() {\n    red(this.red, 'redKronecker');\n    return this.red.kronecker(this);\n  }\n\n  redIInvert() {\n    red(this.red, 'redIInvert');\n    return this.red.iinvert(this);\n  }\n\n  redInvert() {\n    red(this.red, 'redInvert');\n    return this.red.invert(this);\n  }\n\n  redIFermat() {\n    red(this.red, 'redIFermat');\n    return this.red.ifermat(this);\n  }\n\n  redFermat() {\n    red(this.red, 'redFermat');\n    return this.red.fermat(this);\n  }\n  /*\n   * Internal\n   */\n\n\n  _move(dest) {\n    dest.words = this.words;\n    dest.length = this.length;\n    dest.negative = this.negative;\n    dest.red = this.red;\n    return dest;\n  }\n\n  _alloc(size) {\n    while (this.words.length < size) this.words.push(0);\n\n    return this;\n  }\n\n  _expand(size) {\n    this._alloc(size);\n\n    while (this.length < size) this.words[this.length++] = 0;\n\n    return this;\n  }\n\n  _strip() {\n    while (this.length > 1 && this.words[this.length - 1] === 0) this.length -= 1;\n\n    return this._normalize();\n  }\n\n  _normalize() {\n    assert(this.length > 0); // -0 = 0\n\n    if (this.length === 1 && this.words[0] === 0) this.negative = 0;\n    return this;\n  }\n\n  _check() {\n    // We never have a zero length number.\n    assert(this.length > 0); // Cannot exceed array bounds.\n\n    assert(this.length <= this.words.length);\n\n    if (this.length === 1) {\n      // Must be normalized.\n      if (this.words[0] === 0) assert(this.negative === 0);\n      return this;\n    } // Must be stripped.\n\n\n    assert(this.words[this.length - 1] !== 0);\n    return this;\n  }\n\n  _invertp(p) {\n    enforce(BN.isBN(p), 'p', 'bignum');\n    assert(this.negative === 0);\n    assert(p.sign() > 0);\n    if (this.isZero() || p.cmpn(1) === 0) throw new RangeError('Not invertible.');\n    const a = this.clone();\n    const b = p.clone();\n    const x1 = new BN(1);\n    const x2 = new BN(0);\n    const delta = b.clone();\n\n    while (a.cmpn(1) > 0 && b.cmpn(1) > 0) {\n      let i = 0;\n\n      for (let im = 1; (a.words[0] & im) === 0 && i < 26; im <<= 1) i += 1;\n\n      if (i > 0) {\n        a.iushrn(i);\n\n        while (i > 0) {\n          if (x1.isOdd()) x1.iadd(delta);\n          x1.iushrn(1);\n          i -= 1;\n        }\n      }\n\n      let j = 0;\n\n      for (let jm = 1; (b.words[0] & jm) === 0 && j < 26; jm <<= 1) j += 1;\n\n      if (j > 0) {\n        b.iushrn(j);\n\n        while (j > 0) {\n          if (x2.isOdd()) x2.iadd(delta);\n          x2.iushrn(1);\n          j -= 1;\n        }\n      }\n\n      if (a.cmp(b) >= 0) {\n        a.isub(b);\n        x1.isub(x2);\n      } else {\n        b.isub(a);\n        x2.isub(x1);\n      }\n    } // Quick reduction (typically +/- 2P).\n\n\n    const res = a.cmpn(1) === 0 ? x1 : x2;\n\n    if (res.ucmp(p) >= 0) {\n      res._isub(res, p);\n\n      if (res.ucmp(p) >= 0) res._isub(res, p);\n    }\n\n    if (res.isNeg()) res.iadd(p);\n    return res;\n  }\n\n  _factor2(num) {\n    // Find common factor of two.\n    // Expects inputs to be non-zero.\n    if ((this.words[0] | num.words[0]) & 1) return 0;\n    const len = Math.min(this.length, num.length);\n    let r = 0;\n\n    for (let i = 0; i < len; i++) {\n      const b = zeroBits(this.words[i] | num.words[i]);\n      r += b;\n      if (b !== 26) break;\n    }\n\n    return r;\n  }\n\n  _cloneNormal() {\n    return this.red ? this.fromRed() : this.clone();\n  }\n\n  _forceRed(ctx) {\n    this.red = ctx;\n    return this;\n  }\n  /*\n   * Helpers\n   */\n\n\n  clone() {\n    const copy = new BN();\n    copy.words = new Array(this.length);\n\n    for (let i = 0; i < this.length; i++) copy.words[i] = this.words[i];\n\n    copy.length = this.length;\n    copy.negative = this.negative;\n    copy.red = this.red;\n    return copy;\n  }\n\n  inject(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    this._alloc(num.length);\n\n    for (let i = 0; i < num.length; i++) this.words[i] = num.words[i];\n\n    this.length = num.length;\n    this.negative = num.negative;\n    this.red = num.red;\n    return this;\n  }\n\n  set(num, endian) {\n    return this.fromNumber(num, endian);\n  }\n\n  swap(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    const x = this;\n    const y = num;\n    [x.words, y.words] = [y.words, x.words];\n    [x.length, y.length] = [y.length, x.length];\n    [x.negative, y.negative] = [y.negative, x.negative];\n    [x.red, y.red] = [y.red, x.red];\n    return x;\n  }\n\n  reverse() {\n    const neg = this.negative;\n    this.fromBuffer(this.toBuffer('be'), 'le');\n    this.negative = neg;\n    return this;\n  }\n\n  byteLength() {\n    return Math.ceil(this.bitLength() / 8);\n  }\n\n  bitLength() {\n    const w = this.words[this.length - 1];\n    const hi = countBits(w);\n    return (this.length - 1) * 26 + hi;\n  }\n\n  zeroBits() {\n    if (this.isZero()) return 0;\n    if (this.isOdd()) return 0;\n    let r = 0;\n\n    for (let i = 0; i < this.length; i++) {\n      const b = zeroBits(this.words[i]);\n      r += b;\n      if (b !== 26) break;\n    }\n\n    return r;\n  }\n\n  isSafe() {\n    if (this.length <= 2) return true;\n    if (this.length === 3 && this.words[2] === 0x01) return true;\n    return false;\n  }\n\n  word(pos) {\n    enforce(pos >>> 0 === pos, 'pos', 'uint32');\n    if (pos >= this.length) return 0;\n    return this.words[pos];\n  }\n\n  [custom]() {\n    let prefix = 'BN';\n    if (this.red) prefix = 'BN-R';\n    return `<${prefix}: ${this.toString(10)}>`;\n  }\n  /*\n   * Constant Time\n   */\n\n\n  csign() {\n    return this.negative * -2 + 1 - this.czero();\n  }\n\n  czero() {\n    const zword = this.words[0] - 1 >>> 31;\n    return this.length - 2 >>> 31 & zword;\n  }\n\n  cneg() {\n    return this.negative;\n  }\n\n  cpos() {\n    return this.negative ^ 1;\n  }\n\n  ceq(num) {\n    enforce(BN.isBN(num), 'num', 'bignum'); // Assumes `num` is the \"constant size\"\n    // parameter. Note that constant size\n    // doesn't necessarily mean secret.\n\n    let z = 0;\n\n    for (let i = 0; i < num.length; i++) z |= this.words[i % this.length] ^ num.words[i];\n\n    z |= this.length ^ num.length;\n    z |= this.negative ^ num.negative;\n    return z - 1 >>> 31;\n  }\n\n  ceqn(num) {\n    const neg = num >> 31 & 1;\n    const word = (num | 0) * (-neg | 1) & 0x3ffffff;\n    let z = 0;\n    z |= this.words[0] ^ word;\n    z |= this.length ^ 1;\n    z |= this.negative ^ neg;\n    return z - 1 >>> 31;\n  }\n\n  cswap(num, flag) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    const x = this;\n    const y = num;\n    const cond = (flag >> 31 | -flag >> 31) & 1;\n    const mask = -cond & 0x3ffffff;\n\n    x._alloc(y.words.length);\n\n    y._alloc(x.words.length);\n\n    for (let i = 0; i < x.words.length; i++) {\n      const word = (x.words[i] ^ y.words[i]) & mask;\n      x.words[i] ^= word;\n      y.words[i] ^= word;\n    }\n\n    const length = (x.length ^ y.length) & mask;\n    const negative = (x.negative ^ y.negative) & mask;\n    x.length ^= length;\n    y.length ^= length;\n    x.negative ^= negative;\n    y.negative ^= negative;\n    return this;\n  }\n\n  cinject(num, flag) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    const x = this;\n    const y = num;\n    const cond = (flag >> 31 | -flag >> 31) & 1;\n    const mask0 = cond - 1 & 0x3ffffff;\n    const mask1 = ~(cond - 1) & 0x3ffffff;\n\n    x._alloc(y.length);\n\n    for (let i = 0; i < y.length; i++) x.words[i] = x.words[i] & mask0 | y.words[i] & mask1;\n\n    x.length = x.length & mask0 | y.length & mask1;\n    x.negative = x.negative & mask0 | y.negative & mask1;\n    return this;\n  }\n\n  cset(num, flag) {\n    const cond = (flag >> 31 | -flag >> 31) & 1;\n    const mask0 = cond - 1 & 0x3ffffff;\n    const mask1 = ~(cond - 1) & 0x3ffffff;\n    const neg = num >> 31 & 1;\n    const word = (num | 0) * (-neg | 1) & 0x3ffffff;\n    this.words[0] = this.words[0] & mask0 | word & mask1;\n    this.length = this.length & mask0 | 1 & mask1;\n    this.negative = this.negative & mask0 | neg & mask1;\n    return this;\n  }\n  /*\n   * Conversion\n   */\n\n\n  toNumber() {\n    let num = this.words[0];\n\n    if (this.length === 2) {\n      num += this.words[1] * 0x4000000;\n    } else if (this.length === 3 && this.words[2] === 0x01) {\n      // Note: at this stage it is known that the top bit is set.\n      num += 0x10000000000000 + this.words[1] * 0x4000000;\n    } else if (this.length > 2) {\n      throw new RangeError('Number can only safely store up to 53 bits.');\n    }\n\n    return this.negative !== 0 ? -num : num;\n  }\n\n  toDouble() {\n    let num = 0;\n\n    for (let i = this.length - 1; i >= 0; i--) num = num * 0x4000000 + this.words[i];\n\n    return this.negative !== 0 ? -num : num;\n  }\n\n  valueOf() {\n    return this.toDouble();\n  }\n\n  toBigInt() {\n    if (!HAS_BIGINT) throw new Error('BigInt is not supported!');\n    const s52 = BigInt(52);\n    const s26 = BigInt(26);\n    let i = this.length - 1;\n    let num = BigInt(0);\n\n    for (; i >= 1; i -= 2) {\n      const hi = this.words[i] * 0x4000000;\n      const lo = this.words[i - 1];\n      num = num << s52 | BigInt(hi + lo);\n    }\n\n    if (i >= 0) num = num << s26 | BigInt(this.words[0]);\n    return this.negative !== 0 ? -num : num;\n  }\n\n  toBool() {\n    return !this.isZero();\n  }\n\n  toString(base, padding) {\n    base = getBase(base);\n    if (padding == null) padding = 0;\n    if (padding === 0) padding = 1;\n    enforce(base >>> 0 === base, 'base', 'uint32');\n    enforce(padding >>> 0 === padding, 'padding', 'uint32');\n    if (base < 2 || base > 36) throw new RangeError('Base ranges between 2 and 36.');\n\n    this._check();\n\n    if (base === 16) {\n      let out = '';\n      let off = 0;\n      let carry = 0;\n\n      for (let i = 0; i < this.length; i++) {\n        const w = this.words[i];\n        const word = ((w << off | carry) & 0xffffff).toString(16);\n        carry = w >>> 24 - off & 0xffffff;\n        if (carry !== 0 || i !== this.length - 1) out = zeros[6 - word.length] + word + out;else out = word + out;\n        off += 2;\n\n        if (off >= 26) {\n          off -= 26;\n          i -= 1;\n        }\n      }\n\n      if (carry !== 0) out = carry.toString(16) + out;\n\n      while (out.length % padding !== 0) out = '0' + out;\n\n      if (this.negative !== 0) out = '-' + out;\n      return out;\n    }\n\n    const groupSize = groupSizes[base - 1];\n    const groupBase = groupBases[base - 1];\n    const c = this.clone();\n    let out = '';\n    c.negative = 0;\n\n    while (!c.isZero()) {\n      const r = c.remrn(groupBase).toString(base);\n      c.iquon(groupBase);\n      if (!c.isZero()) out = zeros[groupSize - r.length] + r + out;else out = r + out;\n    }\n\n    if (this.isZero()) out = '0';\n\n    while (out.length % padding !== 0) out = '0' + out;\n\n    if (this.negative !== 0) out = '-' + out;\n    return out;\n  }\n\n  toJSON() {\n    return this.toString(16, 2);\n  }\n\n  toArray(endian, length) {\n    return this.toArrayLike(Array, endian, length);\n  }\n\n  toBuffer(endian, length) {\n    return this.toArrayLike(Buffer, endian, length);\n  }\n\n  toArrayLike(ArrayType, endian, length) {\n    if (endian == null) endian = 'be';\n    if (length == null) length = 0;\n    enforce(typeof ArrayType === 'function', 'ArrayType', 'function');\n    enforce(endian === 'be' || endian === 'le', 'endian', 'endianness');\n    enforce(length >>> 0 === length, 'length', 'uint32');\n\n    this._check();\n\n    const bytes = this.byteLength();\n    const size = length || Math.max(1, bytes);\n    if (bytes > size) throw new RangeError('Byte array longer than desired length.');\n    const res = allocate(ArrayType, size); // See: https://github.com/indutny/bn.js/pull/222\n\n    if (endian === 'be') {\n      let pos = res.length - 1;\n      let carry = 0;\n\n      for (let i = 0; i < this.length; i++) {\n        const shift = (i & 3) << 1;\n        const word = this.words[i] << shift | carry;\n        res[pos--] = word & 0xff;\n        if (pos >= 0) res[pos--] = word >>> 8 & 0xff;\n        if (pos >= 0) res[pos--] = word >>> 16 & 0xff;\n\n        if (shift === 6) {\n          if (pos >= 0) res[pos--] = word >>> 24 & 0xff;\n          carry = 0;\n        } else {\n          carry = word >>> 24;\n        }\n      }\n\n      if (pos >= 0) {\n        res[pos--] = carry;\n\n        while (pos >= 0) res[pos--] = 0;\n\n        carry = 0;\n      }\n\n      assert(carry === 0);\n    } else {\n      let pos = 0;\n      let carry = 0;\n\n      for (let i = 0; i < this.length; i++) {\n        const shift = (i & 3) << 1;\n        const word = this.words[i] << shift | carry;\n        res[pos++] = word & 0xff;\n        if (pos < res.length) res[pos++] = word >>> 8 & 0xff;\n        if (pos < res.length) res[pos++] = word >>> 16 & 0xff;\n\n        if (shift === 6) {\n          if (pos < res.length) res[pos++] = word >>> 24 & 0xff;\n          carry = 0;\n        } else {\n          carry = word >>> 24;\n        }\n      }\n\n      if (pos < res.length) {\n        res[pos++] = carry;\n\n        while (pos < res.length) res[pos++] = 0;\n\n        carry = 0;\n      }\n\n      assert(carry === 0);\n    }\n\n    return res;\n  }\n\n  encode(endian, length) {\n    return this.toBuffer(endian, length);\n  }\n  /*\n   * Instantiation\n   */\n\n\n  of(num, endian) {\n    return this.fromNumber(num, endian);\n  }\n\n  fromNumber(num, endian) {\n    if (endian == null) endian = 'be';\n    enforce(isInteger(num), 'num', 'integer');\n    enforce(endian === 'be' || endian === 'le', 'endian', 'endianness');\n    const neg = num < 0 | 0;\n    if (neg) num = -num;\n\n    if (num < 0x4000000) {\n      this.words[0] = num & 0x3ffffff;\n      this.length = 1;\n    } else if (num < 0x10000000000000) {\n      this.words = [num & 0x3ffffff, num / 0x4000000 & 0x3ffffff];\n      this.length = 2;\n    } else {\n      this.words = [num & 0x3ffffff, num / 0x4000000 & 0x3ffffff, 1];\n      this.length = 3;\n    }\n\n    this.negative = neg;\n    if (endian === 'le') this.reverse();\n    return this;\n  }\n\n  fromDouble(num, endian) {\n    if (endian == null) endian = 'be';\n    enforce(typeof num === 'number', 'num', 'double');\n    enforce(endian === 'be' || endian === 'le', 'endian', 'endianness');\n    if (!isFinite(num)) num = 0;\n    const neg = num <= -1 | 0;\n    if (num < 0) num = -num;\n    num = Math.floor(num);\n    this.words = [];\n\n    while (num > 0) {\n      const lo = num % 0x4000000;\n      const hi = (num - lo) / 0x4000000;\n      this.words.push(lo);\n      num = hi;\n    }\n\n    if (this.words.length === 0) this.words.push(0);\n    this.length = this.words.length;\n    this.negative = neg;\n    if (endian === 'le') this.reverse();\n    return this;\n  }\n\n  fromBigInt(num, endian) {\n    if (endian == null) endian = 'be';\n    enforce(typeof num === 'bigint', 'num', 'bigint');\n    enforce(endian === 'be' || endian === 'le', 'endian', 'endianness');\n    if (!HAS_BIGINT) throw new Error('BigInt is not supported!'); // You know the implementation has a\n    // problem when strings are twice\n    // as fast as bigints.\n\n    const start = num < BigInt(0) | 0;\n\n    this._fromHex(num.toString(16), start);\n\n    this.negative = start;\n    if (endian === 'le') this.reverse();\n    return this;\n  }\n\n  fromBool(value) {\n    enforce(typeof value === 'boolean', 'value', 'boolean');\n    this.words[0] = value | 0;\n    this.length = 1;\n    this.negative = 0;\n    return this;\n  }\n\n  fromString(str, base, endian) {\n    if (base === 'le' || base === 'be') [base, endian] = [endian, base];\n    base = getBase(base);\n    if (endian == null) endian = 'be';\n    enforce(typeof str === 'string', 'string', 'string');\n    enforce(base >>> 0 === base, 'base', 'uint32');\n    enforce(endian === 'be' || endian === 'le', 'endian', 'endianness');\n    if (base < 2 || base > 36) throw new Error('Base ranges between 2 and 36.');\n    str = str.replace(/\\s+/g, '');\n    let start = 0;\n    if (str.length > 0 && str.charCodeAt(0) === 0x2d) start = 1;\n    if (base === 16) this._fromHex(str, start);else this._fromBase(str, base, start);\n    this.negative = start;\n\n    this._normalize();\n\n    if (endian === 'le') this.reverse();\n    return this;\n  }\n\n  _fromHex(str, start) {\n    this.length = Math.max(2, Math.ceil((str.length - start) / 6));\n    this.words = new Array(this.length);\n\n    for (let i = 0; i < this.length; i++) this.words[i] = 0; // Scan 24-bit chunks and add them to the number.\n\n\n    let off = 0;\n    let i = str.length - 6;\n    let j = 0;\n\n    for (; i >= start; i -= 6) {\n      const w = parseHex(str, i, i + 6);\n      this.words[j] |= w << off & 0x3ffffff; // `0x3fffff` is intentional here, 26bits max shift + 24bit hex limb.\n\n      this.words[j + 1] |= w >>> 26 - off & 0x3fffff;\n      off += 24;\n\n      if (off >= 26) {\n        off -= 26;\n        j += 1;\n      }\n    }\n\n    if (i + 6 !== start) {\n      const w = parseHex(str, start, i + 6);\n      this.words[j] |= w << off & 0x3ffffff;\n      this.words[j + 1] |= w >>> 26 - off & 0x3fffff;\n    }\n\n    return this._strip();\n  }\n\n  _fromBase(str, base, start) {\n    // Initialize as zero.\n    this.words[0] = 0;\n    this.length = 1;\n    this.negative = 0; // Find length of limb in base.\n\n    let limbLen = 0;\n    let limbPow = 1;\n\n    for (; limbPow <= 0x3ffffff; limbPow *= base) limbLen += 1;\n\n    limbLen -= 1;\n    limbPow = limbPow / base | 0;\n    const total = str.length - start;\n    const mod = total % limbLen;\n    const end = Math.min(total, total - mod) + start;\n    let i = start;\n\n    for (; i < end; i += limbLen) {\n      const word = parseBase(str, i, i + limbLen, base);\n      this.imuln(limbPow);\n\n      this._iaddn(word);\n    }\n\n    if (mod !== 0) {\n      const pow = Math.pow(base, mod);\n      const word = parseBase(str, i, str.length, base);\n      this.imuln(pow);\n\n      this._iaddn(word);\n    }\n\n    return this;\n  }\n\n  fromJSON(json) {\n    if (BN.isBN(json)) {\n      if (json.red) return json.fromRed();\n      return json.clone();\n    }\n\n    if (Array.isArray(json)) {\n      for (const chunk of json) enforce(typeof chunk === 'string', 'chunk', 'string');\n\n      json = json.join('');\n    }\n\n    return this.fromString(json, 16);\n  }\n\n  fromBN(num) {\n    return this.inject(num);\n  }\n\n  fromArray(data, endian) {\n    enforce(Array.isArray(data), 'data', 'array');\n    return this.fromArrayLike(data, endian);\n  }\n\n  fromBuffer(data, endian) {\n    enforce(Buffer.isBuffer(data), 'data', 'buffer');\n    return this.fromArrayLike(data, endian);\n  }\n\n  fromArrayLike(data, endian) {\n    if (endian == null) endian = 'be';\n    enforce(data && data.length >>> 0 === data.length, 'data', 'array-like');\n    enforce(endian === 'be' || endian === 'le', 'endian', 'endianness');\n\n    if (data.length === 0) {\n      this.words[0] = 0;\n      this.length = 1;\n      this.negative = 0;\n      return this;\n    }\n\n    this.length = Math.max(2, Math.ceil(data.length / 3));\n    this.words = new Array(this.length);\n    this.negative = 0;\n\n    for (let i = 0; i < this.length; i++) this.words[i] = 0;\n\n    const left = data.length % 3;\n    let off = 0;\n    let j = 0;\n    let w = 0;\n\n    if (endian === 'be') {\n      for (let i = data.length - 1; i >= 2; i -= 3) {\n        const w = data[i] | data[i - 1] << 8 | data[i - 2] << 16;\n        this.words[j] |= w << off & 0x3ffffff;\n        this.words[j + 1] = w >>> 26 - off & 0x3ffffff;\n        off += 24;\n\n        if (off >= 26) {\n          off -= 26;\n          j += 1;\n        }\n      }\n\n      switch (left) {\n        case 2:\n          w = data[1] | data[0] << 8;\n          break;\n\n        case 1:\n          w = data[0];\n          break;\n      }\n    } else {\n      const len = data.length - left;\n\n      for (let i = 0; i < len; i += 3) {\n        const w = data[i] | data[i + 1] << 8 | data[i + 2] << 16;\n        this.words[j] |= w << off & 0x3ffffff;\n        this.words[j + 1] = w >>> 26 - off & 0x3ffffff;\n        off += 24;\n\n        if (off >= 26) {\n          off -= 26;\n          j += 1;\n        }\n      }\n\n      switch (left) {\n        case 2:\n          w = data[len] | data[len + 1] << 8;\n          break;\n\n        case 1:\n          w = data[len];\n          break;\n      }\n    }\n\n    if (left > 0) {\n      this.words[j] |= w << off & 0x3ffffff;\n      this.words[j + 1] = w >>> 26 - off & 0x3ffffff;\n    }\n\n    return this._strip();\n  }\n\n  decode(data, endian) {\n    return this.fromBuffer(data, endian);\n  }\n\n  from(num, base, endian) {\n    if (num == null) return this;\n    if (base === 'le' || base === 'be') [base, endian] = [endian, base];\n    if (typeof num === 'number') return this.fromNumber(num, endian);\n    if (typeof num === 'bigint') return this.fromBigInt(num, endian);\n    if (typeof num === 'string') return this.fromString(num, base, endian);\n\n    if (typeof num === 'object') {\n      if (BN.isBN(num)) return this.fromBN(num, endian);\n      if (num.length >>> 0 === num.length) return this.fromArrayLike(num, endian);\n    }\n\n    if (typeof num === 'boolean') return this.fromBool(num);\n    throw new TypeError('Non-numeric object passed to BN.');\n  }\n  /*\n   * Static Methods\n   */\n\n\n  static min(...args) {\n    let min = null;\n\n    for (const num of args) {\n      enforce(BN.isBN(num), 'num', 'bignum');\n      if (!min || num.cmp(min) < 0) min = num;\n    }\n\n    return min || new BN(0);\n  }\n\n  static max(...args) {\n    let max = null;\n\n    for (const num of args) {\n      enforce(BN.isBN(num), 'num', 'bignum');\n      if (!max || num.cmp(max) > 0) max = num;\n    }\n\n    return max || new BN(0);\n  }\n\n  static cmp(a, b) {\n    enforce(BN.isBN(a), 'a', 'bignum');\n    return a.cmp(b);\n  }\n\n  static ucmp(a, b) {\n    enforce(BN.isBN(a), 'a', 'bignum');\n    return a.ucmp(b);\n  }\n\n  static red(num) {\n    return new Red(num);\n  }\n\n  static barrett(num) {\n    return new Barrett(num);\n  }\n\n  static mont(num) {\n    return new Mont(num);\n  }\n\n  static _prime(name) {\n    if (primes[name]) return primes[name];\n    let prime;\n    if (name === 'p192') prime = new P192();else if (name === 'p224') prime = new P224();else if (name === 'p521') prime = new P521();else if (name === 'k256') prime = new K256();else if (name === 'p25519') prime = new P25519();else if (name === 'p448') prime = new P448();else throw new Error(`Unknown prime: \"${name}\".`);\n    primes[name] = prime;\n    return prime;\n  }\n\n  static prime(name) {\n    return BN._prime(name).p.clone();\n  }\n\n  static pow(num, exp) {\n    if (num === 2) return BN.shift(1, exp);\n    return new BN().fromNumber(num).pown(exp);\n  }\n\n  static shift(num, bits) {\n    if (num === 1) return new BN(0).usetn(bits, 1);\n    return new BN().fromNumber(num).ishln(bits);\n  }\n\n  static mask(bits) {\n    return BN.shift(1, bits).isubn(1);\n  }\n\n  static randomBits(rng, bits) {\n    enforce(rng != null, 'rng', 'rng');\n    enforce(bits >>> 0 === bits, 'bits', 'uint32');\n\n    if (typeof rng === 'object') {\n      enforce(typeof rng.randomBytes === 'function', 'rng', 'rng');\n      const size = bits + 7 >>> 3;\n      const total = size * 8;\n      const bytes = rng.randomBytes(size);\n      enforce(Buffer.isBuffer(bytes), 'bytes', 'buffer');\n      if (bytes.length !== size) throw new RangeError('Invalid number of bytes returned from RNG.');\n      const num = BN.fromBuffer(bytes);\n      if (total > bits) num.iushrn(total - bits);\n      return num;\n    }\n\n    enforce(typeof rng === 'function', 'rng', 'rng');\n    const num = rng(bits);\n    enforce(BN.isBN(num), 'num', 'bignum');\n    range(num.negative === 0, 'RNG');\n    nonred(!num.red, 'RNG');\n    if (num.bitLength() > bits) throw new RangeError('Invalid number of bits returned from RNG.');\n    return num;\n  }\n\n  static random(rng, min, max) {\n    min = BN.cast(min, 16);\n    max = BN.cast(max, 16);\n    if (min.cmp(max) > 0) throw new RangeError('Minimum cannot be greater than maximum.');\n    const space = max.sub(min).iabs();\n    const bits = space.bitLength();\n    if (bits === 0) return min.clone();\n\n    for (;;) {\n      const num = BN.randomBits(rng, bits); // Maximum is _exclusive_!\n\n      if (num.cmp(space) >= 0) continue; // Minimum is _inclusive_!\n\n      num.iadd(min);\n      return num;\n    }\n  }\n\n  static of(num, endian) {\n    return new BN().of(num, endian);\n  }\n\n  static fromNumber(num, endian) {\n    return new BN().fromNumber(num, endian);\n  }\n\n  static fromDouble(num, endian) {\n    return new BN().fromDouble(num, endian);\n  }\n\n  static fromBigInt(num, endian) {\n    return new BN().fromBigInt(num, endian);\n  }\n\n  static fromBool(value) {\n    return new BN().fromBool(value);\n  }\n\n  static fromString(str, base, endian) {\n    return new BN().fromString(str, base, endian);\n  }\n\n  static fromJSON(json) {\n    return new BN().fromJSON(json);\n  }\n\n  static fromBN(num) {\n    return new BN().fromBN(num);\n  }\n\n  static fromArray(data, endian) {\n    return new BN().fromArray(data, endian);\n  }\n\n  static fromBuffer(data, endian) {\n    return new BN().fromBuffer(data, endian);\n  }\n\n  static fromArrayLike(data, endian) {\n    return new BN().fromArrayLike(data, endian);\n  }\n\n  static decode(data, endian) {\n    return new BN().decode(data, endian);\n  }\n\n  static from(num, base, endian) {\n    return new BN().from(num, base, endian);\n  }\n\n  static cast(num, base, endian) {\n    if (BN.isBN(num)) return num;\n    return new BN(num, base, endian);\n  }\n\n  static isBN(obj) {\n    return obj instanceof BN;\n  }\n\n}\n/*\n * Static\n */\n\n\nBN.BN = BN;\nBN.wordSize = 26;\nBN.native = 0;\n/**\n * Prime\n */\n\nclass Prime {\n  constructor(name, p) {\n    // P = 2^N - K\n    this.name = name;\n    this.p = new BN(p, 16);\n    this.n = this.p.bitLength();\n    this.k = BN.shift(1, this.n).isub(this.p);\n    this.lo = this.p.clone();\n    this.one = this.p.clone();\n  }\n\n  ireduce(num) {\n    // Assumes that `num` is less than `P^2`:\n    // num = HI * (2^N - K) + HI * K + LO = HI * K + LO (mod P)\n    const neg = num.negative !== 0; // Track bits.\n\n    let bits = num.bitLength(); // Must be less than P^2.\n\n    assert(bits <= this.n * 2); // Ensure positive.\n\n    num.negative = 0; // Reduce.\n\n    while (bits > this.n) {\n      // lo = num & ((1 << n) - 1)\n      // num = num >> n\n      this.split(num, this.lo); // num = num * K\n\n      this.imulK(num); // num = num + lo\n\n      num._iadd(num, this.lo); // bits = bitlen(num)\n\n\n      bits = num.bitLength();\n    } // Final reduction.\n\n\n    const cmp = bits < this.n ? -1 : num.ucmp(this.p);\n\n    if (cmp === 0) {\n      num.words[0] = 0;\n      num.length = 1;\n    } else if (cmp > 0) {\n      num._isub(num, this.p);\n    } else {// Note: we shouldn't need to strip here.\n    } // Adjust sign.\n\n\n    if (neg && !num.isZero()) num._isub(this.p, num);\n    return num;\n  }\n\n  split(input, out) {\n    input._split(this.n, out);\n  }\n\n  imulK(num) {\n    return num.imul(this.k);\n  }\n\n}\n/**\n * P192\n */\n\n\nclass P192 extends Prime {\n  constructor() {\n    // 2^192 - 2^64 - 1 (= 3 mod 4)\n    super('p192', 'ffffffff ffffffff ffffffff fffffffe' + 'ffffffff ffffffff');\n  }\n\n  imulK(num) {\n    // K = 0x10000000000000001\n    // K = 2^64 + 1\n    const one = this.one.inject(num);\n    return num.iushln(64)._iadd(num, one);\n  }\n\n}\n/**\n * P224\n */\n\n\nclass P224 extends Prime {\n  constructor() {\n    // 2^224 - 2^96 + 1 (no congruence)\n    super('p224', 'ffffffff ffffffff ffffffff ffffffff' + '00000000 00000000 00000001');\n  }\n\n  imulK(num) {\n    // K = 0xffffffffffffffffffffffff\n    // K = 2^96 - 1\n    const one = this.one.inject(num);\n    return num.iushln(96)._isub(num, one);\n  }\n\n}\n/**\n * P521\n */\n\n\nclass P521 extends Prime {\n  constructor() {\n    // 2^521 - 1 (= 3 mod 4)\n    super('p521', '000001ff ffffffff ffffffff ffffffff' + 'ffffffff ffffffff ffffffff ffffffff' + 'ffffffff ffffffff ffffffff ffffffff' + 'ffffffff ffffffff ffffffff ffffffff' + 'ffffffff');\n  }\n\n  imulK(num) {\n    // K = 0x01\n    return num;\n  }\n\n}\n/**\n * K256\n */\n\n\nclass K256 extends Prime {\n  constructor() {\n    // 2^256 - 2^32 - 977 (= 3 mod 4)\n    super('k256', 'ffffffff ffffffff ffffffff ffffffff' + 'ffffffff ffffffff fffffffe fffffc2f');\n  }\n\n  split(input, output) {\n    // 256 = 9 * 26 + 22\n    const mask = 0x3fffff;\n    const len = Math.min(input.length, 9);\n\n    output._alloc(len + 1);\n\n    for (let i = 0; i < len; i++) output.words[i] = input.words[i];\n\n    output.length = len;\n\n    if (input.length <= 9) {\n      output._strip();\n\n      input.words[0] = 0;\n      input.length = 1;\n      return;\n    } // Shift by 9 limbs.\n\n\n    let prev = input.words[9];\n    let i = 10;\n    output.words[output.length++] = prev & mask;\n\n    output._strip();\n\n    for (; i < input.length; i++) {\n      const next = input.words[i] | 0;\n      input.words[i - 10] = (next & mask) << 4 | prev >>> 22;\n      prev = next;\n    }\n\n    prev >>>= 22;\n    input.words[i - 10] = prev;\n    if (prev === 0 && input.length > 10) input.length -= 10;else input.length -= 9;\n\n    input._strip(); // Unsure if we need this.\n\n  }\n\n  imulK(num) {\n    // K = 0x1000003d1 = [0x40, 0x3d1]\n    // K = 2^32 + 977\n    num._expand(num.length + 2); // Bounded at: 0x40 * 0x3ffffff + 0x3d0 = 0x100000390\n\n\n    let lo = 0;\n\n    for (let i = 0; i < num.length; i++) {\n      const w = num.words[i];\n      lo += w * 0x3d1;\n      num.words[i] = lo & 0x3ffffff;\n      lo = w * 0x40 + Math.floor(lo / 0x4000000);\n    } // Fast length reduction.\n\n\n    if (num.words[num.length - 1] === 0) {\n      num.length -= 1;\n      if (num.words[num.length - 1] === 0) num.length -= 1;\n    } // Note: we shouldn't need to strip here.\n\n\n    return num;\n  }\n\n}\n/**\n * P25519\n */\n\n\nclass P25519 extends Prime {\n  constructor() {\n    // 2^255 - 19 (= 5 mod 8)\n    super('p25519', '7fffffff ffffffff ffffffff ffffffff' + 'ffffffff ffffffff ffffffff ffffffed');\n  }\n\n  imulK(num) {\n    // K = 0x13\n    let carry = 0;\n\n    for (let i = 0; i < num.length; i++) {\n      const w = num.words[i] * 0x13 + carry;\n      carry = w >>> 26;\n      num.words[i] = w & 0x3ffffff;\n    }\n\n    if (carry !== 0) {\n      num._alloc(num.length + 1);\n\n      num.words[num.length++] = carry;\n    } // Note: we shouldn't need to strip here.\n\n\n    return num;\n  }\n\n}\n/**\n * P448\n */\n\n\nclass P448 extends Prime {\n  constructor() {\n    // 2^448 - 2^224 - 1 (= 3 mod 4)\n    super('p448', 'ffffffff ffffffff ffffffff ffffffff' + 'ffffffff ffffffff fffffffe ffffffff' + 'ffffffff ffffffff ffffffff ffffffff' + 'ffffffff ffffffff');\n  }\n\n  imulK(num) {\n    // K = 0x100000000000000000000000000000000000000000000000000000001\n    // K = 2^224 + 1\n    const one = this.one.inject(num);\n    return num.iushln(224)._iadd(num, one);\n  }\n\n}\n/**\n * Reduction Engine\n */\n\n\nclass Red {\n  constructor(m) {\n    let prime = null;\n\n    if (typeof m === 'string') {\n      prime = BN._prime(m);\n      m = prime.p;\n    }\n\n    enforce(BN.isBN(m), 'm', 'bignum');\n    nonred(!m.red, 'reduction');\n    range(m.sign() > 0, 'reduction');\n    this.m = m;\n    this.prime = prime;\n    this.mb = null;\n    this.sm1 = null;\n  }\n\n  _verify1(a) {\n    range(a.negative === 0, 'red');\n    red(a.red != null, 'red');\n  }\n\n  _verify2(a, b) {\n    range((a.negative | b.negative) === 0, 'red');\n    red(a.red != null && a.red === b.red, 'red');\n  }\n\n  get mont() {\n    return false;\n  }\n\n  get coprime() {\n    return false;\n  }\n\n  precompute() {\n    // Precompute `sqrt(-1)` for primes congruent to 5 mod 8.\n    if (this.sm1 === null && this.m.andln(7) === 5) {\n      const x = new BN(2).toRed(this);\n      const e = this.m.subn(1).iushrn(2); // sqrt(-1) = 2^((p - 1) / 4) mod p\n\n      this.sm1 = this.pow(x, e);\n    }\n\n    return this;\n  }\n\n  convertTo(num) {\n    const res = num.mod(this.m);\n    res.red = this;\n    return res;\n  }\n\n  convertFrom(num) {\n    const res = num.clone();\n    res.red = null;\n    return res;\n  }\n\n  intTo(a) {\n    return a;\n  }\n\n  intFrom(a) {\n    return a;\n  }\n\n  imod(a) {\n    if (this.prime) return this.prime.ireduce(a)._forceRed(this);\n    return a.imod(this.m)._forceRed(this);\n  }\n\n  iadd(a, b) {\n    this._verify2(a, b);\n\n    a._iadd(a, b);\n\n    if (a.ucmp(this.m) >= 0) a._isub(a, this.m);\n    return a;\n  }\n\n  add(a, b) {\n    if (a.length < b.length) return this.iadd(b.clone(), a);\n    return this.iadd(a.clone(), b);\n  }\n\n  iaddn(a, num) {\n    this._verify1(a);\n\n    if (num < 0) return this.isubn(a, -num);\n    if (this.m.length === 1) num %= this.m.words[0];\n\n    a._iaddn(num);\n\n    if (a.ucmp(this.m) >= 0) a._isub(a, this.m);\n    return a;\n  }\n\n  addn(a, num) {\n    return this.iaddn(a.clone(), num);\n  }\n\n  isub(a, b) {\n    this._verify2(a, b); //  0: a - a mod m == 0\n    // -1: a - b mod m == m - (b - a)\n    // +1: a - b mod m == a - b\n\n\n    const cmp = a.ucmp(b);\n\n    if (cmp === 0) {\n      a.words[0] = 0;\n      a.length = 1;\n      return a;\n    }\n\n    if (cmp < 0) {\n      a._isub(b, a);\n\n      a._isub(this.m, a);\n    } else {\n      a._isub(a, b);\n    }\n\n    return a;\n  }\n\n  sub(a, b) {\n    return this.isub(a.clone(), b);\n  }\n\n  isubn(a, num) {\n    this._verify1(a);\n\n    if (num < 0) return this.iaddn(a, -num);\n    if (this.m.length === 1) num %= this.m.words[0]; //  <: a - b mod m == m - (b - a)\n    // >=: a - b mod m == a - b\n\n    if (a.length === 1 && a.words[0] < num) {\n      a.words[0] = num - a.words[0];\n\n      a._isub(this.m, a);\n    } else {\n      a._isubn(num);\n    }\n\n    return a;\n  }\n\n  subn(a, num) {\n    return this.isubn(a.clone(), num);\n  }\n\n  imul(a, b) {\n    this._verify2(a, b);\n\n    return this.imod(a.imul(b));\n  }\n\n  mul(a, b) {\n    this._verify2(a, b);\n\n    return this.imod(a.mul(b));\n  }\n\n  imuln(a, num) {\n    this._verify1(a);\n\n    if (a.isZero()) return a;\n\n    if (num === 0) {\n      a.words[0] = 0;\n      a.length = 1;\n      return a;\n    }\n\n    const neg = num < 0;\n    if (neg) num = -num;\n    if (this.m.length === 1) num %= this.m.words[0];\n    a.imuln(num);\n\n    if (num <= 16) {\n      // Quick reduction.\n      while (a.ucmp(this.m) >= 0) a._isub(a, this.m);\n    } else {\n      this.imod(a);\n    }\n\n    if (neg) this.ineg(a);\n    return a;\n  }\n\n  muln(a, num) {\n    return this.imuln(a.clone(), num);\n  }\n\n  idiv(a, b) {\n    return this.div(a, b)._move(a);\n  }\n\n  div(a, b) {\n    return this.mul(a, this.invert(b));\n  }\n\n  idivn(a, num) {\n    return this.divn(a, num)._move(a);\n  }\n\n  divn(a, num) {\n    return this.div(a, this.convertTo(new BN(num)));\n  }\n\n  ipow(a, num) {\n    return this.pow(a, num)._move(a);\n  }\n\n  pow(a, num) {\n    this._verify1(a);\n\n    if (num.isNeg()) a = this.invert(a); // Small exponent.\n\n    if (num.length === 1) return this.pown(a, num.words[0]); // Call out to BigInt.\n\n    if (HAS_BIGINT && !this.prime) return this.powInt(a, num); // Otherwise, a BN implementation.\n\n    return this.powNum(a, num);\n  }\n\n  powNum(a, num) {\n    // Sliding window.\n    const wnd = new Array(WND_SIZE);\n    wnd[0] = this.sqrn(a, WND_WIDTH - 1);\n    wnd[1] = this.mul(wnd[0], a);\n\n    for (let i = 2; i < WND_SIZE; i++) wnd[i] = this.mul(wnd[i - 1], a);\n\n    let i = num.bitLength();\n    let r = new BN(1).toRed(this);\n\n    while (i >= WND_WIDTH) {\n      const pos = i - WND_WIDTH;\n      const bits = num.bits(pos, WND_WIDTH);\n\n      if (bits < WND_SIZE) {\n        r = this.sqr(r);\n        i -= 1;\n        continue;\n      }\n\n      r = this.sqrn(r, WND_WIDTH);\n      r = this.mul(r, wnd[bits & ~WND_SIZE]);\n      i = pos;\n    }\n\n    if (i > 0) {\n      const bits = num.bits(0, i);\n\n      while (i--) {\n        r = this.sqr(r);\n        if (bits >> i & 1) r = this.mul(r, a);\n      }\n    }\n\n    return r;\n  }\n\n  powInt(a, num) {\n    if (this.mb === null) this.mb = this.m.toBigInt();\n    const x = this.intFrom(a.toBigInt());\n    const y = powInt(x, num, this.mb);\n    const z = this.intTo(y);\n    return BN.fromBigInt(z)._forceRed(this);\n  }\n\n  sqrn(a, n) {\n    for (let i = 0; i < n; i++) a = this.sqr(a);\n\n    return a;\n  }\n\n  ipown(a, num) {\n    return this.pown(a, num)._move(a);\n  }\n\n  pown(a, num) {\n    this._verify1(a);\n\n    if (num < 0) {\n      a = this.invert(a);\n      num = -num;\n    }\n\n    if (num === 0) return new BN(1).toRed(this);\n    if (num === 1) return a.clone();\n    const bits = countBits(num);\n    let r = a;\n\n    for (let i = bits - 2; i >= 0; i--) {\n      r = this.sqr(r);\n      if (num >> i & 1) r = this.mul(r, a);\n    }\n\n    return r;\n  }\n\n  isqr(a) {\n    return this.imul(a, a);\n  }\n\n  sqr(a) {\n    return this.mul(a, a);\n  }\n\n  isqrt(x) {\n    return this.sqrt(x)._move(x);\n  }\n\n  sqrt(x) {\n    this._verify1(x); // Fast case (p = 3 mod 4).\n\n\n    if (this.m.andln(3) === 3) return this.sqrt3mod4(x); // Fast case (p = 5 mod 8).\n\n    if (this.m.andln(7) === 5) {\n      if (this.sm1 != null) return this.sqrt5mod8sm1(x);\n      return this.sqrt5mod8(x);\n    } // Slow case (Tonelli-Shanks).\n\n\n    return this.sqrt0(x);\n  }\n\n  sqrt3mod4(x) {\n    const e = this.m.addn(1).iushrn(2); // (p + 1) / 4\n\n    const b = this.pow(x, e);\n    if (!this.sqr(b).eq(x)) throw new Error('X is not a square mod P.');\n    return b;\n  }\n\n  sqrt5mod8(x) {\n    // Atkin's Algorithm.\n    const one = new BN(1).toRed(this);\n    const e = this.m.ushrn(3); // (p - 5) / 8\n\n    const x2 = this.add(x, x);\n    const alpha = this.pow(x2, e);\n    const beta = this.mul(x2, this.sqr(alpha));\n    const b = this.mul(this.mul(alpha, x), this.isub(beta, one));\n    if (!this.sqr(b).eq(x)) throw new Error('X is not a square mod P.');\n    return b;\n  }\n\n  sqrt5mod8sm1(x) {\n    const e = this.m.addn(3).iushrn(3); // (p + 3) / 8\n\n    const b = this.pow(x, e);\n    if (this.sqr(b).eq(x)) return b;\n    const c = this.mul(b, this.sm1);\n    if (this.sqr(c).eq(x)) return c;\n    throw new Error('X is not a square mod P.');\n  }\n\n  sqrt0(x) {\n    if (this.m.cmpn(1) === 0 || !this.m.isOdd()) throw new Error('Invalid prime.');\n\n    switch (this.jacobi(x)) {\n      case -1:\n        throw new Error('X is not a square mod P.');\n\n      case 0:\n        return new BN(0)._forceRed(this);\n\n      case 1:\n        break;\n    }\n\n    const one = new BN(1).toRed(this);\n    const s = this.m.subn(1);\n    const e = s.zeroBits();\n    s.iushrn(e);\n    const n = new BN(2).toRed(this);\n\n    while (this.jacobi(n) !== -1) this.iadd(n, one);\n\n    let b = this.pow(x, s);\n    let g = this.pow(n, s);\n    let y = this.pow(x, s.iaddn(1).iushrn(1));\n    let k = e;\n\n    for (;;) {\n      let t = b;\n      let m = 0;\n\n      while (t.cmp(one) !== 0 && m < k) {\n        t = this.sqr(t);\n        m += 1;\n      }\n\n      if (m === 0) break;\n      assert(m < k);\n      t = this.sqrn(g, k - m - 1);\n      g = this.sqr(t);\n      y = this.mul(y, t);\n      b = this.mul(b, g);\n      k = m;\n    }\n\n    return y;\n  }\n\n  idivsqrt(u, v) {\n    return this.divsqrt(u, v)._move(u);\n  }\n\n  divsqrt(u, v) {\n    this._verify2(u, v); // v = 0\n\n\n    if (v.isZero()) throw new RangeError('Not invertible.'); // p = 3 mod 4\n\n    if (this.m.andln(3) === 3) return this.divsqrt3mod4(u, v); // p = 5 mod 8\n\n    if (this.sm1 != null && this.m.andln(7) === 5) return this.divsqrt5mod8(u, v);\n    return this.sqrt(this.div(u, v));\n  }\n\n  divsqrt3mod4(u, v) {\n    // x = u^3 * v * (u^5 * v^3)^((p - 3) / 4) mod p\n    const e = this.m.subn(3).iushrn(2);\n    const u2 = this.sqr(u);\n    const u3 = this.mul(u2, u);\n    const u5 = this.mul(u3, u2);\n    const v3 = this.mul(this.sqr(v), v);\n    const p = this.pow(this.mul(u5, v3), e);\n    const x = this.mul(this.mul(u3, v), p);\n    const c = this.mul(v, this.sqr(x));\n    if (c.cmp(u) === 0) return x;\n    throw new Error('X is not a square mod P.');\n  }\n\n  divsqrt5mod8(u, v) {\n    // x = u * v^3 * (u * v^7)^((p - 5) / 8) mod p\n    const e = this.m.subn(5).iushrn(3);\n    const v3 = this.mul(this.sqr(v), v);\n    const v7 = this.mul(this.sqr(v3), v);\n    const p = this.pow(this.mul(u, v7), e);\n    const x = this.mul(this.mul(u, v3), p);\n    const c = this.mul(v, this.sqr(x));\n    if (c.cmp(u) === 0) return x;\n    if (this.ineg(c).cmp(u) === 0) return this.mul(x, this.sm1);\n    throw new Error('X is not a square mod P.');\n  }\n\n  isSquare(a) {\n    let symbol;\n    if (this.prime || this.coprime) symbol = this.legendre(a);else if (this.m.isOdd()) symbol = this.jacobi(a);else symbol = this.kronecker(a);\n    return Boolean(~symbol >>> 31);\n  }\n\n  ishl(a, num) {\n    this._verify1(a);\n\n    return this.imod(a.iushl(num));\n  }\n\n  shl(a, num) {\n    return this.ishl(a.clone(), num);\n  }\n\n  ishln(a, num) {\n    this._verify1(a);\n\n    a.iushln(num);\n\n    if (num <= 4) {\n      // Quick reduction.\n      while (a.ucmp(this.m) >= 0) a._isub(a, this.m);\n    } else {\n      this.imod(a);\n    }\n\n    return a;\n  }\n\n  shln(a, num) {\n    return this.ishln(a.clone(), num);\n  }\n\n  ineg(a) {\n    this._verify1(a);\n\n    if (!a.isZero()) a._isub(this.m, a);\n    return a;\n  }\n\n  neg(a) {\n    return this.ineg(a.clone());\n  }\n\n  eq(a, b) {\n    this._verify2(a, b);\n\n    return a.ucmp(b) === 0;\n  }\n\n  eqn(a, num) {\n    this._verify1(a);\n\n    if (this.m.length === 1) {\n      num %= this.m.words[0];\n      if (num < 0) num += this.m.words[0];\n      return a.ucmpn(num) === 0;\n    }\n\n    if (num < 0) {\n      this.m._isubn(-num);\n\n      const cmp = a.ucmp(this.m);\n\n      this.m._iaddn(-num);\n\n      return cmp === 0;\n    }\n\n    return a.ucmpn(num) === 0;\n  }\n\n  isHigh(a) {\n    return !this.isLow(a);\n  }\n\n  isLow(a) {\n    this._verify1(a);\n\n    return a.ucmp(this.m.ushrn(1)) <= 0;\n  }\n\n  isOdd(a) {\n    this._verify1(a);\n\n    return a.isOdd();\n  }\n\n  isEven(a) {\n    this._verify1(a);\n\n    return a.isEven();\n  }\n\n  legendre(num) {\n    this._verify1(num);\n\n    if (this.m.isEven()) throw new Error('legendre: `num` must be odd.'); // Euler's criterion.\n\n    const e = this.m.subn(1).iushrn(1); // (p - 1) / 2\n\n    const symbol = this.pow(num, e);\n    const one = new BN(1).toRed(this);\n    const a = symbol.czero();\n    const b = symbol.ceq(one);\n    const c = symbol.ceq(this.ineg(one)); // Must be one of these.\n\n    if ((a | b | c) === 0) throw new Error('Invalid prime.'); // Cannot be multiple.\n\n    assert(a + b + c === 1); // 0, 1, or -1.\n\n    return b - c;\n  }\n\n  jacobi(a) {\n    this._verify1(a);\n\n    return a.jacobi(this.m);\n  }\n\n  kronecker(a) {\n    this._verify1(a);\n\n    return a.kronecker(this.m);\n  }\n\n  iinvert(a) {\n    return this.invert(a)._move(a);\n  }\n\n  invert(a) {\n    this._verify1(a);\n\n    if (this.prime) return this.imod(a._invertp(this.m));\n    return a.invert(this.m)._forceRed(this);\n  }\n\n  ifermat(a) {\n    return this.fermat(a)._move(a);\n  }\n\n  fermat(a) {\n    this._verify1(a);\n\n    if (a.isZero() || this.m.cmpn(1) === 0) throw new RangeError('Not invertible.'); // Invert using fermat's little theorem.\n\n    return this.pow(a, this.m.subn(2));\n  }\n\n  [custom]() {\n    if (this.prime) return `<Red: ${this.prime.name}>`;\n    return `<Red: ${this.m.toString(10)}>`;\n  }\n\n}\n/**\n * Barrett Engine\n */\n\n\nclass Barrett extends Red {\n  constructor(m) {\n    super(m);\n    this.prime = null;\n    this.n = this.m.bitLength();\n    if (this.n % 26 !== 0) this.n += 26 - this.n % 26;\n    this.k = this.n * 2;\n    this.w = this.k / 26;\n    this.b = BN.shift(1, this.k).div(this.m);\n  }\n\n  convertTo(num) {\n    if (num.length > this.w) return super.convertTo(num);\n    return this.imod(num.clone());\n  }\n\n  _shift(q) {\n    let i = 0;\n    let j = this.w;\n\n    while (j < q.length) q.words[i++] = q.words[j++];\n\n    if (i === 0) q.words[i++] = 0;\n    q.length = i;\n  }\n\n  imod(a) {\n    const neg = a.negative;\n    assert(a.length <= this.w);\n    a.negative = 0;\n    const q = a.mul(this.b); // Shift right by `k` bits.\n\n    this._shift(q);\n\n    a._isub(a, q.mul(this.m));\n\n    if (a.ucmp(this.m) >= 0) a._isub(a, this.m);\n    if (neg && !a.isZero()) a._isub(this.m, a);\n    a.red = this;\n    return a;\n  }\n\n}\n/**\n * Montgomery Engine\n */\n\n\nclass Mont extends Red {\n  constructor(m) {\n    super(m);\n    this.prime = null;\n    this.n = this.m.bitLength();\n    if (this.n % 26 !== 0) this.n += 26 - this.n % 26;\n    this.r = BN.shift(1, this.n);\n    this.r2 = BN.shift(1, this.n * 2).imod(this.m);\n    this.ri = this.r._invertp(this.m).imod(this.m);\n    this.mi = this.r.mul(this.ri).isubn(1).div(this.m);\n    this.rib = null;\n  }\n\n  get mont() {\n    return true;\n  }\n\n  get coprime() {\n    return true;\n  }\n\n  convertTo(num) {\n    return this.imod(num.ushln(this.n));\n  }\n\n  convertFrom(num) {\n    const r = this.imod(num.mul(this.ri));\n    r.red = null;\n    return r;\n  }\n\n  intTo(a) {\n    return (a << BigInt(this.n)) % this.mb;\n  }\n\n  intFrom(a) {\n    if (this.rib === null) this.rib = this.ri.toBigInt();\n    return a * this.rib % this.mb;\n  }\n\n  iaddn(a, num) {\n    return this.iadd(a, this.convertTo(new BN(num)));\n  }\n\n  isubn(a, num) {\n    return this.isub(a, this.convertTo(new BN(num)));\n  }\n\n  imul(a, b) {\n    return this.mul(a, b)._move(a);\n  }\n\n  mul(a, b) {\n    this._verify2(a, b);\n\n    if (a.isZero() || b.isZero()) return new BN(0)._forceRed(this);\n    const t = a.mul(b);\n    const c = t.umaskn(this.n).mul(this.mi).iumaskn(this.n);\n    const u = t.iadd(c.mul(this.m)).iushrn(this.n);\n    if (u.ucmp(this.m) >= 0) u._isub(u, this.m);\n    return u._forceRed(this);\n  }\n\n  imuln(a, num) {\n    this._verify1(a);\n\n    if (a.isZero()) return a;\n\n    if (num === 0) {\n      a.words[0] = 0;\n      a.length = 1;\n      return a;\n    }\n\n    const neg = num < 0;\n    if (neg) num = -num;\n    if (this.m.length === 1) num %= this.m.words[0];\n    const bits = countBits(num); // Potentially compute with additions.\n    // This avoids an expensive division.\n\n    if (bits > 5) {\n      // Slow case (num > 31).\n      this.imul(a, this.convertTo(new BN(num)));\n    } else if ((num & num - 1) === 0) {\n      // Optimize for powers of two.\n      for (let i = 0; i < bits - 1; i++) this.iadd(a, a);\n    } else {\n      // Multiply left to right.\n      const c = a.clone();\n\n      for (let i = bits - 2; i >= 0; i--) {\n        this.iadd(a, a);\n        if (num >> i & 1) this.iadd(a, c);\n      }\n    }\n\n    if (neg) this.ineg(a);\n    return a;\n  }\n\n  eqn(a, num) {\n    this._verify1(a);\n\n    if (num === 0) return a.isZero();\n    return a.ucmp(this.convertTo(new BN(num))) === 0;\n  }\n\n  isLow(a) {\n    this._verify1(a);\n\n    return this.convertFrom(a).ucmp(this.m.ushrn(1)) <= 0;\n  }\n\n  isOdd(a) {\n    this._verify1(a);\n\n    return this.convertFrom(a).isOdd();\n  }\n\n  isEven(a) {\n    this._verify1(a);\n\n    return this.convertFrom(a).isEven();\n  }\n\n  invert(a) {\n    this._verify1(a); // (AR)^-1 * R^2 = (A^-1 * R^-1) * R^2 = A^-1 * R\n\n\n    return this.imod(a._invertp(this.m).mul(this.r2));\n  }\n\n}\n/*\n * Helpers\n */\n\n\nfunction makeError(Error, msg, start) {\n  const err = new Error(msg);\n  if (Error.captureStackTrace) Error.captureStackTrace(err, start);\n  return err;\n}\n\nfunction assert(value, message) {\n  if (!value) {\n    const msg = message || 'Assertion failed.';\n    throw makeError(Error, msg, assert);\n  }\n}\n\nfunction enforce(value, name, type) {\n  if (!value) {\n    const msg = `\"${name}\" must be a(n) ${type}.`;\n    throw makeError(TypeError, msg, enforce);\n  }\n}\n\nfunction range(value, name) {\n  if (!value) {\n    const msg = `\"${name}\" only works with positive numbers.`;\n    throw makeError(RangeError, msg, range);\n  }\n}\n\nfunction red(value, name) {\n  if (!value) {\n    const msg = `\"${name}\" only works with red numbers.`;\n    throw makeError(TypeError, msg, red);\n  }\n}\n\nfunction nonred(value, name) {\n  if (!value) {\n    const msg = `\"${name}\" only works with normal numbers.`;\n    throw makeError(TypeError, msg, nonred);\n  }\n}\n\nfunction nonzero(value) {\n  if (!value) {\n    const msg = 'Cannot divide by zero.';\n    throw makeError(RangeError, msg, nonzero);\n  }\n}\n\nfunction isInteger(num) {\n  return Number.isSafeInteger(num);\n}\n\nfunction isSMI(num) {\n  return isInteger(num) && num >= -0x3ffffff && num <= 0x3ffffff;\n}\n\nfunction allocate(ArrayType, size) {\n  if (ArrayType.allocUnsafeSlow) return ArrayType.allocUnsafeSlow(size);\n  return new ArrayType(size);\n}\n\nfunction getBase(base) {\n  if (base == null) return 10;\n  if (typeof base === 'number') return base;\n\n  switch (base) {\n    case 'bin':\n      return 2;\n\n    case 'oct':\n      return 8;\n\n    case 'dec':\n      return 10;\n\n    case 'hex':\n      return 16;\n  }\n\n  return 0;\n}\n/*\n * Internal\n */\n\n\nfunction countBits(w) {\n  if (Math.clz32) return 32 - Math.clz32(w);\n  let t = w;\n  let r = 0;\n\n  if (t >= 0x1000) {\n    r += 13;\n    t >>>= 13;\n  }\n\n  if (t >= 0x40) {\n    r += 7;\n    t >>>= 7;\n  }\n\n  if (t >= 0x8) {\n    r += 4;\n    t >>>= 4;\n  }\n\n  if (t >= 0x02) {\n    r += 2;\n    t >>>= 2;\n  }\n\n  return r + t;\n}\n\nfunction zeroBits(w) {\n  // Shortcut.\n  if (w === 0) return 26;\n  let t = w;\n  let r = 0;\n\n  if ((t & 0x1fff) === 0) {\n    r += 13;\n    t >>>= 13;\n  }\n\n  if ((t & 0x7f) === 0) {\n    r += 7;\n    t >>>= 7;\n  }\n\n  if ((t & 0xf) === 0) {\n    r += 4;\n    t >>>= 4;\n  }\n\n  if ((t & 0x3) === 0) {\n    r += 2;\n    t >>>= 2;\n  }\n\n  if ((t & 0x1) === 0) r += 1;\n  return r;\n}\n\nfunction parseHex(str, start, end) {\n  const len = Math.min(str.length, end);\n  let r = 0;\n  let z = 0;\n\n  for (let i = start; i < len; i++) {\n    const c = str.charCodeAt(i) - 48;\n    r <<= 4;\n    let b;\n\n    if (c >= 49 && c <= 54) {\n      // 'a' - 'f'\n      b = c - 49 + 0xa;\n    } else if (c >= 17 && c <= 22) {\n      // 'A' - 'F'\n      b = c - 17 + 0xa;\n    } else {\n      // '0' - '9'\n      b = c;\n    }\n\n    r |= b;\n    z |= b;\n  }\n\n  if (z & ~15) throw new Error('Invalid string.');\n  return r;\n}\n\nfunction parseBase(str, start, end, mul) {\n  const len = Math.min(str.length, end);\n  let r = 0;\n\n  for (let i = start; i < len; i++) {\n    const c = str.charCodeAt(i) - 48;\n    r *= mul;\n    let b;\n\n    if (c >= 49) {\n      // 'a'\n      b = c - 49 + 0xa;\n    } else if (c >= 17) {\n      // 'A'\n      b = c - 17 + 0xa;\n    } else {\n      // '0' - '9'\n      b = c;\n    }\n\n    if (c < 0 || c > 207 || b >= mul) throw new Error('Invalid string.');\n    r += b;\n  }\n\n  return r;\n}\n/*\n * Exponentiation (bigint)\n */\n\n\nfunction powInt(x, e, m) {\n  // Sliding window.\n  const wnd = new Array(WND_SIZE);\n  wnd[0] = sqrn(x, WND_WIDTH - 1, m);\n  wnd[1] = wnd[0] * x;\n\n  for (let i = 2; i < WND_SIZE; i++) wnd[i] = wnd[i - 1] * x % m;\n\n  let i = e.bitLength();\n  let r = BigInt(1);\n\n  while (i >= WND_WIDTH) {\n    const pos = i - WND_WIDTH;\n    const bits = e.bits(pos, WND_WIDTH);\n\n    if (bits < WND_SIZE) {\n      r = r * r % m;\n      i -= 1;\n      continue;\n    }\n\n    r = sqrn(r, WND_WIDTH, m);\n    r = r * wnd[bits & ~WND_SIZE] % m;\n    i = pos;\n  }\n\n  if (i > 0) {\n    const bits = e.bits(0, i);\n\n    while (i--) {\n      r = r * r % m;\n      if (bits >> i & 1) r = r * x % m;\n    }\n  }\n\n  return r;\n}\n\nfunction sqrn(x, n, m) {\n  for (let i = 0; i < n; i++) x = x * x % m;\n\n  return x;\n}\n/*\n * Multiplication\n */\n\n\nfunction smallMulTo(self, num, out) {\n  const len = self.length + num.length;\n  out.negative = self.negative ^ num.negative;\n\n  out._alloc(len);\n\n  out.length = len; // Peel one iteration (compiler can't\n  // do it, because of code complexity).\n\n  const a = self.words[0];\n  const b = num.words[0];\n  const r = a * b;\n  const lo = r & 0x3ffffff;\n  let carry = r / 0x4000000 | 0;\n  let k = 1;\n  out.words[0] = lo;\n\n  for (; k < out.length - 1; k++) {\n    // Sum all words with the same\n    // `i + j = k` and accumulate\n    // `ncarry`, note that ncarry\n    // could be >= 0x3ffffff.\n    let ncarry = carry >>> 26;\n    let rword = carry & 0x3ffffff;\n    const min = Math.max(0, k - self.length + 1);\n    const max = Math.min(k, num.length - 1);\n\n    for (let j = min; j <= max; j++) {\n      const i = k - j;\n      const a = self.words[i];\n      const b = num.words[j];\n      const r = a * b + rword;\n      ncarry += r / 0x4000000 | 0;\n      rword = r & 0x3ffffff;\n    }\n\n    out.words[k] = rword | 0;\n    carry = ncarry | 0;\n  }\n\n  if (carry !== 0) out.words[k] = carry | 0;else out.length -= 1;\n  return out._strip();\n}\n\nfunction bigMulTo(self, num, out) {\n  const len = self.length + num.length;\n  out.negative = self.negative ^ num.negative;\n\n  out._alloc(len);\n\n  out.length = len;\n  let carry = 0;\n  let hncarry = 0;\n  let k = 0;\n\n  for (; k < out.length - 1; k++) {\n    // Sum all words with the same\n    // `i + j = k` and accumulate\n    // `ncarry`, note that ncarry\n    // could be >= 0x3ffffff.\n    let ncarry = hncarry;\n    hncarry = 0;\n    let rword = carry & 0x3ffffff;\n    const min = Math.max(0, k - self.length + 1);\n    const max = Math.min(k, num.length - 1);\n\n    for (let j = min; j <= max; j++) {\n      const i = k - j;\n      const a = self.words[i];\n      const b = num.words[j];\n      const r = a * b;\n      let lo = r & 0x3ffffff;\n      ncarry = ncarry + (r / 0x4000000 | 0) | 0;\n      lo = lo + rword | 0;\n      rword = lo & 0x3ffffff;\n      ncarry = ncarry + (lo >>> 26) | 0;\n      hncarry += ncarry >>> 26;\n      ncarry &= 0x3ffffff;\n    }\n\n    out.words[k] = rword;\n    carry = ncarry;\n    ncarry = hncarry;\n  }\n\n  if (carry !== 0) out.words[k] = carry;else out.length -= 1;\n  return out._strip();\n}\n\nfunction jumboMulTo(x, y, out) {\n  // v8 has a 2147483519 bit max (~256mb).\n  if (!HAS_BIGINT || x.length + y.length > 82595519) return bigMulTo(x, y, out);\n  const zero = BigInt(0);\n  const mask = BigInt(0x3ffffff);\n  const shift = BigInt(26);\n  let z = x.toBigInt() * y.toBigInt();\n  const neg = z < zero | 0;\n  if (neg) z = -z;\n  let i = 0;\n\n  while (z > zero) {\n    out.words[i++] = Number(z & mask);\n    z >>= shift;\n  }\n\n  if (i === 0) out.words[i++] = 0;\n  out.length = i;\n  out.negative = neg;\n  return out;\n}\n\nfunction comb10MulTo(self, num, out) {\n  const a = self.words;\n  const b = num.words;\n  const o = out.words;\n  const a0 = a[0] | 0;\n  const al0 = a0 & 0x1fff;\n  const ah0 = a0 >>> 13;\n  const a1 = a[1] | 0;\n  const al1 = a1 & 0x1fff;\n  const ah1 = a1 >>> 13;\n  const a2 = a[2] | 0;\n  const al2 = a2 & 0x1fff;\n  const ah2 = a2 >>> 13;\n  const a3 = a[3] | 0;\n  const al3 = a3 & 0x1fff;\n  const ah3 = a3 >>> 13;\n  const a4 = a[4] | 0;\n  const al4 = a4 & 0x1fff;\n  const ah4 = a4 >>> 13;\n  const a5 = a[5] | 0;\n  const al5 = a5 & 0x1fff;\n  const ah5 = a5 >>> 13;\n  const a6 = a[6] | 0;\n  const al6 = a6 & 0x1fff;\n  const ah6 = a6 >>> 13;\n  const a7 = a[7] | 0;\n  const al7 = a7 & 0x1fff;\n  const ah7 = a7 >>> 13;\n  const a8 = a[8] | 0;\n  const al8 = a8 & 0x1fff;\n  const ah8 = a8 >>> 13;\n  const a9 = a[9] | 0;\n  const al9 = a9 & 0x1fff;\n  const ah9 = a9 >>> 13;\n  const b0 = b[0] | 0;\n  const bl0 = b0 & 0x1fff;\n  const bh0 = b0 >>> 13;\n  const b1 = b[1] | 0;\n  const bl1 = b1 & 0x1fff;\n  const bh1 = b1 >>> 13;\n  const b2 = b[2] | 0;\n  const bl2 = b2 & 0x1fff;\n  const bh2 = b2 >>> 13;\n  const b3 = b[3] | 0;\n  const bl3 = b3 & 0x1fff;\n  const bh3 = b3 >>> 13;\n  const b4 = b[4] | 0;\n  const bl4 = b4 & 0x1fff;\n  const bh4 = b4 >>> 13;\n  const b5 = b[5] | 0;\n  const bl5 = b5 & 0x1fff;\n  const bh5 = b5 >>> 13;\n  const b6 = b[6] | 0;\n  const bl6 = b6 & 0x1fff;\n  const bh6 = b6 >>> 13;\n  const b7 = b[7] | 0;\n  const bl7 = b7 & 0x1fff;\n  const bh7 = b7 >>> 13;\n  const b8 = b[8] | 0;\n  const bl8 = b8 & 0x1fff;\n  const bh8 = b8 >>> 13;\n  const b9 = b[9] | 0;\n  const bl9 = b9 & 0x1fff;\n  const bh9 = b9 >>> 13;\n  let c = 0;\n  let lo, mid, hi;\n  out.negative = self.negative ^ num.negative;\n\n  out._alloc(20);\n\n  out.length = 19;\n  /* k = 0 */\n\n  lo = Math.imul(al0, bl0);\n  mid = Math.imul(al0, bh0);\n  mid = mid + Math.imul(ah0, bl0) | 0;\n  hi = Math.imul(ah0, bh0);\n  let w0 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w0 >>> 26) | 0;\n  w0 &= 0x3ffffff;\n  /* k = 1 */\n\n  lo = Math.imul(al1, bl0);\n  mid = Math.imul(al1, bh0);\n  mid = mid + Math.imul(ah1, bl0) | 0;\n  hi = Math.imul(ah1, bh0);\n  lo = lo + Math.imul(al0, bl1) | 0;\n  mid = mid + Math.imul(al0, bh1) | 0;\n  mid = mid + Math.imul(ah0, bl1) | 0;\n  hi = hi + Math.imul(ah0, bh1) | 0;\n  let w1 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w1 >>> 26) | 0;\n  w1 &= 0x3ffffff;\n  /* k = 2 */\n\n  lo = Math.imul(al2, bl0);\n  mid = Math.imul(al2, bh0);\n  mid = mid + Math.imul(ah2, bl0) | 0;\n  hi = Math.imul(ah2, bh0);\n  lo = lo + Math.imul(al1, bl1) | 0;\n  mid = mid + Math.imul(al1, bh1) | 0;\n  mid = mid + Math.imul(ah1, bl1) | 0;\n  hi = hi + Math.imul(ah1, bh1) | 0;\n  lo = lo + Math.imul(al0, bl2) | 0;\n  mid = mid + Math.imul(al0, bh2) | 0;\n  mid = mid + Math.imul(ah0, bl2) | 0;\n  hi = hi + Math.imul(ah0, bh2) | 0;\n  let w2 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w2 >>> 26) | 0;\n  w2 &= 0x3ffffff;\n  /* k = 3 */\n\n  lo = Math.imul(al3, bl0);\n  mid = Math.imul(al3, bh0);\n  mid = mid + Math.imul(ah3, bl0) | 0;\n  hi = Math.imul(ah3, bh0);\n  lo = lo + Math.imul(al2, bl1) | 0;\n  mid = mid + Math.imul(al2, bh1) | 0;\n  mid = mid + Math.imul(ah2, bl1) | 0;\n  hi = hi + Math.imul(ah2, bh1) | 0;\n  lo = lo + Math.imul(al1, bl2) | 0;\n  mid = mid + Math.imul(al1, bh2) | 0;\n  mid = mid + Math.imul(ah1, bl2) | 0;\n  hi = hi + Math.imul(ah1, bh2) | 0;\n  lo = lo + Math.imul(al0, bl3) | 0;\n  mid = mid + Math.imul(al0, bh3) | 0;\n  mid = mid + Math.imul(ah0, bl3) | 0;\n  hi = hi + Math.imul(ah0, bh3) | 0;\n  let w3 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w3 >>> 26) | 0;\n  w3 &= 0x3ffffff;\n  /* k = 4 */\n\n  lo = Math.imul(al4, bl0);\n  mid = Math.imul(al4, bh0);\n  mid = mid + Math.imul(ah4, bl0) | 0;\n  hi = Math.imul(ah4, bh0);\n  lo = lo + Math.imul(al3, bl1) | 0;\n  mid = mid + Math.imul(al3, bh1) | 0;\n  mid = mid + Math.imul(ah3, bl1) | 0;\n  hi = hi + Math.imul(ah3, bh1) | 0;\n  lo = lo + Math.imul(al2, bl2) | 0;\n  mid = mid + Math.imul(al2, bh2) | 0;\n  mid = mid + Math.imul(ah2, bl2) | 0;\n  hi = hi + Math.imul(ah2, bh2) | 0;\n  lo = lo + Math.imul(al1, bl3) | 0;\n  mid = mid + Math.imul(al1, bh3) | 0;\n  mid = mid + Math.imul(ah1, bl3) | 0;\n  hi = hi + Math.imul(ah1, bh3) | 0;\n  lo = lo + Math.imul(al0, bl4) | 0;\n  mid = mid + Math.imul(al0, bh4) | 0;\n  mid = mid + Math.imul(ah0, bl4) | 0;\n  hi = hi + Math.imul(ah0, bh4) | 0;\n  let w4 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w4 >>> 26) | 0;\n  w4 &= 0x3ffffff;\n  /* k = 5 */\n\n  lo = Math.imul(al5, bl0);\n  mid = Math.imul(al5, bh0);\n  mid = mid + Math.imul(ah5, bl0) | 0;\n  hi = Math.imul(ah5, bh0);\n  lo = lo + Math.imul(al4, bl1) | 0;\n  mid = mid + Math.imul(al4, bh1) | 0;\n  mid = mid + Math.imul(ah4, bl1) | 0;\n  hi = hi + Math.imul(ah4, bh1) | 0;\n  lo = lo + Math.imul(al3, bl2) | 0;\n  mid = mid + Math.imul(al3, bh2) | 0;\n  mid = mid + Math.imul(ah3, bl2) | 0;\n  hi = hi + Math.imul(ah3, bh2) | 0;\n  lo = lo + Math.imul(al2, bl3) | 0;\n  mid = mid + Math.imul(al2, bh3) | 0;\n  mid = mid + Math.imul(ah2, bl3) | 0;\n  hi = hi + Math.imul(ah2, bh3) | 0;\n  lo = lo + Math.imul(al1, bl4) | 0;\n  mid = mid + Math.imul(al1, bh4) | 0;\n  mid = mid + Math.imul(ah1, bl4) | 0;\n  hi = hi + Math.imul(ah1, bh4) | 0;\n  lo = lo + Math.imul(al0, bl5) | 0;\n  mid = mid + Math.imul(al0, bh5) | 0;\n  mid = mid + Math.imul(ah0, bl5) | 0;\n  hi = hi + Math.imul(ah0, bh5) | 0;\n  let w5 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w5 >>> 26) | 0;\n  w5 &= 0x3ffffff;\n  /* k = 6 */\n\n  lo = Math.imul(al6, bl0);\n  mid = Math.imul(al6, bh0);\n  mid = mid + Math.imul(ah6, bl0) | 0;\n  hi = Math.imul(ah6, bh0);\n  lo = lo + Math.imul(al5, bl1) | 0;\n  mid = mid + Math.imul(al5, bh1) | 0;\n  mid = mid + Math.imul(ah5, bl1) | 0;\n  hi = hi + Math.imul(ah5, bh1) | 0;\n  lo = lo + Math.imul(al4, bl2) | 0;\n  mid = mid + Math.imul(al4, bh2) | 0;\n  mid = mid + Math.imul(ah4, bl2) | 0;\n  hi = hi + Math.imul(ah4, bh2) | 0;\n  lo = lo + Math.imul(al3, bl3) | 0;\n  mid = mid + Math.imul(al3, bh3) | 0;\n  mid = mid + Math.imul(ah3, bl3) | 0;\n  hi = hi + Math.imul(ah3, bh3) | 0;\n  lo = lo + Math.imul(al2, bl4) | 0;\n  mid = mid + Math.imul(al2, bh4) | 0;\n  mid = mid + Math.imul(ah2, bl4) | 0;\n  hi = hi + Math.imul(ah2, bh4) | 0;\n  lo = lo + Math.imul(al1, bl5) | 0;\n  mid = mid + Math.imul(al1, bh5) | 0;\n  mid = mid + Math.imul(ah1, bl5) | 0;\n  hi = hi + Math.imul(ah1, bh5) | 0;\n  lo = lo + Math.imul(al0, bl6) | 0;\n  mid = mid + Math.imul(al0, bh6) | 0;\n  mid = mid + Math.imul(ah0, bl6) | 0;\n  hi = hi + Math.imul(ah0, bh6) | 0;\n  let w6 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w6 >>> 26) | 0;\n  w6 &= 0x3ffffff;\n  /* k = 7 */\n\n  lo = Math.imul(al7, bl0);\n  mid = Math.imul(al7, bh0);\n  mid = mid + Math.imul(ah7, bl0) | 0;\n  hi = Math.imul(ah7, bh0);\n  lo = lo + Math.imul(al6, bl1) | 0;\n  mid = mid + Math.imul(al6, bh1) | 0;\n  mid = mid + Math.imul(ah6, bl1) | 0;\n  hi = hi + Math.imul(ah6, bh1) | 0;\n  lo = lo + Math.imul(al5, bl2) | 0;\n  mid = mid + Math.imul(al5, bh2) | 0;\n  mid = mid + Math.imul(ah5, bl2) | 0;\n  hi = hi + Math.imul(ah5, bh2) | 0;\n  lo = lo + Math.imul(al4, bl3) | 0;\n  mid = mid + Math.imul(al4, bh3) | 0;\n  mid = mid + Math.imul(ah4, bl3) | 0;\n  hi = hi + Math.imul(ah4, bh3) | 0;\n  lo = lo + Math.imul(al3, bl4) | 0;\n  mid = mid + Math.imul(al3, bh4) | 0;\n  mid = mid + Math.imul(ah3, bl4) | 0;\n  hi = hi + Math.imul(ah3, bh4) | 0;\n  lo = lo + Math.imul(al2, bl5) | 0;\n  mid = mid + Math.imul(al2, bh5) | 0;\n  mid = mid + Math.imul(ah2, bl5) | 0;\n  hi = hi + Math.imul(ah2, bh5) | 0;\n  lo = lo + Math.imul(al1, bl6) | 0;\n  mid = mid + Math.imul(al1, bh6) | 0;\n  mid = mid + Math.imul(ah1, bl6) | 0;\n  hi = hi + Math.imul(ah1, bh6) | 0;\n  lo = lo + Math.imul(al0, bl7) | 0;\n  mid = mid + Math.imul(al0, bh7) | 0;\n  mid = mid + Math.imul(ah0, bl7) | 0;\n  hi = hi + Math.imul(ah0, bh7) | 0;\n  let w7 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w7 >>> 26) | 0;\n  w7 &= 0x3ffffff;\n  /* k = 8 */\n\n  lo = Math.imul(al8, bl0);\n  mid = Math.imul(al8, bh0);\n  mid = mid + Math.imul(ah8, bl0) | 0;\n  hi = Math.imul(ah8, bh0);\n  lo = lo + Math.imul(al7, bl1) | 0;\n  mid = mid + Math.imul(al7, bh1) | 0;\n  mid = mid + Math.imul(ah7, bl1) | 0;\n  hi = hi + Math.imul(ah7, bh1) | 0;\n  lo = lo + Math.imul(al6, bl2) | 0;\n  mid = mid + Math.imul(al6, bh2) | 0;\n  mid = mid + Math.imul(ah6, bl2) | 0;\n  hi = hi + Math.imul(ah6, bh2) | 0;\n  lo = lo + Math.imul(al5, bl3) | 0;\n  mid = mid + Math.imul(al5, bh3) | 0;\n  mid = mid + Math.imul(ah5, bl3) | 0;\n  hi = hi + Math.imul(ah5, bh3) | 0;\n  lo = lo + Math.imul(al4, bl4) | 0;\n  mid = mid + Math.imul(al4, bh4) | 0;\n  mid = mid + Math.imul(ah4, bl4) | 0;\n  hi = hi + Math.imul(ah4, bh4) | 0;\n  lo = lo + Math.imul(al3, bl5) | 0;\n  mid = mid + Math.imul(al3, bh5) | 0;\n  mid = mid + Math.imul(ah3, bl5) | 0;\n  hi = hi + Math.imul(ah3, bh5) | 0;\n  lo = lo + Math.imul(al2, bl6) | 0;\n  mid = mid + Math.imul(al2, bh6) | 0;\n  mid = mid + Math.imul(ah2, bl6) | 0;\n  hi = hi + Math.imul(ah2, bh6) | 0;\n  lo = lo + Math.imul(al1, bl7) | 0;\n  mid = mid + Math.imul(al1, bh7) | 0;\n  mid = mid + Math.imul(ah1, bl7) | 0;\n  hi = hi + Math.imul(ah1, bh7) | 0;\n  lo = lo + Math.imul(al0, bl8) | 0;\n  mid = mid + Math.imul(al0, bh8) | 0;\n  mid = mid + Math.imul(ah0, bl8) | 0;\n  hi = hi + Math.imul(ah0, bh8) | 0;\n  let w8 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w8 >>> 26) | 0;\n  w8 &= 0x3ffffff;\n  /* k = 9 */\n\n  lo = Math.imul(al9, bl0);\n  mid = Math.imul(al9, bh0);\n  mid = mid + Math.imul(ah9, bl0) | 0;\n  hi = Math.imul(ah9, bh0);\n  lo = lo + Math.imul(al8, bl1) | 0;\n  mid = mid + Math.imul(al8, bh1) | 0;\n  mid = mid + Math.imul(ah8, bl1) | 0;\n  hi = hi + Math.imul(ah8, bh1) | 0;\n  lo = lo + Math.imul(al7, bl2) | 0;\n  mid = mid + Math.imul(al7, bh2) | 0;\n  mid = mid + Math.imul(ah7, bl2) | 0;\n  hi = hi + Math.imul(ah7, bh2) | 0;\n  lo = lo + Math.imul(al6, bl3) | 0;\n  mid = mid + Math.imul(al6, bh3) | 0;\n  mid = mid + Math.imul(ah6, bl3) | 0;\n  hi = hi + Math.imul(ah6, bh3) | 0;\n  lo = lo + Math.imul(al5, bl4) | 0;\n  mid = mid + Math.imul(al5, bh4) | 0;\n  mid = mid + Math.imul(ah5, bl4) | 0;\n  hi = hi + Math.imul(ah5, bh4) | 0;\n  lo = lo + Math.imul(al4, bl5) | 0;\n  mid = mid + Math.imul(al4, bh5) | 0;\n  mid = mid + Math.imul(ah4, bl5) | 0;\n  hi = hi + Math.imul(ah4, bh5) | 0;\n  lo = lo + Math.imul(al3, bl6) | 0;\n  mid = mid + Math.imul(al3, bh6) | 0;\n  mid = mid + Math.imul(ah3, bl6) | 0;\n  hi = hi + Math.imul(ah3, bh6) | 0;\n  lo = lo + Math.imul(al2, bl7) | 0;\n  mid = mid + Math.imul(al2, bh7) | 0;\n  mid = mid + Math.imul(ah2, bl7) | 0;\n  hi = hi + Math.imul(ah2, bh7) | 0;\n  lo = lo + Math.imul(al1, bl8) | 0;\n  mid = mid + Math.imul(al1, bh8) | 0;\n  mid = mid + Math.imul(ah1, bl8) | 0;\n  hi = hi + Math.imul(ah1, bh8) | 0;\n  lo = lo + Math.imul(al0, bl9) | 0;\n  mid = mid + Math.imul(al0, bh9) | 0;\n  mid = mid + Math.imul(ah0, bl9) | 0;\n  hi = hi + Math.imul(ah0, bh9) | 0;\n  let w9 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w9 >>> 26) | 0;\n  w9 &= 0x3ffffff;\n  /* k = 10 */\n\n  lo = Math.imul(al9, bl1);\n  mid = Math.imul(al9, bh1);\n  mid = mid + Math.imul(ah9, bl1) | 0;\n  hi = Math.imul(ah9, bh1);\n  lo = lo + Math.imul(al8, bl2) | 0;\n  mid = mid + Math.imul(al8, bh2) | 0;\n  mid = mid + Math.imul(ah8, bl2) | 0;\n  hi = hi + Math.imul(ah8, bh2) | 0;\n  lo = lo + Math.imul(al7, bl3) | 0;\n  mid = mid + Math.imul(al7, bh3) | 0;\n  mid = mid + Math.imul(ah7, bl3) | 0;\n  hi = hi + Math.imul(ah7, bh3) | 0;\n  lo = lo + Math.imul(al6, bl4) | 0;\n  mid = mid + Math.imul(al6, bh4) | 0;\n  mid = mid + Math.imul(ah6, bl4) | 0;\n  hi = hi + Math.imul(ah6, bh4) | 0;\n  lo = lo + Math.imul(al5, bl5) | 0;\n  mid = mid + Math.imul(al5, bh5) | 0;\n  mid = mid + Math.imul(ah5, bl5) | 0;\n  hi = hi + Math.imul(ah5, bh5) | 0;\n  lo = lo + Math.imul(al4, bl6) | 0;\n  mid = mid + Math.imul(al4, bh6) | 0;\n  mid = mid + Math.imul(ah4, bl6) | 0;\n  hi = hi + Math.imul(ah4, bh6) | 0;\n  lo = lo + Math.imul(al3, bl7) | 0;\n  mid = mid + Math.imul(al3, bh7) | 0;\n  mid = mid + Math.imul(ah3, bl7) | 0;\n  hi = hi + Math.imul(ah3, bh7) | 0;\n  lo = lo + Math.imul(al2, bl8) | 0;\n  mid = mid + Math.imul(al2, bh8) | 0;\n  mid = mid + Math.imul(ah2, bl8) | 0;\n  hi = hi + Math.imul(ah2, bh8) | 0;\n  lo = lo + Math.imul(al1, bl9) | 0;\n  mid = mid + Math.imul(al1, bh9) | 0;\n  mid = mid + Math.imul(ah1, bl9) | 0;\n  hi = hi + Math.imul(ah1, bh9) | 0;\n  let w10 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w10 >>> 26) | 0;\n  w10 &= 0x3ffffff;\n  /* k = 11 */\n\n  lo = Math.imul(al9, bl2);\n  mid = Math.imul(al9, bh2);\n  mid = mid + Math.imul(ah9, bl2) | 0;\n  hi = Math.imul(ah9, bh2);\n  lo = lo + Math.imul(al8, bl3) | 0;\n  mid = mid + Math.imul(al8, bh3) | 0;\n  mid = mid + Math.imul(ah8, bl3) | 0;\n  hi = hi + Math.imul(ah8, bh3) | 0;\n  lo = lo + Math.imul(al7, bl4) | 0;\n  mid = mid + Math.imul(al7, bh4) | 0;\n  mid = mid + Math.imul(ah7, bl4) | 0;\n  hi = hi + Math.imul(ah7, bh4) | 0;\n  lo = lo + Math.imul(al6, bl5) | 0;\n  mid = mid + Math.imul(al6, bh5) | 0;\n  mid = mid + Math.imul(ah6, bl5) | 0;\n  hi = hi + Math.imul(ah6, bh5) | 0;\n  lo = lo + Math.imul(al5, bl6) | 0;\n  mid = mid + Math.imul(al5, bh6) | 0;\n  mid = mid + Math.imul(ah5, bl6) | 0;\n  hi = hi + Math.imul(ah5, bh6) | 0;\n  lo = lo + Math.imul(al4, bl7) | 0;\n  mid = mid + Math.imul(al4, bh7) | 0;\n  mid = mid + Math.imul(ah4, bl7) | 0;\n  hi = hi + Math.imul(ah4, bh7) | 0;\n  lo = lo + Math.imul(al3, bl8) | 0;\n  mid = mid + Math.imul(al3, bh8) | 0;\n  mid = mid + Math.imul(ah3, bl8) | 0;\n  hi = hi + Math.imul(ah3, bh8) | 0;\n  lo = lo + Math.imul(al2, bl9) | 0;\n  mid = mid + Math.imul(al2, bh9) | 0;\n  mid = mid + Math.imul(ah2, bl9) | 0;\n  hi = hi + Math.imul(ah2, bh9) | 0;\n  let w11 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w11 >>> 26) | 0;\n  w11 &= 0x3ffffff;\n  /* k = 12 */\n\n  lo = Math.imul(al9, bl3);\n  mid = Math.imul(al9, bh3);\n  mid = mid + Math.imul(ah9, bl3) | 0;\n  hi = Math.imul(ah9, bh3);\n  lo = lo + Math.imul(al8, bl4) | 0;\n  mid = mid + Math.imul(al8, bh4) | 0;\n  mid = mid + Math.imul(ah8, bl4) | 0;\n  hi = hi + Math.imul(ah8, bh4) | 0;\n  lo = lo + Math.imul(al7, bl5) | 0;\n  mid = mid + Math.imul(al7, bh5) | 0;\n  mid = mid + Math.imul(ah7, bl5) | 0;\n  hi = hi + Math.imul(ah7, bh5) | 0;\n  lo = lo + Math.imul(al6, bl6) | 0;\n  mid = mid + Math.imul(al6, bh6) | 0;\n  mid = mid + Math.imul(ah6, bl6) | 0;\n  hi = hi + Math.imul(ah6, bh6) | 0;\n  lo = lo + Math.imul(al5, bl7) | 0;\n  mid = mid + Math.imul(al5, bh7) | 0;\n  mid = mid + Math.imul(ah5, bl7) | 0;\n  hi = hi + Math.imul(ah5, bh7) | 0;\n  lo = lo + Math.imul(al4, bl8) | 0;\n  mid = mid + Math.imul(al4, bh8) | 0;\n  mid = mid + Math.imul(ah4, bl8) | 0;\n  hi = hi + Math.imul(ah4, bh8) | 0;\n  lo = lo + Math.imul(al3, bl9) | 0;\n  mid = mid + Math.imul(al3, bh9) | 0;\n  mid = mid + Math.imul(ah3, bl9) | 0;\n  hi = hi + Math.imul(ah3, bh9) | 0;\n  let w12 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w12 >>> 26) | 0;\n  w12 &= 0x3ffffff;\n  /* k = 13 */\n\n  lo = Math.imul(al9, bl4);\n  mid = Math.imul(al9, bh4);\n  mid = mid + Math.imul(ah9, bl4) | 0;\n  hi = Math.imul(ah9, bh4);\n  lo = lo + Math.imul(al8, bl5) | 0;\n  mid = mid + Math.imul(al8, bh5) | 0;\n  mid = mid + Math.imul(ah8, bl5) | 0;\n  hi = hi + Math.imul(ah8, bh5) | 0;\n  lo = lo + Math.imul(al7, bl6) | 0;\n  mid = mid + Math.imul(al7, bh6) | 0;\n  mid = mid + Math.imul(ah7, bl6) | 0;\n  hi = hi + Math.imul(ah7, bh6) | 0;\n  lo = lo + Math.imul(al6, bl7) | 0;\n  mid = mid + Math.imul(al6, bh7) | 0;\n  mid = mid + Math.imul(ah6, bl7) | 0;\n  hi = hi + Math.imul(ah6, bh7) | 0;\n  lo = lo + Math.imul(al5, bl8) | 0;\n  mid = mid + Math.imul(al5, bh8) | 0;\n  mid = mid + Math.imul(ah5, bl8) | 0;\n  hi = hi + Math.imul(ah5, bh8) | 0;\n  lo = lo + Math.imul(al4, bl9) | 0;\n  mid = mid + Math.imul(al4, bh9) | 0;\n  mid = mid + Math.imul(ah4, bl9) | 0;\n  hi = hi + Math.imul(ah4, bh9) | 0;\n  let w13 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w13 >>> 26) | 0;\n  w13 &= 0x3ffffff;\n  /* k = 14 */\n\n  lo = Math.imul(al9, bl5);\n  mid = Math.imul(al9, bh5);\n  mid = mid + Math.imul(ah9, bl5) | 0;\n  hi = Math.imul(ah9, bh5);\n  lo = lo + Math.imul(al8, bl6) | 0;\n  mid = mid + Math.imul(al8, bh6) | 0;\n  mid = mid + Math.imul(ah8, bl6) | 0;\n  hi = hi + Math.imul(ah8, bh6) | 0;\n  lo = lo + Math.imul(al7, bl7) | 0;\n  mid = mid + Math.imul(al7, bh7) | 0;\n  mid = mid + Math.imul(ah7, bl7) | 0;\n  hi = hi + Math.imul(ah7, bh7) | 0;\n  lo = lo + Math.imul(al6, bl8) | 0;\n  mid = mid + Math.imul(al6, bh8) | 0;\n  mid = mid + Math.imul(ah6, bl8) | 0;\n  hi = hi + Math.imul(ah6, bh8) | 0;\n  lo = lo + Math.imul(al5, bl9) | 0;\n  mid = mid + Math.imul(al5, bh9) | 0;\n  mid = mid + Math.imul(ah5, bl9) | 0;\n  hi = hi + Math.imul(ah5, bh9) | 0;\n  let w14 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w14 >>> 26) | 0;\n  w14 &= 0x3ffffff;\n  /* k = 15 */\n\n  lo = Math.imul(al9, bl6);\n  mid = Math.imul(al9, bh6);\n  mid = mid + Math.imul(ah9, bl6) | 0;\n  hi = Math.imul(ah9, bh6);\n  lo = lo + Math.imul(al8, bl7) | 0;\n  mid = mid + Math.imul(al8, bh7) | 0;\n  mid = mid + Math.imul(ah8, bl7) | 0;\n  hi = hi + Math.imul(ah8, bh7) | 0;\n  lo = lo + Math.imul(al7, bl8) | 0;\n  mid = mid + Math.imul(al7, bh8) | 0;\n  mid = mid + Math.imul(ah7, bl8) | 0;\n  hi = hi + Math.imul(ah7, bh8) | 0;\n  lo = lo + Math.imul(al6, bl9) | 0;\n  mid = mid + Math.imul(al6, bh9) | 0;\n  mid = mid + Math.imul(ah6, bl9) | 0;\n  hi = hi + Math.imul(ah6, bh9) | 0;\n  let w15 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w15 >>> 26) | 0;\n  w15 &= 0x3ffffff;\n  /* k = 16 */\n\n  lo = Math.imul(al9, bl7);\n  mid = Math.imul(al9, bh7);\n  mid = mid + Math.imul(ah9, bl7) | 0;\n  hi = Math.imul(ah9, bh7);\n  lo = lo + Math.imul(al8, bl8) | 0;\n  mid = mid + Math.imul(al8, bh8) | 0;\n  mid = mid + Math.imul(ah8, bl8) | 0;\n  hi = hi + Math.imul(ah8, bh8) | 0;\n  lo = lo + Math.imul(al7, bl9) | 0;\n  mid = mid + Math.imul(al7, bh9) | 0;\n  mid = mid + Math.imul(ah7, bl9) | 0;\n  hi = hi + Math.imul(ah7, bh9) | 0;\n  let w16 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w16 >>> 26) | 0;\n  w16 &= 0x3ffffff;\n  /* k = 17 */\n\n  lo = Math.imul(al9, bl8);\n  mid = Math.imul(al9, bh8);\n  mid = mid + Math.imul(ah9, bl8) | 0;\n  hi = Math.imul(ah9, bh8);\n  lo = lo + Math.imul(al8, bl9) | 0;\n  mid = mid + Math.imul(al8, bh9) | 0;\n  mid = mid + Math.imul(ah8, bl9) | 0;\n  hi = hi + Math.imul(ah8, bh9) | 0;\n  let w17 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w17 >>> 26) | 0;\n  w17 &= 0x3ffffff;\n  /* k = 18 */\n\n  lo = Math.imul(al9, bl9);\n  mid = Math.imul(al9, bh9);\n  mid = mid + Math.imul(ah9, bl9) | 0;\n  hi = Math.imul(ah9, bh9);\n  let w18 = (c + lo | 0) + ((mid & 0x1fff) << 13) | 0;\n  c = (hi + (mid >>> 13) | 0) + (w18 >>> 26) | 0;\n  w18 &= 0x3ffffff;\n  o[0] = w0;\n  o[1] = w1;\n  o[2] = w2;\n  o[3] = w3;\n  o[4] = w4;\n  o[5] = w5;\n  o[6] = w6;\n  o[7] = w7;\n  o[8] = w8;\n  o[9] = w9;\n  o[10] = w10;\n  o[11] = w11;\n  o[12] = w12;\n  o[13] = w13;\n  o[14] = w14;\n  o[15] = w15;\n  o[16] = w16;\n  o[17] = w17;\n  o[18] = w18;\n\n  if (c !== 0) {\n    o[19] = c;\n    out.length += 1;\n  } // Note: we shouldn't need to strip here.\n\n\n  return out;\n} // Polyfill comb.\n\n\nif (!Math.imul) comb10MulTo = smallMulTo;\n/*\n * Expose\n */\n\nBN.Red = Red;\nmodule.exports = BN;","map":{"version":3,"sources":["/Users/yenerkaraca/Documents/GitHub/eth-app/node_modules/bcrypto/lib/js/bn.js"],"names":["custom","require","zeros","groupSizes","groupBases","primes","p192","p224","p521","k256","p25519","p448","modes","NONE","QUO","REM","BOTH","EUCLID","ALL","WND_WIDTH","WND_SIZE","HAS_BIGINT","BigInt","BN","constructor","num","base","endian","words","length","negative","red","from","_iadd","a","b","carry","i","_alloc","r","_iaddn","Math","max","iadd","enforce","isBN","cmp","ucmp","_isub","iaddn","isSMI","_isubn","add","clone","addn","assert","_strip","_normalize","isub","isubn","sub","subn","_mul","out","comb10MulTo","len","smallMulTo","bigMulTo","jumboMulTo","imul","mul","_move","imuln","neg","w","lo","Array","muln","mulShift","bits","utestn","iushrn","_div","flags","nonzero","isZero","as","bs","q","quon","remn","_wordDiv","hi","word","shift","countBits","iushln","m","d","_ishlnsubmul","j","ahi","alo","quo","qj","min","ineg","_expand","k","quorem","iquo","iquon","irem","rem","iremn","remrn","p","acc","divmod","idiv","div","idivn","divn","imod","mod","imodn","modrn","modn","divRound","bit","isOdd","ipow","pow","ipown","pown","sqr","isqr","_rootrem","RangeError","ucmpn","u","t","bitLength","v","rootrem","iroot","root","isPower","sign","sqrtrem","isqrt","sqrt","isSquare","iand","x","y","iuand","iuor","width","inotn","iandn","and","andn","andrn","n","iuandn","abs","uand","uandn","uandrn","ior","iorn","or","orn","iuorn","uor","uorn","ixor","iuxor","ixorn","xor","xorn","iuxorn","uxor","uxorn","inot","not","s","ceil","notn","ishl","ishln","toNumber","shl","shln","iushl","mask","ncarry","c","ushl","ushln","_split","output","ishr","ishrn","shr","shrn","iushr","ushr","ushrn","setn","val","usetn","testn","imaskn","iumaskn","maskn","umaskn","andln","pos","index","more","next","iabs","res","cmpn","eq","eqn","gt","gtn","gte","gten","lt","ltn","lte","lten","isNeg","isPos","isEven","legendre","mont","toRed","redLegendre","jacobi","Error","_cloneNormal","zeroBits","bmod8","kronecker","table","z","igcd","gcd","_factor2","az","bz","ilcm","lcm","egcd","A","B","C","D","g","yp","xp","im","jm","iinvert","invert","range","ifermat","fermat","redFermat","fromRed","ipowm","powm","redPow","ipowmn","powmn","redPown","isqrtm","sqrtm","redSqrt","isqrtpq","sqrtpq","sp","sq","mp","mq","lhs","rhs","isPrime","rng","reps","limit","isPrimeMR","isPrimeLucas","force2","nm1","nm3","rnm1","rone","random","redSqr","toString","nm2","toTwos","fromTwos","ctx","Red","convertTo","convertFrom","forceRed","_forceRed","redIAdd","redAdd","redIAddn","redAddn","redISub","redSub","redISubn","redSubn","redIMul","redMul","redIMuln","redMuln","redIDiv","redDiv","redIDivn","redDivn","redIPow","nonred","redIPown","redISqr","redISqrt","redIDivSqrt","idivsqrt","redDivSqrt","divsqrt","redIsSquare","redIShl","redShl","redIShln","redShln","redINeg","redNeg","redEq","redEqn","redIsHigh","isHigh","redIsLow","isLow","redIsOdd","redIsEven","redJacobi","redKronecker","redIInvert","redInvert","redIFermat","dest","size","push","_check","_invertp","x1","x2","delta","copy","inject","set","fromNumber","swap","reverse","fromBuffer","toBuffer","byteLength","isSafe","prefix","csign","czero","zword","cneg","cpos","ceq","ceqn","cswap","flag","cond","cinject","mask0","mask1","cset","toDouble","valueOf","toBigInt","s52","s26","toBool","padding","getBase","off","groupSize","groupBase","toJSON","toArray","toArrayLike","Buffer","ArrayType","bytes","allocate","encode","of","isInteger","fromDouble","isFinite","floor","fromBigInt","start","_fromHex","fromBool","value","fromString","str","replace","charCodeAt","_fromBase","parseHex","limbLen","limbPow","total","end","parseBase","fromJSON","json","isArray","chunk","join","fromBN","fromArray","data","fromArrayLike","isBuffer","left","decode","TypeError","args","barrett","Barrett","Mont","_prime","name","prime","P192","P224","P521","K256","P25519","P448","exp","randomBits","randomBytes","cast","space","obj","wordSize","native","Prime","one","ireduce","split","imulK","input","prev","mb","sm1","_verify1","_verify2","coprime","precompute","e","intTo","intFrom","powInt","powNum","wnd","sqrn","sqrt3mod4","sqrt5mod8sm1","sqrt5mod8","sqrt0","alpha","beta","divsqrt3mod4","divsqrt5mod8","u2","u3","u5","v3","v7","symbol","Boolean","_shift","r2","ri","mi","rib","makeError","msg","err","captureStackTrace","message","type","Number","isSafeInteger","allocUnsafeSlow","clz32","self","rword","hncarry","zero","o","a0","al0","ah0","a1","al1","ah1","a2","al2","ah2","a3","al3","ah3","a4","al4","ah4","a5","al5","ah5","a6","al6","ah6","a7","al7","ah7","a8","al8","ah8","a9","al9","ah9","b0","bl0","bh0","b1","bl1","bh1","b2","bl2","bh2","b3","bl3","bh3","b4","bl4","bh4","b5","bl5","bh5","b6","bl6","bh6","b7","bl7","bh7","b8","bl8","bh8","b9","bl9","bh9","mid","w0","w1","w2","w3","w4","w5","w6","w7","w8","w9","w10","w11","w12","w13","w14","w15","w16","w17","w18","module","exports"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AAEA;;AAEA,MAAM;AAACA,EAAAA;AAAD,IAAWC,OAAO,CAAC,oBAAD,CAAxB;AAEA;;;;;AAIA,MAAMC,KAAK,GAAG,CACZ,EADY,EAEZ,GAFY,EAGZ,IAHY,EAIZ,KAJY,EAKZ,MALY,EAMZ,OANY,EAOZ,QAPY,EAQZ,SARY,EASZ,UATY,EAUZ,WAVY,EAWZ,YAXY,EAYZ,aAZY,EAaZ,cAbY,EAcZ,eAdY,EAeZ,gBAfY,EAgBZ,iBAhBY,EAiBZ,kBAjBY,EAkBZ,mBAlBY,EAmBZ,oBAnBY,EAoBZ,qBApBY,EAqBZ,sBArBY,EAsBZ,uBAtBY,EAuBZ,wBAvBY,EAwBZ,yBAxBY,EAyBZ,0BAzBY,EA0BZ,2BA1BY,CAAd;AA6BA,MAAMC,UAAU,GAAG,CACjB,IADiB,EACX,IADW,EACL,IADK,EACC,IADD,EACO,IADP,EACa,IADb,EAEjB,IAFiB,EAEX,IAFW,EAEL,IAFK,EAEC,IAFD,EAEO,IAFP,EAEa,IAFb,EAGjB,IAHiB,EAGX,IAHW,EAGL,IAHK,EAGC,IAHD,EAGO,IAHP,EAGa,IAHb,EAIjB,IAJiB,EAIX,IAJW,EAIL,IAJK,EAIC,IAJD,EAIO,IAJP,EAIa,IAJb,EAKjB,IALiB,EAKX,IALW,EAKL,IALK,EAKC,IALD,EAKO,IALP,EAKa,IALb,EAMjB,IANiB,EAMX,IANW,EAML,IANK,EAMC,IAND,EAMO,IANP,EAMa,IANb,CAAnB;AASA,MAAMC,UAAU,GAAG,CACjB,UADiB,EACL,UADK,EACO,UADP,EACmB,UADnB,EAEjB,UAFiB,EAEL,UAFK,EAEO,UAFP,EAEmB,UAFnB,EAGjB,UAHiB,EAGL,UAHK,EAGO,UAHP,EAGmB,UAHnB,EAIjB,UAJiB,EAIL,UAJK,EAIO,UAJP,EAImB,UAJnB,EAKjB,UALiB,EAKL,UALK,EAKO,UALP,EAKmB,UALnB,EAMjB,UANiB,EAML,UANK,EAMO,UANP,EAMmB,UANnB,EAOjB,UAPiB,EAOL,UAPK,EAOO,UAPP,EAOmB,UAPnB,EAQjB,UARiB,EAQL,UARK,EAQO,UARP,EAQmB,UARnB,EASjB,UATiB,EASL,UATK,EASO,UATP,EASmB,UATnB,CAAnB;AAYA,MAAMC,MAAM,GAAG;AACbC,EAAAA,IAAI,EAAE,IADO;AAEbC,EAAAA,IAAI,EAAE,IAFO;AAGbC,EAAAA,IAAI,EAAE,IAHO;AAIbC,EAAAA,IAAI,EAAE,IAJO;AAKbC,EAAAA,MAAM,EAAE,IALK;AAMbC,EAAAA,IAAI,EAAE;AANO,CAAf;AASA,MAAMC,KAAK,GAAG;AACZC,EAAAA,IAAI,EAAE,CADM;AAEZC,EAAAA,GAAG,EAAE,CAFO;AAGZC,EAAAA,GAAG,EAAE,CAHO;AAIZC,EAAAA,IAAI,EAAE,CAJM;AAKZC,EAAAA,MAAM,EAAE,CALI;AAMZC,EAAAA,GAAG,EAAE;AANO,CAAd;AASA,MAAMC,SAAS,GAAG,CAAlB;AACA,MAAMC,QAAQ,GAAG,KAAMD,SAAS,GAAG,CAAnC;AAEA,MAAME,UAAU,GAAG,OAAOC,MAAP,KAAkB,UAArC;AAEA;;;;AAIA,MAAMC,EAAN,CAAS;AACPC,EAAAA,WAAW,CAACC,GAAD,EAAMC,IAAN,EAAYC,MAAZ,EAAoB;AAC7B,SAAKC,KAAL,GAAa,CAAC,CAAD,CAAb;AACA,SAAKC,MAAL,GAAc,CAAd;AACA,SAAKC,QAAL,GAAgB,CAAhB;AACA,SAAKC,GAAL,GAAW,IAAX;AACA,SAAKC,IAAL,CAAUP,GAAV,EAAeC,IAAf,EAAqBC,MAArB;AACD;AAED;;;;;AAIAM,EAAAA,KAAK,CAACC,CAAD,EAAIC,CAAJ,EAAO;AACV,QAAIC,KAAK,GAAG,CAAZ;AACA,QAAIC,CAAC,GAAG,CAAR,CAFU,CAIV;;AACA,QAAIH,CAAC,CAACL,MAAF,GAAWM,CAAC,CAACN,MAAjB,EACE,CAACK,CAAD,EAAIC,CAAJ,IAAS,CAACA,CAAD,EAAID,CAAJ,CAAT;AAEF,QAAIA,CAAC,KAAK,IAAV,EACE,KAAKI,MAAL,CAAYJ,CAAC,CAACL,MAAd;;AAEF,WAAOQ,CAAC,GAAGF,CAAC,CAACN,MAAb,EAAqBQ,CAAC,EAAtB,EAA0B;AACxB,YAAME,CAAC,GAAG,CAACL,CAAC,CAACN,KAAF,CAAQS,CAAR,IAAa,CAAd,KAAoBF,CAAC,CAACP,KAAF,CAAQS,CAAR,IAAa,CAAjC,IAAsCD,KAAhD;AAEA,WAAKR,KAAL,CAAWS,CAAX,IAAgBE,CAAC,GAAG,SAApB;AAEAH,MAAAA,KAAK,GAAGG,CAAC,KAAK,EAAd;AACD;;AAED,WAAOH,KAAK,KAAK,CAAV,IAAeC,CAAC,GAAGH,CAAC,CAACL,MAA5B,EAAoCQ,CAAC,EAArC,EAAyC;AACvC,YAAME,CAAC,GAAG,CAACL,CAAC,CAACN,KAAF,CAAQS,CAAR,IAAa,CAAd,IAAmBD,KAA7B;AAEA,WAAKR,KAAL,CAAWS,CAAX,IAAgBE,CAAC,GAAG,SAApB;AAEAH,MAAAA,KAAK,GAAGG,CAAC,KAAK,EAAd;AACD;;AAED,SAAKV,MAAL,GAAcK,CAAC,CAACL,MAAhB;;AAEA,QAAIO,KAAK,KAAK,CAAd,EAAiB;AACf,WAAKE,MAAL,CAAY,KAAKT,MAAL,GAAc,CAA1B;;AACA,WAAKD,KAAL,CAAW,KAAKC,MAAL,EAAX,IAA4BO,KAA5B;AACD,KAHD,MAGO,IAAIF,CAAC,KAAK,IAAV,EAAgB;AACrB;AACA,aAAOG,CAAC,GAAGH,CAAC,CAACL,MAAb,EAAqBQ,CAAC,EAAtB,EACE,KAAKT,KAAL,CAAWS,CAAX,IAAgBH,CAAC,CAACN,KAAF,CAAQS,CAAR,CAAhB;AACH,KApCS,CAsCV;;;AACA,WAAO,IAAP;AACD;;AAEDG,EAAAA,MAAM,CAACf,GAAD,EAAM;AACV,SAAKG,KAAL,CAAW,CAAX,KAAiBH,GAAjB;AAEA,QAAI,KAAKG,KAAL,CAAW,CAAX,IAAgB,SAApB,EACE,OAAO,IAAP,CAJQ,CAMV;;AACA,QAAIS,CAAC,GAAG,CAAR;;AAEA,SAAKC,MAAL,CAAY,KAAKT,MAAL,GAAc,CAA1B;;AAEA,SAAKD,KAAL,CAAW,KAAKC,MAAhB,IAA0B,CAA1B;;AAEA,WAAOQ,CAAC,GAAG,KAAKR,MAAT,IAAmB,KAAKD,KAAL,CAAWS,CAAX,KAAiB,SAA3C,EAAsDA,CAAC,EAAvD,EAA2D;AACzD,WAAKT,KAAL,CAAWS,CAAX,KAAiB,SAAjB;AACA,WAAKT,KAAL,CAAWS,CAAC,GAAG,CAAf,KAAqB,CAArB;AACD;;AAED,SAAKR,MAAL,GAAcY,IAAI,CAACC,GAAL,CAAS,KAAKb,MAAd,EAAsBQ,CAAC,GAAG,CAA1B,CAAd,CAlBU,CAoBV;;AACA,WAAO,IAAP;AACD;AAED;;;;;AAIAM,EAAAA,IAAI,CAAClB,GAAD,EAAM;AACRmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;;AAEA,QAAI,KAAKK,QAAL,KAAkBL,GAAG,CAACK,QAA1B,EAAoC;AAClC;AACA;AACA,WAAKG,KAAL,CAAW,IAAX,EAAiBR,GAAjB;AACD,KAJD,MAIO;AACL;AACA;AACA,YAAMqB,GAAG,GAAG,KAAKC,IAAL,CAAUtB,GAAV,CAAZ,CAHK,CAKL;;AACA,UAAIqB,GAAG,KAAK,CAAZ,EAAe;AACb,aAAKlB,KAAL,CAAW,CAAX,IAAgB,CAAhB;AACA,aAAKC,MAAL,GAAc,CAAd;AACA,aAAKC,QAAL,GAAgB,CAAhB;AACA,eAAO,IAAP;AACD;;AAED,UAAIgB,GAAG,GAAG,CAAV,EAAa;AACX,aAAKE,KAAL,CAAWvB,GAAX,EAAgB,IAAhB;;AACA,aAAKK,QAAL,IAAiB,CAAjB;AACD,OAHD,MAGO;AACL,aAAKkB,KAAL,CAAW,IAAX,EAAiBvB,GAAjB;AACD;AACF;;AAED,WAAO,IAAP;AACD;;AAEDwB,EAAAA,KAAK,CAACxB,GAAD,EAAM;AACTmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AAEA,UAAMK,QAAQ,GAAIL,GAAG,GAAG,CAAP,GAAY,CAA7B;AAEA,QAAIK,QAAJ,EACEL,GAAG,GAAG,CAACA,GAAP;;AAEF,QAAI,KAAKK,QAAL,KAAkBA,QAAtB,EAAgC;AAC9B;AACA;AACA,WAAKU,MAAL,CAAYf,GAAZ;AACD,KAJD,MAIO;AACL;AACA;AACA,UAAI,KAAKI,MAAL,KAAgB,CAAhB,IAAqB,KAAKD,KAAL,CAAW,CAAX,IAAgBH,GAAzC,EAA8C;AAC5C,aAAKG,KAAL,CAAW,CAAX,IAAgBH,GAAG,GAAG,KAAKG,KAAL,CAAW,CAAX,CAAtB;AACA,aAAKE,QAAL,IAAiB,CAAjB;AACD,OAHD,MAGO;AACL,aAAKqB,MAAL,CAAY1B,GAAZ;AACD;AACF;;AAED,WAAO,IAAP;AACD;;AAED2B,EAAAA,GAAG,CAAC3B,GAAD,EAAM;AACPmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,QAAIA,GAAG,CAACI,MAAJ,GAAa,KAAKA,MAAtB,EACE,OAAOJ,GAAG,CAAC4B,KAAJ,GAAYV,IAAZ,CAAiB,IAAjB,CAAP;AAEF,WAAO,KAAKU,KAAL,GAAaV,IAAb,CAAkBlB,GAAlB,CAAP;AACD;;AAED6B,EAAAA,IAAI,CAAC7B,GAAD,EAAM;AACR,WAAO,KAAK4B,KAAL,GAAaJ,KAAb,CAAmBxB,GAAnB,CAAP;AACD;AAED;;;;;AAIAuB,EAAAA,KAAK,CAACd,CAAD,EAAIC,CAAJ,EAAO;AACV,QAAIC,KAAK,GAAG,CAAZ;AACA,QAAIC,CAAC,GAAG,CAAR,CAFU,CAIV;;AACAkB,IAAAA,MAAM,CAACrB,CAAC,CAACL,MAAF,IAAYM,CAAC,CAACN,MAAf,CAAN;AAEA,QAAIK,CAAC,KAAK,IAAV,EACE,KAAKI,MAAL,CAAYJ,CAAC,CAACL,MAAd;;AAEF,WAAOQ,CAAC,GAAGF,CAAC,CAACN,MAAb,EAAqBQ,CAAC,EAAtB,EAA0B;AACxB,YAAME,CAAC,GAAG,CAACL,CAAC,CAACN,KAAF,CAAQS,CAAR,IAAa,CAAd,KAAoBF,CAAC,CAACP,KAAF,CAAQS,CAAR,IAAa,CAAjC,IAAsCD,KAAhD;AAEAA,MAAAA,KAAK,GAAGG,CAAC,IAAI,EAAb;AAEA,WAAKX,KAAL,CAAWS,CAAX,IAAgBE,CAAC,GAAG,SAApB;AACD;;AAED,WAAOH,KAAK,KAAK,CAAV,IAAeC,CAAC,GAAGH,CAAC,CAACL,MAA5B,EAAoCQ,CAAC,EAArC,EAAyC;AACvC,YAAME,CAAC,GAAG,CAACL,CAAC,CAACN,KAAF,CAAQS,CAAR,IAAa,CAAd,IAAmBD,KAA7B;AAEAA,MAAAA,KAAK,GAAGG,CAAC,IAAI,EAAb;AAEA,WAAKX,KAAL,CAAWS,CAAX,IAAgBE,CAAC,GAAG,SAApB;AACD;;AAEDgB,IAAAA,MAAM,CAACnB,KAAK,KAAK,CAAX,CAAN,CA1BU,CA4BV;;AACA,QAAIF,CAAC,KAAK,IAAV,EAAgB;AACd,aAAOG,CAAC,GAAGH,CAAC,CAACL,MAAb,EAAqBQ,CAAC,EAAtB,EACE,KAAKT,KAAL,CAAWS,CAAX,IAAgBH,CAAC,CAACN,KAAF,CAAQS,CAAR,CAAhB;AACH;;AAED,SAAKR,MAAL,GAAcY,IAAI,CAACC,GAAL,CAAS,KAAKb,MAAd,EAAsBQ,CAAtB,CAAd;AAEA,WAAO,KAAKmB,MAAL,EAAP;AACD;;AAEDL,EAAAA,MAAM,CAAC1B,GAAD,EAAM;AACV,SAAKG,KAAL,CAAW,CAAX,KAAiBH,GAAjB;AAEA,QAAI,KAAKG,KAAL,CAAW,CAAX,KAAiB,CAArB,EACE,OAAO,KAAK6B,UAAL,EAAP;AAEFF,IAAAA,MAAM,CAAC,KAAK1B,MAAL,KAAgB,CAAjB,CAAN,CANU,CAQV;;AACA,SAAKS,MAAL,CAAY,KAAKT,MAAL,GAAc,CAA1B;;AAEA,SAAK,IAAIQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKR,MAAT,IAAmB,KAAKD,KAAL,CAAWS,CAAX,IAAgB,CAAnD,EAAsDA,CAAC,EAAvD,EAA2D;AACzD,WAAKT,KAAL,CAAWS,CAAX,KAAiB,SAAjB;AACA,WAAKT,KAAL,CAAWS,CAAC,GAAG,CAAf,KAAqB,CAArB;AACD;;AAED,SAAKT,KAAL,CAAW,KAAKC,MAAhB,IAA0B,CAA1B;AAEA,WAAO,KAAK2B,MAAL,EAAP;AACD;AAED;;;;;AAIAE,EAAAA,IAAI,CAACjC,GAAD,EAAM;AACRmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;;AAEA,QAAI,KAAKK,QAAL,KAAkBL,GAAG,CAACK,QAA1B,EAAoC;AAClC;AACA;AACA,WAAKG,KAAL,CAAW,IAAX,EAAiBR,GAAjB;AACD,KAJD,MAIO;AACL;AACA;AACA,YAAMqB,GAAG,GAAG,KAAKC,IAAL,CAAUtB,GAAV,CAAZ,CAHK,CAKL;;AACA,UAAIqB,GAAG,KAAK,CAAZ,EAAe;AACb,aAAKlB,KAAL,CAAW,CAAX,IAAgB,CAAhB;AACA,aAAKC,MAAL,GAAc,CAAd;AACA,aAAKC,QAAL,GAAgB,CAAhB;AACA,eAAO,IAAP;AACD;;AAED,UAAIgB,GAAG,GAAG,CAAV,EAAa;AACX,aAAKE,KAAL,CAAWvB,GAAX,EAAgB,IAAhB;;AACA,aAAKK,QAAL,IAAiB,CAAjB;AACD,OAHD,MAGO;AACL,aAAKkB,KAAL,CAAW,IAAX,EAAiBvB,GAAjB;AACD;AACF;;AAED,WAAO,IAAP;AACD;;AAEDkC,EAAAA,KAAK,CAAClC,GAAD,EAAM;AACTmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AAEA,UAAMK,QAAQ,GAAIL,GAAG,GAAG,CAAP,GAAY,CAA7B;AAEA,QAAIK,QAAJ,EACEL,GAAG,GAAG,CAACA,GAAP;;AAEF,QAAI,KAAKK,QAAL,KAAkBA,QAAtB,EAAgC;AAC9B;AACA;AACA,WAAKU,MAAL,CAAYf,GAAZ;AACD,KAJD,MAIO;AACL;AACA;AACA,UAAI,KAAKI,MAAL,KAAgB,CAAhB,IAAqB,KAAKD,KAAL,CAAW,CAAX,IAAgBH,GAAzC,EAA8C;AAC5C,aAAKG,KAAL,CAAW,CAAX,IAAgBH,GAAG,GAAG,KAAKG,KAAL,CAAW,CAAX,CAAtB;AACA,aAAKE,QAAL,IAAiB,CAAjB;AACD,OAHD,MAGO;AACL,aAAKqB,MAAL,CAAY1B,GAAZ;AACD;AACF;;AAED,WAAO,IAAP;AACD;;AAEDmC,EAAAA,GAAG,CAACnC,GAAD,EAAM;AACP,WAAO,KAAK4B,KAAL,GAAaK,IAAb,CAAkBjC,GAAlB,CAAP;AACD;;AAEDoC,EAAAA,IAAI,CAACpC,GAAD,EAAM;AACR,WAAO,KAAK4B,KAAL,GAAaM,KAAb,CAAmBlC,GAAnB,CAAP;AACD;AAED;;;;;AAIAqC,EAAAA,IAAI,CAACrC,GAAD,EAAMsC,GAAN,EAAW;AACbnB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AACAmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQkB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,QAAI,KAAKlC,MAAL,KAAgB,EAAhB,IAAsBJ,GAAG,CAACI,MAAJ,KAAe,EAAzC,EACE,OAAOmC,WAAW,CAAC,IAAD,EAAOvC,GAAP,EAAYsC,GAAZ,CAAlB;AAEF,UAAME,GAAG,GAAG,KAAKpC,MAAL,GAAcJ,GAAG,CAACI,MAA9B;AAEA,QAAIoC,GAAG,GAAG,EAAV,EACE,OAAOC,UAAU,CAAC,IAAD,EAAOzC,GAAP,EAAYsC,GAAZ,CAAjB;AAEF,QAAIE,GAAG,GAAG,IAAV,EACE,OAAOE,QAAQ,CAAC,IAAD,EAAO1C,GAAP,EAAYsC,GAAZ,CAAf;AAEF,WAAOK,UAAU,CAAC,IAAD,EAAO3C,GAAP,EAAYsC,GAAZ,CAAjB;AACD;AAED;;;;;AAIAM,EAAAA,IAAI,CAAC5C,GAAD,EAAM;AACR,WAAO,KAAK6C,GAAL,CAAS7C,GAAT,EAAc8C,KAAd,CAAoB,IAApB,CAAP;AACD;;AAEDC,EAAAA,KAAK,CAAC/C,GAAD,EAAM;AACTmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AAEA,UAAMgD,GAAG,GAAIhD,GAAG,GAAG,CAAP,GAAY,CAAxB;AAEA,QAAIgD,GAAJ,EACEhD,GAAG,GAAG,CAACA,GAAP,CANO,CAQT;;AACA,QAAIW,KAAK,GAAG,CAAZ;;AAEA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKR,MAAzB,EAAiCQ,CAAC,EAAlC,EAAsC;AACpC,YAAMqC,CAAC,GAAG,KAAK9C,KAAL,CAAWS,CAAX,IAAgBZ,GAA1B;AACA,YAAMkD,EAAE,GAAG,CAACD,CAAC,GAAG,SAAL,KAAmBtC,KAAK,GAAG,SAA3B,CAAX;AAEAA,MAAAA,KAAK,KAAK,EAAV;AACAA,MAAAA,KAAK,IAAKsC,CAAC,GAAG,SAAL,GAAkB,CAA3B;AACAtC,MAAAA,KAAK,IAAIuC,EAAE,KAAK,EAAhB;AAEA,WAAK/C,KAAL,CAAWS,CAAX,IAAgBsC,EAAE,GAAG,SAArB;AACD;;AAED,SAAK7C,QAAL,IAAiB2C,GAAjB;;AAEA,QAAIrC,KAAK,KAAK,CAAd,EAAiB;AACf,WAAKE,MAAL,CAAY,KAAKT,MAAL,GAAc,CAA1B;;AACA,WAAKD,KAAL,CAAW,KAAKC,MAAL,EAAX,IAA4BO,KAA5B;AACD,KAHD,MAGO;AACL,WAAKoB,MAAL;AACD;;AAED,WAAO,IAAP;AACD;;AAEDc,EAAAA,GAAG,CAAC7C,GAAD,EAAM;AACPmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,UAAMwC,GAAG,GAAG,KAAKpC,MAAL,GAAcJ,GAAG,CAACI,MAA9B;AACA,UAAMkC,GAAG,GAAG,IAAIxC,EAAJ,EAAZ;AAEAwC,IAAAA,GAAG,CAACnC,KAAJ,GAAY,IAAIgD,KAAJ,CAAUX,GAAV,CAAZ;;AAEA,SAAK,IAAI5B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4B,GAApB,EAAyB5B,CAAC,EAA1B,EACE0B,GAAG,CAACnC,KAAJ,CAAUS,CAAV,IAAe,CAAf;;AAEF,WAAO,KAAKyB,IAAL,CAAUrC,GAAV,EAAesC,GAAf,CAAP;AACD;;AAEDc,EAAAA,IAAI,CAACpD,GAAD,EAAM;AACR,WAAO,KAAK4B,KAAL,GAAamB,KAAb,CAAmB/C,GAAnB,CAAP;AACD;AAED;;;;;AAIAqD,EAAAA,QAAQ,CAACrD,GAAD,EAAMsD,IAAN,EAAY;AAClBnC,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AACAmB,IAAAA,OAAO,CAAEmC,IAAI,KAAK,CAAV,KAAiBA,IAAlB,EAAwB,MAAxB,EAAgC,QAAhC,CAAP;AAEA,UAAMxC,CAAC,GAAG,KAAK+B,GAAL,CAAS7C,GAAT,CAAV;AACA,UAAMU,CAAC,GAAGI,CAAC,CAACyC,MAAF,CAASD,IAAI,GAAG,CAAhB,CAAV;AAEAxC,IAAAA,CAAC,CAAC0C,MAAF,CAASF,IAAT;AAEA,QAAI,KAAKjD,QAAL,GAAgBL,GAAG,CAACK,QAAxB,EACE,OAAOS,CAAC,CAACoB,KAAF,CAAQxB,CAAR,CAAP;AAEF,WAAOI,CAAC,CAACU,KAAF,CAAQd,CAAR,CAAP;AACD;AAED;;;;;AAIA+C,EAAAA,IAAI,CAACzD,GAAD,EAAM0D,KAAN,EAAa;AACfvC,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AACA8B,IAAAA,MAAM,CAAC,CAAC4B,KAAK,GAAGvE,KAAK,CAACM,GAAf,MAAwBiE,KAAzB,CAAN;AACA5B,IAAAA,MAAM,CAAC4B,KAAK,KAAKvE,KAAK,CAACC,IAAjB,CAAN;AAEA,UAAMqB,CAAC,GAAG,IAAV;AACA,UAAMC,CAAC,GAAGV,GAAV;AAEA2D,IAAAA,OAAO,CAAC,CAACjD,CAAC,CAACkD,MAAF,EAAF,CAAP;AAEA,QAAInD,CAAC,CAACmD,MAAF,EAAJ,EACE,OAAO,CAAC,IAAI9D,EAAJ,CAAO,CAAP,CAAD,EAAY,IAAIA,EAAJ,CAAO,CAAP,CAAZ,CAAP;AAEF,UAAM+D,EAAE,GAAGpD,CAAC,CAACJ,QAAb;AACA,UAAMyD,EAAE,GAAGpD,CAAC,CAACL,QAAb;AAEAI,IAAAA,CAAC,CAACJ,QAAF,GAAa,CAAb;AACAK,IAAAA,CAAC,CAACL,QAAF,GAAa,CAAb;AAEA,QAAI0D,CAAC,GAAG,IAAR;AACA,QAAIjD,CAAC,GAAG,IAAR;;AAEA,QAAIL,CAAC,CAACa,IAAF,CAAOZ,CAAP,IAAY,CAAhB,EAAmB;AACjB,UAAIgD,KAAK,GAAGvE,KAAK,CAACE,GAAlB,EACE0E,CAAC,GAAG,IAAIjE,EAAJ,CAAO,CAAP,CAAJ;AAEF,UAAI4D,KAAK,GAAGvE,KAAK,CAACG,GAAlB,EACEwB,CAAC,GAAGL,CAAC,CAACmB,KAAF,EAAJ;AACH,KAND,MAMO,IAAIlB,CAAC,CAACN,MAAF,KAAa,CAAjB,EAAoB;AACzB,UAAIsD,KAAK,GAAGvE,KAAK,CAACE,GAAlB,EACE0E,CAAC,GAAGtD,CAAC,CAACuD,IAAF,CAAOtD,CAAC,CAACP,KAAF,CAAQ,CAAR,CAAP,CAAJ;AAEF,UAAIuD,KAAK,GAAGvE,KAAK,CAACG,GAAlB,EACEwB,CAAC,GAAGL,CAAC,CAACwD,IAAF,CAAOvD,CAAC,CAACP,KAAF,CAAQ,CAAR,CAAP,CAAJ;AACH,KANM,MAMA;AACL,OAAC4D,CAAD,EAAIjD,CAAJ,IAASL,CAAC,CAACyD,QAAF,CAAWxD,CAAX,EAAcgD,KAAd,CAAT;AACD;;AAEDjD,IAAAA,CAAC,CAACJ,QAAF,GAAawD,EAAb;AACAnD,IAAAA,CAAC,CAACL,QAAF,GAAayD,EAAb;;AAEA,QAAIJ,KAAK,GAAGvE,KAAK,CAACE,GAAlB,EAAuB;AACrB0E,MAAAA,CAAC,CAAC1D,QAAF,GAAaI,CAAC,CAACJ,QAAF,GAAaK,CAAC,CAACL,QAA5B;;AACA0D,MAAAA,CAAC,CAAC/B,UAAF;AACD;;AAED,QAAI0B,KAAK,GAAGvE,KAAK,CAACG,GAAlB,EAAuB;AACrBwB,MAAAA,CAAC,CAACT,QAAF,GAAaI,CAAC,CAACJ,QAAf;;AACAS,MAAAA,CAAC,CAACkB,UAAF;AACD;;AAED,QAAI0B,KAAK,GAAGvE,KAAK,CAACK,MAAlB,EAA0B;AACxB,UAAIkE,KAAK,GAAGvE,KAAK,CAACE,GAAlB,EAAuB;AACrByC,QAAAA,MAAM,CAAC,CAAC4B,KAAK,GAAGvE,KAAK,CAACG,GAAf,MAAwB,CAAzB,CAAN;;AAEA,YAAIwB,CAAC,CAACT,QAAF,KAAe,CAAnB,EAAsB;AACpB,cAAIK,CAAC,CAACL,QAAF,KAAe,CAAnB,EACE0D,CAAC,CAACvC,KAAF,CAAQ,CAAR,EADF,KAGEuC,CAAC,CAAC7B,KAAF,CAAQ,CAAR;AACH;AACF;;AAED,UAAIwB,KAAK,GAAGvE,KAAK,CAACG,GAAlB,EAAuB;AACrB,YAAIwB,CAAC,CAACT,QAAF,KAAe,CAAnB,EAAsB;AACpB,cAAIK,CAAC,CAACL,QAAF,KAAe,CAAnB,EACES,CAAC,CAACmB,IAAF,CAAOvB,CAAP,EADF,KAGEI,CAAC,CAACI,IAAF,CAAOR,CAAP;AACH;AACF;AACF;;AAED,WAAO,CAACqD,CAAD,EAAIjD,CAAJ,CAAP;AACD;;AAEDoD,EAAAA,QAAQ,CAAClE,GAAD,EAAM0D,KAAN,EAAa;AACnB,QAAIjD,CAAC,GAAG,KAAKmB,KAAL,EAAR;AACA,QAAIlB,CAAC,GAAGV,GAAR;AACA,QAAI+D,CAAC,GAAG,IAAR;AACA,QAAII,EAAJ,CAJmB,CAMnB;;AACA,UAAMC,IAAI,GAAG1D,CAAC,CAACP,KAAF,CAAQO,CAAC,CAACN,MAAF,GAAW,CAAnB,IAAwB,CAArC;AACA,UAAMiE,KAAK,GAAG,KAAKC,SAAS,CAACF,IAAD,CAA5B;;AAEA,QAAIC,KAAK,KAAK,CAAd,EAAiB;AACf3D,MAAAA,CAAC,GAAGA,CAAC,CAACkB,KAAF,EAAJ;AAEAnB,MAAAA,CAAC,CAAC8D,MAAF,CAASF,KAAT;AACA3D,MAAAA,CAAC,CAAC6D,MAAF,CAASF,KAAT;AAEAF,MAAAA,EAAE,GAAGzD,CAAC,CAACP,KAAF,CAAQO,CAAC,CAACN,MAAF,GAAW,CAAnB,IAAwB,CAA7B;AACD,KAPD,MAOO;AACL+D,MAAAA,EAAE,GAAGC,IAAL;AACD,KAnBkB,CAqBnB;;;AACA,UAAMI,CAAC,GAAG/D,CAAC,CAACL,MAAF,GAAWM,CAAC,CAACN,MAAvB;AAEA0B,IAAAA,MAAM,CAAC0C,CAAC,IAAI,CAAN,CAAN;;AAEA,QAAId,KAAK,GAAGvE,KAAK,CAACE,GAAlB,EAAuB;AACrB0E,MAAAA,CAAC,GAAG,IAAIjE,EAAJ,CAAO,CAAP,CAAJ;AACAiE,MAAAA,CAAC,CAAC3D,MAAF,GAAWoE,CAAC,GAAG,CAAf;AACAT,MAAAA,CAAC,CAAC5D,KAAF,GAAU,IAAIgD,KAAJ,CAAUY,CAAC,CAAC3D,MAAZ,CAAV;;AAEA,WAAK,IAAIQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmD,CAAC,CAAC3D,MAAtB,EAA8BQ,CAAC,EAA/B,EACEmD,CAAC,CAAC5D,KAAF,CAAQS,CAAR,IAAa,CAAb;AACH,KAjCkB,CAmCnB;;;AACA,UAAM6D,CAAC,GAAGhE,CAAC,CAACmB,KAAF,EAAV;;AAEA6C,IAAAA,CAAC,CAACC,YAAF,CAAehE,CAAf,EAAkB,CAAlB,EAAqB8D,CAArB;;AAEA,QAAIC,CAAC,CAACpE,QAAF,KAAe,CAAnB,EAAsB;AACpB,UAAI0D,CAAJ,EACEA,CAAC,CAAC5D,KAAF,CAAQqE,CAAR,IAAa,CAAb;AAEF/D,MAAAA,CAAC,GAAGgE,CAAJ;AACD,KA7CkB,CA+CnB;;;AACA,SAAK,IAAIE,CAAC,GAAGH,CAAC,GAAG,CAAjB,EAAoBG,CAAC,IAAI,CAAzB,EAA4BA,CAAC,EAA7B,EAAiC;AAC/B,YAAMC,GAAG,GAAGnE,CAAC,CAACN,KAAF,CAAQO,CAAC,CAACN,MAAF,GAAWuE,CAAnB,CAAZ;AACA,YAAME,GAAG,GAAGpE,CAAC,CAACN,KAAF,CAAQO,CAAC,CAACN,MAAF,GAAWuE,CAAX,GAAe,CAAvB,CAAZ;AACA,YAAMG,GAAG,GAAI,CAACF,GAAG,GAAG,SAAN,GAAkBC,GAAnB,IAA0BV,EAA3B,GAAiC,CAA7C;AAEA,UAAIY,EAAE,GAAG/D,IAAI,CAACgE,GAAL,CAASF,GAAT,EAAc,SAAd,CAAT;;AAEArE,MAAAA,CAAC,CAACiE,YAAF,CAAehE,CAAf,EAAkBqE,EAAlB,EAAsBJ,CAAtB;;AAEA,aAAOlE,CAAC,CAACJ,QAAF,KAAe,CAAtB,EAAyB;AACvB0E,QAAAA,EAAE,IAAI,CAAN;AACAtE,QAAAA,CAAC,CAACJ,QAAF,GAAa,CAAb;;AACAI,QAAAA,CAAC,CAACiE,YAAF,CAAehE,CAAf,EAAkB,CAAlB,EAAqBiE,CAArB;;AACAlE,QAAAA,CAAC,CAACwE,IAAF;AACD;;AAED,UAAIlB,CAAJ,EACEA,CAAC,CAAC5D,KAAF,CAAQwE,CAAR,IAAaI,EAAb;AACH,KAlEkB,CAoEnB;;;AACA,QAAIhB,CAAJ,EACEA,CAAC,CAAChC,MAAF,GAtEiB,CAwEnB;AACA;;AACA,QAAK2B,KAAK,GAAGvE,KAAK,CAACG,GAAf,IAAuB+E,KAAK,KAAK,CAArC,EACE5D,CAAC,CAAC+C,MAAF,CAASa,KAAT;AAEF,WAAO,CAACN,CAAD,EAAItD,CAAJ,CAAP;AACD;;AAEDiE,EAAAA,YAAY,CAAC1E,GAAD,EAAM6C,GAAN,EAAWwB,KAAX,EAAkB;AAC5B,QAAI1D,KAAK,GAAG,CAAZ;AACA,QAAIC,CAAC,GAAG,CAAR;;AAEA,SAAKsE,OAAL,CAAalF,GAAG,CAACI,MAAJ,GAAaiE,KAA1B;;AAEA,WAAOzD,CAAC,GAAGZ,GAAG,CAACI,MAAf,EAAuBQ,CAAC,EAAxB,EAA4B;AAC1B,YAAMuE,CAAC,GAAG,CAAC,KAAKhF,KAAL,CAAWS,CAAC,GAAGyD,KAAf,IAAwB,CAAzB,IAA8B1D,KAAxC;AACA,YAAMG,CAAC,GAAGd,GAAG,CAACG,KAAJ,CAAUS,CAAV,IAAeiC,GAAzB;AACA,YAAMI,CAAC,GAAGkC,CAAC,IAAIrE,CAAC,GAAG,SAAR,CAAX;AAEAH,MAAAA,KAAK,GAAG,CAACsC,CAAC,IAAI,EAAN,KAAcnC,CAAC,GAAG,SAAL,GAAkB,CAA/B,CAAR;AAEA,WAAKX,KAAL,CAAWS,CAAC,GAAGyD,KAAf,IAAwBpB,CAAC,GAAG,SAA5B;AACD;;AAED,WAAOrC,CAAC,GAAG,KAAKR,MAAL,GAAciE,KAAzB,EAAgCzD,CAAC,EAAjC,EAAqC;AACnC,YAAMqC,CAAC,GAAG,CAAC,KAAK9C,KAAL,CAAWS,CAAC,GAAGyD,KAAf,IAAwB,CAAzB,IAA8B1D,KAAxC;AAEAA,MAAAA,KAAK,GAAGsC,CAAC,IAAI,EAAb;AAEA,WAAK9C,KAAL,CAAWS,CAAC,GAAGyD,KAAf,IAAwBpB,CAAC,GAAG,SAA5B;AACD;;AAED,QAAItC,KAAK,KAAK,CAAd,EACE,OAAO,KAAKoB,MAAL,EAAP,CAzB0B,CA2B5B;;AACAD,IAAAA,MAAM,CAACnB,KAAK,KAAK,CAAC,CAAZ,CAAN;AAEAA,IAAAA,KAAK,GAAG,CAAR;;AAEA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKR,MAAzB,EAAiCQ,CAAC,EAAlC,EAAsC;AACpC,YAAMqC,CAAC,GAAG,EAAE,KAAK9C,KAAL,CAAWS,CAAX,IAAgB,CAAlB,IAAuBD,KAAjC;AAEAA,MAAAA,KAAK,GAAGsC,CAAC,IAAI,EAAb;AAEA,WAAK9C,KAAL,CAAWS,CAAX,IAAgBqC,CAAC,GAAG,SAApB;AACD;;AAED,SAAK5C,QAAL,GAAgB,CAAhB;AAEA,WAAO,KAAK0B,MAAL,EAAP;AACD;AAED;;;;;AAIAqD,EAAAA,MAAM,CAACpF,GAAD,EAAM;AACV,WAAO,KAAKyD,IAAL,CAAUzD,GAAV,EAAeb,KAAK,CAACI,IAArB,CAAP;AACD;AAED;;;;;AAIA8F,EAAAA,IAAI,CAACrF,GAAD,EAAM;AACR,WAAO,KAAK8E,GAAL,CAAS9E,GAAT,EAAc8C,KAAd,CAAoB,IAApB,CAAP;AACD;;AAEDwC,EAAAA,KAAK,CAACtF,GAAD,EAAM;AACTmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AACA2D,IAAAA,OAAO,CAAC3D,GAAG,KAAK,CAAT,CAAP;AAEA,UAAMgD,GAAG,GAAIhD,GAAG,GAAG,CAAP,GAAY,CAAxB;AAEA,QAAIgD,GAAJ,EACEhD,GAAG,GAAG,CAACA,GAAP;AAEF,QAAIW,KAAK,GAAG,CAAZ;;AAEA,SAAK,IAAIC,CAAC,GAAG,KAAKR,MAAL,GAAc,CAA3B,EAA8BQ,CAAC,IAAI,CAAnC,EAAsCA,CAAC,EAAvC,EAA2C;AACzC,YAAMqC,CAAC,GAAG,CAAC,KAAK9C,KAAL,CAAWS,CAAX,IAAgB,CAAjB,IAAsBD,KAAK,GAAG,SAAxC;AAEA,WAAKR,KAAL,CAAWS,CAAX,IAAiBqC,CAAC,GAAGjD,GAAL,GAAY,CAA5B;AAEAW,MAAAA,KAAK,GAAGsC,CAAC,GAAGjD,GAAZ;AACD;;AAED,SAAKK,QAAL,IAAiB2C,GAAjB;AAEA,WAAO,KAAKjB,MAAL,EAAP;AACD;;AAED+C,EAAAA,GAAG,CAAC9E,GAAD,EAAM;AACP,WAAO,KAAKyD,IAAL,CAAUzD,GAAV,EAAeb,KAAK,CAACE,GAArB,EAA0B,CAA1B,CAAP;AACD;;AAED2E,EAAAA,IAAI,CAAChE,GAAD,EAAM;AACR,WAAO,KAAK4B,KAAL,GAAa0D,KAAb,CAAmBtF,GAAnB,CAAP;AACD;AAED;;;;;AAIAuF,EAAAA,IAAI,CAACvF,GAAD,EAAM;AACR,WAAO,KAAKwF,GAAL,CAASxF,GAAT,EAAc8C,KAAd,CAAoB,IAApB,CAAP;AACD;;AAED2C,EAAAA,KAAK,CAACzF,GAAD,EAAM;AACT,QAAIwE,CAAC,GAAG,KAAKkB,KAAL,CAAW1F,GAAX,CAAR;AAEA,QAAIwE,CAAC,GAAG,CAAR,EACEA,CAAC,GAAG,CAACA,CAAL;AAEF,SAAKrE,KAAL,CAAW,CAAX,IAAgBqE,CAAhB;AACA,SAAKpE,MAAL,GAAc,CAAd;AAEA,WAAO,KAAK4B,UAAL,EAAP;AACD;;AAEDwD,EAAAA,GAAG,CAACxF,GAAD,EAAM;AACP,WAAO,KAAKyD,IAAL,CAAUzD,GAAV,EAAeb,KAAK,CAACG,GAArB,EAA0B,CAA1B,CAAP;AACD;;AAED2E,EAAAA,IAAI,CAACjE,GAAD,EAAM;AACR,WAAO,KAAK4B,KAAL,GAAa6D,KAAb,CAAmBzF,GAAnB,CAAP;AACD;;AAED0F,EAAAA,KAAK,CAAC1F,GAAD,EAAM;AACTmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AACA2D,IAAAA,OAAO,CAAC3D,GAAG,KAAK,CAAT,CAAP;AAEA,QAAIA,GAAG,GAAG,CAAV,EACEA,GAAG,GAAG,CAACA,GAAP;AAEF,UAAM2F,CAAC,GAAG,CAAC,KAAK,EAAN,IAAY3F,GAAtB;AAEA,QAAI4F,GAAG,GAAG,CAAV;;AAEA,SAAK,IAAIhF,CAAC,GAAG,KAAKR,MAAL,GAAc,CAA3B,EAA8BQ,CAAC,IAAI,CAAnC,EAAsCA,CAAC,EAAvC,EACEgF,GAAG,GAAG,CAACD,CAAC,GAAGC,GAAJ,IAAW,KAAKzF,KAAL,CAAWS,CAAX,IAAgB,CAA3B,CAAD,IAAkCZ,GAAxC;;AAEF,WAAO,KAAKK,QAAL,KAAkB,CAAlB,GAAuB,CAACuF,GAAD,GAAO,CAA9B,GAAmCA,GAA1C;AACD;AAED;;;;;AAIAC,EAAAA,MAAM,CAAC7F,GAAD,EAAM;AACV,WAAO,KAAKyD,IAAL,CAAUzD,GAAV,EAAeb,KAAK,CAACI,IAAN,GAAaJ,KAAK,CAACK,MAAlC,CAAP;AACD;AAED;;;;;AAIAsG,EAAAA,IAAI,CAAC9F,GAAD,EAAM;AACR,WAAO,KAAK+F,GAAL,CAAS/F,GAAT,EAAc8C,KAAd,CAAoB,IAApB,CAAP;AACD;;AAEDkD,EAAAA,KAAK,CAAChG,GAAD,EAAM;AACT,QAAI,KAAKK,QAAL,KAAkB,CAAtB,EACE,OAAO,KAAKiF,KAAL,CAAWtF,GAAX,CAAP;AAEF,UAAMc,CAAC,GAAG,KAAK4E,KAAL,CAAW1F,GAAX,CAAV;AAEA,SAAKsF,KAAL,CAAWtF,GAAX;;AAEA,QAAIc,CAAC,GAAG,CAAR,EAAW;AACT,UAAId,GAAG,GAAG,CAAV,EACE,KAAKwB,KAAL,CAAW,CAAX,EADF,KAGE,KAAKU,KAAL,CAAW,CAAX;AACH;;AAED,WAAO,IAAP;AACD;;AAED6D,EAAAA,GAAG,CAAC/F,GAAD,EAAM;AACP,WAAO,KAAKyD,IAAL,CAAUzD,GAAV,EAAeb,KAAK,CAACI,IAAN,GAAaJ,KAAK,CAACK,MAAlC,EAA0C,CAA1C,CAAP;AACD;;AAEDyG,EAAAA,IAAI,CAACjG,GAAD,EAAM;AACR,WAAO,KAAK4B,KAAL,GAAaoE,KAAb,CAAmBhG,GAAnB,CAAP;AACD;AAED;;;;;AAIAkG,EAAAA,IAAI,CAAClG,GAAD,EAAM;AACR,QAAI,KAAKsB,IAAL,CAAUtB,GAAV,IAAiB,CAArB,EAAwB;AACtB,UAAI,KAAKK,QAAL,KAAkB,CAAtB,EAAyB;AACvB,aAAKkB,KAAL,CAAWvB,GAAX,EAAgB,IAAhB;;AACA,aAAKK,QAAL,GAAgB,CAAhB;AACD;;AACD,aAAO,IAAP;AACD;;AAED,WAAO,KAAK8F,GAAL,CAASnG,GAAT,EAAc8C,KAAd,CAAoB,IAApB,CAAP;AACD;;AAEDsD,EAAAA,KAAK,CAACpG,GAAD,EAAM;AACT,SAAKG,KAAL,CAAW,CAAX,IAAgB,KAAKkG,KAAL,CAAWrG,GAAX,CAAhB;AACA,SAAKI,MAAL,GAAc,CAAd;AACA,SAAKC,QAAL,GAAgB,CAAhB;AACA,WAAO,IAAP;AACD;;AAED8F,EAAAA,GAAG,CAACnG,GAAD,EAAM;AACP,WAAO,KAAKyD,IAAL,CAAUzD,GAAV,EAAeb,KAAK,CAACG,GAAN,GAAYH,KAAK,CAACK,MAAjC,EAAyC,CAAzC,CAAP;AACD;;AAED8G,EAAAA,IAAI,CAACtG,GAAD,EAAM;AACR,WAAO,KAAK4B,KAAL,GAAawE,KAAb,CAAmBpG,GAAnB,CAAP;AACD;;AAEDqG,EAAAA,KAAK,CAACrG,GAAD,EAAM;AACTmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AAEA,QAAIc,CAAC,GAAG,KAAK4E,KAAL,CAAW1F,GAAX,CAAR;;AAEA,QAAIc,CAAC,GAAG,CAAR,EAAW;AACT,UAAId,GAAG,GAAG,CAAV,EACEc,CAAC,IAAId,GAAL,CADF,KAGEc,CAAC,IAAId,GAAL;AACH;;AAED,WAAOc,CAAP;AACD;AAED;;;;;AAIAyF,EAAAA,QAAQ,CAACvG,GAAD,EAAM;AACZ,UAAM,CAAC+D,CAAD,EAAIjD,CAAJ,IAAS,KAAKsE,MAAL,CAAYpF,GAAZ,CAAf,CADY,CAGZ;;AACA,QAAIc,CAAC,CAAC8C,MAAF,EAAJ,EACE,OAAOG,CAAP;AAEF,UAAMyC,GAAG,GAAGxG,GAAG,CAACG,KAAJ,CAAU,CAAV,IAAe,CAA3B;AAEAH,IAAAA,GAAG,CAACwD,MAAJ,CAAW,CAAX;AAEA,UAAMnC,GAAG,GAAGP,CAAC,CAACQ,IAAF,CAAOtB,GAAP,CAAZ;AAEAA,IAAAA,GAAG,CAACuE,MAAJ,CAAW,CAAX;AAEAvE,IAAAA,GAAG,CAACG,KAAJ,CAAU,CAAV,KAAgBqG,GAAhB,CAfY,CAiBZ;;AACA,QAAInF,GAAG,GAAG,CAAN,IAAYrB,GAAG,CAACyG,KAAJ,MAAepF,GAAG,KAAK,CAAvC,EACE,OAAO0C,CAAP,CAnBU,CAqBZ;;AACA,QAAI,KAAK1D,QAAL,GAAgBL,GAAG,CAACK,QAAxB,EACE,OAAO0D,CAAC,CAAC7B,KAAF,CAAQ,CAAR,CAAP;AAEF,WAAO6B,CAAC,CAACvC,KAAF,CAAQ,CAAR,CAAP;AACD;AAED;;;;;AAIAkF,EAAAA,IAAI,CAAC1G,GAAD,EAAM;AACR,WAAO,KAAK2G,GAAL,CAAS3G,GAAT,EAAc8C,KAAd,CAAoB,IAApB,CAAP;AACD;;AAED8D,EAAAA,KAAK,CAAC5G,GAAD,EAAM;AACT,WAAO,KAAK6G,IAAL,CAAU7G,GAAV,EAAe8C,KAAf,CAAqB,IAArB,CAAP;AACD;;AAED6D,EAAAA,GAAG,CAAC3G,GAAD,EAAM;AACPmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,QAAIU,CAAC,GAAG4D,SAAS,CAACtE,GAAG,CAACG,KAAJ,CAAUH,GAAG,CAACI,MAAJ,GAAa,CAAvB,CAAD,CAAjB;AACA,QAAIU,CAAC,GAAG,IAAIhB,EAAJ,CAAO,CAAP,CAAR;;AAEA,SAAK,IAAIc,CAAC,GAAGZ,GAAG,CAACI,MAAJ,GAAa,CAA1B,EAA6BQ,CAAC,IAAI,CAAlC,EAAqCA,CAAC,EAAtC,EAA0C;AACxC,YAAMwD,IAAI,GAAGpE,GAAG,CAACG,KAAJ,CAAUS,CAAV,CAAb;;AAEA,WAAK,IAAI+D,CAAC,GAAGjE,CAAC,GAAG,CAAjB,EAAoBiE,CAAC,IAAI,CAAzB,EAA4BA,CAAC,EAA7B,EAAiC;AAC/B7D,QAAAA,CAAC,GAAGA,CAAC,CAACgG,GAAF,EAAJ;AAEA,YAAK1C,IAAI,IAAIO,CAAT,GAAc,CAAlB,EACE7D,CAAC,GAAGA,CAAC,CAAC+B,GAAF,CAAM,IAAN,CAAJ;AACH;;AAEDnC,MAAAA,CAAC,GAAG,EAAJ;AACD;;AAED,WAAOI,CAAP;AACD;;AAED+F,EAAAA,IAAI,CAAC7G,GAAD,EAAM;AACRmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AAEA,QAAIA,GAAG,GAAG,CAAV,EACEA,GAAG,GAAG,CAACA,GAAP;AAEF,QAAIA,GAAG,KAAK,CAAZ,EACE,OAAO,IAAIF,EAAJ,CAAO,CAAP,CAAP;AAEF,QAAIE,GAAG,KAAK,CAAZ,EACE,OAAO,KAAK4B,KAAL,EAAP;AAEF,UAAM0B,IAAI,GAAGgB,SAAS,CAACtE,GAAD,CAAtB;AAEA,QAAIc,CAAC,GAAG,IAAR;;AAEA,SAAK,IAAIF,CAAC,GAAG0C,IAAI,GAAG,CAApB,EAAuB1C,CAAC,IAAI,CAA5B,EAA+BA,CAAC,EAAhC,EAAoC;AAClCE,MAAAA,CAAC,GAAGA,CAAC,CAACgG,GAAF,EAAJ;AAEA,UAAK9G,GAAG,IAAIY,CAAR,GAAa,CAAjB,EACEE,CAAC,GAAGA,CAAC,CAAC+B,GAAF,CAAM,IAAN,CAAJ;AACH;;AAED,WAAO/B,CAAP;AACD;;AAEDiG,EAAAA,IAAI,GAAG;AACL,WAAO,KAAKnE,IAAL,CAAU,IAAV,CAAP;AACD;;AAEDkE,EAAAA,GAAG,GAAG;AACJ,WAAO,KAAKjE,GAAL,CAAS,IAAT,CAAP;AACD;AAED;;;;;AAIAmE,EAAAA,QAAQ,CAACL,GAAD,EAAMnB,GAAN,EAAW;AACjBrE,IAAAA,OAAO,CAAEwF,GAAG,KAAK,CAAT,KAAgBA,GAAjB,EAAsB,KAAtB,EAA6B,QAA7B,CAAP;AAEA,QAAIA,GAAG,KAAK,CAAZ,EACE,MAAM,IAAIM,UAAJ,CAAe,cAAf,CAAN;AAEF,QAAI,CAACN,GAAD,GAAO,KAAKtG,QAAhB,EACE,MAAM,IAAI4G,UAAJ,CAAe,0BAAf,CAAN;AAEF,QAAI,KAAKC,KAAL,CAAW,CAAX,KAAiB,CAArB,EACE,OAAO,CAAC,KAAKtF,KAAL,EAAD,EAAe,IAAI9B,EAAJ,CAAO,CAAP,CAAf,CAAP;AAEF,QAAIqH,CAAC,GAAG,IAAIrH,EAAJ,CAAO,CAAP,CAAR;AACA,QAAIsH,CAAC,GAAGtH,EAAE,CAACuE,KAAH,CAAS,CAAT,EAAY,KAAKgD,SAAL,KAAmBV,GAAnB,GAAyB,CAAzB,GAA6B,CAAzC,CAAR;AACA,QAAIW,CAAJ,EAAOxG,CAAP;AAEA,QAAI,KAAKT,QAAL,KAAkB,CAAtB,EACE+G,CAAC,CAACnC,IAAF;;AAEF,QAAI0B,GAAG,KAAK,CAAZ,EAAe;AACb,SAAG;AACDQ,QAAAA,CAAC,GAAGC,CAAJ;AACAA,QAAAA,CAAC,GAAG,KAAKtC,GAAL,CAASqC,CAAT,CAAJ;AACAC,QAAAA,CAAC,CAAClG,IAAF,CAAOiG,CAAP;AACAC,QAAAA,CAAC,CAAC5D,MAAF,CAAS,CAAT;AACD,OALD,QAKS4D,CAAC,CAAC9F,IAAF,CAAO6F,CAAP,IAAY,CALrB;AAMD,KAPD,MAOO;AACL,SAAG;AACDA,QAAAA,CAAC,GAAGC,CAAJ;AACAA,QAAAA,CAAC,GAAGD,CAAC,CAACN,IAAF,CAAOF,GAAG,GAAG,CAAb,CAAJ;AACAS,QAAAA,CAAC,GAAG,KAAKtC,GAAL,CAASsC,CAAT,CAAJ;AACAE,QAAAA,CAAC,GAAGH,CAAC,CAAC/D,IAAF,CAAOuD,GAAG,GAAG,CAAb,CAAJ;AACAS,QAAAA,CAAC,CAAClG,IAAF,CAAOoG,CAAP;AACAF,QAAAA,CAAC,GAAGA,CAAC,CAACpD,IAAF,CAAO2C,GAAP,CAAJ;AACD,OAPD,QAOSS,CAAC,CAAC9F,IAAF,CAAO6F,CAAP,IAAY,CAPrB;AAQD;;AAED,QAAI3B,GAAJ,EAAS;AACP4B,MAAAA,CAAC,GAAGD,CAAC,CAACN,IAAF,CAAOF,GAAP,CAAJ;AACA7F,MAAAA,CAAC,GAAG,KAAKqB,GAAL,CAASiF,CAAT,CAAJ;AACD;;AAED,WAAO,CAACD,CAAD,EAAIrG,CAAJ,CAAP;AACD;AAED;;;;;AAIAyG,EAAAA,OAAO,CAACZ,GAAD,EAAM;AACX,WAAO,KAAKK,QAAL,CAAcL,GAAd,EAAmB,CAAnB,CAAP;AACD;;AAEDa,EAAAA,KAAK,CAACb,GAAD,EAAM;AACT,WAAO,KAAKc,IAAL,CAAUd,GAAV,EAAe7D,KAAf,CAAqB,IAArB,CAAP;AACD;;AAED2E,EAAAA,IAAI,CAACd,GAAD,EAAM;AACR,WAAO,KAAKK,QAAL,CAAcL,GAAd,EAAmB,CAAnB,EAAsB,CAAtB,CAAP;AACD;;AAEDe,EAAAA,OAAO,CAACf,GAAD,EAAM;AACXxF,IAAAA,OAAO,CAAEwF,GAAG,KAAK,CAAT,KAAgBA,GAAjB,EAAsB,KAAtB,EAA6B,QAA7B,CAAP;AAEA,QAAIA,GAAG,KAAK,CAAR,IAAc,CAACA,GAAD,GAAO,KAAKtG,QAA9B,EACE,OAAO,KAAP;AAEF,UAAM,GAAGS,CAAH,IAAQ,KAAKyG,OAAL,CAAaZ,GAAb,CAAd;AAEA,WAAO7F,CAAC,CAAC6G,IAAF,OAAa,CAApB;AACD;;AAEDC,EAAAA,OAAO,GAAG;AACR,WAAO,KAAKL,OAAL,CAAa,CAAb,CAAP;AACD;;AAEDM,EAAAA,KAAK,GAAG;AACN,WAAO,KAAKC,IAAL,GAAYhF,KAAZ,CAAkB,IAAlB,CAAP;AACD;;AAEDgF,EAAAA,IAAI,GAAG;AACL,WAAO,KAAKL,IAAL,CAAU,CAAV,CAAP;AACD;;AAEDM,EAAAA,QAAQ,GAAG;AACT,WAAO,KAAKL,OAAL,CAAa,CAAb,CAAP;AACD;AAED;;;;;AAIAM,EAAAA,IAAI,CAAChI,GAAD,EAAM;AACRmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,QAAIiI,CAAC,GAAG,IAAR;AACA,QAAIC,CAAC,GAAGlI,GAAR;AAEA,QAAIiI,CAAC,KAAKC,CAAV,EACE,OAAOD,CAAP;AAEF,QAAI,CAACA,CAAC,CAAC5H,QAAF,GAAa6H,CAAC,CAAC7H,QAAhB,MAA8B,CAAlC,EACE,OAAO4H,CAAC,CAACE,KAAF,CAAQD,CAAR,CAAP;;AAEF,QAAI,CAACD,CAAC,CAAC5H,QAAF,GAAa6H,CAAC,CAAC7H,QAAhB,MAA8B,CAAlC,EAAqC;AACnC;AACA;AACA;AACA4H,MAAAA,CAAC,CAACzG,KAAF,CAAQ,CAAR;AACA0G,MAAAA,CAAC,CAAC1G,KAAF,CAAQ,CAAR;AACAyG,MAAAA,CAAC,CAACG,IAAF,CAAOF,CAAP;AACAD,MAAAA,CAAC,CAAC/F,KAAF,CAAQ,CAAR;AACAgG,MAAAA,CAAC,CAAChG,KAAF,CAAQ,CAAR;AACA,aAAO+F,CAAP;AACD,KAtBO,CAwBR;;;AACA,QAAIA,CAAC,CAAC5H,QAAF,KAAe,CAAnB,EACE,CAAC4H,CAAD,EAAIC,CAAJ,IAAS,CAACA,CAAC,CAACtG,KAAF,EAAD,EAAYqG,CAAZ,CAAT,CA1BM,CA4BR;AACA;;AACA,UAAMI,KAAK,GAAGJ,CAAC,CAACZ,SAAF,EAAd;AAEAa,IAAAA,CAAC,CAAC1G,KAAF,CAAQ,CAAR;AACA0G,IAAAA,CAAC,CAACI,KAAF,CAAQD,KAAR;AACAJ,IAAAA,CAAC,CAACE,KAAF,CAAQD,CAAR;AACAA,IAAAA,CAAC,CAACI,KAAF,CAAQD,KAAR;AACAH,IAAAA,CAAC,CAAChG,KAAF,CAAQ,CAAR;AAEA,WAAO+F,CAAC,CAACnF,KAAF,CAAQ,IAAR,CAAP;AACD;;AAEDyF,EAAAA,KAAK,CAACvI,GAAD,EAAM;AACTmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AAEA,QAAI,CAAC,KAAKK,QAAL,GAAiBL,GAAG,GAAG,CAAxB,MAAgC,CAApC,EACE,OAAO,KAAKgI,IAAL,CAAU,IAAIlI,EAAJ,CAAOE,GAAP,CAAV,CAAP;AAEF,SAAKG,KAAL,CAAW,CAAX,KAAiBH,GAAjB;AACA,SAAKI,MAAL,GAAc,CAAd;AAEA,WAAO,IAAP;AACD;;AAEDoI,EAAAA,GAAG,CAACxI,GAAD,EAAM;AACP,WAAO,KAAK4B,KAAL,GAAaoG,IAAb,CAAkBhI,GAAlB,CAAP;AACD;;AAEDyI,EAAAA,IAAI,CAACzI,GAAD,EAAM;AACR,WAAO,KAAK4B,KAAL,GAAa2G,KAAb,CAAmBvI,GAAnB,CAAP;AACD;;AAED0I,EAAAA,KAAK,CAAC1I,GAAD,EAAM;AACTmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;;AAEA,QAAI,CAAC,KAAKK,QAAL,GAAiBL,GAAG,GAAG,CAAxB,MAAgC,CAApC,EAAuC;AACrC,YAAM2I,CAAC,GAAG,KAAKX,IAAL,CAAU,IAAIlI,EAAJ,CAAOE,GAAP,CAAV,CAAV;AAEA,UAAI2I,CAAC,CAACvI,MAAF,GAAW,CAAf,EACE,MAAM,IAAI6G,UAAJ,CAAe,yBAAf,CAAN;AAEF,aAAO0B,CAAC,CAACtI,QAAF,KAAe,CAAf,GAAmB,CAACsI,CAAC,CAACxI,KAAF,CAAQ,CAAR,CAApB,GAAiCwI,CAAC,CAACxI,KAAF,CAAQ,CAAR,CAAxC;AACD;;AAED,WAAO,KAAKA,KAAL,CAAW,CAAX,IAAgBH,GAAvB;AACD;AAED;;;;;AAIAmI,EAAAA,KAAK,CAACnI,GAAD,EAAM;AACTmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,SAAKI,MAAL,GAAcY,IAAI,CAACgE,GAAL,CAAS,KAAK5E,MAAd,EAAsBJ,GAAG,CAACI,MAA1B,CAAd;;AAEA,SAAK,IAAIQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKR,MAAzB,EAAiCQ,CAAC,EAAlC,EACE,KAAKT,KAAL,CAAWS,CAAX,KAAiBZ,GAAG,CAACG,KAAJ,CAAUS,CAAV,CAAjB;;AAEF,WAAO,KAAKmB,MAAL,EAAP;AACD;;AAED6G,EAAAA,MAAM,CAAC5I,GAAD,EAAM;AACVmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AAEA,SAAKG,KAAL,CAAW,CAAX,KAAiBa,IAAI,CAAC6H,GAAL,CAAS7I,GAAT,CAAjB;AACA,SAAKI,MAAL,GAAc,CAAd;AAEA,WAAO,KAAK4B,UAAL,EAAP;AACD;;AAED8G,EAAAA,IAAI,CAAC9I,GAAD,EAAM;AACR,WAAO,KAAK4B,KAAL,GAAauG,KAAb,CAAmBnI,GAAnB,CAAP;AACD;;AAED+I,EAAAA,KAAK,CAAC/I,GAAD,EAAM;AACT,WAAO,KAAK4B,KAAL,GAAagH,MAAb,CAAoB5I,GAApB,CAAP;AACD;;AAEDgJ,EAAAA,MAAM,CAAChJ,GAAD,EAAM;AACVmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AAEA,UAAM2I,CAAC,GAAG,KAAKxI,KAAL,CAAW,CAAX,IAAgBa,IAAI,CAAC6H,GAAL,CAAS7I,GAAT,CAA1B;AAEA,WAAO,KAAKK,QAAL,KAAkB,CAAlB,GAAuB,CAACsI,CAAD,GAAK,CAA5B,GAAiCA,CAAxC;AACD;AAED;;;;;AAIAM,EAAAA,GAAG,CAACjJ,GAAD,EAAM;AACPmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,QAAIiI,CAAC,GAAG,IAAR;AACA,QAAIC,CAAC,GAAGlI,GAAR;AAEA,QAAIiI,CAAC,KAAKC,CAAV,EACE,OAAOD,CAAP;AAEF,QAAI,CAACA,CAAC,CAAC5H,QAAF,GAAa6H,CAAC,CAAC7H,QAAhB,MAA8B,CAAlC,EACE,OAAO4H,CAAC,CAACG,IAAF,CAAOF,CAAP,CAAP;;AAEF,QAAI,CAACD,CAAC,CAAC5H,QAAF,GAAa6H,CAAC,CAAC7H,QAAhB,MAA8B,CAAlC,EAAqC;AACnC;AACA;AACA;AACA4H,MAAAA,CAAC,CAACzG,KAAF,CAAQ,CAAR;AACA0G,MAAAA,CAAC,CAAC1G,KAAF,CAAQ,CAAR;AACAyG,MAAAA,CAAC,CAACE,KAAF,CAAQD,CAAR;AACAD,MAAAA,CAAC,CAAC/F,KAAF,CAAQ,CAAR;AACAgG,MAAAA,CAAC,CAAChG,KAAF,CAAQ,CAAR;AACA,aAAO+F,CAAP;AACD,KAtBM,CAwBP;;;AACAC,IAAAA,CAAC,GAAGA,CAAC,CAACtG,KAAF,EAAJ;AAEA,QAAIqG,CAAC,CAAC5H,QAAF,KAAe,CAAnB,EACE,CAAC4H,CAAD,EAAIC,CAAJ,IAAS,CAACA,CAAD,EAAID,CAAJ,CAAT,CA5BK,CA8BP;AACA;AACA;;AACAC,IAAAA,CAAC,CAAC1G,KAAF,CAAQ,CAAR;AACAyG,IAAAA,CAAC,CAACK,KAAF,CAAQJ,CAAC,CAACb,SAAF,EAAR;AACAa,IAAAA,CAAC,CAACC,KAAF,CAAQF,CAAR;AACAC,IAAAA,CAAC,CAAChG,KAAF,CAAQ,CAAR;AAEA,WAAOgG,CAAC,CAACpF,KAAF,CAAQ,IAAR,CAAP;AACD;;AAEDoG,EAAAA,IAAI,CAAClJ,GAAD,EAAM;AACRmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AAEA,QAAI,CAAC,KAAKK,QAAL,GAAiBL,GAAG,GAAG,CAAxB,MAAgC,CAApC,EACE,OAAO,KAAKiJ,GAAL,CAAS,IAAInJ,EAAJ,CAAOE,GAAP,CAAT,CAAP;AAEF,SAAKG,KAAL,CAAW,CAAX,KAAiBH,GAAjB;AAEA,WAAO,IAAP;AACD;;AAEDmJ,EAAAA,EAAE,CAACnJ,GAAD,EAAM;AACN,WAAO,KAAK4B,KAAL,GAAaqH,GAAb,CAAiBjJ,GAAjB,CAAP;AACD;;AAEDoJ,EAAAA,GAAG,CAACpJ,GAAD,EAAM;AACP,WAAO,KAAK4B,KAAL,GAAasH,IAAb,CAAkBlJ,GAAlB,CAAP;AACD;AAED;;;;;AAIAoI,EAAAA,IAAI,CAACpI,GAAD,EAAM;AACRmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;;AAEA,SAAKkF,OAAL,CAAalF,GAAG,CAACI,MAAjB;;AAEA,SAAK,IAAIQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGZ,GAAG,CAACI,MAAxB,EAAgCQ,CAAC,EAAjC,EACE,KAAKT,KAAL,CAAWS,CAAX,KAAiBZ,GAAG,CAACG,KAAJ,CAAUS,CAAV,CAAjB,CANM,CAQR;;;AACA,WAAO,IAAP;AACD;;AAEDyI,EAAAA,KAAK,CAACrJ,GAAD,EAAM;AACTmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AAEA,SAAKG,KAAL,CAAW,CAAX,KAAiBa,IAAI,CAAC6H,GAAL,CAAS7I,GAAT,CAAjB;AAEA,WAAO,IAAP;AACD;;AAEDsJ,EAAAA,GAAG,CAACtJ,GAAD,EAAM;AACP,WAAO,KAAK4B,KAAL,GAAawG,IAAb,CAAkBpI,GAAlB,CAAP;AACD;;AAEDuJ,EAAAA,IAAI,CAACvJ,GAAD,EAAM;AACR,WAAO,KAAK4B,KAAL,GAAayH,KAAb,CAAmBrJ,GAAnB,CAAP;AACD;AAED;;;;;AAIAwJ,EAAAA,IAAI,CAACxJ,GAAD,EAAM;AACRmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,QAAIiI,CAAC,GAAG,IAAR;AACA,QAAIC,CAAC,GAAGlI,GAAR;;AAEA,QAAIiI,CAAC,KAAKC,CAAV,EAAa;AACXD,MAAAA,CAAC,CAAC9H,KAAF,CAAQ,CAAR,IAAa,CAAb;AACA8H,MAAAA,CAAC,CAAC7H,MAAF,GAAW,CAAX;AACA6H,MAAAA,CAAC,CAAC5H,QAAF,GAAa,CAAb;AACA,aAAO4H,CAAP;AACD;;AAED,QAAI,CAACA,CAAC,CAAC5H,QAAF,GAAa6H,CAAC,CAAC7H,QAAhB,MAA8B,CAAlC,EACE,OAAO4H,CAAC,CAACwB,KAAF,CAAQvB,CAAR,CAAP;;AAEF,QAAI,CAACD,CAAC,CAAC5H,QAAF,GAAa6H,CAAC,CAAC7H,QAAhB,MAA8B,CAAlC,EAAqC;AACnC;AACA;AACA4H,MAAAA,CAAC,CAACzG,KAAF,CAAQ,CAAR;AACA0G,MAAAA,CAAC,CAAC1G,KAAF,CAAQ,CAAR;AACAyG,MAAAA,CAAC,CAACwB,KAAF,CAAQvB,CAAR;AACAD,MAAAA,CAAC,CAAChD,IAAF;AACAiD,MAAAA,CAAC,CAAChG,KAAF,CAAQ,CAAR;AACA,aAAO+F,CAAP;AACD,KAzBO,CA2BR;;;AACA,QAAIA,CAAC,CAAC5H,QAAF,KAAe,CAAnB,EACE,CAAC4H,CAAD,EAAIC,CAAJ,IAAS,CAACA,CAAC,CAACtG,KAAF,EAAD,EAAYqG,CAAZ,CAAT,CA7BM,CA+BR;AACA;AACA;;AACAC,IAAAA,CAAC,CAAC1G,KAAF,CAAQ,CAAR;AACAyG,IAAAA,CAAC,CAACwB,KAAF,CAAQvB,CAAR;AACAD,IAAAA,CAAC,CAACzG,KAAF,CAAQ,CAAR;AACAyG,IAAAA,CAAC,CAAChD,IAAF;AACAiD,IAAAA,CAAC,CAAChG,KAAF,CAAQ,CAAR;AAEA,WAAO+F,CAAC,CAACnF,KAAF,CAAQ,IAAR,CAAP;AACD;;AAED4G,EAAAA,KAAK,CAAC1J,GAAD,EAAM;AACTmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AAEA,QAAI,CAAC,KAAKK,QAAL,GAAiBL,GAAG,GAAG,CAAxB,MAAgC,CAApC,EACE,OAAO,KAAKwJ,IAAL,CAAU,IAAI1J,EAAJ,CAAOE,GAAP,CAAV,CAAP;AAEF,SAAKG,KAAL,CAAW,CAAX,KAAiBH,GAAjB;AAEA,WAAO,IAAP;AACD;;AAED2J,EAAAA,GAAG,CAAC3J,GAAD,EAAM;AACP,WAAO,KAAK4B,KAAL,GAAa4H,IAAb,CAAkBxJ,GAAlB,CAAP;AACD;;AAED4J,EAAAA,IAAI,CAAC5J,GAAD,EAAM;AACR,WAAO,KAAK4B,KAAL,GAAa8H,KAAb,CAAmB1J,GAAnB,CAAP;AACD;AAED;;;;;AAIAyJ,EAAAA,KAAK,CAACzJ,GAAD,EAAM;AACTmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,QAAIS,CAAC,GAAG,IAAR;AACA,QAAIC,CAAC,GAAGV,GAAR;AAEA,QAAIS,CAAC,CAACL,MAAF,GAAWM,CAAC,CAACN,MAAjB,EACE,CAACK,CAAD,EAAIC,CAAJ,IAAS,CAACA,CAAD,EAAID,CAAJ,CAAT;AAEF,QAAIG,CAAC,GAAG,CAAR;;AAEA,WAAOA,CAAC,GAAGF,CAAC,CAACN,MAAb,EAAqBQ,CAAC,EAAtB,EACE,KAAKT,KAAL,CAAWS,CAAX,IAAgBH,CAAC,CAACN,KAAF,CAAQS,CAAR,IAAaF,CAAC,CAACP,KAAF,CAAQS,CAAR,CAA7B;;AAEF,QAAIH,CAAC,KAAK,IAAV,EAAgB;AACd,WAAKI,MAAL,CAAYJ,CAAC,CAACL,MAAd;;AAEA,aAAOQ,CAAC,GAAGH,CAAC,CAACL,MAAb,EAAqBQ,CAAC,EAAtB,EACE,KAAKT,KAAL,CAAWS,CAAX,IAAgBH,CAAC,CAACN,KAAF,CAAQS,CAAR,CAAhB;AACH;;AAED,SAAKR,MAAL,GAAcK,CAAC,CAACL,MAAhB;AAEA,WAAO,KAAK2B,MAAL,EAAP;AACD;;AAED8H,EAAAA,MAAM,CAAC7J,GAAD,EAAM;AACVmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AAEA,SAAKG,KAAL,CAAW,CAAX,KAAiBa,IAAI,CAAC6H,GAAL,CAAS7I,GAAT,CAAjB;AAEA,WAAO,KAAKgC,UAAL,EAAP;AACD;;AAED8H,EAAAA,IAAI,CAAC9J,GAAD,EAAM;AACR,WAAO,KAAK4B,KAAL,GAAa6H,KAAb,CAAmBzJ,GAAnB,CAAP;AACD;;AAED+J,EAAAA,KAAK,CAAC/J,GAAD,EAAM;AACT,WAAO,KAAK4B,KAAL,GAAaiI,MAAb,CAAoB7J,GAApB,CAAP;AACD;AAED;;;;;AAIAgK,EAAAA,IAAI,GAAG;AACL,QAAI,KAAK3J,QAAL,KAAkB,CAAtB,EAAyB;AACvB;AACA,WAAK4E,IAAL,GAAY/C,KAAZ,CAAkB,CAAlB;AACD,KAHD,MAGO;AACL;AACA,WAAKV,KAAL,CAAW,CAAX,EAAcyD,IAAd;AACD;;AACD,WAAO,IAAP;AACD;;AAEDgF,EAAAA,GAAG,GAAG;AACJ,WAAO,KAAKrI,KAAL,GAAaoI,IAAb,EAAP;AACD;;AAED1B,EAAAA,KAAK,CAACD,KAAD,EAAQ;AACXlH,IAAAA,OAAO,CAAEkH,KAAK,KAAK,CAAX,KAAkBA,KAAnB,EAA0B,OAA1B,EAAmC,QAAnC,CAAP;AAEA,UAAMvH,CAAC,GAAGuH,KAAK,GAAG,EAAlB;AAEA,QAAI6B,CAAC,GAAGlJ,IAAI,CAACmJ,IAAL,CAAU9B,KAAK,GAAG,EAAlB,CAAR;AACA,QAAIzH,CAAC,GAAG,CAAR,CANW,CAQX;;AACA,SAAKsE,OAAL,CAAagF,CAAb;;AAEA,QAAIpJ,CAAC,GAAG,CAAR,EACEoJ,CAAC,IAAI,CAAL,CAZS,CAcX;;AACA,WAAOtJ,CAAC,GAAGsJ,CAAX,EAActJ,CAAC,EAAf,EACE,KAAKT,KAAL,CAAWS,CAAX,KAAiB,SAAjB,CAhBS,CAkBX;;;AACA,QAAIE,CAAC,GAAG,CAAR,EACE,KAAKX,KAAL,CAAWS,CAAX,KAAiB,CAAC,KAAKE,CAAN,IAAW,CAA5B,CApBS,CAsBX;;AACA,WAAO,KAAKiB,MAAL,EAAP;AACD;;AAEDqI,EAAAA,IAAI,CAAC/B,KAAD,EAAQ;AACV,WAAO,KAAKzG,KAAL,GAAa0G,KAAb,CAAmBD,KAAnB,CAAP;AACD;AAED;;;;;AAIAgC,EAAAA,IAAI,CAACrK,GAAD,EAAM;AACRmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,MAAf,EAAuB,QAAvB,CAAP;AACAmB,IAAAA,OAAO,CAACnB,GAAG,CAACqH,SAAJ,MAAmB,EAApB,EAAwB,MAAxB,EAAgC,QAAhC,CAAP;AACA,WAAO,KAAKiD,KAAL,CAAWtK,GAAG,CAACuK,QAAJ,EAAX,CAAP;AACD;;AAEDD,EAAAA,KAAK,CAAChH,IAAD,EAAO;AACV,WAAO,KAAKiB,MAAL,CAAYjB,IAAZ,CAAP;AACD;;AAEDkH,EAAAA,GAAG,CAACxK,GAAD,EAAM;AACP,WAAO,KAAK4B,KAAL,GAAayI,IAAb,CAAkBrK,GAAlB,CAAP;AACD;;AAEDyK,EAAAA,IAAI,CAACnH,IAAD,EAAO;AACT,WAAO,KAAK1B,KAAL,GAAa0I,KAAb,CAAmBhH,IAAnB,CAAP;AACD;AAED;;;;;AAIAoH,EAAAA,KAAK,CAAC1K,GAAD,EAAM;AACTmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,MAAf,EAAuB,QAAvB,CAAP;AACAmB,IAAAA,OAAO,CAACnB,GAAG,CAACqH,SAAJ,MAAmB,EAApB,EAAwB,MAAxB,EAAgC,QAAhC,CAAP;AACA,WAAO,KAAK9C,MAAL,CAAYvE,GAAG,CAACuK,QAAJ,EAAZ,CAAP;AACD;;AAEDhG,EAAAA,MAAM,CAACjB,IAAD,EAAO;AACXnC,IAAAA,OAAO,CAAEmC,IAAI,KAAK,CAAV,KAAiBA,IAAlB,EAAwB,MAAxB,EAAgC,QAAhC,CAAP;AAEA,UAAMxC,CAAC,GAAGwC,IAAI,GAAG,EAAjB;AACA,UAAM4G,CAAC,GAAG,CAAC5G,IAAI,GAAGxC,CAAR,IAAa,EAAvB;AACA,UAAM6J,IAAI,GAAI,CAAC,KAAK7J,CAAN,IAAW,CAAZ,IAAmB,KAAKA,CAArC;;AAEA,QAAIA,CAAC,KAAK,CAAV,EAAa;AACX,UAAIH,KAAK,GAAG,CAAZ;;AAEA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKR,MAAzB,EAAiCQ,CAAC,EAAlC,EAAsC;AACpC,cAAMgK,MAAM,GAAG,KAAKzK,KAAL,CAAWS,CAAX,IAAgB+J,IAA/B;AACA,cAAME,CAAC,GAAI,CAAC,KAAK1K,KAAL,CAAWS,CAAX,IAAgB,CAAjB,IAAsBgK,MAAvB,IAAkC9J,CAA5C;AAEA,aAAKX,KAAL,CAAWS,CAAX,IAAgBiK,CAAC,GAAGlK,KAApB;AAEAA,QAAAA,KAAK,GAAGiK,MAAM,KAAM,KAAK9J,CAAzB;AACD;;AAED,UAAIH,KAAK,KAAK,CAAd,EAAiB;AACf,aAAKE,MAAL,CAAY,KAAKT,MAAL,GAAc,CAA1B;;AACA,aAAKD,KAAL,CAAW,KAAKC,MAAL,EAAX,IAA4BO,KAA5B;AACD;AACF;;AAED,QAAIuJ,CAAC,KAAK,CAAV,EAAa;AACX,WAAKrJ,MAAL,CAAY,KAAKT,MAAL,GAAc8J,CAA1B;;AAEA,WAAK,IAAItJ,CAAC,GAAG,KAAKR,MAAL,GAAc,CAA3B,EAA8BQ,CAAC,IAAI,CAAnC,EAAsCA,CAAC,EAAvC,EACE,KAAKT,KAAL,CAAWS,CAAC,GAAGsJ,CAAf,IAAoB,KAAK/J,KAAL,CAAWS,CAAX,CAApB;;AAEF,WAAK,IAAIA,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsJ,CAApB,EAAuBtJ,CAAC,EAAxB,EACE,KAAKT,KAAL,CAAWS,CAAX,IAAgB,CAAhB;;AAEF,WAAKR,MAAL,IAAe8J,CAAf;AACD;;AAED,WAAO,KAAKnI,MAAL,EAAP;AACD;;AAED+I,EAAAA,IAAI,CAAC9K,GAAD,EAAM;AACR,WAAO,KAAK4B,KAAL,GAAa8I,KAAb,CAAmB1K,GAAnB,CAAP;AACD;;AAED+K,EAAAA,KAAK,CAACzH,IAAD,EAAO;AACV,WAAO,KAAK1B,KAAL,GAAa2C,MAAb,CAAoBjB,IAApB,CAAP;AACD;AAED;;;;;AAIA0H,EAAAA,MAAM,CAAC1H,IAAD,EAAO2H,MAAP,EAAe;AACnB,UAAMnK,CAAC,GAAGwC,IAAI,GAAG,EAAjB;AACA,UAAM4G,CAAC,GAAGlJ,IAAI,CAACgE,GAAL,CAAS,CAAC1B,IAAI,GAAGxC,CAAR,IAAa,EAAtB,EAA0B,KAAKV,MAA/B,CAAV;AACA,UAAMuK,IAAI,GAAG,CAAC,KAAK7J,CAAN,IAAW,CAAxB,CAHmB,CAKnB;;AACA,QAAImK,MAAJ,EAAY;AACVA,MAAAA,MAAM,CAACpK,MAAP,CAAcqJ,CAAd;;AAEA,WAAK,IAAItJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsJ,CAApB,EAAuBtJ,CAAC,EAAxB,EACEqK,MAAM,CAAC9K,KAAP,CAAaS,CAAb,IAAkB,KAAKT,KAAL,CAAWS,CAAX,CAAlB;;AAEFqK,MAAAA,MAAM,CAAC7K,MAAP,GAAgB8J,CAAhB;AACD;;AAED,QAAIA,CAAC,KAAK,CAAV,EAAa,CACX;AACD,KAFD,MAEO,IAAI,KAAK9J,MAAL,GAAc8J,CAAlB,EAAqB;AAC1B,WAAK9J,MAAL,IAAe8J,CAAf;;AACA,WAAK,IAAItJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKR,MAAzB,EAAiCQ,CAAC,EAAlC,EACE,KAAKT,KAAL,CAAWS,CAAX,IAAgB,KAAKT,KAAL,CAAWS,CAAC,GAAGsJ,CAAf,CAAhB;AACH,KAJM,MAIA;AACL,WAAK/J,KAAL,CAAW,CAAX,IAAgB,CAAhB;AACA,WAAKC,MAAL,GAAc,CAAd;AACD;;AAED,QAAIO,KAAK,GAAG,CAAZ;;AAEA,QAAIG,CAAC,KAAK,CAAV,EAAa;AACX,WAAK,IAAIF,CAAC,GAAG,KAAKR,MAAL,GAAc,CAA3B,EAA8BQ,CAAC,IAAI,CAAnC,EAAsCA,CAAC,EAAvC,EAA2C;AACzC,cAAMwD,IAAI,GAAG,KAAKjE,KAAL,CAAWS,CAAX,IAAgB,CAA7B;AAEA,aAAKT,KAAL,CAAWS,CAAX,IAAiBD,KAAK,IAAK,KAAKG,CAAhB,GAAuBsD,IAAI,KAAKtD,CAAhD;AAEAH,QAAAA,KAAK,GAAGyD,IAAI,GAAGuG,IAAf;AACD;AACF,KApCkB,CAsCnB;;;AACA,QAAIM,MAAJ,EAAY;AACV,UAAItK,KAAK,KAAK,CAAd,EAAiB;AACfsK,QAAAA,MAAM,CAACpK,MAAP,CAAcoK,MAAM,CAAC7K,MAAP,GAAgB,CAA9B;;AACA6K,QAAAA,MAAM,CAAC9K,KAAP,CAAa8K,MAAM,CAAC7K,MAAP,EAAb,IAAgCO,KAAhC;AACD,OAHD,MAGO;AACL,YAAIsK,MAAM,CAAC7K,MAAP,KAAkB,CAAtB,EACE6K,MAAM,CAAC9K,KAAP,CAAa8K,MAAM,CAAC7K,MAAP,EAAb,IAAgC,CAAhC;;AAEF6K,QAAAA,MAAM,CAAClJ,MAAP;AACD;AACF;;AAED,WAAO,KAAKA,MAAL,EAAP;AACD;AAED;;;;;AAIAmJ,EAAAA,IAAI,CAAClL,GAAD,EAAM;AACRmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,MAAf,EAAuB,QAAvB,CAAP;AACAmB,IAAAA,OAAO,CAACnB,GAAG,CAACqH,SAAJ,MAAmB,EAApB,EAAwB,MAAxB,EAAgC,QAAhC,CAAP;AACA,WAAO,KAAK8D,KAAL,CAAWnL,GAAG,CAACuK,QAAJ,EAAX,CAAP;AACD;;AAEDY,EAAAA,KAAK,CAAC7H,IAAD,EAAO;AACVnC,IAAAA,OAAO,CAAEmC,IAAI,KAAK,CAAV,KAAiBA,IAAlB,EAAwB,MAAxB,EAAgC,QAAhC,CAAP;;AAEA,QAAI,KAAKjD,QAAL,KAAkB,CAAtB,EAAyB;AACvB;AACA;AACA;AACA,WAAKmB,KAAL,CAAW,CAAX;AACA,WAAKgC,MAAL,CAAYF,IAAZ;AACA,WAAKpB,KAAL,CAAW,CAAX;AACA,aAAO,IAAP;AACD;;AAED,WAAO,KAAKsB,MAAL,CAAYF,IAAZ,CAAP;AACD;;AAED8H,EAAAA,GAAG,CAACpL,GAAD,EAAM;AACP,WAAO,KAAK4B,KAAL,GAAasJ,IAAb,CAAkBlL,GAAlB,CAAP;AACD;;AAEDqL,EAAAA,IAAI,CAAC/H,IAAD,EAAO;AACT,WAAO,KAAK1B,KAAL,GAAauJ,KAAb,CAAmB7H,IAAnB,CAAP;AACD;AAED;;;;;AAIAgI,EAAAA,KAAK,CAACtL,GAAD,EAAM;AACTmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,MAAf,EAAuB,QAAvB,CAAP;AACAmB,IAAAA,OAAO,CAACnB,GAAG,CAACqH,SAAJ,MAAmB,EAApB,EAAwB,MAAxB,EAAgC,QAAhC,CAAP;AACA,WAAO,KAAK7D,MAAL,CAAYxD,GAAG,CAACuK,QAAJ,EAAZ,CAAP;AACD;;AAED/G,EAAAA,MAAM,CAACF,IAAD,EAAO;AACXnC,IAAAA,OAAO,CAAEmC,IAAI,KAAK,CAAV,KAAiBA,IAAlB,EAAwB,MAAxB,EAAgC,QAAhC,CAAP;AACA,WAAO,KAAK0H,MAAL,CAAY1H,IAAZ,EAAkB,IAAlB,CAAP;AACD;;AAEDiI,EAAAA,IAAI,CAACvL,GAAD,EAAM;AACR,WAAO,KAAK4B,KAAL,GAAa0J,KAAb,CAAmBtL,GAAnB,CAAP;AACD;;AAEDwL,EAAAA,KAAK,CAAClI,IAAD,EAAO;AACV,WAAO,KAAK1B,KAAL,GAAa4B,MAAb,CAAoBF,IAApB,CAAP;AACD;AAED;;;;;AAIAmI,EAAAA,IAAI,CAACjF,GAAD,EAAMkF,GAAN,EAAW;AACbvK,IAAAA,OAAO,CAAEqF,GAAG,KAAK,CAAT,KAAgBA,GAAjB,EAAsB,KAAtB,EAA6B,QAA7B,CAAP;;AAEA,QAAI,KAAKnG,QAAL,KAAkB,CAAtB,EAAyB;AACvB,WAAKmB,KAAL,CAAW,CAAX;AACA,WAAKmK,KAAL,CAAWnF,GAAX,EAAgB,CAACkF,GAAjB;AACA,WAAKxJ,KAAL,CAAW,CAAX;AACA,aAAO,IAAP;AACD;;AAED,WAAO,KAAKyJ,KAAL,CAAWnF,GAAX,EAAgBkF,GAAhB,CAAP;AACD;;AAEDC,EAAAA,KAAK,CAACnF,GAAD,EAAMkF,GAAN,EAAW;AACdvK,IAAAA,OAAO,CAAEqF,GAAG,KAAK,CAAT,KAAgBA,GAAjB,EAAsB,KAAtB,EAA6B,QAA7B,CAAP;AAEA,UAAM1F,CAAC,GAAG0F,GAAG,GAAG,EAAhB;AACA,UAAM0D,CAAC,GAAG,CAAC1D,GAAG,GAAG1F,CAAP,IAAY,EAAtB;;AAEA,SAAKoE,OAAL,CAAagF,CAAC,GAAG,CAAjB;;AAEA,QAAIwB,GAAJ,EACE,KAAKvL,KAAL,CAAW+J,CAAX,KAAkB,KAAKpJ,CAAvB,CADF,KAGE,KAAKX,KAAL,CAAW+J,CAAX,KAAiB,EAAE,KAAKpJ,CAAP,CAAjB;AAEF,WAAO,KAAKiB,MAAL,EAAP;AACD;;AAED6J,EAAAA,KAAK,CAACpF,GAAD,EAAM;AACTrF,IAAAA,OAAO,CAAEqF,GAAG,KAAK,CAAT,KAAgBA,GAAjB,EAAsB,KAAtB,EAA6B,QAA7B,CAAP;AAEA,UAAM1F,CAAC,GAAG0F,GAAG,GAAG,EAAhB;AACA,UAAM0D,CAAC,GAAG,CAAC1D,GAAG,GAAG1F,CAAP,IAAY,EAAtB,CAJS,CAMT;;AACA,QAAI,KAAKV,MAAL,IAAe8J,CAAnB,EACE,OAAO,KAAK7J,QAAZ,CARO,CAUT;;AACA,UAAM4C,CAAC,GAAG,KAAK9C,KAAL,CAAW+J,CAAX,CAAV;AACA,UAAMwB,GAAG,GAAIzI,CAAC,IAAInC,CAAN,GAAW,CAAvB;;AAEA,QAAI,KAAKT,QAAL,KAAkB,CAAtB,EAAyB;AACvB,UAAIS,CAAC,GAAG,CAAJ,IAAUmC,CAAC,GAAI,CAAC,KAAKnC,CAAN,IAAW,CAA9B,EACE,OAAO4K,GAAG,GAAG,CAAb;AAEF,UAAI/G,CAAC,GAAGuF,CAAR;;AAEA,aAAOvF,CAAC,EAAR,EAAY;AACV,YAAI,KAAKxE,KAAL,CAAWwE,CAAX,IAAgB,CAApB,EACE,OAAO+G,GAAG,GAAG,CAAb;AACH;AACF;;AAED,WAAOA,GAAP;AACD;;AAEDnI,EAAAA,MAAM,CAACiD,GAAD,EAAM;AACVrF,IAAAA,OAAO,CAAEqF,GAAG,KAAK,CAAT,KAAgBA,GAAjB,EAAsB,KAAtB,EAA6B,QAA7B,CAAP;AAEA,UAAM1F,CAAC,GAAG0F,GAAG,GAAG,EAAhB;AACA,UAAM0D,CAAC,GAAG,CAAC1D,GAAG,GAAG1F,CAAP,IAAY,EAAtB,CAJU,CAMV;;AACA,QAAI,KAAKV,MAAL,IAAe8J,CAAnB,EACE,OAAO,CAAP,CARQ,CAUV;;AACA,WAAQ,KAAK/J,KAAL,CAAW+J,CAAX,KAAiBpJ,CAAlB,GAAuB,CAA9B;AACD;;AAED+K,EAAAA,MAAM,CAACvI,IAAD,EAAO;AACXnC,IAAAA,OAAO,CAAEmC,IAAI,KAAK,CAAV,KAAiBA,IAAlB,EAAwB,MAAxB,EAAgC,QAAhC,CAAP;;AAEA,QAAI,KAAKjD,QAAL,KAAkB,CAAtB,EAAyB;AACvB,WAAKmB,KAAL,CAAW,CAAX;AACA,WAAK8G,KAAL,CAAWhF,IAAI,GAAG,CAAlB;AACA,WAAK2B,IAAL;AACD;;AAED,WAAO,KAAK6G,OAAL,CAAaxI,IAAb,CAAP;AACD;;AAEDyI,EAAAA,KAAK,CAACzI,IAAD,EAAO;AACV,WAAO,KAAK1B,KAAL,GAAaiK,MAAb,CAAoBvI,IAApB,CAAP;AACD;;AAEDwI,EAAAA,OAAO,CAACxI,IAAD,EAAO;AACZnC,IAAAA,OAAO,CAAEmC,IAAI,KAAK,CAAV,KAAiBA,IAAlB,EAAwB,MAAxB,EAAgC,QAAhC,CAAP;AAEA,UAAMxC,CAAC,GAAGwC,IAAI,GAAG,EAAjB;AAEA,QAAI4G,CAAC,GAAG,CAAC5G,IAAI,GAAGxC,CAAR,IAAa,EAArB;AAEA,QAAI,KAAKV,MAAL,IAAe8J,CAAnB,EACE,OAAO,IAAP;AAEF,QAAIpJ,CAAC,KAAK,CAAV,EACEoJ,CAAC,IAAI,CAAL;AAEF,SAAK9J,MAAL,GAAcY,IAAI,CAACgE,GAAL,CAASkF,CAAT,EAAY,KAAK9J,MAAjB,CAAd;AAEA,QAAIU,CAAC,KAAK,CAAV,EACE,KAAKX,KAAL,CAAW,KAAKC,MAAL,GAAc,CAAzB,KAA+B,CAAC,KAAKU,CAAN,IAAW,CAA1C;AAEF,QAAI,KAAKV,MAAL,KAAgB,CAApB,EACE,KAAKD,KAAL,CAAW,KAAKC,MAAL,EAAX,IAA4B,CAA5B;AAEF,WAAO,KAAK2B,MAAL,EAAP;AACD;;AAEDiK,EAAAA,MAAM,CAAC1I,IAAD,EAAO;AACX,WAAO,KAAK1B,KAAL,GAAakK,OAAb,CAAqBxI,IAArB,CAAP;AACD;;AAED2I,EAAAA,KAAK,CAACjM,GAAD,EAAM;AACT,WAAO,KAAKG,KAAL,CAAW,CAAX,IAAgBH,GAAvB;AACD;;AAEDwG,EAAAA,GAAG,CAAC0F,GAAD,EAAM;AACP,WAAO,KAAK3I,MAAL,CAAY2I,GAAZ,CAAP;AACD;;AAED5I,EAAAA,IAAI,CAAC4I,GAAD,EAAM7D,KAAN,EAAa;AACflH,IAAAA,OAAO,CAAE+K,GAAG,KAAK,CAAT,KAAgBA,GAAjB,EAAsB,KAAtB,EAA6B,QAA7B,CAAP;AACA/K,IAAAA,OAAO,CAAEkH,KAAK,KAAK,CAAX,KAAkBA,KAAnB,EAA0B,OAA1B,EAAmC,QAAnC,CAAP;AACAlH,IAAAA,OAAO,CAACkH,KAAK,IAAI,EAAV,EAAc,OAAd,EAAuB,OAAvB,CAAP;AAEA,UAAMhE,KAAK,GAAG6H,GAAG,GAAG,EAApB;AACA,UAAMC,KAAK,GAAG,CAACD,GAAG,GAAG7H,KAAP,IAAgB,EAA9B;AAEA,QAAI8H,KAAK,IAAI,KAAK/L,MAAlB,EACE,OAAO,CAAP;AAEF,QAAIkD,IAAI,GAAI,KAAKnD,KAAL,CAAWgM,KAAX,KAAqB9H,KAAtB,GAAgC,CAAC,KAAKgE,KAAN,IAAe,CAA1D;;AAEA,QAAIhE,KAAK,GAAGgE,KAAR,GAAgB,EAAhB,IAAsB8D,KAAK,GAAG,CAAR,GAAY,KAAK/L,MAA3C,EAAmD;AACjD,YAAMgM,IAAI,GAAG/H,KAAK,GAAGgE,KAAR,GAAgB,EAA7B;AACA,YAAMgE,IAAI,GAAG,KAAKlM,KAAL,CAAWgM,KAAK,GAAG,CAAnB,IAAyB,CAAC,KAAKC,IAAN,IAAc,CAApD;AAEA9I,MAAAA,IAAI,IAAI+I,IAAI,IAAK,KAAKhI,KAAtB;AACD;;AAED,WAAOf,IAAP;AACD;AAED;;;;;AAIA2B,EAAAA,IAAI,GAAG;AACL,QAAI,CAAC,KAAKrB,MAAL,EAAL,EACE,KAAKvD,QAAL,IAAiB,CAAjB;AAEF,WAAO,IAAP;AACD;;AAED2C,EAAAA,GAAG,GAAG;AACJ,WAAO,KAAKpB,KAAL,GAAaqD,IAAb,EAAP;AACD;;AAEDqH,EAAAA,IAAI,GAAG;AACL,SAAKjM,QAAL,GAAgB,CAAhB;AACA,WAAO,IAAP;AACD;;AAEDwI,EAAAA,GAAG,GAAG;AACJ,WAAO,KAAKjH,KAAL,GAAa0K,IAAb,EAAP;AACD;AAED;;;;;AAIAjL,EAAAA,GAAG,CAACrB,GAAD,EAAM;AACPmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,QAAI,KAAKK,QAAL,KAAkBL,GAAG,CAACK,QAA1B,EACE,OAAOL,GAAG,CAACK,QAAJ,GAAe,KAAKA,QAA3B;AAEF,UAAMkM,GAAG,GAAG,KAAKjL,IAAL,CAAUtB,GAAV,CAAZ;AAEA,QAAI,KAAKK,QAAL,KAAkB,CAAtB,EACE,OAAO,CAACkM,GAAD,GAAO,CAAd;AAEF,WAAOA,GAAP;AACD;;AAEDC,EAAAA,IAAI,CAACxM,GAAD,EAAM;AACRmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AAEA,UAAMK,QAAQ,GAAIL,GAAG,GAAG,CAAP,GAAY,CAA7B;AAEA,QAAI,KAAKK,QAAL,KAAkBA,QAAtB,EACE,OAAOA,QAAQ,GAAG,KAAKA,QAAvB;AAEF,UAAMkM,GAAG,GAAG,KAAKrF,KAAL,CAAWlH,GAAX,CAAZ;AAEA,QAAI,KAAKK,QAAL,KAAkB,CAAtB,EACE,OAAO,CAACkM,GAAD,GAAO,CAAd;AAEF,WAAOA,GAAP;AACD;;AAEDE,EAAAA,EAAE,CAACzM,GAAD,EAAM;AACN,WAAO,KAAKqB,GAAL,CAASrB,GAAT,MAAkB,CAAzB;AACD;;AAED0M,EAAAA,GAAG,CAAC1M,GAAD,EAAM;AACP,WAAO,KAAKwM,IAAL,CAAUxM,GAAV,MAAmB,CAA1B;AACD;;AAED2M,EAAAA,EAAE,CAAC3M,GAAD,EAAM;AACN,WAAO,KAAKqB,GAAL,CAASrB,GAAT,IAAgB,CAAvB;AACD;;AAED4M,EAAAA,GAAG,CAAC5M,GAAD,EAAM;AACP,WAAO,KAAKwM,IAAL,CAAUxM,GAAV,IAAiB,CAAxB;AACD;;AAED6M,EAAAA,GAAG,CAAC7M,GAAD,EAAM;AACP,WAAO,KAAKqB,GAAL,CAASrB,GAAT,KAAiB,CAAxB;AACD;;AAED8M,EAAAA,IAAI,CAAC9M,GAAD,EAAM;AACR,WAAO,KAAKwM,IAAL,CAAUxM,GAAV,KAAkB,CAAzB;AACD;;AAED+M,EAAAA,EAAE,CAAC/M,GAAD,EAAM;AACN,WAAO,KAAKqB,GAAL,CAASrB,GAAT,IAAgB,CAAvB;AACD;;AAEDgN,EAAAA,GAAG,CAAChN,GAAD,EAAM;AACP,WAAO,KAAKwM,IAAL,CAAUxM,GAAV,IAAiB,CAAxB;AACD;;AAEDiN,EAAAA,GAAG,CAACjN,GAAD,EAAM;AACP,WAAO,KAAKqB,GAAL,CAASrB,GAAT,KAAiB,CAAxB;AACD;;AAEDkN,EAAAA,IAAI,CAAClN,GAAD,EAAM;AACR,WAAO,KAAKwM,IAAL,CAAUxM,GAAV,KAAkB,CAAzB;AACD;;AAED2H,EAAAA,IAAI,GAAG;AACL,QAAI,KAAKtH,QAAL,KAAkB,CAAtB,EACE,OAAO,CAAC,CAAR;AAEF,QAAI,KAAKD,MAAL,KAAgB,CAAhB,IAAqB,KAAKD,KAAL,CAAW,CAAX,MAAkB,CAA3C,EACE,OAAO,CAAP;AAEF,WAAO,CAAP;AACD;;AAEDyD,EAAAA,MAAM,GAAG;AACP,WAAO,KAAKxD,MAAL,KAAgB,CAAhB,IAAqB,KAAKD,KAAL,CAAW,CAAX,MAAkB,CAA9C;AACD;;AAEDgN,EAAAA,KAAK,GAAG;AACN,WAAO,KAAK9M,QAAL,KAAkB,CAAzB;AACD;;AAED+M,EAAAA,KAAK,GAAG;AACN,WAAO,KAAK/M,QAAL,KAAkB,CAAzB;AACD;;AAEDoG,EAAAA,KAAK,GAAG;AACN,WAAO,CAAC,KAAKtG,KAAL,CAAW,CAAX,IAAgB,CAAjB,MAAwB,CAA/B;AACD;;AAEDkN,EAAAA,MAAM,GAAG;AACP,WAAO,CAAC,KAAKlN,KAAL,CAAW,CAAX,IAAgB,CAAjB,MAAwB,CAA/B;AACD;AAED;;;;;AAIAmB,EAAAA,IAAI,CAACtB,GAAD,EAAM;AACRmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,QAAI,KAAKI,MAAL,GAAcJ,GAAG,CAACI,MAAtB,EACE,OAAO,CAAC,CAAR;AAEF,QAAI,KAAKA,MAAL,GAAcJ,GAAG,CAACI,MAAtB,EACE,OAAO,CAAP;;AAEF,SAAK,IAAIQ,CAAC,GAAG,KAAKR,MAAL,GAAc,CAA3B,EAA8BQ,CAAC,IAAI,CAAnC,EAAsCA,CAAC,EAAvC,EAA2C;AACzC,YAAMH,CAAC,GAAG,KAAKN,KAAL,CAAWS,CAAX,IAAgB,CAA1B;AACA,YAAMF,CAAC,GAAGV,GAAG,CAACG,KAAJ,CAAUS,CAAV,IAAe,CAAzB;AAEA,UAAIH,CAAC,KAAKC,CAAV,EACE;AAEF,aAAO,CAACD,CAAC,GAAGC,CAAL,KAAWD,CAAC,GAAGC,CAAf,CAAP;AACD;;AAED,WAAO,CAAP;AACD;;AAEDwG,EAAAA,KAAK,CAAClH,GAAD,EAAM;AACTmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AAEA,QAAI,KAAKI,MAAL,GAAc,CAAlB,EACE,OAAO,CAAP;AAEF,UAAM6C,CAAC,GAAG,KAAK9C,KAAL,CAAW,CAAX,IAAgB,CAA1B;AAEA,QAAIH,GAAG,GAAG,CAAV,EACEA,GAAG,GAAG,CAACA,GAAP;AAEF,WAAO,CAACiD,CAAC,GAAGjD,GAAL,KAAaiD,CAAC,GAAGjD,GAAjB,CAAP;AACD;AAED;;;;;AAIAsN,EAAAA,QAAQ,CAACtN,GAAD,EAAM;AACZ,UAAMM,GAAG,GAAGV,UAAU,GAAGE,EAAE,CAACQ,GAAH,CAAON,GAAP,CAAH,GAAiBF,EAAE,CAACyN,IAAH,CAAQvN,GAAR,CAAvC;AACA,WAAO,KAAKwN,KAAL,CAAWlN,GAAX,EAAgBmN,WAAhB,EAAP;AACD;;AAEDC,EAAAA,MAAM,CAAC1N,GAAD,EAAM;AACVmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,QAAIA,GAAG,CAAC4D,MAAJ,MAAgB5D,GAAG,CAACqN,MAAJ,EAApB,EACE,MAAM,IAAIM,KAAJ,CAAU,4BAAV,CAAN;;AAEF,QAAIlN,CAAC,GAAG,KAAKmN,YAAL,EAAR;;AACA,QAAIlN,CAAC,GAAGV,GAAG,CAAC4B,KAAJ,EAAR;AACA,QAAI+C,CAAC,GAAG,CAAR;;AAEA,QAAIjE,CAAC,CAACyM,KAAF,EAAJ,EAAe;AACb,UAAI1M,CAAC,CAAC0M,KAAF,EAAJ,EACExI,CAAC,GAAG,CAAC,CAAL;AACFjE,MAAAA,CAAC,CAACuE,IAAF;AACD;;AAED,aAAS;AACP,UAAIvE,CAAC,CAAC8L,IAAF,CAAO,CAAP,MAAc,CAAlB,EACE,OAAO7H,CAAP;AAEF,UAAIlE,CAAC,CAACmD,MAAF,EAAJ,EACE,OAAO,CAAP;AAEFnD,MAAAA,CAAC,CAACyF,IAAF,CAAOxF,CAAP;AAEA,UAAID,CAAC,CAACmD,MAAF,EAAJ,EACE,OAAO,CAAP;AAEF,YAAMsG,CAAC,GAAGzJ,CAAC,CAACoN,QAAF,EAAV;;AAEA,UAAI3D,CAAC,GAAG,CAAR,EAAW;AACT,cAAM4D,KAAK,GAAGpN,CAAC,CAACuL,KAAF,CAAQ,CAAR,CAAd;AAEA,YAAI6B,KAAK,KAAK,CAAV,IAAeA,KAAK,KAAK,CAA7B,EACEnJ,CAAC,GAAG,CAACA,CAAL;AACH;;AAED,YAAMkG,CAAC,GAAGpK,CAAC,CAAC+C,MAAF,CAAS0G,CAAT,CAAV;AAEA,UAAIxJ,CAAC,CAACuL,KAAF,CAAQ,CAAR,MAAe,CAAf,IAAoBpB,CAAC,CAACoB,KAAF,CAAQ,CAAR,MAAe,CAAvC,EACEtH,CAAC,GAAG,CAACA,CAAL;AAEFlE,MAAAA,CAAC,GAAGC,CAAJ;AACAA,MAAAA,CAAC,GAAGmK,CAAJ;AACD;AACF;;AAEDkD,EAAAA,SAAS,CAAC/N,GAAD,EAAM;AACbmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,UAAMgO,KAAK,GAAG,CACZ,CADY,EACR,CADQ,EACL,CADK,EACF,CAAC,CADC,EAEZ,CAFY,EAET,CAAC,CAFQ,EAEL,CAFK,EAED,CAFC,CAAd;;AAKA,QAAIvN,CAAC,GAAG,KAAKmN,YAAL,EAAR;;AACA,QAAIlN,CAAC,GAAGV,GAAG,CAAC4B,KAAJ,EAAR;AACA,QAAIsI,CAAC,GAAG,CAAR;AAEA,QAAIxJ,CAAC,CAACkD,MAAF,EAAJ,EACE,OAAOnD,CAAC,CAACyG,KAAF,CAAQ,CAAR,MAAe,CAAf,GAAmBgD,CAAnB,GAAuB,CAA9B;AAEF,QAAI,CAACzJ,CAAC,CAACgG,KAAF,EAAD,IAAc,CAAC/F,CAAC,CAAC+F,KAAF,EAAnB,EACE,OAAO,CAAP;AAEF,UAAMwH,CAAC,GAAGvN,CAAC,CAACmN,QAAF,EAAV;AAEAnN,IAAAA,CAAC,CAAC8C,MAAF,CAASyK,CAAT;AAEA,QAAIA,CAAC,GAAG,CAAR,EACE/D,CAAC,GAAG8D,KAAK,CAACvN,CAAC,CAACwL,KAAF,CAAQ,CAAR,CAAD,CAAT;;AAEF,QAAIvL,CAAC,CAACyM,KAAF,EAAJ,EAAe;AACb,UAAI1M,CAAC,CAAC0M,KAAF,EAAJ,EACEjD,CAAC,GAAG,CAACA,CAAL;AACFxJ,MAAAA,CAAC,CAACuE,IAAF;AACD;;AAED,aAAS;AACP,UAAIxE,CAAC,CAACmD,MAAF,EAAJ,EACE,OAAOlD,CAAC,CAAC8L,IAAF,CAAO,CAAP,MAAc,CAAd,GAAkBtC,CAAlB,GAAsB,CAA7B;AAEF,YAAM+D,CAAC,GAAGxN,CAAC,CAACoN,QAAF,EAAV;AAEApN,MAAAA,CAAC,CAAC+C,MAAF,CAASyK,CAAT;AAEA,UAAIA,CAAC,GAAG,CAAR,EACE/D,CAAC,IAAI8D,KAAK,CAACtN,CAAC,CAACuL,KAAF,CAAQ,CAAR,CAAD,CAAV;AAEF,YAAMhJ,CAAC,GAAGxC,CAAC,CAACN,KAAF,CAAQ,CAAR,IAAcM,CAAC,CAACJ,QAAF,GAAa,SAArC;AAEA,UAAI4C,CAAC,GAAGvC,CAAC,CAACP,KAAF,CAAQ,CAAR,CAAJ,GAAiB,CAArB,EACE+J,CAAC,GAAG,CAACA,CAAL;AAEFxJ,MAAAA,CAAC,CAACwF,IAAF,CAAOzF,CAAP;AAEA,OAACA,CAAD,EAAIC,CAAJ,IAAS,CAACA,CAAD,EAAID,CAAJ,CAAT;AAEAC,MAAAA,CAAC,CAACL,QAAF,GAAa,CAAb;AACD;AACF;;AAED6N,EAAAA,IAAI,CAAClO,GAAD,EAAM;AACR,WAAO,KAAKmO,GAAL,CAASnO,GAAT,EAAc8C,KAAd,CAAoB,IAApB,CAAP;AACD;;AAEDqL,EAAAA,GAAG,CAACnO,GAAD,EAAM;AACPmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,QAAI,KAAK4D,MAAL,EAAJ,EACE,OAAO5D,GAAG,CAAC6I,GAAJ,EAAP;AAEF,QAAI7I,GAAG,CAAC4D,MAAJ,EAAJ,EACE,OAAO,KAAKiF,GAAL,EAAP;AAEF,QAAIpI,CAAC,GAAG,KAAKmB,KAAL,EAAR;AACA,QAAIlB,CAAC,GAAGV,GAAG,CAAC4B,KAAJ,EAAR;AAEAnB,IAAAA,CAAC,CAACJ,QAAF,GAAa,CAAb;AACAK,IAAAA,CAAC,CAACL,QAAF,GAAa,CAAb,CAbO,CAeP;;AACA,UAAMgE,KAAK,GAAG5D,CAAC,CAAC2N,QAAF,CAAW1N,CAAX,CAAd;;AAEA,QAAI2D,KAAK,KAAK,CAAd,EAAiB;AACf5D,MAAAA,CAAC,CAAC+C,MAAF,CAASa,KAAT;AACA3D,MAAAA,CAAC,CAAC8C,MAAF,CAASa,KAAT;AACD;;AAED,aAAS;AACP,YAAMgK,EAAE,GAAG5N,CAAC,CAACoN,QAAF,EAAX;AACA,YAAMS,EAAE,GAAG5N,CAAC,CAACmN,QAAF,EAAX;AAEA,UAAIQ,EAAE,KAAK,CAAX,EACE5N,CAAC,CAAC+C,MAAF,CAAS6K,EAAT;AAEF,UAAIC,EAAE,KAAK,CAAX,EACE5N,CAAC,CAAC8C,MAAF,CAAS8K,EAAT;AAEF,YAAMjN,GAAG,GAAGZ,CAAC,CAACa,IAAF,CAAOZ,CAAP,CAAZ;;AAEA,UAAIW,GAAG,GAAG,CAAV,EAAa;AACX;AACA,SAACZ,CAAD,EAAIC,CAAJ,IAAS,CAACA,CAAD,EAAID,CAAJ,CAAT;AACD,OAHD,MAGO,IAAIY,GAAG,KAAK,CAAR,IAAaX,CAAC,CAACwG,KAAF,CAAQ,CAAR,MAAe,CAAhC,EAAmC;AACxC;AACA;AACA;AACD;;AAEDzG,MAAAA,CAAC,CAACc,KAAF,CAAQd,CAAR,EAAWC,CAAX;AACD;;AAED,WAAOA,CAAC,CAAC6D,MAAF,CAASF,KAAT,CAAP;AACD;;AAEDkK,EAAAA,IAAI,CAACvO,GAAD,EAAM;AACR,WAAO,KAAKwO,GAAL,CAASxO,GAAT,EAAc8C,KAAd,CAAoB,IAApB,CAAP;AACD;;AAED0L,EAAAA,GAAG,CAACxO,GAAD,EAAM;AACPmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,QAAI,KAAK4D,MAAL,MAAiB5D,GAAG,CAAC4D,MAAJ,EAArB,EACE,OAAO,IAAI9D,EAAJ,CAAO,CAAP,CAAP;AAEF,WAAO,KAAKgF,GAAL,CAAS,KAAKqJ,GAAL,CAASnO,GAAT,CAAT,EAAwB6C,GAAxB,CAA4B7C,GAA5B,EAAiCsM,IAAjC,EAAP;AACD;;AAEDmC,EAAAA,IAAI,CAACzO,GAAD,EAAM;AACRmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;;AAEA,QAAI,KAAK4D,MAAL,EAAJ,EAAmB;AACjB,aAAO,CACL,IAAI9D,EAAJ,CAAO,CAAP,CADK,EAEL,IAAIA,EAAJ,CAAOE,GAAG,CAAC2H,IAAJ,EAAP,CAFK,EAGL3H,GAAG,CAAC6I,GAAJ,EAHK,CAAP;AAKD;;AAED,QAAI7I,GAAG,CAAC4D,MAAJ,EAAJ,EAAkB;AAChB,aAAO,CACL,IAAI9D,EAAJ,CAAO,KAAK6H,IAAL,EAAP,CADK,EAEL,IAAI7H,EAAJ,CAAO,CAAP,CAFK,EAGL,KAAK+I,GAAL,EAHK,CAAP;AAKD;;AAED,UAAMZ,CAAC,GAAG,KAAKrG,KAAL,EAAV;AACA,UAAMsG,CAAC,GAAGlI,GAAG,CAAC4B,KAAJ,EAAV;AAEAqG,IAAAA,CAAC,CAAC5H,QAAF,GAAa,CAAb;AACA6H,IAAAA,CAAC,CAAC7H,QAAF,GAAa,CAAb,CAvBQ,CAyBR;;AACA,UAAMqO,CAAC,GAAG,IAAI5O,EAAJ,CAAO,CAAP,CAAV;AACA,UAAM6O,CAAC,GAAG,IAAI7O,EAAJ,CAAO,CAAP,CAAV,CA3BQ,CA6BR;;AACA,UAAM8O,CAAC,GAAG,IAAI9O,EAAJ,CAAO,CAAP,CAAV;AACA,UAAM+O,CAAC,GAAG,IAAI/O,EAAJ,CAAO,CAAP,CAAV,CA/BQ,CAiCR;;AACA,UAAMgP,CAAC,GAAG7G,CAAC,CAACmG,QAAF,CAAWlG,CAAX,CAAV;;AAEA,QAAI4G,CAAC,KAAK,CAAV,EAAa;AACX7G,MAAAA,CAAC,CAACzE,MAAF,CAASsL,CAAT;AACA5G,MAAAA,CAAC,CAAC1E,MAAF,CAASsL,CAAT;AACD;;AAED,UAAMC,EAAE,GAAG7G,CAAC,CAACtG,KAAF,EAAX;AACA,UAAMoN,EAAE,GAAG/G,CAAC,CAACrG,KAAF,EAAX;;AAEA,WAAO,CAACqG,CAAC,CAACrE,MAAF,EAAR,EAAoB;AAClB,UAAIhD,CAAC,GAAG,CAAR;;AAEA,WAAK,IAAIqO,EAAE,GAAG,CAAd,EAAiB,CAAChH,CAAC,CAAC9H,KAAF,CAAQ,CAAR,IAAa8O,EAAd,MAAsB,CAAtB,IAA2BrO,CAAC,GAAG,EAAhD,EAAoDqO,EAAE,KAAK,CAA3D,EACErO,CAAC,IAAI,CAAL;;AAEF,UAAIA,CAAC,GAAG,CAAR,EAAW;AACTqH,QAAAA,CAAC,CAACzE,MAAF,CAAS5C,CAAT;;AAEA,eAAOA,CAAC,GAAG,CAAX,EAAc;AACZ,cAAI8N,CAAC,CAACjI,KAAF,MAAakI,CAAC,CAAClI,KAAF,EAAjB,EAA4B;AAC1BiI,YAAAA,CAAC,CAACxN,IAAF,CAAO6N,EAAP;AACAJ,YAAAA,CAAC,CAAC1M,IAAF,CAAO+M,EAAP;AACD;;AAEDN,UAAAA,CAAC,CAAClL,MAAF,CAAS,CAAT;AACAmL,UAAAA,CAAC,CAACnL,MAAF,CAAS,CAAT;AAEA5C,UAAAA,CAAC,IAAI,CAAL;AACD;AACF;;AAED,UAAI+D,CAAC,GAAG,CAAR;;AAEA,WAAK,IAAIuK,EAAE,GAAG,CAAd,EAAiB,CAAChH,CAAC,CAAC/H,KAAF,CAAQ,CAAR,IAAa+O,EAAd,MAAsB,CAAtB,IAA2BvK,CAAC,GAAG,EAAhD,EAAoDuK,EAAE,KAAK,CAA3D,EACEvK,CAAC,IAAI,CAAL;;AAEF,UAAIA,CAAC,GAAG,CAAR,EAAW;AACTuD,QAAAA,CAAC,CAAC1E,MAAF,CAASmB,CAAT;;AAEA,eAAOA,CAAC,GAAG,CAAX,EAAc;AACZ,cAAIiK,CAAC,CAACnI,KAAF,MAAaoI,CAAC,CAACpI,KAAF,EAAjB,EAA4B;AAC1BmI,YAAAA,CAAC,CAAC1N,IAAF,CAAO6N,EAAP;AACAF,YAAAA,CAAC,CAAC5M,IAAF,CAAO+M,EAAP;AACD;;AAEDJ,UAAAA,CAAC,CAACpL,MAAF,CAAS,CAAT;AACAqL,UAAAA,CAAC,CAACrL,MAAF,CAAS,CAAT;AAEAmB,UAAAA,CAAC,IAAI,CAAL;AACD;AACF;;AAED,UAAIsD,CAAC,CAAC5G,GAAF,CAAM6G,CAAN,KAAY,CAAhB,EAAmB;AACjBD,QAAAA,CAAC,CAAChG,IAAF,CAAOiG,CAAP;AACAwG,QAAAA,CAAC,CAACzM,IAAF,CAAO2M,CAAP;AACAD,QAAAA,CAAC,CAAC1M,IAAF,CAAO4M,CAAP;AACD,OAJD,MAIO;AACL3G,QAAAA,CAAC,CAACjG,IAAF,CAAOgG,CAAP;AACA2G,QAAAA,CAAC,CAAC3M,IAAF,CAAOyM,CAAP;AACAG,QAAAA,CAAC,CAAC5M,IAAF,CAAO0M,CAAP;AACD;AACF;;AAED,QAAI,KAAKtO,QAAL,KAAkB,CAAtB,EACEuO,CAAC,CAAC3J,IAAF;AAEF,QAAIjF,GAAG,CAACK,QAAJ,KAAiB,CAArB,EACEwO,CAAC,CAAC5J,IAAF;AAEF,WAAO,CAAC2J,CAAD,EAAIC,CAAJ,EAAO3G,CAAC,CAAC3D,MAAF,CAASuK,CAAT,CAAP,CAAP;AACD;;AAEDK,EAAAA,OAAO,CAACnP,GAAD,EAAM;AACX,WAAO,KAAKoP,MAAL,CAAYpP,GAAZ,EAAiB8C,KAAjB,CAAuB,IAAvB,CAAP;AACD;;AAEDsM,EAAAA,MAAM,CAACpP,GAAD,EAAM;AACVmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AACAqP,IAAAA,KAAK,CAACrP,GAAG,CAAC2H,IAAJ,KAAa,CAAd,EAAiB,QAAjB,CAAL;AAEA,QAAI3H,GAAG,CAACwM,IAAJ,CAAS,CAAT,MAAgB,CAApB,EACE,MAAM,IAAIvF,UAAJ,CAAe,iBAAf,CAAN;AAEF,UAAM,CAACiD,CAAD,GAAK4E,CAAL,IAAU,KAAKL,IAAL,CAAUzO,GAAV,CAAhB;AAEA,QAAI8O,CAAC,CAACtC,IAAF,CAAO,CAAP,MAAc,CAAlB,EACE,MAAM,IAAIvF,UAAJ,CAAe,iBAAf,CAAN;AAEF,WAAOiD,CAAC,CAAChE,IAAF,CAAOlG,GAAP,CAAP;AACD;;AAEDsP,EAAAA,OAAO,CAACtP,GAAD,EAAM;AACX,WAAO,KAAKuP,MAAL,CAAYvP,GAAZ,EAAiB8C,KAAjB,CAAuB,IAAvB,CAAP;AACD;;AAEDyM,EAAAA,MAAM,CAACvP,GAAD,EAAM;AACV,UAAMM,GAAG,GAAGV,UAAU,GAAGE,EAAE,CAACQ,GAAH,CAAON,GAAP,CAAH,GAAiBF,EAAE,CAACyN,IAAH,CAAQvN,GAAR,CAAvC;AACA,WAAO,KAAKwN,KAAL,CAAWlN,GAAX,EAAgBkP,SAAhB,GAA4BC,OAA5B,EAAP;AACD;;AAEDC,EAAAA,KAAK,CAACxH,CAAD,EAAI1D,CAAJ,EAAO+I,IAAP,EAAa;AAChB,WAAO,KAAKoC,IAAL,CAAUzH,CAAV,EAAa1D,CAAb,EAAgB+I,IAAhB,EAAsBzK,KAAtB,CAA4B,IAA5B,CAAP;AACD;;AAED6M,EAAAA,IAAI,CAACzH,CAAD,EAAI1D,CAAJ,EAAO+I,IAAP,EAAa;AACf,UAAMjN,GAAG,GAAG,CAACV,UAAD,IAAe2N,IAAf,GAAsBzN,EAAE,CAACyN,IAAH,CAAQ/I,CAAR,CAAtB,GAAmC1E,EAAE,CAACQ,GAAH,CAAOkE,CAAP,CAA/C;AACA,WAAO,KAAKgJ,KAAL,CAAWlN,GAAX,EAAgBsP,MAAhB,CAAuB1H,CAAvB,EAA0BuH,OAA1B,EAAP;AACD;;AAEDI,EAAAA,MAAM,CAAC3H,CAAD,EAAI1D,CAAJ,EAAO+I,IAAP,EAAa;AACjB,WAAO,KAAKuC,KAAL,CAAW5H,CAAX,EAAc1D,CAAd,EAAiB+I,IAAjB,EAAuBzK,KAAvB,CAA6B,IAA7B,CAAP;AACD;;AAEDgN,EAAAA,KAAK,CAAC5H,CAAD,EAAI1D,CAAJ,EAAO+I,IAAP,EAAa;AAChB,UAAMjN,GAAG,GAAGiN,IAAI,GAAGzN,EAAE,CAACyN,IAAH,CAAQ/I,CAAR,CAAH,GAAgB1E,EAAE,CAACQ,GAAH,CAAOkE,CAAP,CAAhC;AACA,WAAO,KAAKgJ,KAAL,CAAWlN,GAAX,EAAgByP,OAAhB,CAAwB7H,CAAxB,EAA2BuH,OAA3B,EAAP;AACD;;AAEDO,EAAAA,MAAM,CAACrK,CAAD,EAAI;AACR,WAAO,KAAKsK,KAAL,CAAWtK,CAAX,EAAc7C,KAAd,CAAoB,IAApB,CAAP;AACD;;AAEDmN,EAAAA,KAAK,CAACtK,CAAD,EAAI;AACPxE,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQuE,CAAR,CAAD,EAAa,GAAb,EAAkB,QAAlB,CAAP;AAEA,QAAIrF,GAAJ;;AAEA,QAAIqF,CAAC,CAACsG,KAAF,CAAQ,CAAR,MAAe,CAAf,IAAoBtG,CAAC,CAACsG,KAAF,CAAQ,CAAR,MAAe,CAAvC,EAA0C;AACxC;AACA3L,MAAAA,GAAG,GAAGR,EAAE,CAACQ,GAAH,CAAOqF,CAAP,CAAN;AACD,KAHD,MAGO;AACLrF,MAAAA,GAAG,GAAGR,EAAE,CAACyN,IAAH,CAAQ5H,CAAR,CAAN;AACD;;AAED,WAAO,KAAK6H,KAAL,CAAWlN,GAAX,EAAgB4P,OAAhB,GAA0BT,OAA1B,EAAP;AACD;;AAEDU,EAAAA,OAAO,CAACxK,CAAD,EAAI5B,CAAJ,EAAO;AACZ,WAAO,KAAKqM,MAAL,CAAYzK,CAAZ,EAAe5B,CAAf,EAAkBjB,KAAlB,CAAwB,IAAxB,CAAP;AACD;;AAEDsN,EAAAA,MAAM,CAACzK,CAAD,EAAI5B,CAAJ,EAAO;AACX,UAAMsM,EAAE,GAAG,KAAKJ,KAAL,CAAWtK,CAAX,CAAX;AACA,UAAM2K,EAAE,GAAG,KAAKL,KAAL,CAAWlM,CAAX,CAAX;AACA,UAAM,CAACwM,EAAD,EAAKC,EAAL,IAAW7K,CAAC,CAAC8I,IAAF,CAAO1K,CAAP,CAAjB;AACA,UAAM0M,GAAG,GAAGH,EAAE,CAACzN,GAAH,CAAO0N,EAAP,EAAW1N,GAAX,CAAe8C,CAAf,CAAZ;AACA,UAAM+K,GAAG,GAAGL,EAAE,CAACxN,GAAH,CAAO2N,EAAP,EAAW3N,GAAX,CAAekB,CAAf,CAAZ;AACA,UAAM4E,CAAC,GAAGhD,CAAC,CAAC9C,GAAF,CAAMkB,CAAN,CAAV;AAEA,WAAO0M,GAAG,CAACvP,IAAJ,CAASwP,GAAT,EAAcxK,IAAd,CAAmByC,CAAnB,CAAP;AACD;AAED;;;;;AAIAgI,EAAAA,OAAO,CAACC,GAAD,EAAMC,IAAN,EAAYC,KAAZ,EAAmB;AACxB3P,IAAAA,OAAO,CAAE0P,IAAI,KAAK,CAAV,KAAiBA,IAAlB,EAAwB,MAAxB,EAAgC,QAAhC,CAAP;AAEA,QAAI,CAAC,KAAKE,SAAL,CAAeH,GAAf,EAAoBC,IAAI,GAAG,CAA3B,EAA8B,IAA9B,CAAL,EACE,OAAO,KAAP;AAEF,QAAI,CAAC,KAAKG,YAAL,CAAkBF,KAAlB,CAAL,EACE,OAAO,KAAP;AAEF,WAAO,IAAP;AACD;;AAEDC,EAAAA,SAAS,CAACH,GAAD,EAAMC,IAAN,EAAYI,MAAM,GAAG,KAArB,EAA4B;AACnC9P,IAAAA,OAAO,CAAE0P,IAAI,KAAK,CAAV,KAAiBA,IAAlB,EAAwB,MAAxB,EAAgC,QAAhC,CAAP;AACA1P,IAAAA,OAAO,CAAC0P,IAAI,GAAG,CAAR,EAAW,MAAX,EAAmB,SAAnB,CAAP;AACA1P,IAAAA,OAAO,CAAC,OAAO8P,MAAP,KAAkB,SAAnB,EAA8B,QAA9B,EAAwC,SAAxC,CAAP;AAEA,UAAMtI,CAAC,GAAG,IAAV;;AAEA,QAAIA,CAAC,CAAC6D,IAAF,CAAO,CAAP,IAAY,CAAhB,EAAmB;AACjB,aAAO7D,CAAC,CAAC6D,IAAF,CAAO,CAAP,MAAc,CAAd,IACA7D,CAAC,CAAC6D,IAAF,CAAO,CAAP,MAAc,CADd,IAEA7D,CAAC,CAAC6D,IAAF,CAAO,CAAP,MAAc,CAFrB;AAGD;;AAED,QAAI7D,CAAC,CAAC0E,MAAF,EAAJ,EACE,OAAO,KAAP;AAEF,UAAM6D,GAAG,GAAGvI,CAAC,CAACvG,IAAF,CAAO,CAAP,CAAZ;AACA,UAAM+O,GAAG,GAAGD,GAAG,CAAC9O,IAAJ,CAAS,CAAT,CAAZ;AACA,UAAM+C,CAAC,GAAG+L,GAAG,CAACrD,QAAJ,EAAV;AACA,UAAM9J,CAAC,GAAGmN,GAAG,CAAC1F,KAAJ,CAAUrG,CAAV,CAAV;AAEA,UAAM7E,GAAG,GAAGR,EAAE,CAACQ,GAAH,CAAOqI,CAAP,CAAZ;AACA,UAAMyI,IAAI,GAAGF,GAAG,CAAC1D,KAAJ,CAAUlN,GAAV,CAAb;AACA,UAAM+Q,IAAI,GAAG,IAAIvR,EAAJ,CAAO,CAAP,EAAU0N,KAAV,CAAgBlN,GAAhB,CAAb;;AAEJ+L,IAAAA,IAAI,EACA,KAAK,IAAIzL,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiQ,IAApB,EAA0BjQ,CAAC,EAA3B,EAA+B;AAC7B,UAAIqH,CAAJ;;AAEA,UAAIrH,CAAC,KAAKiQ,IAAI,GAAG,CAAb,IAAkBI,MAAtB,EAA8B;AAC5BhJ,QAAAA,CAAC,GAAG,IAAInI,EAAJ,CAAO,CAAP,CAAJ;AACD,OAFD,MAEO;AACLmI,QAAAA,CAAC,GAAGnI,EAAE,CAACwR,MAAH,CAAUV,GAAV,EAAe,CAAf,EAAkBO,GAAlB,CAAJ;AACAlJ,QAAAA,CAAC,CAACzG,KAAF,CAAQ,CAAR;AACD;;AAED,UAAI0G,CAAC,GAAGD,CAAC,CAACuF,KAAF,CAAQlN,GAAR,EAAasP,MAAb,CAAoB7L,CAApB,CAAR;AAEA,UAAImE,CAAC,CAAC7G,GAAF,CAAMgQ,IAAN,MAAgB,CAAhB,IAAqBnJ,CAAC,CAAC7G,GAAF,CAAM+P,IAAN,MAAgB,CAAzC,EACE;;AAEF,WAAK,IAAIzM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGQ,CAApB,EAAuBR,CAAC,EAAxB,EAA4B;AAC1BuD,QAAAA,CAAC,GAAGA,CAAC,CAACqJ,MAAF,EAAJ;AAEA,YAAIrJ,CAAC,CAAC7G,GAAF,CAAM+P,IAAN,MAAgB,CAApB,EACE,SAAS/E,IAAT;AAEF,YAAInE,CAAC,CAAC7G,GAAF,CAAMgQ,IAAN,MAAgB,CAApB,EACE,OAAO,KAAP;AACH;;AAED,aAAO,KAAP;AACD;;AAED,WAAO,IAAP;AACD;;AAEDL,EAAAA,YAAY,CAACF,KAAK,GAAG,CAAT,EAAY;AACtB3P,IAAAA,OAAO,CAAE2P,KAAK,KAAK,CAAX,KAAkBA,KAAnB,EAA0B,OAA1B,EAAmC,QAAnC,CAAP;AAEA,UAAMnI,CAAC,GAAG,IAAV,CAHsB,CAKtB;;AACA,QAAIA,CAAC,CAAC6D,IAAF,CAAO,CAAP,KAAa,CAAjB,EACE,OAAO,KAAP,CAPoB,CAStB;;AACA,QAAI7D,CAAC,CAAC0E,MAAF,EAAJ,EACE,OAAO1E,CAAC,CAAC6D,IAAF,CAAO,CAAP,MAAc,CAArB;AAEF,QAAI7G,CAAC,GAAG,CAAR;;AAEA,aAAS;AACP,UAAIA,CAAC,GAAG,KAAR,EAAe;AACb;AACA,cAAM,IAAIgI,KAAJ,CAAW,8BAA6BhF,CAAC,CAAC6I,QAAF,CAAW,EAAX,CAAe,GAAvD,CAAN;AACD;;AAED,UAAIV,KAAK,KAAK,CAAV,IAAenL,CAAC,GAAGmL,KAAvB,EAA8B;AAC5B;AACA,eAAO,KAAP;AACD;;AAED,YAAMrM,CAAC,GAAG,IAAI3E,EAAJ,CAAO6F,CAAC,GAAGA,CAAJ,GAAQ,CAAf,CAAV;AACA,YAAMhB,CAAC,GAAGF,CAAC,CAACiJ,MAAF,CAAS/E,CAAT,CAAV;AAEA,UAAIhE,CAAC,KAAK,CAAC,CAAX,EACE;AAEF,UAAIA,CAAC,KAAK,CAAV,EACE,OAAOgE,CAAC,CAAC6D,IAAF,CAAO7G,CAAC,GAAG,CAAX,MAAkB,CAAzB;;AAEF,UAAIA,CAAC,KAAK,EAAV,EAAc;AACZ,YAAIgD,CAAC,CAACZ,QAAF,EAAJ,EACE,OAAO,KAAP;AACH;;AAEDpC,MAAAA,CAAC,IAAI,CAAL;AACD;;AAED,UAAMuE,CAAC,GAAGvB,CAAC,CAAC9G,IAAF,CAAO,CAAP,CAAV;AACA,UAAMf,CAAC,GAAGoJ,CAAC,CAAC2D,QAAF,EAAV;AACA,UAAM4D,GAAG,GAAG9I,CAAC,CAACvG,IAAF,CAAO,CAAP,CAAZ;AAEA,QAAI6F,CAAC,GAAG,IAAInI,EAAJ,CAAO,CAAP,CAAR;AACA,QAAIoI,CAAC,GAAG,IAAIpI,EAAJ,CAAO6F,CAAP,CAAR;AAEAuE,IAAAA,CAAC,CAAC1G,MAAF,CAAS1C,CAAT;;AAEA,SAAK,IAAIF,CAAC,GAAGsJ,CAAC,CAAC7C,SAAF,EAAb,EAA4BzG,CAAC,IAAI,CAAjC,EAAoCA,CAAC,EAArC,EAAyC;AACvC,UAAIsJ,CAAC,CAAC3G,MAAF,CAAS3C,CAAT,CAAJ,EAAiB;AACfqH,QAAAA,CAAC,GAAGA,CAAC,CAACpF,GAAF,CAAMqF,CAAN,EAAShH,IAAT,CAAcyH,CAAd,EAAiBzG,KAAjB,CAAuByD,CAAvB,EAA0BO,IAA1B,CAA+ByC,CAA/B,CAAJ;AACAT,QAAAA,CAAC,GAAGA,CAAC,CAACpB,GAAF,GAAQ5F,IAAR,CAAauQ,GAAb,EAAkBvL,IAAlB,CAAuByC,CAAvB,CAAJ;AACD,OAHD,MAGO;AACLT,QAAAA,CAAC,GAAGA,CAAC,CAACrF,GAAF,CAAMoF,CAAN,EAAS/G,IAAT,CAAcyH,CAAd,EAAiBzG,KAAjB,CAAuByD,CAAvB,EAA0BO,IAA1B,CAA+ByC,CAA/B,CAAJ;AACAV,QAAAA,CAAC,GAAGA,CAAC,CAACnB,GAAF,GAAQ5F,IAAR,CAAauQ,GAAb,EAAkBvL,IAAlB,CAAuByC,CAAvB,CAAJ;AACD;AACF;;AAED,QAAIV,CAAC,CAACuE,IAAF,CAAO,CAAP,MAAc,CAAd,IAAmBvE,CAAC,CAAC5G,GAAF,CAAMoQ,GAAN,MAAe,CAAtC,EAAyC;AACvC,UAAIhR,CAAC,GAAGwH,CAAC,CAAC7E,IAAF,CAAOuC,CAAP,CAAR;AACA,UAAIjF,CAAC,GAAGwH,CAAC,CAAC6C,KAAF,CAAQ,CAAR,CAAR;AAEA,UAAItK,CAAC,CAACY,GAAF,CAAMX,CAAN,IAAW,CAAf,EACE,CAACD,CAAD,EAAIC,CAAJ,IAAS,CAACA,CAAD,EAAID,CAAJ,CAAT;AAEF,UAAIA,CAAC,CAACwB,IAAF,CAAOvB,CAAP,EAAUwF,IAAV,CAAeyC,CAAf,EAAkB/E,MAAlB,EAAJ,EACE,OAAO,IAAP;AACH;;AAED,SAAK,IAAIwD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGtG,CAAC,GAAG,CAAxB,EAA2BsG,CAAC,EAA5B,EAAgC;AAC9B,UAAIa,CAAC,CAACrE,MAAF,EAAJ,EACE,OAAO,IAAP;AAEF,UAAIqE,CAAC,CAACuE,IAAF,CAAO,CAAP,MAAc,CAAlB,EACE,OAAO,KAAP;AAEFvE,MAAAA,CAAC,GAAGA,CAAC,CAACnB,GAAF,GAAQ5E,KAAR,CAAc,CAAd,EAAiBgE,IAAjB,CAAsByC,CAAtB,CAAJ;AACD;;AAED,WAAO,KAAP;AACD;AAED;;;;;AAIA+I,EAAAA,MAAM,CAACrJ,KAAD,EAAQ;AACZ,QAAI,KAAKhI,QAAL,KAAkB,CAAtB,EACE,OAAO,KAAKwI,GAAL,GAAWP,KAAX,CAAiBD,KAAjB,EAAwB7G,KAAxB,CAA8B,CAA9B,CAAP;AAEF,WAAO,KAAKI,KAAL,EAAP;AACD;;AAED+P,EAAAA,QAAQ,CAACtJ,KAAD,EAAQ;AACdlH,IAAAA,OAAO,CAAEkH,KAAK,KAAK,CAAX,KAAkBA,KAAnB,EAA0B,OAA1B,EAAmC,QAAnC,CAAP;AACAgH,IAAAA,KAAK,CAAChH,KAAK,GAAG,CAAT,EAAY,OAAZ,CAAL;AAEA,QAAI,KAAKuD,KAAL,CAAWvD,KAAK,GAAG,CAAnB,CAAJ,EACE,OAAO,KAAK+B,IAAL,CAAU/B,KAAV,EAAiB7G,KAAjB,CAAuB,CAAvB,EAA0ByD,IAA1B,EAAP;AAEF,WAAO,KAAKrD,KAAL,EAAP;AACD;AAED;;;;;AAIA4L,EAAAA,KAAK,CAACoE,GAAD,EAAM;AACTzQ,IAAAA,OAAO,CAACyQ,GAAG,YAAYC,GAAhB,EAAqB,KAArB,EAA4B,mBAA5B,CAAP;AAEA,QAAI,KAAKvR,GAAT,EACE,MAAM,IAAIqN,KAAJ,CAAU,+BAAV,CAAN;AAEF,WAAOiE,GAAG,CAACE,SAAJ,CAAc,IAAd,CAAP;AACD;;AAEDrC,EAAAA,OAAO,GAAG;AACRnP,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,SAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASyR,WAAT,CAAqB,IAArB,CAAP;AACD;;AAEDC,EAAAA,QAAQ,CAACJ,GAAD,EAAM;AACZzQ,IAAAA,OAAO,CAACyQ,GAAG,YAAYC,GAAhB,EAAqB,KAArB,EAA4B,mBAA5B,CAAP;;AAEA,QAAI,KAAKvR,GAAT,EAAc;AACZ,UAAI,CAACsR,GAAG,CAACpN,CAAJ,CAAMiI,EAAN,CAAS,KAAKnM,GAAL,CAASkE,CAAlB,CAAD,IAAyBoN,GAAG,CAACrE,IAAJ,KAAa,KAAKjN,GAAL,CAASiN,IAAnD,EACE,MAAM,IAAII,KAAJ,CAAU,+BAAV,CAAN;AACH,KAHD,MAGO;AACL0B,MAAAA,KAAK,CAAC,KAAKhP,QAAL,KAAkB,CAAnB,EAAsB,KAAtB,CAAL;AACAgP,MAAAA,KAAK,CAAC,KAAK/N,IAAL,CAAUsQ,GAAG,CAACpN,CAAd,IAAmB,CAApB,EAAuB,KAAvB,CAAL;AACD;;AAED,WAAO,KAAK5C,KAAL,GAAaqQ,SAAb,CAAuBL,GAAvB,CAAP;AACD;;AAEDM,EAAAA,OAAO,CAAClS,GAAD,EAAM;AACXmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,SAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASY,IAAT,CAAc,IAAd,EAAoBlB,GAApB,CAAP;AACD;;AAEDmS,EAAAA,MAAM,CAACnS,GAAD,EAAM;AACVmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,QAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASqB,GAAT,CAAa,IAAb,EAAmB3B,GAAnB,CAAP;AACD;;AAEDoS,EAAAA,QAAQ,CAACpS,GAAD,EAAM;AACZmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,UAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASkB,KAAT,CAAe,IAAf,EAAqBxB,GAArB,CAAP;AACD;;AAEDqS,EAAAA,OAAO,CAACrS,GAAD,EAAM;AACXmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,SAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASuB,IAAT,CAAc,IAAd,EAAoB7B,GAApB,CAAP;AACD;;AAEDsS,EAAAA,OAAO,CAACtS,GAAD,EAAM;AACXmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,SAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAAS2B,IAAT,CAAc,IAAd,EAAoBjC,GAApB,CAAP;AACD;;AAEDuS,EAAAA,MAAM,CAACvS,GAAD,EAAM;AACVmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,QAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAAS6B,GAAT,CAAa,IAAb,EAAmBnC,GAAnB,CAAP;AACD;;AAEDwS,EAAAA,QAAQ,CAACxS,GAAD,EAAM;AACZmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,UAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAAS4B,KAAT,CAAe,IAAf,EAAqBlC,GAArB,CAAP;AACD;;AAEDyS,EAAAA,OAAO,CAACzS,GAAD,EAAM;AACXmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,SAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAAS8B,IAAT,CAAc,IAAd,EAAoBpC,GAApB,CAAP;AACD;;AAED0S,EAAAA,OAAO,CAAC1S,GAAD,EAAM;AACXmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,SAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASsC,IAAT,CAAc,IAAd,EAAoB5C,GAApB,CAAP;AACD;;AAED2S,EAAAA,MAAM,CAAC3S,GAAD,EAAM;AACVmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,QAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASuC,GAAT,CAAa,IAAb,EAAmB7C,GAAnB,CAAP;AACD;;AAED4S,EAAAA,QAAQ,CAAC5S,GAAD,EAAM;AACZmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,UAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASyC,KAAT,CAAe,IAAf,EAAqB/C,GAArB,CAAP;AACD;;AAED6S,EAAAA,OAAO,CAAC7S,GAAD,EAAM;AACXmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,SAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAAS8C,IAAT,CAAc,IAAd,EAAoBpD,GAApB,CAAP;AACD;;AAED8S,EAAAA,OAAO,CAAC9S,GAAD,EAAM;AACXmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,SAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASwF,IAAT,CAAc,IAAd,EAAoB9F,GAApB,CAAP;AACD;;AAED+S,EAAAA,MAAM,CAAC/S,GAAD,EAAM;AACVmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,QAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASyF,GAAT,CAAa,IAAb,EAAmB/F,GAAnB,CAAP;AACD;;AAEDgT,EAAAA,QAAQ,CAAChT,GAAD,EAAM;AACZmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,UAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAAS0F,KAAT,CAAe,IAAf,EAAqBhG,GAArB,CAAP;AACD;;AAEDiT,EAAAA,OAAO,CAACjT,GAAD,EAAM;AACXmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,SAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAAS2F,IAAT,CAAc,IAAd,EAAoBjG,GAApB,CAAP;AACD;;AAEDkT,EAAAA,OAAO,CAAClT,GAAD,EAAM;AACXmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,SAAX,CAAH;AACA6S,IAAAA,MAAM,CAAC,CAACnT,GAAG,CAACM,GAAN,EAAW,SAAX,CAAN;AACA,WAAO,KAAKA,GAAL,CAASoG,IAAT,CAAc,IAAd,EAAoB1G,GAApB,CAAP;AACD;;AAED4P,EAAAA,MAAM,CAAC5P,GAAD,EAAM;AACVmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,QAAX,CAAH;AACA6S,IAAAA,MAAM,CAAC,CAACnT,GAAG,CAACM,GAAN,EAAW,QAAX,CAAN;AACA,WAAO,KAAKA,GAAL,CAASqG,GAAT,CAAa,IAAb,EAAmB3G,GAAnB,CAAP;AACD;;AAEDoT,EAAAA,QAAQ,CAACpT,GAAD,EAAM;AACZmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,UAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASsG,KAAT,CAAe,IAAf,EAAqB5G,GAArB,CAAP;AACD;;AAED+P,EAAAA,OAAO,CAAC/P,GAAD,EAAM;AACXmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,SAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASuG,IAAT,CAAc,IAAd,EAAoB7G,GAApB,CAAP;AACD;;AAEDqT,EAAAA,OAAO,GAAG;AACR/S,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,SAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASyG,IAAT,CAAc,IAAd,CAAP;AACD;;AAEDwK,EAAAA,MAAM,GAAG;AACPjR,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,QAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASwG,GAAT,CAAa,IAAb,CAAP;AACD;;AAEDwM,EAAAA,QAAQ,GAAG;AACThT,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,UAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASuH,KAAT,CAAe,IAAf,CAAP;AACD;;AAEDqI,EAAAA,OAAO,GAAG;AACR5P,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,SAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASwH,IAAT,CAAc,IAAd,CAAP;AACD;;AAEDyL,EAAAA,WAAW,CAACjM,CAAD,EAAI;AACbhH,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,aAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASkT,QAAT,CAAkB,IAAlB,EAAwBlM,CAAxB,CAAP;AACD;;AAEDmM,EAAAA,UAAU,CAACnM,CAAD,EAAI;AACZhH,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,YAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASoT,OAAT,CAAiB,IAAjB,EAAuBpM,CAAvB,CAAP;AACD;;AAEDqM,EAAAA,WAAW,GAAG;AACZrT,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,aAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASyH,QAAT,CAAkB,IAAlB,CAAP;AACD;;AAED6L,EAAAA,OAAO,CAAC5T,GAAD,EAAM;AACXmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,SAAX,CAAH;AACA6S,IAAAA,MAAM,CAAC,CAACnT,GAAG,CAACM,GAAN,EAAW,SAAX,CAAN;AACA,WAAO,KAAKA,GAAL,CAAS+J,IAAT,CAAc,IAAd,EAAoBrK,GAApB,CAAP;AACD;;AAED6T,EAAAA,MAAM,CAAC7T,GAAD,EAAM;AACVmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,QAAX,CAAH;AACA6S,IAAAA,MAAM,CAAC,CAACnT,GAAG,CAACM,GAAN,EAAW,QAAX,CAAN;AACA,WAAO,KAAKA,GAAL,CAASkK,GAAT,CAAa,IAAb,EAAmBxK,GAAnB,CAAP;AACD;;AAED8T,EAAAA,QAAQ,CAAC9T,GAAD,EAAM;AACZmB,IAAAA,OAAO,CAAEnB,GAAG,KAAK,CAAT,KAAgBA,GAAjB,EAAsB,KAAtB,EAA6B,QAA7B,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,UAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASgK,KAAT,CAAe,IAAf,EAAqBtK,GAArB,CAAP;AACD;;AAED+T,EAAAA,OAAO,CAAC/T,GAAD,EAAM;AACXmB,IAAAA,OAAO,CAAEnB,GAAG,KAAK,CAAT,KAAgBA,GAAjB,EAAsB,KAAtB,EAA6B,QAA7B,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,SAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASmK,IAAT,CAAc,IAAd,EAAoBzK,GAApB,CAAP;AACD;;AAEDgU,EAAAA,OAAO,GAAG;AACR1T,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,SAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAAS2E,IAAT,CAAc,IAAd,CAAP;AACD;;AAEDgP,EAAAA,MAAM,GAAG;AACP3T,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,QAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAAS0C,GAAT,CAAa,IAAb,CAAP;AACD;;AAEDkR,EAAAA,KAAK,CAAClU,GAAD,EAAM;AACTmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,OAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASmM,EAAT,CAAY,IAAZ,EAAkBzM,GAAlB,CAAP;AACD;;AAEDmU,EAAAA,MAAM,CAACnU,GAAD,EAAM;AACVmB,IAAAA,OAAO,CAACM,KAAK,CAACzB,GAAD,CAAN,EAAa,KAAb,EAAoB,KAApB,CAAP;AACAM,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,QAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASoM,GAAT,CAAa,IAAb,EAAmB1M,GAAnB,CAAP;AACD;;AAEDoU,EAAAA,SAAS,GAAG;AACV9T,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,WAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAAS+T,MAAT,CAAgB,IAAhB,CAAP;AACD;;AAEDC,EAAAA,QAAQ,GAAG;AACThU,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,UAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASiU,KAAT,CAAe,IAAf,CAAP;AACD;;AAEDC,EAAAA,QAAQ,GAAG;AACTlU,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,UAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASmG,KAAT,CAAe,IAAf,CAAP;AACD;;AAEDgO,EAAAA,SAAS,GAAG;AACVnU,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,WAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAAS+M,MAAT,CAAgB,IAAhB,CAAP;AACD;;AAEDI,EAAAA,WAAW,GAAG;AACZnN,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,aAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASgN,QAAT,CAAkB,IAAlB,CAAP;AACD;;AAEDoH,EAAAA,SAAS,GAAG;AACVpU,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,WAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASoN,MAAT,CAAgB,IAAhB,CAAP;AACD;;AAEDiH,EAAAA,YAAY,GAAG;AACbrU,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,cAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASyN,SAAT,CAAmB,IAAnB,CAAP;AACD;;AAED6G,EAAAA,UAAU,GAAG;AACXtU,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,YAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAAS6O,OAAT,CAAiB,IAAjB,CAAP;AACD;;AAED0F,EAAAA,SAAS,GAAG;AACVvU,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,WAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAAS8O,MAAT,CAAgB,IAAhB,CAAP;AACD;;AAED0F,EAAAA,UAAU,GAAG;AACXxU,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,YAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASgP,OAAT,CAAiB,IAAjB,CAAP;AACD;;AAEDE,EAAAA,SAAS,GAAG;AACVlP,IAAAA,GAAG,CAAC,KAAKA,GAAN,EAAW,WAAX,CAAH;AACA,WAAO,KAAKA,GAAL,CAASiP,MAAT,CAAgB,IAAhB,CAAP;AACD;AAED;;;;;AAIAzM,EAAAA,KAAK,CAACiS,IAAD,EAAO;AACVA,IAAAA,IAAI,CAAC5U,KAAL,GAAa,KAAKA,KAAlB;AACA4U,IAAAA,IAAI,CAAC3U,MAAL,GAAc,KAAKA,MAAnB;AACA2U,IAAAA,IAAI,CAAC1U,QAAL,GAAgB,KAAKA,QAArB;AACA0U,IAAAA,IAAI,CAACzU,GAAL,GAAW,KAAKA,GAAhB;AACA,WAAOyU,IAAP;AACD;;AAEDlU,EAAAA,MAAM,CAACmU,IAAD,EAAO;AACX,WAAO,KAAK7U,KAAL,CAAWC,MAAX,GAAoB4U,IAA3B,EACE,KAAK7U,KAAL,CAAW8U,IAAX,CAAgB,CAAhB;;AAEF,WAAO,IAAP;AACD;;AAED/P,EAAAA,OAAO,CAAC8P,IAAD,EAAO;AACZ,SAAKnU,MAAL,CAAYmU,IAAZ;;AAEA,WAAO,KAAK5U,MAAL,GAAc4U,IAArB,EACE,KAAK7U,KAAL,CAAW,KAAKC,MAAL,EAAX,IAA4B,CAA5B;;AAEF,WAAO,IAAP;AACD;;AAED2B,EAAAA,MAAM,GAAG;AACP,WAAO,KAAK3B,MAAL,GAAc,CAAd,IAAmB,KAAKD,KAAL,CAAW,KAAKC,MAAL,GAAc,CAAzB,MAAgC,CAA1D,EACE,KAAKA,MAAL,IAAe,CAAf;;AAEF,WAAO,KAAK4B,UAAL,EAAP;AACD;;AAEDA,EAAAA,UAAU,GAAG;AACXF,IAAAA,MAAM,CAAC,KAAK1B,MAAL,GAAc,CAAf,CAAN,CADW,CAGX;;AACA,QAAI,KAAKA,MAAL,KAAgB,CAAhB,IAAqB,KAAKD,KAAL,CAAW,CAAX,MAAkB,CAA3C,EACE,KAAKE,QAAL,GAAgB,CAAhB;AAEF,WAAO,IAAP;AACD;;AAED6U,EAAAA,MAAM,GAAG;AACP;AACApT,IAAAA,MAAM,CAAC,KAAK1B,MAAL,GAAc,CAAf,CAAN,CAFO,CAIP;;AACA0B,IAAAA,MAAM,CAAC,KAAK1B,MAAL,IAAe,KAAKD,KAAL,CAAWC,MAA3B,CAAN;;AAEA,QAAI,KAAKA,MAAL,KAAgB,CAApB,EAAuB;AACrB;AACA,UAAI,KAAKD,KAAL,CAAW,CAAX,MAAkB,CAAtB,EACE2B,MAAM,CAAC,KAAKzB,QAAL,KAAkB,CAAnB,CAAN;AACF,aAAO,IAAP;AACD,KAZM,CAcP;;;AACAyB,IAAAA,MAAM,CAAC,KAAK3B,KAAL,CAAW,KAAKC,MAAL,GAAc,CAAzB,MAAgC,CAAjC,CAAN;AAEA,WAAO,IAAP;AACD;;AAED+U,EAAAA,QAAQ,CAACxP,CAAD,EAAI;AACVxE,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQuE,CAAR,CAAD,EAAa,GAAb,EAAkB,QAAlB,CAAP;AACA7D,IAAAA,MAAM,CAAC,KAAKzB,QAAL,KAAkB,CAAnB,CAAN;AACAyB,IAAAA,MAAM,CAAC6D,CAAC,CAACgC,IAAF,KAAW,CAAZ,CAAN;AAEA,QAAI,KAAK/D,MAAL,MAAiB+B,CAAC,CAAC6G,IAAF,CAAO,CAAP,MAAc,CAAnC,EACE,MAAM,IAAIvF,UAAJ,CAAe,iBAAf,CAAN;AAEF,UAAMxG,CAAC,GAAG,KAAKmB,KAAL,EAAV;AACA,UAAMlB,CAAC,GAAGiF,CAAC,CAAC/D,KAAF,EAAV;AACA,UAAMwT,EAAE,GAAG,IAAItV,EAAJ,CAAO,CAAP,CAAX;AACA,UAAMuV,EAAE,GAAG,IAAIvV,EAAJ,CAAO,CAAP,CAAX;AACA,UAAMwV,KAAK,GAAG5U,CAAC,CAACkB,KAAF,EAAd;;AAEA,WAAOnB,CAAC,CAAC+L,IAAF,CAAO,CAAP,IAAY,CAAZ,IAAiB9L,CAAC,CAAC8L,IAAF,CAAO,CAAP,IAAY,CAApC,EAAuC;AACrC,UAAI5L,CAAC,GAAG,CAAR;;AAEA,WAAK,IAAIqO,EAAE,GAAG,CAAd,EAAiB,CAACxO,CAAC,CAACN,KAAF,CAAQ,CAAR,IAAa8O,EAAd,MAAsB,CAAtB,IAA2BrO,CAAC,GAAG,EAAhD,EAAoDqO,EAAE,KAAK,CAA3D,EACErO,CAAC,IAAI,CAAL;;AAEF,UAAIA,CAAC,GAAG,CAAR,EAAW;AACTH,QAAAA,CAAC,CAAC+C,MAAF,CAAS5C,CAAT;;AAEA,eAAOA,CAAC,GAAG,CAAX,EAAc;AACZ,cAAIwU,EAAE,CAAC3O,KAAH,EAAJ,EACE2O,EAAE,CAAClU,IAAH,CAAQoU,KAAR;AAEFF,UAAAA,EAAE,CAAC5R,MAAH,CAAU,CAAV;AAEA5C,UAAAA,CAAC,IAAI,CAAL;AACD;AACF;;AAED,UAAI+D,CAAC,GAAG,CAAR;;AAEA,WAAK,IAAIuK,EAAE,GAAG,CAAd,EAAiB,CAACxO,CAAC,CAACP,KAAF,CAAQ,CAAR,IAAa+O,EAAd,MAAsB,CAAtB,IAA2BvK,CAAC,GAAG,EAAhD,EAAoDuK,EAAE,KAAK,CAA3D,EACEvK,CAAC,IAAI,CAAL;;AAEF,UAAIA,CAAC,GAAG,CAAR,EAAW;AACTjE,QAAAA,CAAC,CAAC8C,MAAF,CAASmB,CAAT;;AAEA,eAAOA,CAAC,GAAG,CAAX,EAAc;AACZ,cAAI0Q,EAAE,CAAC5O,KAAH,EAAJ,EACE4O,EAAE,CAACnU,IAAH,CAAQoU,KAAR;AAEFD,UAAAA,EAAE,CAAC7R,MAAH,CAAU,CAAV;AAEAmB,UAAAA,CAAC,IAAI,CAAL;AACD;AACF;;AAED,UAAIlE,CAAC,CAACY,GAAF,CAAMX,CAAN,KAAY,CAAhB,EAAmB;AACjBD,QAAAA,CAAC,CAACwB,IAAF,CAAOvB,CAAP;AACA0U,QAAAA,EAAE,CAACnT,IAAH,CAAQoT,EAAR;AACD,OAHD,MAGO;AACL3U,QAAAA,CAAC,CAACuB,IAAF,CAAOxB,CAAP;AACA4U,QAAAA,EAAE,CAACpT,IAAH,CAAQmT,EAAR;AACD;AACF,KA1DS,CA4DV;;;AACA,UAAM7I,GAAG,GAAG9L,CAAC,CAAC+L,IAAF,CAAO,CAAP,MAAc,CAAd,GAAkB4I,EAAlB,GAAuBC,EAAnC;;AAEA,QAAI9I,GAAG,CAACjL,IAAJ,CAASqE,CAAT,KAAe,CAAnB,EAAsB;AACpB4G,MAAAA,GAAG,CAAChL,KAAJ,CAAUgL,GAAV,EAAe5G,CAAf;;AAEA,UAAI4G,GAAG,CAACjL,IAAJ,CAASqE,CAAT,KAAe,CAAnB,EACE4G,GAAG,CAAChL,KAAJ,CAAUgL,GAAV,EAAe5G,CAAf;AACH;;AAED,QAAI4G,GAAG,CAACY,KAAJ,EAAJ,EACEZ,GAAG,CAACrL,IAAJ,CAASyE,CAAT;AAEF,WAAO4G,GAAP;AACD;;AAED6B,EAAAA,QAAQ,CAACpO,GAAD,EAAM;AACZ;AACA;AACA,QAAI,CAAC,KAAKG,KAAL,CAAW,CAAX,IAAgBH,GAAG,CAACG,KAAJ,CAAU,CAAV,CAAjB,IAAiC,CAArC,EACE,OAAO,CAAP;AAEF,UAAMqC,GAAG,GAAGxB,IAAI,CAACgE,GAAL,CAAS,KAAK5E,MAAd,EAAsBJ,GAAG,CAACI,MAA1B,CAAZ;AAEA,QAAIU,CAAC,GAAG,CAAR;;AAEA,SAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4B,GAApB,EAAyB5B,CAAC,EAA1B,EAA8B;AAC5B,YAAMF,CAAC,GAAGmN,QAAQ,CAAC,KAAK1N,KAAL,CAAWS,CAAX,IAAgBZ,GAAG,CAACG,KAAJ,CAAUS,CAAV,CAAjB,CAAlB;AAEAE,MAAAA,CAAC,IAAIJ,CAAL;AAEA,UAAIA,CAAC,KAAK,EAAV,EACE;AACH;;AAED,WAAOI,CAAP;AACD;;AAED8M,EAAAA,YAAY,GAAG;AACb,WAAO,KAAKtN,GAAL,GAAW,KAAKmP,OAAL,EAAX,GAA4B,KAAK7N,KAAL,EAAnC;AACD;;AAEDqQ,EAAAA,SAAS,CAACL,GAAD,EAAM;AACb,SAAKtR,GAAL,GAAWsR,GAAX;AACA,WAAO,IAAP;AACD;AAED;;;;;AAIAhQ,EAAAA,KAAK,GAAG;AACN,UAAM2T,IAAI,GAAG,IAAIzV,EAAJ,EAAb;AAEAyV,IAAAA,IAAI,CAACpV,KAAL,GAAa,IAAIgD,KAAJ,CAAU,KAAK/C,MAAf,CAAb;;AAEA,SAAK,IAAIQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKR,MAAzB,EAAiCQ,CAAC,EAAlC,EACE2U,IAAI,CAACpV,KAAL,CAAWS,CAAX,IAAgB,KAAKT,KAAL,CAAWS,CAAX,CAAhB;;AAEF2U,IAAAA,IAAI,CAACnV,MAAL,GAAc,KAAKA,MAAnB;AACAmV,IAAAA,IAAI,CAAClV,QAAL,GAAgB,KAAKA,QAArB;AACAkV,IAAAA,IAAI,CAACjV,GAAL,GAAW,KAAKA,GAAhB;AAEA,WAAOiV,IAAP;AACD;;AAEDC,EAAAA,MAAM,CAACxV,GAAD,EAAM;AACVmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;;AAEA,SAAKa,MAAL,CAAYb,GAAG,CAACI,MAAhB;;AAEA,SAAK,IAAIQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGZ,GAAG,CAACI,MAAxB,EAAgCQ,CAAC,EAAjC,EACE,KAAKT,KAAL,CAAWS,CAAX,IAAgBZ,GAAG,CAACG,KAAJ,CAAUS,CAAV,CAAhB;;AAEF,SAAKR,MAAL,GAAcJ,GAAG,CAACI,MAAlB;AACA,SAAKC,QAAL,GAAgBL,GAAG,CAACK,QAApB;AACA,SAAKC,GAAL,GAAWN,GAAG,CAACM,GAAf;AAEA,WAAO,IAAP;AACD;;AAEDmV,EAAAA,GAAG,CAACzV,GAAD,EAAME,MAAN,EAAc;AACf,WAAO,KAAKwV,UAAL,CAAgB1V,GAAhB,EAAqBE,MAArB,CAAP;AACD;;AAEDyV,EAAAA,IAAI,CAAC3V,GAAD,EAAM;AACRmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,UAAMiI,CAAC,GAAG,IAAV;AACA,UAAMC,CAAC,GAAGlI,GAAV;AAEA,KAACiI,CAAC,CAAC9H,KAAH,EAAU+H,CAAC,CAAC/H,KAAZ,IAAqB,CAAC+H,CAAC,CAAC/H,KAAH,EAAU8H,CAAC,CAAC9H,KAAZ,CAArB;AACA,KAAC8H,CAAC,CAAC7H,MAAH,EAAW8H,CAAC,CAAC9H,MAAb,IAAuB,CAAC8H,CAAC,CAAC9H,MAAH,EAAW6H,CAAC,CAAC7H,MAAb,CAAvB;AACA,KAAC6H,CAAC,CAAC5H,QAAH,EAAa6H,CAAC,CAAC7H,QAAf,IAA2B,CAAC6H,CAAC,CAAC7H,QAAH,EAAa4H,CAAC,CAAC5H,QAAf,CAA3B;AACA,KAAC4H,CAAC,CAAC3H,GAAH,EAAQ4H,CAAC,CAAC5H,GAAV,IAAiB,CAAC4H,CAAC,CAAC5H,GAAH,EAAQ2H,CAAC,CAAC3H,GAAV,CAAjB;AAEA,WAAO2H,CAAP;AACD;;AAED2N,EAAAA,OAAO,GAAG;AACR,UAAM5S,GAAG,GAAG,KAAK3C,QAAjB;AAEA,SAAKwV,UAAL,CAAgB,KAAKC,QAAL,CAAc,IAAd,CAAhB,EAAqC,IAArC;AACA,SAAKzV,QAAL,GAAgB2C,GAAhB;AAEA,WAAO,IAAP;AACD;;AAED+S,EAAAA,UAAU,GAAG;AACX,WAAO/U,IAAI,CAACmJ,IAAL,CAAU,KAAK9C,SAAL,KAAmB,CAA7B,CAAP;AACD;;AAEDA,EAAAA,SAAS,GAAG;AACV,UAAMpE,CAAC,GAAG,KAAK9C,KAAL,CAAW,KAAKC,MAAL,GAAc,CAAzB,CAAV;AACA,UAAM+D,EAAE,GAAGG,SAAS,CAACrB,CAAD,CAApB;AACA,WAAO,CAAC,KAAK7C,MAAL,GAAc,CAAf,IAAoB,EAApB,GAAyB+D,EAAhC;AACD;;AAED0J,EAAAA,QAAQ,GAAG;AACT,QAAI,KAAKjK,MAAL,EAAJ,EACE,OAAO,CAAP;AAEF,QAAI,KAAK6C,KAAL,EAAJ,EACE,OAAO,CAAP;AAEF,QAAI3F,CAAC,GAAG,CAAR;;AAEA,SAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKR,MAAzB,EAAiCQ,CAAC,EAAlC,EAAsC;AACpC,YAAMF,CAAC,GAAGmN,QAAQ,CAAC,KAAK1N,KAAL,CAAWS,CAAX,CAAD,CAAlB;AAEAE,MAAAA,CAAC,IAAIJ,CAAL;AAEA,UAAIA,CAAC,KAAK,EAAV,EACE;AACH;;AAED,WAAOI,CAAP;AACD;;AAEDkV,EAAAA,MAAM,GAAG;AACP,QAAI,KAAK5V,MAAL,IAAe,CAAnB,EACE,OAAO,IAAP;AAEF,QAAI,KAAKA,MAAL,KAAgB,CAAhB,IAAqB,KAAKD,KAAL,CAAW,CAAX,MAAkB,IAA3C,EACE,OAAO,IAAP;AAEF,WAAO,KAAP;AACD;;AAEDiE,EAAAA,IAAI,CAAC8H,GAAD,EAAM;AACR/K,IAAAA,OAAO,CAAE+K,GAAG,KAAK,CAAT,KAAgBA,GAAjB,EAAsB,KAAtB,EAA6B,QAA7B,CAAP;AAEA,QAAIA,GAAG,IAAI,KAAK9L,MAAhB,EACE,OAAO,CAAP;AAEF,WAAO,KAAKD,KAAL,CAAW+L,GAAX,CAAP;AACD;;AAED,GAAC3N,MAAD,IAAW;AACT,QAAI0X,MAAM,GAAG,IAAb;AAEA,QAAI,KAAK3V,GAAT,EACE2V,MAAM,GAAG,MAAT;AAEF,WAAQ,IAAGA,MAAO,KAAI,KAAKzE,QAAL,CAAc,EAAd,CAAkB,GAAxC;AACD;AAED;;;;;AAIA0E,EAAAA,KAAK,GAAG;AACN,WAAO,KAAK7V,QAAL,GAAgB,CAAC,CAAjB,GAAqB,CAArB,GAAyB,KAAK8V,KAAL,EAAhC;AACD;;AAEDA,EAAAA,KAAK,GAAG;AACN,UAAMC,KAAK,GAAI,KAAKjW,KAAL,CAAW,CAAX,IAAgB,CAAjB,KAAwB,EAAtC;AACA,WAAS,KAAKC,MAAL,GAAc,CAAf,KAAsB,EAAvB,GAA6BgW,KAApC;AACD;;AAEDC,EAAAA,IAAI,GAAG;AACL,WAAO,KAAKhW,QAAZ;AACD;;AAEDiW,EAAAA,IAAI,GAAG;AACL,WAAO,KAAKjW,QAAL,GAAgB,CAAvB;AACD;;AAEDkW,EAAAA,GAAG,CAACvW,GAAD,EAAM;AACPmB,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP,CADO,CAGP;AACA;AACA;;AACA,QAAIiO,CAAC,GAAG,CAAR;;AAEA,SAAK,IAAIrN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGZ,GAAG,CAACI,MAAxB,EAAgCQ,CAAC,EAAjC,EACEqN,CAAC,IAAI,KAAK9N,KAAL,CAAWS,CAAC,GAAG,KAAKR,MAApB,IAA8BJ,GAAG,CAACG,KAAJ,CAAUS,CAAV,CAAnC;;AAEFqN,IAAAA,CAAC,IAAI,KAAK7N,MAAL,GAAcJ,GAAG,CAACI,MAAvB;AACA6N,IAAAA,CAAC,IAAI,KAAK5N,QAAL,GAAgBL,GAAG,CAACK,QAAzB;AAEA,WAAQ4N,CAAC,GAAG,CAAL,KAAY,EAAnB;AACD;;AAEDuI,EAAAA,IAAI,CAACxW,GAAD,EAAM;AACR,UAAMgD,GAAG,GAAIhD,GAAG,IAAI,EAAR,GAAc,CAA1B;AACA,UAAMoE,IAAI,GAAI,CAACpE,GAAG,GAAG,CAAP,KAAa,CAACgD,GAAD,GAAO,CAApB,CAAD,GAA2B,SAAxC;AAEA,QAAIiL,CAAC,GAAG,CAAR;AAEAA,IAAAA,CAAC,IAAI,KAAK9N,KAAL,CAAW,CAAX,IAAgBiE,IAArB;AACA6J,IAAAA,CAAC,IAAI,KAAK7N,MAAL,GAAc,CAAnB;AACA6N,IAAAA,CAAC,IAAI,KAAK5N,QAAL,GAAgB2C,GAArB;AAEA,WAAQiL,CAAC,GAAG,CAAL,KAAY,EAAnB;AACD;;AAEDwI,EAAAA,KAAK,CAACzW,GAAD,EAAM0W,IAAN,EAAY;AACfvV,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,UAAMiI,CAAC,GAAG,IAAV;AACA,UAAMC,CAAC,GAAGlI,GAAV;AACA,UAAM2W,IAAI,GAAG,CAAED,IAAI,IAAI,EAAT,GAAgB,CAACA,IAAD,IAAS,EAA1B,IAAiC,CAA9C;AACA,UAAM/L,IAAI,GAAG,CAACgM,IAAD,GAAQ,SAArB;;AAEA1O,IAAAA,CAAC,CAACpH,MAAF,CAASqH,CAAC,CAAC/H,KAAF,CAAQC,MAAjB;;AACA8H,IAAAA,CAAC,CAACrH,MAAF,CAASoH,CAAC,CAAC9H,KAAF,CAAQC,MAAjB;;AAEA,SAAK,IAAIQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqH,CAAC,CAAC9H,KAAF,CAAQC,MAA5B,EAAoCQ,CAAC,EAArC,EAAyC;AACvC,YAAMwD,IAAI,GAAG,CAAC6D,CAAC,CAAC9H,KAAF,CAAQS,CAAR,IAAasH,CAAC,CAAC/H,KAAF,CAAQS,CAAR,CAAd,IAA4B+J,IAAzC;AAEA1C,MAAAA,CAAC,CAAC9H,KAAF,CAAQS,CAAR,KAAcwD,IAAd;AACA8D,MAAAA,CAAC,CAAC/H,KAAF,CAAQS,CAAR,KAAcwD,IAAd;AACD;;AAED,UAAMhE,MAAM,GAAG,CAAC6H,CAAC,CAAC7H,MAAF,GAAW8H,CAAC,CAAC9H,MAAd,IAAwBuK,IAAvC;AACA,UAAMtK,QAAQ,GAAG,CAAC4H,CAAC,CAAC5H,QAAF,GAAa6H,CAAC,CAAC7H,QAAhB,IAA4BsK,IAA7C;AAEA1C,IAAAA,CAAC,CAAC7H,MAAF,IAAYA,MAAZ;AACA8H,IAAAA,CAAC,CAAC9H,MAAF,IAAYA,MAAZ;AAEA6H,IAAAA,CAAC,CAAC5H,QAAF,IAAcA,QAAd;AACA6H,IAAAA,CAAC,CAAC7H,QAAF,IAAcA,QAAd;AAEA,WAAO,IAAP;AACD;;AAEDuW,EAAAA,OAAO,CAAC5W,GAAD,EAAM0W,IAAN,EAAY;AACjBvV,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,UAAMiI,CAAC,GAAG,IAAV;AACA,UAAMC,CAAC,GAAGlI,GAAV;AACA,UAAM2W,IAAI,GAAG,CAAED,IAAI,IAAI,EAAT,GAAgB,CAACA,IAAD,IAAS,EAA1B,IAAiC,CAA9C;AACA,UAAMG,KAAK,GAAIF,IAAI,GAAG,CAAR,GAAa,SAA3B;AACA,UAAMG,KAAK,GAAG,EAAEH,IAAI,GAAG,CAAT,IAAc,SAA5B;;AAEA1O,IAAAA,CAAC,CAACpH,MAAF,CAASqH,CAAC,CAAC9H,MAAX;;AAEA,SAAK,IAAIQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsH,CAAC,CAAC9H,MAAtB,EAA8BQ,CAAC,EAA/B,EACEqH,CAAC,CAAC9H,KAAF,CAAQS,CAAR,IAAcqH,CAAC,CAAC9H,KAAF,CAAQS,CAAR,IAAaiW,KAAd,GAAwB3O,CAAC,CAAC/H,KAAF,CAAQS,CAAR,IAAakW,KAAlD;;AAEF7O,IAAAA,CAAC,CAAC7H,MAAF,GAAY6H,CAAC,CAAC7H,MAAF,GAAWyW,KAAZ,GAAsB3O,CAAC,CAAC9H,MAAF,GAAW0W,KAA5C;AACA7O,IAAAA,CAAC,CAAC5H,QAAF,GAAc4H,CAAC,CAAC5H,QAAF,GAAawW,KAAd,GAAwB3O,CAAC,CAAC7H,QAAF,GAAayW,KAAlD;AAEA,WAAO,IAAP;AACD;;AAEDC,EAAAA,IAAI,CAAC/W,GAAD,EAAM0W,IAAN,EAAY;AACd,UAAMC,IAAI,GAAG,CAAED,IAAI,IAAI,EAAT,GAAgB,CAACA,IAAD,IAAS,EAA1B,IAAiC,CAA9C;AACA,UAAMG,KAAK,GAAIF,IAAI,GAAG,CAAR,GAAa,SAA3B;AACA,UAAMG,KAAK,GAAG,EAAEH,IAAI,GAAG,CAAT,IAAc,SAA5B;AACA,UAAM3T,GAAG,GAAIhD,GAAG,IAAI,EAAR,GAAc,CAA1B;AACA,UAAMoE,IAAI,GAAI,CAACpE,GAAG,GAAG,CAAP,KAAa,CAACgD,GAAD,GAAO,CAApB,CAAD,GAA2B,SAAxC;AAEA,SAAK7C,KAAL,CAAW,CAAX,IAAiB,KAAKA,KAAL,CAAW,CAAX,IAAgB0W,KAAjB,GAA2BzS,IAAI,GAAG0S,KAAlD;AACA,SAAK1W,MAAL,GAAe,KAAKA,MAAL,GAAcyW,KAAf,GAAyB,IAAIC,KAA3C;AACA,SAAKzW,QAAL,GAAiB,KAAKA,QAAL,GAAgBwW,KAAjB,GAA2B7T,GAAG,GAAG8T,KAAjD;AAEA,WAAO,IAAP;AACD;AAED;;;;;AAIAvM,EAAAA,QAAQ,GAAG;AACT,QAAIvK,GAAG,GAAG,KAAKG,KAAL,CAAW,CAAX,CAAV;;AAEA,QAAI,KAAKC,MAAL,KAAgB,CAApB,EAAuB;AACrBJ,MAAAA,GAAG,IAAI,KAAKG,KAAL,CAAW,CAAX,IAAgB,SAAvB;AACD,KAFD,MAEO,IAAI,KAAKC,MAAL,KAAgB,CAAhB,IAAqB,KAAKD,KAAL,CAAW,CAAX,MAAkB,IAA3C,EAAiD;AACtD;AACAH,MAAAA,GAAG,IAAI,mBAAoB,KAAKG,KAAL,CAAW,CAAX,IAAgB,SAA3C;AACD,KAHM,MAGA,IAAI,KAAKC,MAAL,GAAc,CAAlB,EAAqB;AAC1B,YAAM,IAAI6G,UAAJ,CAAe,6CAAf,CAAN;AACD;;AAED,WAAO,KAAK5G,QAAL,KAAkB,CAAlB,GAAsB,CAACL,GAAvB,GAA6BA,GAApC;AACD;;AAEDgX,EAAAA,QAAQ,GAAG;AACT,QAAIhX,GAAG,GAAG,CAAV;;AAEA,SAAK,IAAIY,CAAC,GAAG,KAAKR,MAAL,GAAc,CAA3B,EAA8BQ,CAAC,IAAI,CAAnC,EAAsCA,CAAC,EAAvC,EACEZ,GAAG,GAAIA,GAAG,GAAG,SAAP,GAAoB,KAAKG,KAAL,CAAWS,CAAX,CAA1B;;AAEF,WAAO,KAAKP,QAAL,KAAkB,CAAlB,GAAsB,CAACL,GAAvB,GAA6BA,GAApC;AACD;;AAEDiX,EAAAA,OAAO,GAAG;AACR,WAAO,KAAKD,QAAL,EAAP;AACD;;AAEDE,EAAAA,QAAQ,GAAG;AACT,QAAI,CAACtX,UAAL,EACE,MAAM,IAAI+N,KAAJ,CAAU,0BAAV,CAAN;AAEF,UAAMwJ,GAAG,GAAGtX,MAAM,CAAC,EAAD,CAAlB;AACA,UAAMuX,GAAG,GAAGvX,MAAM,CAAC,EAAD,CAAlB;AAEA,QAAIe,CAAC,GAAG,KAAKR,MAAL,GAAc,CAAtB;AACA,QAAIJ,GAAG,GAAGH,MAAM,CAAC,CAAD,CAAhB;;AAEA,WAAOe,CAAC,IAAI,CAAZ,EAAeA,CAAC,IAAI,CAApB,EAAuB;AACrB,YAAMuD,EAAE,GAAG,KAAKhE,KAAL,CAAWS,CAAX,IAAgB,SAA3B;AACA,YAAMsC,EAAE,GAAG,KAAK/C,KAAL,CAAWS,CAAC,GAAG,CAAf,CAAX;AAEAZ,MAAAA,GAAG,GAAIA,GAAG,IAAImX,GAAR,GAAetX,MAAM,CAACsE,EAAE,GAAGjB,EAAN,CAA3B;AACD;;AAED,QAAItC,CAAC,IAAI,CAAT,EACEZ,GAAG,GAAIA,GAAG,IAAIoX,GAAR,GAAevX,MAAM,CAAC,KAAKM,KAAL,CAAW,CAAX,CAAD,CAA3B;AAEF,WAAO,KAAKE,QAAL,KAAkB,CAAlB,GAAsB,CAACL,GAAvB,GAA6BA,GAApC;AACD;;AAEDqX,EAAAA,MAAM,GAAG;AACP,WAAO,CAAC,KAAKzT,MAAL,EAAR;AACD;;AAED4N,EAAAA,QAAQ,CAACvR,IAAD,EAAOqX,OAAP,EAAgB;AACtBrX,IAAAA,IAAI,GAAGsX,OAAO,CAACtX,IAAD,CAAd;AAEA,QAAIqX,OAAO,IAAI,IAAf,EACEA,OAAO,GAAG,CAAV;AAEF,QAAIA,OAAO,KAAK,CAAhB,EACEA,OAAO,GAAG,CAAV;AAEFnW,IAAAA,OAAO,CAAElB,IAAI,KAAK,CAAV,KAAiBA,IAAlB,EAAwB,MAAxB,EAAgC,QAAhC,CAAP;AACAkB,IAAAA,OAAO,CAAEmW,OAAO,KAAK,CAAb,KAAoBA,OAArB,EAA8B,SAA9B,EAAyC,QAAzC,CAAP;AAEA,QAAIrX,IAAI,GAAG,CAAP,IAAYA,IAAI,GAAG,EAAvB,EACE,MAAM,IAAIgH,UAAJ,CAAe,+BAAf,CAAN;;AAEF,SAAKiO,MAAL;;AAEA,QAAIjV,IAAI,KAAK,EAAb,EAAiB;AACf,UAAIqC,GAAG,GAAG,EAAV;AACA,UAAIkV,GAAG,GAAG,CAAV;AACA,UAAI7W,KAAK,GAAG,CAAZ;;AAEA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKR,MAAzB,EAAiCQ,CAAC,EAAlC,EAAsC;AACpC,cAAMqC,CAAC,GAAG,KAAK9C,KAAL,CAAWS,CAAX,CAAV;AACA,cAAMwD,IAAI,GAAG,CAAC,CAAEnB,CAAC,IAAIuU,GAAN,GAAa7W,KAAd,IAAuB,QAAxB,EAAkC6Q,QAAlC,CAA2C,EAA3C,CAAb;AAEA7Q,QAAAA,KAAK,GAAIsC,CAAC,KAAM,KAAKuU,GAAb,GAAqB,QAA7B;AAEA,YAAI7W,KAAK,KAAK,CAAV,IAAeC,CAAC,KAAK,KAAKR,MAAL,GAAc,CAAvC,EACEkC,GAAG,GAAG7D,KAAK,CAAC,IAAI2F,IAAI,CAAChE,MAAV,CAAL,GAAyBgE,IAAzB,GAAgC9B,GAAtC,CADF,KAGEA,GAAG,GAAG8B,IAAI,GAAG9B,GAAb;AAEFkV,QAAAA,GAAG,IAAI,CAAP;;AAEA,YAAIA,GAAG,IAAI,EAAX,EAAe;AACbA,UAAAA,GAAG,IAAI,EAAP;AACA5W,UAAAA,CAAC,IAAI,CAAL;AACD;AACF;;AAED,UAAID,KAAK,KAAK,CAAd,EACE2B,GAAG,GAAG3B,KAAK,CAAC6Q,QAAN,CAAe,EAAf,IAAqBlP,GAA3B;;AAEF,aAAOA,GAAG,CAAClC,MAAJ,GAAakX,OAAb,KAAyB,CAAhC,EACEhV,GAAG,GAAG,MAAMA,GAAZ;;AAEF,UAAI,KAAKjC,QAAL,KAAkB,CAAtB,EACEiC,GAAG,GAAG,MAAMA,GAAZ;AAEF,aAAOA,GAAP;AACD;;AAED,UAAMmV,SAAS,GAAG/Y,UAAU,CAACuB,IAAI,GAAG,CAAR,CAA5B;AACA,UAAMyX,SAAS,GAAG/Y,UAAU,CAACsB,IAAI,GAAG,CAAR,CAA5B;AACA,UAAM4K,CAAC,GAAG,KAAKjJ,KAAL,EAAV;AAEA,QAAIU,GAAG,GAAG,EAAV;AAEAuI,IAAAA,CAAC,CAACxK,QAAF,GAAa,CAAb;;AAEA,WAAO,CAACwK,CAAC,CAACjH,MAAF,EAAR,EAAoB;AAClB,YAAM9C,CAAC,GAAG+J,CAAC,CAACnF,KAAF,CAAQgS,SAAR,EAAmBlG,QAAnB,CAA4BvR,IAA5B,CAAV;AAEA4K,MAAAA,CAAC,CAACvF,KAAF,CAAQoS,SAAR;AAEA,UAAI,CAAC7M,CAAC,CAACjH,MAAF,EAAL,EACEtB,GAAG,GAAG7D,KAAK,CAACgZ,SAAS,GAAG3W,CAAC,CAACV,MAAf,CAAL,GAA8BU,CAA9B,GAAkCwB,GAAxC,CADF,KAGEA,GAAG,GAAGxB,CAAC,GAAGwB,GAAV;AACH;;AAED,QAAI,KAAKsB,MAAL,EAAJ,EACEtB,GAAG,GAAG,GAAN;;AAEF,WAAOA,GAAG,CAAClC,MAAJ,GAAakX,OAAb,KAAyB,CAAhC,EACEhV,GAAG,GAAG,MAAMA,GAAZ;;AAEF,QAAI,KAAKjC,QAAL,KAAkB,CAAtB,EACEiC,GAAG,GAAG,MAAMA,GAAZ;AAEF,WAAOA,GAAP;AACD;;AAEDqV,EAAAA,MAAM,GAAG;AACP,WAAO,KAAKnG,QAAL,CAAc,EAAd,EAAkB,CAAlB,CAAP;AACD;;AAEDoG,EAAAA,OAAO,CAAC1X,MAAD,EAASE,MAAT,EAAiB;AACtB,WAAO,KAAKyX,WAAL,CAAiB1U,KAAjB,EAAwBjD,MAAxB,EAAgCE,MAAhC,CAAP;AACD;;AAED0V,EAAAA,QAAQ,CAAC5V,MAAD,EAASE,MAAT,EAAiB;AACvB,WAAO,KAAKyX,WAAL,CAAiBC,MAAjB,EAAyB5X,MAAzB,EAAiCE,MAAjC,CAAP;AACD;;AAEDyX,EAAAA,WAAW,CAACE,SAAD,EAAY7X,MAAZ,EAAoBE,MAApB,EAA4B;AACrC,QAAIF,MAAM,IAAI,IAAd,EACEA,MAAM,GAAG,IAAT;AAEF,QAAIE,MAAM,IAAI,IAAd,EACEA,MAAM,GAAG,CAAT;AAEFe,IAAAA,OAAO,CAAC,OAAO4W,SAAP,KAAqB,UAAtB,EAAkC,WAAlC,EAA+C,UAA/C,CAAP;AACA5W,IAAAA,OAAO,CAACjB,MAAM,KAAK,IAAX,IAAmBA,MAAM,KAAK,IAA/B,EAAqC,QAArC,EAA+C,YAA/C,CAAP;AACAiB,IAAAA,OAAO,CAAEf,MAAM,KAAK,CAAZ,KAAmBA,MAApB,EAA4B,QAA5B,EAAsC,QAAtC,CAAP;;AAEA,SAAK8U,MAAL;;AAEA,UAAM8C,KAAK,GAAG,KAAKjC,UAAL,EAAd;AACA,UAAMf,IAAI,GAAG5U,MAAM,IAAIY,IAAI,CAACC,GAAL,CAAS,CAAT,EAAY+W,KAAZ,CAAvB;AAEA,QAAIA,KAAK,GAAGhD,IAAZ,EACE,MAAM,IAAI/N,UAAJ,CAAe,wCAAf,CAAN;AAEF,UAAMsF,GAAG,GAAG0L,QAAQ,CAACF,SAAD,EAAY/C,IAAZ,CAApB,CAnBqC,CAqBrC;;AACA,QAAI9U,MAAM,KAAK,IAAf,EAAqB;AACnB,UAAIgM,GAAG,GAAGK,GAAG,CAACnM,MAAJ,GAAa,CAAvB;AACA,UAAIO,KAAK,GAAG,CAAZ;;AAEA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKR,MAAzB,EAAiCQ,CAAC,EAAlC,EAAsC;AACpC,cAAMyD,KAAK,GAAG,CAACzD,CAAC,GAAG,CAAL,KAAW,CAAzB;AACA,cAAMwD,IAAI,GAAI,KAAKjE,KAAL,CAAWS,CAAX,KAAiByD,KAAlB,GAA2B1D,KAAxC;AAEA4L,QAAAA,GAAG,CAACL,GAAG,EAAJ,CAAH,GAAa9H,IAAI,GAAG,IAApB;AAEA,YAAI8H,GAAG,IAAI,CAAX,EACEK,GAAG,CAACL,GAAG,EAAJ,CAAH,GAAc9H,IAAI,KAAK,CAAV,GAAe,IAA5B;AAEF,YAAI8H,GAAG,IAAI,CAAX,EACEK,GAAG,CAACL,GAAG,EAAJ,CAAH,GAAc9H,IAAI,KAAK,EAAV,GAAgB,IAA7B;;AAEF,YAAIC,KAAK,KAAK,CAAd,EAAiB;AACf,cAAI6H,GAAG,IAAI,CAAX,EACEK,GAAG,CAACL,GAAG,EAAJ,CAAH,GAAc9H,IAAI,KAAK,EAAV,GAAgB,IAA7B;AAEFzD,UAAAA,KAAK,GAAG,CAAR;AACD,SALD,MAKO;AACLA,UAAAA,KAAK,GAAGyD,IAAI,KAAK,EAAjB;AACD;AACF;;AAED,UAAI8H,GAAG,IAAI,CAAX,EAAc;AACZK,QAAAA,GAAG,CAACL,GAAG,EAAJ,CAAH,GAAavL,KAAb;;AAEA,eAAOuL,GAAG,IAAI,CAAd,EACEK,GAAG,CAACL,GAAG,EAAJ,CAAH,GAAa,CAAb;;AAEFvL,QAAAA,KAAK,GAAG,CAAR;AACD;;AAEDmB,MAAAA,MAAM,CAACnB,KAAK,KAAK,CAAX,CAAN;AACD,KApCD,MAoCO;AACL,UAAIuL,GAAG,GAAG,CAAV;AACA,UAAIvL,KAAK,GAAG,CAAZ;;AAEA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKR,MAAzB,EAAiCQ,CAAC,EAAlC,EAAsC;AACpC,cAAMyD,KAAK,GAAG,CAACzD,CAAC,GAAG,CAAL,KAAW,CAAzB;AACA,cAAMwD,IAAI,GAAI,KAAKjE,KAAL,CAAWS,CAAX,KAAiByD,KAAlB,GAA2B1D,KAAxC;AAEA4L,QAAAA,GAAG,CAACL,GAAG,EAAJ,CAAH,GAAa9H,IAAI,GAAG,IAApB;AAEA,YAAI8H,GAAG,GAAGK,GAAG,CAACnM,MAAd,EACEmM,GAAG,CAACL,GAAG,EAAJ,CAAH,GAAc9H,IAAI,KAAK,CAAV,GAAe,IAA5B;AAEF,YAAI8H,GAAG,GAAGK,GAAG,CAACnM,MAAd,EACEmM,GAAG,CAACL,GAAG,EAAJ,CAAH,GAAc9H,IAAI,KAAK,EAAV,GAAgB,IAA7B;;AAEF,YAAIC,KAAK,KAAK,CAAd,EAAiB;AACf,cAAI6H,GAAG,GAAGK,GAAG,CAACnM,MAAd,EACEmM,GAAG,CAACL,GAAG,EAAJ,CAAH,GAAc9H,IAAI,KAAK,EAAV,GAAgB,IAA7B;AAEFzD,UAAAA,KAAK,GAAG,CAAR;AACD,SALD,MAKO;AACLA,UAAAA,KAAK,GAAGyD,IAAI,KAAK,EAAjB;AACD;AACF;;AAED,UAAI8H,GAAG,GAAGK,GAAG,CAACnM,MAAd,EAAsB;AACpBmM,QAAAA,GAAG,CAACL,GAAG,EAAJ,CAAH,GAAavL,KAAb;;AAEA,eAAOuL,GAAG,GAAGK,GAAG,CAACnM,MAAjB,EACEmM,GAAG,CAACL,GAAG,EAAJ,CAAH,GAAa,CAAb;;AAEFvL,QAAAA,KAAK,GAAG,CAAR;AACD;;AAEDmB,MAAAA,MAAM,CAACnB,KAAK,KAAK,CAAX,CAAN;AACD;;AAED,WAAO4L,GAAP;AACD;;AAED2L,EAAAA,MAAM,CAAChY,MAAD,EAASE,MAAT,EAAiB;AACrB,WAAO,KAAK0V,QAAL,CAAc5V,MAAd,EAAsBE,MAAtB,CAAP;AACD;AAED;;;;;AAIA+X,EAAAA,EAAE,CAACnY,GAAD,EAAME,MAAN,EAAc;AACd,WAAO,KAAKwV,UAAL,CAAgB1V,GAAhB,EAAqBE,MAArB,CAAP;AACD;;AAEDwV,EAAAA,UAAU,CAAC1V,GAAD,EAAME,MAAN,EAAc;AACtB,QAAIA,MAAM,IAAI,IAAd,EACEA,MAAM,GAAG,IAAT;AAEFiB,IAAAA,OAAO,CAACiX,SAAS,CAACpY,GAAD,CAAV,EAAiB,KAAjB,EAAwB,SAAxB,CAAP;AACAmB,IAAAA,OAAO,CAACjB,MAAM,KAAK,IAAX,IAAmBA,MAAM,KAAK,IAA/B,EAAqC,QAArC,EAA+C,YAA/C,CAAP;AAEA,UAAM8C,GAAG,GAAIhD,GAAG,GAAG,CAAP,GAAY,CAAxB;AAEA,QAAIgD,GAAJ,EACEhD,GAAG,GAAG,CAACA,GAAP;;AAEF,QAAIA,GAAG,GAAG,SAAV,EAAqB;AACnB,WAAKG,KAAL,CAAW,CAAX,IAAgBH,GAAG,GAAG,SAAtB;AACA,WAAKI,MAAL,GAAc,CAAd;AACD,KAHD,MAGO,IAAIJ,GAAG,GAAG,gBAAV,EAA4B;AACjC,WAAKG,KAAL,GAAa,CACXH,GAAG,GAAG,SADK,EAEVA,GAAG,GAAG,SAAP,GAAoB,SAFT,CAAb;AAIA,WAAKI,MAAL,GAAc,CAAd;AACD,KANM,MAMA;AACL,WAAKD,KAAL,GAAa,CACXH,GAAG,GAAG,SADK,EAEVA,GAAG,GAAG,SAAP,GAAoB,SAFT,EAGX,CAHW,CAAb;AAKA,WAAKI,MAAL,GAAc,CAAd;AACD;;AAED,SAAKC,QAAL,GAAgB2C,GAAhB;AAEA,QAAI9C,MAAM,KAAK,IAAf,EACE,KAAK0V,OAAL;AAEF,WAAO,IAAP;AACD;;AAEDyC,EAAAA,UAAU,CAACrY,GAAD,EAAME,MAAN,EAAc;AACtB,QAAIA,MAAM,IAAI,IAAd,EACEA,MAAM,GAAG,IAAT;AAEFiB,IAAAA,OAAO,CAAC,OAAOnB,GAAP,KAAe,QAAhB,EAA0B,KAA1B,EAAiC,QAAjC,CAAP;AACAmB,IAAAA,OAAO,CAACjB,MAAM,KAAK,IAAX,IAAmBA,MAAM,KAAK,IAA/B,EAAqC,QAArC,EAA+C,YAA/C,CAAP;AAEA,QAAI,CAACoY,QAAQ,CAACtY,GAAD,CAAb,EACEA,GAAG,GAAG,CAAN;AAEF,UAAMgD,GAAG,GAAIhD,GAAG,IAAI,CAAC,CAAT,GAAc,CAA1B;AAEA,QAAIA,GAAG,GAAG,CAAV,EACEA,GAAG,GAAG,CAACA,GAAP;AAEFA,IAAAA,GAAG,GAAGgB,IAAI,CAACuX,KAAL,CAAWvY,GAAX,CAAN;AAEA,SAAKG,KAAL,GAAa,EAAb;;AAEA,WAAOH,GAAG,GAAG,CAAb,EAAgB;AACd,YAAMkD,EAAE,GAAGlD,GAAG,GAAG,SAAjB;AACA,YAAMmE,EAAE,GAAG,CAACnE,GAAG,GAAGkD,EAAP,IAAa,SAAxB;AAEA,WAAK/C,KAAL,CAAW8U,IAAX,CAAgB/R,EAAhB;AAEAlD,MAAAA,GAAG,GAAGmE,EAAN;AACD;;AAED,QAAI,KAAKhE,KAAL,CAAWC,MAAX,KAAsB,CAA1B,EACE,KAAKD,KAAL,CAAW8U,IAAX,CAAgB,CAAhB;AAEF,SAAK7U,MAAL,GAAc,KAAKD,KAAL,CAAWC,MAAzB;AACA,SAAKC,QAAL,GAAgB2C,GAAhB;AAEA,QAAI9C,MAAM,KAAK,IAAf,EACE,KAAK0V,OAAL;AAEF,WAAO,IAAP;AACD;;AAED4C,EAAAA,UAAU,CAACxY,GAAD,EAAME,MAAN,EAAc;AACtB,QAAIA,MAAM,IAAI,IAAd,EACEA,MAAM,GAAG,IAAT;AAEFiB,IAAAA,OAAO,CAAC,OAAOnB,GAAP,KAAe,QAAhB,EAA0B,KAA1B,EAAiC,QAAjC,CAAP;AACAmB,IAAAA,OAAO,CAACjB,MAAM,KAAK,IAAX,IAAmBA,MAAM,KAAK,IAA/B,EAAqC,QAArC,EAA+C,YAA/C,CAAP;AAEA,QAAI,CAACN,UAAL,EACE,MAAM,IAAI+N,KAAJ,CAAU,0BAAV,CAAN,CARoB,CAUtB;AACA;AACA;;AACA,UAAM8K,KAAK,GAAIzY,GAAG,GAAGH,MAAM,CAAC,CAAD,CAAb,GAAoB,CAAlC;;AAEA,SAAK6Y,QAAL,CAAc1Y,GAAG,CAACwR,QAAJ,CAAa,EAAb,CAAd,EAAgCiH,KAAhC;;AACA,SAAKpY,QAAL,GAAgBoY,KAAhB;AAEA,QAAIvY,MAAM,KAAK,IAAf,EACE,KAAK0V,OAAL;AAEF,WAAO,IAAP;AACD;;AAED+C,EAAAA,QAAQ,CAACC,KAAD,EAAQ;AACdzX,IAAAA,OAAO,CAAC,OAAOyX,KAAP,KAAiB,SAAlB,EAA6B,OAA7B,EAAsC,SAAtC,CAAP;AAEA,SAAKzY,KAAL,CAAW,CAAX,IAAgByY,KAAK,GAAG,CAAxB;AACA,SAAKxY,MAAL,GAAc,CAAd;AACA,SAAKC,QAAL,GAAgB,CAAhB;AAEA,WAAO,IAAP;AACD;;AAEDwY,EAAAA,UAAU,CAACC,GAAD,EAAM7Y,IAAN,EAAYC,MAAZ,EAAoB;AAC5B,QAAID,IAAI,KAAK,IAAT,IAAiBA,IAAI,KAAK,IAA9B,EACE,CAACA,IAAD,EAAOC,MAAP,IAAiB,CAACA,MAAD,EAASD,IAAT,CAAjB;AAEFA,IAAAA,IAAI,GAAGsX,OAAO,CAACtX,IAAD,CAAd;AAEA,QAAIC,MAAM,IAAI,IAAd,EACEA,MAAM,GAAG,IAAT;AAEFiB,IAAAA,OAAO,CAAC,OAAO2X,GAAP,KAAe,QAAhB,EAA0B,QAA1B,EAAoC,QAApC,CAAP;AACA3X,IAAAA,OAAO,CAAElB,IAAI,KAAK,CAAV,KAAiBA,IAAlB,EAAwB,MAAxB,EAAgC,QAAhC,CAAP;AACAkB,IAAAA,OAAO,CAACjB,MAAM,KAAK,IAAX,IAAmBA,MAAM,KAAK,IAA/B,EAAqC,QAArC,EAA+C,YAA/C,CAAP;AAEA,QAAID,IAAI,GAAG,CAAP,IAAYA,IAAI,GAAG,EAAvB,EACE,MAAM,IAAI0N,KAAJ,CAAU,+BAAV,CAAN;AAEFmL,IAAAA,GAAG,GAAGA,GAAG,CAACC,OAAJ,CAAY,MAAZ,EAAoB,EAApB,CAAN;AAEA,QAAIN,KAAK,GAAG,CAAZ;AAEA,QAAIK,GAAG,CAAC1Y,MAAJ,GAAa,CAAb,IAAkB0Y,GAAG,CAACE,UAAJ,CAAe,CAAf,MAAsB,IAA5C,EACEP,KAAK,GAAG,CAAR;AAEF,QAAIxY,IAAI,KAAK,EAAb,EACE,KAAKyY,QAAL,CAAcI,GAAd,EAAmBL,KAAnB,EADF,KAGE,KAAKQ,SAAL,CAAeH,GAAf,EAAoB7Y,IAApB,EAA0BwY,KAA1B;AAEF,SAAKpY,QAAL,GAAgBoY,KAAhB;;AAEA,SAAKzW,UAAL;;AAEA,QAAI9B,MAAM,KAAK,IAAf,EACE,KAAK0V,OAAL;AAEF,WAAO,IAAP;AACD;;AAED8C,EAAAA,QAAQ,CAACI,GAAD,EAAML,KAAN,EAAa;AACnB,SAAKrY,MAAL,GAAcY,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYD,IAAI,CAACmJ,IAAL,CAAU,CAAC2O,GAAG,CAAC1Y,MAAJ,GAAaqY,KAAd,IAAuB,CAAjC,CAAZ,CAAd;AACA,SAAKtY,KAAL,GAAa,IAAIgD,KAAJ,CAAU,KAAK/C,MAAf,CAAb;;AAEA,SAAK,IAAIQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKR,MAAzB,EAAiCQ,CAAC,EAAlC,EACE,KAAKT,KAAL,CAAWS,CAAX,IAAgB,CAAhB,CALiB,CAOnB;;;AACA,QAAI4W,GAAG,GAAG,CAAV;AACA,QAAI5W,CAAC,GAAGkY,GAAG,CAAC1Y,MAAJ,GAAa,CAArB;AACA,QAAIuE,CAAC,GAAG,CAAR;;AAEA,WAAO/D,CAAC,IAAI6X,KAAZ,EAAmB7X,CAAC,IAAI,CAAxB,EAA2B;AACzB,YAAMqC,CAAC,GAAGiW,QAAQ,CAACJ,GAAD,EAAMlY,CAAN,EAASA,CAAC,GAAG,CAAb,CAAlB;AAEA,WAAKT,KAAL,CAAWwE,CAAX,KAAkB1B,CAAC,IAAIuU,GAAN,GAAa,SAA9B,CAHyB,CAKzB;;AACA,WAAKrX,KAAL,CAAWwE,CAAC,GAAG,CAAf,KAAsB1B,CAAC,KAAM,KAAKuU,GAAb,GAAqB,QAA1C;AAEAA,MAAAA,GAAG,IAAI,EAAP;;AAEA,UAAIA,GAAG,IAAI,EAAX,EAAe;AACbA,QAAAA,GAAG,IAAI,EAAP;AACA7S,QAAAA,CAAC,IAAI,CAAL;AACD;AACF;;AAED,QAAI/D,CAAC,GAAG,CAAJ,KAAU6X,KAAd,EAAqB;AACnB,YAAMxV,CAAC,GAAGiW,QAAQ,CAACJ,GAAD,EAAML,KAAN,EAAa7X,CAAC,GAAG,CAAjB,CAAlB;AAEA,WAAKT,KAAL,CAAWwE,CAAX,KAAkB1B,CAAC,IAAIuU,GAAN,GAAa,SAA9B;AACA,WAAKrX,KAAL,CAAWwE,CAAC,GAAG,CAAf,KAAsB1B,CAAC,KAAM,KAAKuU,GAAb,GAAqB,QAA1C;AACD;;AAED,WAAO,KAAKzV,MAAL,EAAP;AACD;;AAEDkX,EAAAA,SAAS,CAACH,GAAD,EAAM7Y,IAAN,EAAYwY,KAAZ,EAAmB;AAC1B;AACA,SAAKtY,KAAL,CAAW,CAAX,IAAgB,CAAhB;AACA,SAAKC,MAAL,GAAc,CAAd;AACA,SAAKC,QAAL,GAAgB,CAAhB,CAJ0B,CAM1B;;AACA,QAAI8Y,OAAO,GAAG,CAAd;AACA,QAAIC,OAAO,GAAG,CAAd;;AAEA,WAAOA,OAAO,IAAI,SAAlB,EAA6BA,OAAO,IAAInZ,IAAxC,EACEkZ,OAAO,IAAI,CAAX;;AAEFA,IAAAA,OAAO,IAAI,CAAX;AACAC,IAAAA,OAAO,GAAIA,OAAO,GAAGnZ,IAAX,GAAmB,CAA7B;AAEA,UAAMoZ,KAAK,GAAGP,GAAG,CAAC1Y,MAAJ,GAAaqY,KAA3B;AACA,UAAMtS,GAAG,GAAGkT,KAAK,GAAGF,OAApB;AACA,UAAMG,GAAG,GAAGtY,IAAI,CAACgE,GAAL,CAASqU,KAAT,EAAgBA,KAAK,GAAGlT,GAAxB,IAA+BsS,KAA3C;AAEA,QAAI7X,CAAC,GAAG6X,KAAR;;AAEA,WAAO7X,CAAC,GAAG0Y,GAAX,EAAgB1Y,CAAC,IAAIuY,OAArB,EAA8B;AAC5B,YAAM/U,IAAI,GAAGmV,SAAS,CAACT,GAAD,EAAMlY,CAAN,EAASA,CAAC,GAAGuY,OAAb,EAAsBlZ,IAAtB,CAAtB;AAEA,WAAK8C,KAAL,CAAWqW,OAAX;;AACA,WAAKrY,MAAL,CAAYqD,IAAZ;AACD;;AAED,QAAI+B,GAAG,KAAK,CAAZ,EAAe;AACb,YAAMQ,GAAG,GAAG3F,IAAI,CAAC2F,GAAL,CAAS1G,IAAT,EAAekG,GAAf,CAAZ;AACA,YAAM/B,IAAI,GAAGmV,SAAS,CAACT,GAAD,EAAMlY,CAAN,EAASkY,GAAG,CAAC1Y,MAAb,EAAqBH,IAArB,CAAtB;AAEA,WAAK8C,KAAL,CAAW4D,GAAX;;AACA,WAAK5F,MAAL,CAAYqD,IAAZ;AACD;;AAED,WAAO,IAAP;AACD;;AAEDoV,EAAAA,QAAQ,CAACC,IAAD,EAAO;AACb,QAAI3Z,EAAE,CAACsB,IAAH,CAAQqY,IAAR,CAAJ,EAAmB;AACjB,UAAIA,IAAI,CAACnZ,GAAT,EACE,OAAOmZ,IAAI,CAAChK,OAAL,EAAP;AAEF,aAAOgK,IAAI,CAAC7X,KAAL,EAAP;AACD;;AAED,QAAIuB,KAAK,CAACuW,OAAN,CAAcD,IAAd,CAAJ,EAAyB;AACvB,WAAK,MAAME,KAAX,IAAoBF,IAApB,EACEtY,OAAO,CAAC,OAAOwY,KAAP,KAAiB,QAAlB,EAA4B,OAA5B,EAAqC,QAArC,CAAP;;AAEFF,MAAAA,IAAI,GAAGA,IAAI,CAACG,IAAL,CAAU,EAAV,CAAP;AACD;;AAED,WAAO,KAAKf,UAAL,CAAgBY,IAAhB,EAAsB,EAAtB,CAAP;AACD;;AAEDI,EAAAA,MAAM,CAAC7Z,GAAD,EAAM;AACV,WAAO,KAAKwV,MAAL,CAAYxV,GAAZ,CAAP;AACD;;AAED8Z,EAAAA,SAAS,CAACC,IAAD,EAAO7Z,MAAP,EAAe;AACtBiB,IAAAA,OAAO,CAACgC,KAAK,CAACuW,OAAN,CAAcK,IAAd,CAAD,EAAsB,MAAtB,EAA8B,OAA9B,CAAP;AACA,WAAO,KAAKC,aAAL,CAAmBD,IAAnB,EAAyB7Z,MAAzB,CAAP;AACD;;AAED2V,EAAAA,UAAU,CAACkE,IAAD,EAAO7Z,MAAP,EAAe;AACvBiB,IAAAA,OAAO,CAAC2W,MAAM,CAACmC,QAAP,CAAgBF,IAAhB,CAAD,EAAwB,MAAxB,EAAgC,QAAhC,CAAP;AACA,WAAO,KAAKC,aAAL,CAAmBD,IAAnB,EAAyB7Z,MAAzB,CAAP;AACD;;AAED8Z,EAAAA,aAAa,CAACD,IAAD,EAAO7Z,MAAP,EAAe;AAC1B,QAAIA,MAAM,IAAI,IAAd,EACEA,MAAM,GAAG,IAAT;AAEFiB,IAAAA,OAAO,CAAC4Y,IAAI,IAAKA,IAAI,CAAC3Z,MAAL,KAAgB,CAAjB,KAAwB2Z,IAAI,CAAC3Z,MAAtC,EAA8C,MAA9C,EAAsD,YAAtD,CAAP;AACAe,IAAAA,OAAO,CAACjB,MAAM,KAAK,IAAX,IAAmBA,MAAM,KAAK,IAA/B,EAAqC,QAArC,EAA+C,YAA/C,CAAP;;AAEA,QAAI6Z,IAAI,CAAC3Z,MAAL,KAAgB,CAApB,EAAuB;AACrB,WAAKD,KAAL,CAAW,CAAX,IAAgB,CAAhB;AACA,WAAKC,MAAL,GAAc,CAAd;AACA,WAAKC,QAAL,GAAgB,CAAhB;AACA,aAAO,IAAP;AACD;;AAED,SAAKD,MAAL,GAAcY,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYD,IAAI,CAACmJ,IAAL,CAAU4P,IAAI,CAAC3Z,MAAL,GAAc,CAAxB,CAAZ,CAAd;AACA,SAAKD,KAAL,GAAa,IAAIgD,KAAJ,CAAU,KAAK/C,MAAf,CAAb;AACA,SAAKC,QAAL,GAAgB,CAAhB;;AAEA,SAAK,IAAIO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKR,MAAzB,EAAiCQ,CAAC,EAAlC,EACE,KAAKT,KAAL,CAAWS,CAAX,IAAgB,CAAhB;;AAEF,UAAMsZ,IAAI,GAAGH,IAAI,CAAC3Z,MAAL,GAAc,CAA3B;AAEA,QAAIoX,GAAG,GAAG,CAAV;AACA,QAAI7S,CAAC,GAAG,CAAR;AACA,QAAI1B,CAAC,GAAG,CAAR;;AAEA,QAAI/C,MAAM,KAAK,IAAf,EAAqB;AACnB,WAAK,IAAIU,CAAC,GAAGmZ,IAAI,CAAC3Z,MAAL,GAAc,CAA3B,EAA8BQ,CAAC,IAAI,CAAnC,EAAsCA,CAAC,IAAI,CAA3C,EAA8C;AAC5C,cAAMqC,CAAC,GAAG8W,IAAI,CAACnZ,CAAD,CAAJ,GAAWmZ,IAAI,CAACnZ,CAAC,GAAG,CAAL,CAAJ,IAAe,CAA1B,GAAgCmZ,IAAI,CAACnZ,CAAC,GAAG,CAAL,CAAJ,IAAe,EAAzD;AAEA,aAAKT,KAAL,CAAWwE,CAAX,KAAkB1B,CAAC,IAAIuU,GAAN,GAAa,SAA9B;AACA,aAAKrX,KAAL,CAAWwE,CAAC,GAAG,CAAf,IAAqB1B,CAAC,KAAM,KAAKuU,GAAb,GAAqB,SAAzC;AAEAA,QAAAA,GAAG,IAAI,EAAP;;AAEA,YAAIA,GAAG,IAAI,EAAX,EAAe;AACbA,UAAAA,GAAG,IAAI,EAAP;AACA7S,UAAAA,CAAC,IAAI,CAAL;AACD;AACF;;AAED,cAAQuV,IAAR;AACE,aAAK,CAAL;AACEjX,UAAAA,CAAC,GAAG8W,IAAI,CAAC,CAAD,CAAJ,GAAWA,IAAI,CAAC,CAAD,CAAJ,IAAW,CAA1B;AACA;;AACF,aAAK,CAAL;AACE9W,UAAAA,CAAC,GAAG8W,IAAI,CAAC,CAAD,CAAR;AACA;AANJ;AAQD,KAvBD,MAuBO;AACL,YAAMvX,GAAG,GAAGuX,IAAI,CAAC3Z,MAAL,GAAc8Z,IAA1B;;AAEA,WAAK,IAAItZ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4B,GAApB,EAAyB5B,CAAC,IAAI,CAA9B,EAAiC;AAC/B,cAAMqC,CAAC,GAAG8W,IAAI,CAACnZ,CAAD,CAAJ,GAAWmZ,IAAI,CAACnZ,CAAC,GAAG,CAAL,CAAJ,IAAe,CAA1B,GAAgCmZ,IAAI,CAACnZ,CAAC,GAAG,CAAL,CAAJ,IAAe,EAAzD;AAEA,aAAKT,KAAL,CAAWwE,CAAX,KAAkB1B,CAAC,IAAIuU,GAAN,GAAa,SAA9B;AACA,aAAKrX,KAAL,CAAWwE,CAAC,GAAG,CAAf,IAAqB1B,CAAC,KAAM,KAAKuU,GAAb,GAAqB,SAAzC;AAEAA,QAAAA,GAAG,IAAI,EAAP;;AAEA,YAAIA,GAAG,IAAI,EAAX,EAAe;AACbA,UAAAA,GAAG,IAAI,EAAP;AACA7S,UAAAA,CAAC,IAAI,CAAL;AACD;AACF;;AAED,cAAQuV,IAAR;AACE,aAAK,CAAL;AACEjX,UAAAA,CAAC,GAAG8W,IAAI,CAACvX,GAAD,CAAJ,GAAauX,IAAI,CAACvX,GAAG,GAAG,CAAP,CAAJ,IAAiB,CAAlC;AACA;;AACF,aAAK,CAAL;AACES,UAAAA,CAAC,GAAG8W,IAAI,CAACvX,GAAD,CAAR;AACA;AANJ;AAQD;;AAED,QAAI0X,IAAI,GAAG,CAAX,EAAc;AACZ,WAAK/Z,KAAL,CAAWwE,CAAX,KAAkB1B,CAAC,IAAIuU,GAAN,GAAa,SAA9B;AACA,WAAKrX,KAAL,CAAWwE,CAAC,GAAG,CAAf,IAAqB1B,CAAC,KAAM,KAAKuU,GAAb,GAAqB,SAAzC;AACD;;AAED,WAAO,KAAKzV,MAAL,EAAP;AACD;;AAEDoY,EAAAA,MAAM,CAACJ,IAAD,EAAO7Z,MAAP,EAAe;AACnB,WAAO,KAAK2V,UAAL,CAAgBkE,IAAhB,EAAsB7Z,MAAtB,CAAP;AACD;;AAEDK,EAAAA,IAAI,CAACP,GAAD,EAAMC,IAAN,EAAYC,MAAZ,EAAoB;AACtB,QAAIF,GAAG,IAAI,IAAX,EACE,OAAO,IAAP;AAEF,QAAIC,IAAI,KAAK,IAAT,IAAiBA,IAAI,KAAK,IAA9B,EACE,CAACA,IAAD,EAAOC,MAAP,IAAiB,CAACA,MAAD,EAASD,IAAT,CAAjB;AAEF,QAAI,OAAOD,GAAP,KAAe,QAAnB,EACE,OAAO,KAAK0V,UAAL,CAAgB1V,GAAhB,EAAqBE,MAArB,CAAP;AAEF,QAAI,OAAOF,GAAP,KAAe,QAAnB,EACE,OAAO,KAAKwY,UAAL,CAAgBxY,GAAhB,EAAqBE,MAArB,CAAP;AAEF,QAAI,OAAOF,GAAP,KAAe,QAAnB,EACE,OAAO,KAAK6Y,UAAL,CAAgB7Y,GAAhB,EAAqBC,IAArB,EAA2BC,MAA3B,CAAP;;AAEF,QAAI,OAAOF,GAAP,KAAe,QAAnB,EAA6B;AAC3B,UAAIF,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAJ,EACE,OAAO,KAAK6Z,MAAL,CAAY7Z,GAAZ,EAAiBE,MAAjB,CAAP;AAEF,UAAKF,GAAG,CAACI,MAAJ,KAAe,CAAhB,KAAuBJ,GAAG,CAACI,MAA/B,EACE,OAAO,KAAK4Z,aAAL,CAAmBha,GAAnB,EAAwBE,MAAxB,CAAP;AACH;;AAED,QAAI,OAAOF,GAAP,KAAe,SAAnB,EACE,OAAO,KAAK2Y,QAAL,CAAc3Y,GAAd,CAAP;AAEF,UAAM,IAAIoa,SAAJ,CAAc,kCAAd,CAAN;AACD;AAED;;;;;AAIA,SAAOpV,GAAP,CAAW,GAAGqV,IAAd,EAAoB;AAClB,QAAIrV,GAAG,GAAG,IAAV;;AAEA,SAAK,MAAMhF,GAAX,IAAkBqa,IAAlB,EAAwB;AACtBlZ,MAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,UAAI,CAACgF,GAAD,IAAQhF,GAAG,CAACqB,GAAJ,CAAQ2D,GAAR,IAAe,CAA3B,EACEA,GAAG,GAAGhF,GAAN;AACH;;AAED,WAAOgF,GAAG,IAAI,IAAIlF,EAAJ,CAAO,CAAP,CAAd;AACD;;AAED,SAAOmB,GAAP,CAAW,GAAGoZ,IAAd,EAAoB;AAClB,QAAIpZ,GAAG,GAAG,IAAV;;AAEA,SAAK,MAAMjB,GAAX,IAAkBqa,IAAlB,EAAwB;AACtBlZ,MAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AAEA,UAAI,CAACiB,GAAD,IAAQjB,GAAG,CAACqB,GAAJ,CAAQJ,GAAR,IAAe,CAA3B,EACEA,GAAG,GAAGjB,GAAN;AACH;;AAED,WAAOiB,GAAG,IAAI,IAAInB,EAAJ,CAAO,CAAP,CAAd;AACD;;AAED,SAAOuB,GAAP,CAAWZ,CAAX,EAAcC,CAAd,EAAiB;AACfS,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQX,CAAR,CAAD,EAAa,GAAb,EAAkB,QAAlB,CAAP;AACA,WAAOA,CAAC,CAACY,GAAF,CAAMX,CAAN,CAAP;AACD;;AAED,SAAOY,IAAP,CAAYb,CAAZ,EAAeC,CAAf,EAAkB;AAChBS,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQX,CAAR,CAAD,EAAa,GAAb,EAAkB,QAAlB,CAAP;AACA,WAAOA,CAAC,CAACa,IAAF,CAAOZ,CAAP,CAAP;AACD;;AAED,SAAOJ,GAAP,CAAWN,GAAX,EAAgB;AACd,WAAO,IAAI6R,GAAJ,CAAQ7R,GAAR,CAAP;AACD;;AAED,SAAOsa,OAAP,CAAeta,GAAf,EAAoB;AAClB,WAAO,IAAIua,OAAJ,CAAYva,GAAZ,CAAP;AACD;;AAED,SAAOuN,IAAP,CAAYvN,GAAZ,EAAiB;AACf,WAAO,IAAIwa,IAAJ,CAASxa,GAAT,CAAP;AACD;;AAED,SAAOya,MAAP,CAAcC,IAAd,EAAoB;AAClB,QAAI9b,MAAM,CAAC8b,IAAD,CAAV,EACE,OAAO9b,MAAM,CAAC8b,IAAD,CAAb;AAEF,QAAIC,KAAJ;AAEA,QAAID,IAAI,KAAK,MAAb,EACEC,KAAK,GAAG,IAAIC,IAAJ,EAAR,CADF,KAEK,IAAIF,IAAI,KAAK,MAAb,EACHC,KAAK,GAAG,IAAIE,IAAJ,EAAR,CADG,KAEA,IAAIH,IAAI,KAAK,MAAb,EACHC,KAAK,GAAG,IAAIG,IAAJ,EAAR,CADG,KAEA,IAAIJ,IAAI,KAAK,MAAb,EACHC,KAAK,GAAG,IAAII,IAAJ,EAAR,CADG,KAEA,IAAIL,IAAI,KAAK,QAAb,EACHC,KAAK,GAAG,IAAIK,MAAJ,EAAR,CADG,KAEA,IAAIN,IAAI,KAAK,MAAb,EACHC,KAAK,GAAG,IAAIM,IAAJ,EAAR,CADG,KAGH,MAAM,IAAItN,KAAJ,CAAW,mBAAkB+M,IAAK,IAAlC,CAAN;AAEF9b,IAAAA,MAAM,CAAC8b,IAAD,CAAN,GAAeC,KAAf;AAEA,WAAOA,KAAP;AACD;;AAED,SAAOA,KAAP,CAAaD,IAAb,EAAmB;AACjB,WAAO5a,EAAE,CAAC2a,MAAH,CAAUC,IAAV,EAAgB/U,CAAhB,CAAkB/D,KAAlB,EAAP;AACD;;AAED,SAAO+E,GAAP,CAAW3G,GAAX,EAAgBkb,GAAhB,EAAqB;AACnB,QAAIlb,GAAG,KAAK,CAAZ,EACE,OAAOF,EAAE,CAACuE,KAAH,CAAS,CAAT,EAAY6W,GAAZ,CAAP;AAEF,WAAO,IAAIpb,EAAJ,GAAS4V,UAAT,CAAoB1V,GAApB,EAAyB6G,IAAzB,CAA8BqU,GAA9B,CAAP;AACD;;AAED,SAAO7W,KAAP,CAAarE,GAAb,EAAkBsD,IAAlB,EAAwB;AACtB,QAAItD,GAAG,KAAK,CAAZ,EACE,OAAO,IAAIF,EAAJ,CAAO,CAAP,EAAU6L,KAAV,CAAgBrI,IAAhB,EAAsB,CAAtB,CAAP;AAEF,WAAO,IAAIxD,EAAJ,GAAS4V,UAAT,CAAoB1V,GAApB,EAAyBsK,KAAzB,CAA+BhH,IAA/B,CAAP;AACD;;AAED,SAAOqH,IAAP,CAAYrH,IAAZ,EAAkB;AAChB,WAAOxD,EAAE,CAACuE,KAAH,CAAS,CAAT,EAAYf,IAAZ,EAAkBpB,KAAlB,CAAwB,CAAxB,CAAP;AACD;;AAED,SAAOiZ,UAAP,CAAkBvK,GAAlB,EAAuBtN,IAAvB,EAA6B;AAC3BnC,IAAAA,OAAO,CAACyP,GAAG,IAAI,IAAR,EAAc,KAAd,EAAqB,KAArB,CAAP;AACAzP,IAAAA,OAAO,CAAEmC,IAAI,KAAK,CAAV,KAAiBA,IAAlB,EAAwB,MAAxB,EAAgC,QAAhC,CAAP;;AAEA,QAAI,OAAOsN,GAAP,KAAe,QAAnB,EAA6B;AAC3BzP,MAAAA,OAAO,CAAC,OAAOyP,GAAG,CAACwK,WAAX,KAA2B,UAA5B,EAAwC,KAAxC,EAA+C,KAA/C,CAAP;AAEA,YAAMpG,IAAI,GAAI1R,IAAI,GAAG,CAAR,KAAe,CAA5B;AACA,YAAM+V,KAAK,GAAGrE,IAAI,GAAG,CAArB;AACA,YAAMgD,KAAK,GAAGpH,GAAG,CAACwK,WAAJ,CAAgBpG,IAAhB,CAAd;AAEA7T,MAAAA,OAAO,CAAC2W,MAAM,CAACmC,QAAP,CAAgBjC,KAAhB,CAAD,EAAyB,OAAzB,EAAkC,QAAlC,CAAP;AAEA,UAAIA,KAAK,CAAC5X,MAAN,KAAiB4U,IAArB,EACE,MAAM,IAAI/N,UAAJ,CAAe,4CAAf,CAAN;AAEF,YAAMjH,GAAG,GAAGF,EAAE,CAAC+V,UAAH,CAAcmC,KAAd,CAAZ;AAEA,UAAIqB,KAAK,GAAG/V,IAAZ,EACEtD,GAAG,CAACwD,MAAJ,CAAW6V,KAAK,GAAG/V,IAAnB;AAEF,aAAOtD,GAAP;AACD;;AAEDmB,IAAAA,OAAO,CAAC,OAAOyP,GAAP,KAAe,UAAhB,EAA4B,KAA5B,EAAmC,KAAnC,CAAP;AAEA,UAAM5Q,GAAG,GAAG4Q,GAAG,CAACtN,IAAD,CAAf;AAEAnC,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAD,EAAe,KAAf,EAAsB,QAAtB,CAAP;AACAqP,IAAAA,KAAK,CAACrP,GAAG,CAACK,QAAJ,KAAiB,CAAlB,EAAqB,KAArB,CAAL;AACA8S,IAAAA,MAAM,CAAC,CAACnT,GAAG,CAACM,GAAN,EAAW,KAAX,CAAN;AAEA,QAAIN,GAAG,CAACqH,SAAJ,KAAkB/D,IAAtB,EACE,MAAM,IAAI2D,UAAJ,CAAe,2CAAf,CAAN;AAEF,WAAOjH,GAAP;AACD;;AAED,SAAOsR,MAAP,CAAcV,GAAd,EAAmB5L,GAAnB,EAAwB/D,GAAxB,EAA6B;AAC3B+D,IAAAA,GAAG,GAAGlF,EAAE,CAACub,IAAH,CAAQrW,GAAR,EAAa,EAAb,CAAN;AACA/D,IAAAA,GAAG,GAAGnB,EAAE,CAACub,IAAH,CAAQpa,GAAR,EAAa,EAAb,CAAN;AAEA,QAAI+D,GAAG,CAAC3D,GAAJ,CAAQJ,GAAR,IAAe,CAAnB,EACE,MAAM,IAAIgG,UAAJ,CAAe,yCAAf,CAAN;AAEF,UAAMqU,KAAK,GAAGra,GAAG,CAACkB,GAAJ,CAAQ6C,GAAR,EAAasH,IAAb,EAAd;AACA,UAAMhJ,IAAI,GAAGgY,KAAK,CAACjU,SAAN,EAAb;AAEA,QAAI/D,IAAI,KAAK,CAAb,EACE,OAAO0B,GAAG,CAACpD,KAAJ,EAAP;;AAEF,aAAS;AACP,YAAM5B,GAAG,GAAGF,EAAE,CAACqb,UAAH,CAAcvK,GAAd,EAAmBtN,IAAnB,CAAZ,CADO,CAGP;;AACA,UAAItD,GAAG,CAACqB,GAAJ,CAAQia,KAAR,KAAkB,CAAtB,EACE,SALK,CAOP;;AACAtb,MAAAA,GAAG,CAACkB,IAAJ,CAAS8D,GAAT;AAEA,aAAOhF,GAAP;AACD;AACF;;AAED,SAAOmY,EAAP,CAAUnY,GAAV,EAAeE,MAAf,EAAuB;AACrB,WAAO,IAAIJ,EAAJ,GAASqY,EAAT,CAAYnY,GAAZ,EAAiBE,MAAjB,CAAP;AACD;;AAED,SAAOwV,UAAP,CAAkB1V,GAAlB,EAAuBE,MAAvB,EAA+B;AAC7B,WAAO,IAAIJ,EAAJ,GAAS4V,UAAT,CAAoB1V,GAApB,EAAyBE,MAAzB,CAAP;AACD;;AAED,SAAOmY,UAAP,CAAkBrY,GAAlB,EAAuBE,MAAvB,EAA+B;AAC7B,WAAO,IAAIJ,EAAJ,GAASuY,UAAT,CAAoBrY,GAApB,EAAyBE,MAAzB,CAAP;AACD;;AAED,SAAOsY,UAAP,CAAkBxY,GAAlB,EAAuBE,MAAvB,EAA+B;AAC7B,WAAO,IAAIJ,EAAJ,GAAS0Y,UAAT,CAAoBxY,GAApB,EAAyBE,MAAzB,CAAP;AACD;;AAED,SAAOyY,QAAP,CAAgBC,KAAhB,EAAuB;AACrB,WAAO,IAAI9Y,EAAJ,GAAS6Y,QAAT,CAAkBC,KAAlB,CAAP;AACD;;AAED,SAAOC,UAAP,CAAkBC,GAAlB,EAAuB7Y,IAAvB,EAA6BC,MAA7B,EAAqC;AACnC,WAAO,IAAIJ,EAAJ,GAAS+Y,UAAT,CAAoBC,GAApB,EAAyB7Y,IAAzB,EAA+BC,MAA/B,CAAP;AACD;;AAED,SAAOsZ,QAAP,CAAgBC,IAAhB,EAAsB;AACpB,WAAO,IAAI3Z,EAAJ,GAAS0Z,QAAT,CAAkBC,IAAlB,CAAP;AACD;;AAED,SAAOI,MAAP,CAAc7Z,GAAd,EAAmB;AACjB,WAAO,IAAIF,EAAJ,GAAS+Z,MAAT,CAAgB7Z,GAAhB,CAAP;AACD;;AAED,SAAO8Z,SAAP,CAAiBC,IAAjB,EAAuB7Z,MAAvB,EAA+B;AAC7B,WAAO,IAAIJ,EAAJ,GAASga,SAAT,CAAmBC,IAAnB,EAAyB7Z,MAAzB,CAAP;AACD;;AAED,SAAO2V,UAAP,CAAkBkE,IAAlB,EAAwB7Z,MAAxB,EAAgC;AAC9B,WAAO,IAAIJ,EAAJ,GAAS+V,UAAT,CAAoBkE,IAApB,EAA0B7Z,MAA1B,CAAP;AACD;;AAED,SAAO8Z,aAAP,CAAqBD,IAArB,EAA2B7Z,MAA3B,EAAmC;AACjC,WAAO,IAAIJ,EAAJ,GAASka,aAAT,CAAuBD,IAAvB,EAA6B7Z,MAA7B,CAAP;AACD;;AAED,SAAOia,MAAP,CAAcJ,IAAd,EAAoB7Z,MAApB,EAA4B;AAC1B,WAAO,IAAIJ,EAAJ,GAASqa,MAAT,CAAgBJ,IAAhB,EAAsB7Z,MAAtB,CAAP;AACD;;AAED,SAAOK,IAAP,CAAYP,GAAZ,EAAiBC,IAAjB,EAAuBC,MAAvB,EAA+B;AAC7B,WAAO,IAAIJ,EAAJ,GAASS,IAAT,CAAcP,GAAd,EAAmBC,IAAnB,EAAyBC,MAAzB,CAAP;AACD;;AAED,SAAOmb,IAAP,CAAYrb,GAAZ,EAAiBC,IAAjB,EAAuBC,MAAvB,EAA+B;AAC7B,QAAIJ,EAAE,CAACsB,IAAH,CAAQpB,GAAR,CAAJ,EACE,OAAOA,GAAP;AAEF,WAAO,IAAIF,EAAJ,CAAOE,GAAP,EAAYC,IAAZ,EAAkBC,MAAlB,CAAP;AACD;;AAED,SAAOkB,IAAP,CAAYma,GAAZ,EAAiB;AACf,WAAOA,GAAG,YAAYzb,EAAtB;AACD;;AAn4HM;AAs4HT;;;;;AAIAA,EAAE,CAACA,EAAH,GAAQA,EAAR;AACAA,EAAE,CAAC0b,QAAH,GAAc,EAAd;AACA1b,EAAE,CAAC2b,MAAH,GAAY,CAAZ;AAEA;;;;AAIA,MAAMC,KAAN,CAAY;AACV3b,EAAAA,WAAW,CAAC2a,IAAD,EAAO/U,CAAP,EAAU;AACnB;AACA,SAAK+U,IAAL,GAAYA,IAAZ;AACA,SAAK/U,CAAL,GAAS,IAAI7F,EAAJ,CAAO6F,CAAP,EAAU,EAAV,CAAT;AACA,SAAKgD,CAAL,GAAS,KAAKhD,CAAL,CAAO0B,SAAP,EAAT;AACA,SAAKlC,CAAL,GAASrF,EAAE,CAACuE,KAAH,CAAS,CAAT,EAAY,KAAKsE,CAAjB,EAAoB1G,IAApB,CAAyB,KAAK0D,CAA9B,CAAT;AACA,SAAKzC,EAAL,GAAU,KAAKyC,CAAL,CAAO/D,KAAP,EAAV;AACA,SAAK+Z,GAAL,GAAW,KAAKhW,CAAL,CAAO/D,KAAP,EAAX;AACD;;AAEDga,EAAAA,OAAO,CAAC5b,GAAD,EAAM;AACX;AACA;AACA,UAAMgD,GAAG,GAAGhD,GAAG,CAACK,QAAJ,KAAiB,CAA7B,CAHW,CAKX;;AACA,QAAIiD,IAAI,GAAGtD,GAAG,CAACqH,SAAJ,EAAX,CANW,CAQX;;AACAvF,IAAAA,MAAM,CAACwB,IAAI,IAAI,KAAKqF,CAAL,GAAS,CAAlB,CAAN,CATW,CAWX;;AACA3I,IAAAA,GAAG,CAACK,QAAJ,GAAe,CAAf,CAZW,CAcX;;AACA,WAAOiD,IAAI,GAAG,KAAKqF,CAAnB,EAAsB;AACpB;AACA;AACA,WAAKkT,KAAL,CAAW7b,GAAX,EAAgB,KAAKkD,EAArB,EAHoB,CAKpB;;AACA,WAAK4Y,KAAL,CAAW9b,GAAX,EANoB,CAQpB;;AACAA,MAAAA,GAAG,CAACQ,KAAJ,CAAUR,GAAV,EAAe,KAAKkD,EAApB,EAToB,CAWpB;;;AACAI,MAAAA,IAAI,GAAGtD,GAAG,CAACqH,SAAJ,EAAP;AACD,KA5BU,CA8BX;;;AACA,UAAMhG,GAAG,GAAGiC,IAAI,GAAG,KAAKqF,CAAZ,GAAgB,CAAC,CAAjB,GAAqB3I,GAAG,CAACsB,IAAJ,CAAS,KAAKqE,CAAd,CAAjC;;AAEA,QAAItE,GAAG,KAAK,CAAZ,EAAe;AACbrB,MAAAA,GAAG,CAACG,KAAJ,CAAU,CAAV,IAAe,CAAf;AACAH,MAAAA,GAAG,CAACI,MAAJ,GAAa,CAAb;AACD,KAHD,MAGO,IAAIiB,GAAG,GAAG,CAAV,EAAa;AAClBrB,MAAAA,GAAG,CAACuB,KAAJ,CAAUvB,GAAV,EAAe,KAAK2F,CAApB;AACD,KAFM,MAEA,CACL;AACD,KAxCU,CA0CX;;;AACA,QAAI3C,GAAG,IAAI,CAAChD,GAAG,CAAC4D,MAAJ,EAAZ,EACE5D,GAAG,CAACuB,KAAJ,CAAU,KAAKoE,CAAf,EAAkB3F,GAAlB;AAEF,WAAOA,GAAP;AACD;;AAED6b,EAAAA,KAAK,CAACE,KAAD,EAAQzZ,GAAR,EAAa;AAChByZ,IAAAA,KAAK,CAAC/Q,MAAN,CAAa,KAAKrC,CAAlB,EAAqBrG,GAArB;AACD;;AAEDwZ,EAAAA,KAAK,CAAC9b,GAAD,EAAM;AACT,WAAOA,GAAG,CAAC4C,IAAJ,CAAS,KAAKuC,CAAd,CAAP;AACD;;AAlES;AAqEZ;;;;;AAIA,MAAMyV,IAAN,SAAmBc,KAAnB,CAAyB;AACvB3b,EAAAA,WAAW,GAAG;AACZ;AACA,UAAM,MAAN,EAAc,wCACA,mBADd;AAED;;AAED+b,EAAAA,KAAK,CAAC9b,GAAD,EAAM;AACT;AACA;AACA,UAAM2b,GAAG,GAAG,KAAKA,GAAL,CAASnG,MAAT,CAAgBxV,GAAhB,CAAZ;AACA,WAAOA,GAAG,CAACuE,MAAJ,CAAW,EAAX,EAAe/D,KAAf,CAAqBR,GAArB,EAA0B2b,GAA1B,CAAP;AACD;;AAZsB;AAezB;;;;;AAIA,MAAMd,IAAN,SAAmBa,KAAnB,CAAyB;AACvB3b,EAAAA,WAAW,GAAG;AACZ;AACA,UAAM,MAAN,EAAc,wCACA,4BADd;AAED;;AAED+b,EAAAA,KAAK,CAAC9b,GAAD,EAAM;AACT;AACA;AACA,UAAM2b,GAAG,GAAG,KAAKA,GAAL,CAASnG,MAAT,CAAgBxV,GAAhB,CAAZ;AACA,WAAOA,GAAG,CAACuE,MAAJ,CAAW,EAAX,EAAehD,KAAf,CAAqBvB,GAArB,EAA0B2b,GAA1B,CAAP;AACD;;AAZsB;AAezB;;;;;AAIA,MAAMb,IAAN,SAAmBY,KAAnB,CAAyB;AACvB3b,EAAAA,WAAW,GAAG;AACZ;AACA,UAAM,MAAN,EAAc,wCACA,qCADA,GAEA,qCAFA,GAGA,qCAHA,GAIA,UAJd;AAKD;;AAED+b,EAAAA,KAAK,CAAC9b,GAAD,EAAM;AACT;AACA,WAAOA,GAAP;AACD;;AAbsB;AAgBzB;;;;;AAIA,MAAM+a,IAAN,SAAmBW,KAAnB,CAAyB;AACvB3b,EAAAA,WAAW,GAAG;AACZ;AACA,UAAM,MAAN,EAAc,wCACA,qCADd;AAED;;AAED8b,EAAAA,KAAK,CAACE,KAAD,EAAQ9Q,MAAR,EAAgB;AACnB;AACA,UAAMN,IAAI,GAAG,QAAb;AACA,UAAMnI,GAAG,GAAGxB,IAAI,CAACgE,GAAL,CAAS+W,KAAK,CAAC3b,MAAf,EAAuB,CAAvB,CAAZ;;AAEA6K,IAAAA,MAAM,CAACpK,MAAP,CAAc2B,GAAG,GAAG,CAApB;;AAEA,SAAK,IAAI5B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4B,GAApB,EAAyB5B,CAAC,EAA1B,EACEqK,MAAM,CAAC9K,KAAP,CAAaS,CAAb,IAAkBmb,KAAK,CAAC5b,KAAN,CAAYS,CAAZ,CAAlB;;AAEFqK,IAAAA,MAAM,CAAC7K,MAAP,GAAgBoC,GAAhB;;AAEA,QAAIuZ,KAAK,CAAC3b,MAAN,IAAgB,CAApB,EAAuB;AACrB6K,MAAAA,MAAM,CAAClJ,MAAP;;AACAga,MAAAA,KAAK,CAAC5b,KAAN,CAAY,CAAZ,IAAiB,CAAjB;AACA4b,MAAAA,KAAK,CAAC3b,MAAN,GAAe,CAAf;AACA;AACD,KAjBkB,CAmBnB;;;AACA,QAAI4b,IAAI,GAAGD,KAAK,CAAC5b,KAAN,CAAY,CAAZ,CAAX;AACA,QAAIS,CAAC,GAAG,EAAR;AAEAqK,IAAAA,MAAM,CAAC9K,KAAP,CAAa8K,MAAM,CAAC7K,MAAP,EAAb,IAAgC4b,IAAI,GAAGrR,IAAvC;;AACAM,IAAAA,MAAM,CAAClJ,MAAP;;AAEA,WAAOnB,CAAC,GAAGmb,KAAK,CAAC3b,MAAjB,EAAyBQ,CAAC,EAA1B,EAA8B;AAC5B,YAAMyL,IAAI,GAAG0P,KAAK,CAAC5b,KAAN,CAAYS,CAAZ,IAAiB,CAA9B;AAEAmb,MAAAA,KAAK,CAAC5b,KAAN,CAAYS,CAAC,GAAG,EAAhB,IAAuB,CAACyL,IAAI,GAAG1B,IAAR,KAAiB,CAAlB,GAAwBqR,IAAI,KAAK,EAAvD;AAEAA,MAAAA,IAAI,GAAG3P,IAAP;AACD;;AAED2P,IAAAA,IAAI,MAAM,EAAV;AAEAD,IAAAA,KAAK,CAAC5b,KAAN,CAAYS,CAAC,GAAG,EAAhB,IAAsBob,IAAtB;AAEA,QAAIA,IAAI,KAAK,CAAT,IAAcD,KAAK,CAAC3b,MAAN,GAAe,EAAjC,EACE2b,KAAK,CAAC3b,MAAN,IAAgB,EAAhB,CADF,KAGE2b,KAAK,CAAC3b,MAAN,IAAgB,CAAhB;;AAEF2b,IAAAA,KAAK,CAACha,MAAN,GA3CmB,CA2CH;;AACjB;;AAED+Z,EAAAA,KAAK,CAAC9b,GAAD,EAAM;AACT;AACA;AACAA,IAAAA,GAAG,CAACkF,OAAJ,CAAYlF,GAAG,CAACI,MAAJ,GAAa,CAAzB,EAHS,CAKT;;;AACA,QAAI8C,EAAE,GAAG,CAAT;;AAEA,SAAK,IAAItC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGZ,GAAG,CAACI,MAAxB,EAAgCQ,CAAC,EAAjC,EAAqC;AACnC,YAAMqC,CAAC,GAAGjD,GAAG,CAACG,KAAJ,CAAUS,CAAV,CAAV;AAEAsC,MAAAA,EAAE,IAAID,CAAC,GAAG,KAAV;AAEAjD,MAAAA,GAAG,CAACG,KAAJ,CAAUS,CAAV,IAAesC,EAAE,GAAG,SAApB;AAEAA,MAAAA,EAAE,GAAGD,CAAC,GAAG,IAAJ,GAAWjC,IAAI,CAACuX,KAAL,CAAWrV,EAAE,GAAG,SAAhB,CAAhB;AACD,KAhBQ,CAkBT;;;AACA,QAAIlD,GAAG,CAACG,KAAJ,CAAUH,GAAG,CAACI,MAAJ,GAAa,CAAvB,MAA8B,CAAlC,EAAqC;AACnCJ,MAAAA,GAAG,CAACI,MAAJ,IAAc,CAAd;AACA,UAAIJ,GAAG,CAACG,KAAJ,CAAUH,GAAG,CAACI,MAAJ,GAAa,CAAvB,MAA8B,CAAlC,EACEJ,GAAG,CAACI,MAAJ,IAAc,CAAd;AACH,KAvBQ,CAyBT;;;AACA,WAAOJ,GAAP;AACD;;AAhFsB;AAmFzB;;;;;AAIA,MAAMgb,MAAN,SAAqBU,KAArB,CAA2B;AACzB3b,EAAAA,WAAW,GAAG;AACZ;AACA,UAAM,QAAN,EAAgB,wCACA,qCADhB;AAED;;AAED+b,EAAAA,KAAK,CAAC9b,GAAD,EAAM;AACT;AACA,QAAIW,KAAK,GAAG,CAAZ;;AAEA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGZ,GAAG,CAACI,MAAxB,EAAgCQ,CAAC,EAAjC,EAAqC;AACnC,YAAMqC,CAAC,GAAGjD,GAAG,CAACG,KAAJ,CAAUS,CAAV,IAAe,IAAf,GAAsBD,KAAhC;AAEAA,MAAAA,KAAK,GAAGsC,CAAC,KAAK,EAAd;AAEAjD,MAAAA,GAAG,CAACG,KAAJ,CAAUS,CAAV,IAAeqC,CAAC,GAAG,SAAnB;AACD;;AAED,QAAItC,KAAK,KAAK,CAAd,EAAiB;AACfX,MAAAA,GAAG,CAACa,MAAJ,CAAWb,GAAG,CAACI,MAAJ,GAAa,CAAxB;;AACAJ,MAAAA,GAAG,CAACG,KAAJ,CAAUH,GAAG,CAACI,MAAJ,EAAV,IAA0BO,KAA1B;AACD,KAfQ,CAiBT;;;AACA,WAAOX,GAAP;AACD;;AA1BwB;AA6B3B;;;;;AAIA,MAAMib,IAAN,SAAmBS,KAAnB,CAAyB;AACvB3b,EAAAA,WAAW,GAAG;AACZ;AACA,UAAM,MAAN,EAAc,wCACA,qCADA,GAEA,qCAFA,GAGA,mBAHd;AAID;;AAED+b,EAAAA,KAAK,CAAC9b,GAAD,EAAM;AACT;AACA;AACA,UAAM2b,GAAG,GAAG,KAAKA,GAAL,CAASnG,MAAT,CAAgBxV,GAAhB,CAAZ;AACA,WAAOA,GAAG,CAACuE,MAAJ,CAAW,GAAX,EAAgB/D,KAAhB,CAAsBR,GAAtB,EAA2B2b,GAA3B,CAAP;AACD;;AAdsB;AAiBzB;;;;;AAIA,MAAM9J,GAAN,CAAU;AACR9R,EAAAA,WAAW,CAACyE,CAAD,EAAI;AACb,QAAImW,KAAK,GAAG,IAAZ;;AAEA,QAAI,OAAOnW,CAAP,KAAa,QAAjB,EAA2B;AACzBmW,MAAAA,KAAK,GAAG7a,EAAE,CAAC2a,MAAH,CAAUjW,CAAV,CAAR;AACAA,MAAAA,CAAC,GAAGmW,KAAK,CAAChV,CAAV;AACD;;AAEDxE,IAAAA,OAAO,CAACrB,EAAE,CAACsB,IAAH,CAAQoD,CAAR,CAAD,EAAa,GAAb,EAAkB,QAAlB,CAAP;AACA2O,IAAAA,MAAM,CAAC,CAAC3O,CAAC,CAAClE,GAAJ,EAAS,WAAT,CAAN;AACA+O,IAAAA,KAAK,CAAC7K,CAAC,CAACmD,IAAF,KAAW,CAAZ,EAAe,WAAf,CAAL;AAEA,SAAKnD,CAAL,GAASA,CAAT;AACA,SAAKmW,KAAL,GAAaA,KAAb;AACA,SAAKsB,EAAL,GAAU,IAAV;AACA,SAAKC,GAAL,GAAW,IAAX;AACD;;AAEDC,EAAAA,QAAQ,CAAC1b,CAAD,EAAI;AACV4O,IAAAA,KAAK,CAAC5O,CAAC,CAACJ,QAAF,KAAe,CAAhB,EAAmB,KAAnB,CAAL;AACAC,IAAAA,GAAG,CAACG,CAAC,CAACH,GAAF,IAAS,IAAV,EAAgB,KAAhB,CAAH;AACD;;AAED8b,EAAAA,QAAQ,CAAC3b,CAAD,EAAIC,CAAJ,EAAO;AACb2O,IAAAA,KAAK,CAAC,CAAC5O,CAAC,CAACJ,QAAF,GAAaK,CAAC,CAACL,QAAhB,MAA8B,CAA/B,EAAkC,KAAlC,CAAL;AACAC,IAAAA,GAAG,CAACG,CAAC,CAACH,GAAF,IAAS,IAAT,IAAiBG,CAAC,CAACH,GAAF,KAAUI,CAAC,CAACJ,GAA9B,EAAmC,KAAnC,CAAH;AACD;;AAED,MAAIiN,IAAJ,GAAW;AACT,WAAO,KAAP;AACD;;AAED,MAAI8O,OAAJ,GAAc;AACZ,WAAO,KAAP;AACD;;AAEDC,EAAAA,UAAU,GAAG;AACX;AACA,QAAI,KAAKJ,GAAL,KAAa,IAAb,IAAqB,KAAK1X,CAAL,CAAOyH,KAAP,CAAa,CAAb,MAAoB,CAA7C,EAAgD;AAC9C,YAAMhE,CAAC,GAAG,IAAInI,EAAJ,CAAO,CAAP,EAAU0N,KAAV,CAAgB,IAAhB,CAAV;AACA,YAAM+O,CAAC,GAAG,KAAK/X,CAAL,CAAOpC,IAAP,CAAY,CAAZ,EAAeoB,MAAf,CAAsB,CAAtB,CAAV,CAF8C,CAI9C;;AACA,WAAK0Y,GAAL,GAAW,KAAKvV,GAAL,CAASsB,CAAT,EAAYsU,CAAZ,CAAX;AACD;;AAED,WAAO,IAAP;AACD;;AAEDzK,EAAAA,SAAS,CAAC9R,GAAD,EAAM;AACb,UAAMuM,GAAG,GAAGvM,GAAG,CAACmG,GAAJ,CAAQ,KAAK3B,CAAb,CAAZ;AACA+H,IAAAA,GAAG,CAACjM,GAAJ,GAAU,IAAV;AACA,WAAOiM,GAAP;AACD;;AAEDwF,EAAAA,WAAW,CAAC/R,GAAD,EAAM;AACf,UAAMuM,GAAG,GAAGvM,GAAG,CAAC4B,KAAJ,EAAZ;AACA2K,IAAAA,GAAG,CAACjM,GAAJ,GAAU,IAAV;AACA,WAAOiM,GAAP;AACD;;AAEDiQ,EAAAA,KAAK,CAAC/b,CAAD,EAAI;AACP,WAAOA,CAAP;AACD;;AAEDgc,EAAAA,OAAO,CAAChc,CAAD,EAAI;AACT,WAAOA,CAAP;AACD;;AAEDyF,EAAAA,IAAI,CAACzF,CAAD,EAAI;AACN,QAAI,KAAKka,KAAT,EACE,OAAO,KAAKA,KAAL,CAAWiB,OAAX,CAAmBnb,CAAnB,EAAsBwR,SAAtB,CAAgC,IAAhC,CAAP;AAEF,WAAOxR,CAAC,CAACyF,IAAF,CAAO,KAAK1B,CAAZ,EAAeyN,SAAf,CAAyB,IAAzB,CAAP;AACD;;AAED/Q,EAAAA,IAAI,CAACT,CAAD,EAAIC,CAAJ,EAAO;AACT,SAAK0b,QAAL,CAAc3b,CAAd,EAAiBC,CAAjB;;AAEAD,IAAAA,CAAC,CAACD,KAAF,CAAQC,CAAR,EAAWC,CAAX;;AAEA,QAAID,CAAC,CAACa,IAAF,CAAO,KAAKkD,CAAZ,KAAkB,CAAtB,EACE/D,CAAC,CAACc,KAAF,CAAQd,CAAR,EAAW,KAAK+D,CAAhB;AAEF,WAAO/D,CAAP;AACD;;AAEDkB,EAAAA,GAAG,CAAClB,CAAD,EAAIC,CAAJ,EAAO;AACR,QAAID,CAAC,CAACL,MAAF,GAAWM,CAAC,CAACN,MAAjB,EACE,OAAO,KAAKc,IAAL,CAAUR,CAAC,CAACkB,KAAF,EAAV,EAAqBnB,CAArB,CAAP;AAEF,WAAO,KAAKS,IAAL,CAAUT,CAAC,CAACmB,KAAF,EAAV,EAAqBlB,CAArB,CAAP;AACD;;AAEDc,EAAAA,KAAK,CAACf,CAAD,EAAIT,GAAJ,EAAS;AACZ,SAAKmc,QAAL,CAAc1b,CAAd;;AAEA,QAAIT,GAAG,GAAG,CAAV,EACE,OAAO,KAAKkC,KAAL,CAAWzB,CAAX,EAAc,CAACT,GAAf,CAAP;AAEF,QAAI,KAAKwE,CAAL,CAAOpE,MAAP,KAAkB,CAAtB,EACEJ,GAAG,IAAI,KAAKwE,CAAL,CAAOrE,KAAP,CAAa,CAAb,CAAP;;AAEFM,IAAAA,CAAC,CAACM,MAAF,CAASf,GAAT;;AAEA,QAAIS,CAAC,CAACa,IAAF,CAAO,KAAKkD,CAAZ,KAAkB,CAAtB,EACE/D,CAAC,CAACc,KAAF,CAAQd,CAAR,EAAW,KAAK+D,CAAhB;AAEF,WAAO/D,CAAP;AACD;;AAEDoB,EAAAA,IAAI,CAACpB,CAAD,EAAIT,GAAJ,EAAS;AACX,WAAO,KAAKwB,KAAL,CAAWf,CAAC,CAACmB,KAAF,EAAX,EAAsB5B,GAAtB,CAAP;AACD;;AAEDiC,EAAAA,IAAI,CAACxB,CAAD,EAAIC,CAAJ,EAAO;AACT,SAAK0b,QAAL,CAAc3b,CAAd,EAAiBC,CAAjB,EADS,CAGT;AACA;AACA;;;AACA,UAAMW,GAAG,GAAGZ,CAAC,CAACa,IAAF,CAAOZ,CAAP,CAAZ;;AAEA,QAAIW,GAAG,KAAK,CAAZ,EAAe;AACbZ,MAAAA,CAAC,CAACN,KAAF,CAAQ,CAAR,IAAa,CAAb;AACAM,MAAAA,CAAC,CAACL,MAAF,GAAW,CAAX;AACA,aAAOK,CAAP;AACD;;AAED,QAAIY,GAAG,GAAG,CAAV,EAAa;AACXZ,MAAAA,CAAC,CAACc,KAAF,CAAQb,CAAR,EAAWD,CAAX;;AACAA,MAAAA,CAAC,CAACc,KAAF,CAAQ,KAAKiD,CAAb,EAAgB/D,CAAhB;AACD,KAHD,MAGO;AACLA,MAAAA,CAAC,CAACc,KAAF,CAAQd,CAAR,EAAWC,CAAX;AACD;;AAED,WAAOD,CAAP;AACD;;AAED0B,EAAAA,GAAG,CAAC1B,CAAD,EAAIC,CAAJ,EAAO;AACR,WAAO,KAAKuB,IAAL,CAAUxB,CAAC,CAACmB,KAAF,EAAV,EAAqBlB,CAArB,CAAP;AACD;;AAEDwB,EAAAA,KAAK,CAACzB,CAAD,EAAIT,GAAJ,EAAS;AACZ,SAAKmc,QAAL,CAAc1b,CAAd;;AAEA,QAAIT,GAAG,GAAG,CAAV,EACE,OAAO,KAAKwB,KAAL,CAAWf,CAAX,EAAc,CAACT,GAAf,CAAP;AAEF,QAAI,KAAKwE,CAAL,CAAOpE,MAAP,KAAkB,CAAtB,EACEJ,GAAG,IAAI,KAAKwE,CAAL,CAAOrE,KAAP,CAAa,CAAb,CAAP,CAPU,CASZ;AACA;;AACA,QAAIM,CAAC,CAACL,MAAF,KAAa,CAAb,IAAkBK,CAAC,CAACN,KAAF,CAAQ,CAAR,IAAaH,GAAnC,EAAwC;AACtCS,MAAAA,CAAC,CAACN,KAAF,CAAQ,CAAR,IAAaH,GAAG,GAAGS,CAAC,CAACN,KAAF,CAAQ,CAAR,CAAnB;;AACAM,MAAAA,CAAC,CAACc,KAAF,CAAQ,KAAKiD,CAAb,EAAgB/D,CAAhB;AACD,KAHD,MAGO;AACLA,MAAAA,CAAC,CAACiB,MAAF,CAAS1B,GAAT;AACD;;AAED,WAAOS,CAAP;AACD;;AAED2B,EAAAA,IAAI,CAAC3B,CAAD,EAAIT,GAAJ,EAAS;AACX,WAAO,KAAKkC,KAAL,CAAWzB,CAAC,CAACmB,KAAF,EAAX,EAAsB5B,GAAtB,CAAP;AACD;;AAED4C,EAAAA,IAAI,CAACnC,CAAD,EAAIC,CAAJ,EAAO;AACT,SAAK0b,QAAL,CAAc3b,CAAd,EAAiBC,CAAjB;;AACA,WAAO,KAAKwF,IAAL,CAAUzF,CAAC,CAACmC,IAAF,CAAOlC,CAAP,CAAV,CAAP;AACD;;AAEDmC,EAAAA,GAAG,CAACpC,CAAD,EAAIC,CAAJ,EAAO;AACR,SAAK0b,QAAL,CAAc3b,CAAd,EAAiBC,CAAjB;;AACA,WAAO,KAAKwF,IAAL,CAAUzF,CAAC,CAACoC,GAAF,CAAMnC,CAAN,CAAV,CAAP;AACD;;AAEDqC,EAAAA,KAAK,CAACtC,CAAD,EAAIT,GAAJ,EAAS;AACZ,SAAKmc,QAAL,CAAc1b,CAAd;;AAEA,QAAIA,CAAC,CAACmD,MAAF,EAAJ,EACE,OAAOnD,CAAP;;AAEF,QAAIT,GAAG,KAAK,CAAZ,EAAe;AACbS,MAAAA,CAAC,CAACN,KAAF,CAAQ,CAAR,IAAa,CAAb;AACAM,MAAAA,CAAC,CAACL,MAAF,GAAW,CAAX;AACA,aAAOK,CAAP;AACD;;AAED,UAAMuC,GAAG,GAAGhD,GAAG,GAAG,CAAlB;AAEA,QAAIgD,GAAJ,EACEhD,GAAG,GAAG,CAACA,GAAP;AAEF,QAAI,KAAKwE,CAAL,CAAOpE,MAAP,KAAkB,CAAtB,EACEJ,GAAG,IAAI,KAAKwE,CAAL,CAAOrE,KAAP,CAAa,CAAb,CAAP;AAEFM,IAAAA,CAAC,CAACsC,KAAF,CAAQ/C,GAAR;;AAEA,QAAIA,GAAG,IAAI,EAAX,EAAe;AACb;AACA,aAAOS,CAAC,CAACa,IAAF,CAAO,KAAKkD,CAAZ,KAAkB,CAAzB,EACE/D,CAAC,CAACc,KAAF,CAAQd,CAAR,EAAW,KAAK+D,CAAhB;AACH,KAJD,MAIO;AACL,WAAK0B,IAAL,CAAUzF,CAAV;AACD;;AAED,QAAIuC,GAAJ,EACE,KAAKiC,IAAL,CAAUxE,CAAV;AAEF,WAAOA,CAAP;AACD;;AAED2C,EAAAA,IAAI,CAAC3C,CAAD,EAAIT,GAAJ,EAAS;AACX,WAAO,KAAK+C,KAAL,CAAWtC,CAAC,CAACmB,KAAF,EAAX,EAAsB5B,GAAtB,CAAP;AACD;;AAED8F,EAAAA,IAAI,CAACrF,CAAD,EAAIC,CAAJ,EAAO;AACT,WAAO,KAAKqF,GAAL,CAAStF,CAAT,EAAYC,CAAZ,EAAeoC,KAAf,CAAqBrC,CAArB,CAAP;AACD;;AAEDsF,EAAAA,GAAG,CAACtF,CAAD,EAAIC,CAAJ,EAAO;AACR,WAAO,KAAKmC,GAAL,CAASpC,CAAT,EAAY,KAAK2O,MAAL,CAAY1O,CAAZ,CAAZ,CAAP;AACD;;AAEDsF,EAAAA,KAAK,CAACvF,CAAD,EAAIT,GAAJ,EAAS;AACZ,WAAO,KAAKiG,IAAL,CAAUxF,CAAV,EAAaT,GAAb,EAAkB8C,KAAlB,CAAwBrC,CAAxB,CAAP;AACD;;AAEDwF,EAAAA,IAAI,CAACxF,CAAD,EAAIT,GAAJ,EAAS;AACX,WAAO,KAAK+F,GAAL,CAAStF,CAAT,EAAY,KAAKqR,SAAL,CAAe,IAAIhS,EAAJ,CAAOE,GAAP,CAAf,CAAZ,CAAP;AACD;;AAED0G,EAAAA,IAAI,CAACjG,CAAD,EAAIT,GAAJ,EAAS;AACX,WAAO,KAAK2G,GAAL,CAASlG,CAAT,EAAYT,GAAZ,EAAiB8C,KAAjB,CAAuBrC,CAAvB,CAAP;AACD;;AAEDkG,EAAAA,GAAG,CAAClG,CAAD,EAAIT,GAAJ,EAAS;AACV,SAAKmc,QAAL,CAAc1b,CAAd;;AAEA,QAAIT,GAAG,CAACmN,KAAJ,EAAJ,EACE1M,CAAC,GAAG,KAAK2O,MAAL,CAAY3O,CAAZ,CAAJ,CAJQ,CAMV;;AACA,QAAIT,GAAG,CAACI,MAAJ,KAAe,CAAnB,EACE,OAAO,KAAKyG,IAAL,CAAUpG,CAAV,EAAaT,GAAG,CAACG,KAAJ,CAAU,CAAV,CAAb,CAAP,CARQ,CAUV;;AACA,QAAIP,UAAU,IAAI,CAAC,KAAK+a,KAAxB,EACE,OAAO,KAAK+B,MAAL,CAAYjc,CAAZ,EAAeT,GAAf,CAAP,CAZQ,CAcV;;AACA,WAAO,KAAK2c,MAAL,CAAYlc,CAAZ,EAAeT,GAAf,CAAP;AACD;;AAED2c,EAAAA,MAAM,CAAClc,CAAD,EAAIT,GAAJ,EAAS;AACb;AACA,UAAM4c,GAAG,GAAG,IAAIzZ,KAAJ,CAAUxD,QAAV,CAAZ;AAEAid,IAAAA,GAAG,CAAC,CAAD,CAAH,GAAS,KAAKC,IAAL,CAAUpc,CAAV,EAAaf,SAAS,GAAG,CAAzB,CAAT;AACAkd,IAAAA,GAAG,CAAC,CAAD,CAAH,GAAS,KAAK/Z,GAAL,CAAS+Z,GAAG,CAAC,CAAD,CAAZ,EAAiBnc,CAAjB,CAAT;;AAEA,SAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjB,QAApB,EAA8BiB,CAAC,EAA/B,EACEgc,GAAG,CAAChc,CAAD,CAAH,GAAS,KAAKiC,GAAL,CAAS+Z,GAAG,CAAChc,CAAC,GAAG,CAAL,CAAZ,EAAqBH,CAArB,CAAT;;AAEF,QAAIG,CAAC,GAAGZ,GAAG,CAACqH,SAAJ,EAAR;AACA,QAAIvG,CAAC,GAAG,IAAIhB,EAAJ,CAAO,CAAP,EAAU0N,KAAV,CAAgB,IAAhB,CAAR;;AAEA,WAAO5M,CAAC,IAAIlB,SAAZ,EAAuB;AACrB,YAAMwM,GAAG,GAAGtL,CAAC,GAAGlB,SAAhB;AACA,YAAM4D,IAAI,GAAGtD,GAAG,CAACsD,IAAJ,CAAS4I,GAAT,EAAcxM,SAAd,CAAb;;AAEA,UAAI4D,IAAI,GAAG3D,QAAX,EAAqB;AACnBmB,QAAAA,CAAC,GAAG,KAAKgG,GAAL,CAAShG,CAAT,CAAJ;AACAF,QAAAA,CAAC,IAAI,CAAL;AACA;AACD;;AAEDE,MAAAA,CAAC,GAAG,KAAK+b,IAAL,CAAU/b,CAAV,EAAapB,SAAb,CAAJ;AACAoB,MAAAA,CAAC,GAAG,KAAK+B,GAAL,CAAS/B,CAAT,EAAY8b,GAAG,CAACtZ,IAAI,GAAG,CAAC3D,QAAT,CAAf,CAAJ;AACAiB,MAAAA,CAAC,GAAGsL,GAAJ;AACD;;AAED,QAAItL,CAAC,GAAG,CAAR,EAAW;AACT,YAAM0C,IAAI,GAAGtD,GAAG,CAACsD,IAAJ,CAAS,CAAT,EAAY1C,CAAZ,CAAb;;AAEA,aAAOA,CAAC,EAAR,EAAY;AACVE,QAAAA,CAAC,GAAG,KAAKgG,GAAL,CAAShG,CAAT,CAAJ;AAEA,YAAKwC,IAAI,IAAI1C,CAAT,GAAc,CAAlB,EACEE,CAAC,GAAG,KAAK+B,GAAL,CAAS/B,CAAT,EAAYL,CAAZ,CAAJ;AACH;AACF;;AAED,WAAOK,CAAP;AACD;;AAED4b,EAAAA,MAAM,CAACjc,CAAD,EAAIT,GAAJ,EAAS;AACb,QAAI,KAAKic,EAAL,KAAY,IAAhB,EACE,KAAKA,EAAL,GAAU,KAAKzX,CAAL,CAAO0S,QAAP,EAAV;AAEF,UAAMjP,CAAC,GAAG,KAAKwU,OAAL,CAAahc,CAAC,CAACyW,QAAF,EAAb,CAAV;AACA,UAAMhP,CAAC,GAAGwU,MAAM,CAACzU,CAAD,EAAIjI,GAAJ,EAAS,KAAKic,EAAd,CAAhB;AACA,UAAMhO,CAAC,GAAG,KAAKuO,KAAL,CAAWtU,CAAX,CAAV;AAEA,WAAOpI,EAAE,CAAC0Y,UAAH,CAAcvK,CAAd,EAAiBgE,SAAjB,CAA2B,IAA3B,CAAP;AACD;;AAED4K,EAAAA,IAAI,CAACpc,CAAD,EAAIkI,CAAJ,EAAO;AACT,SAAK,IAAI/H,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+H,CAApB,EAAuB/H,CAAC,EAAxB,EACEH,CAAC,GAAG,KAAKqG,GAAL,CAASrG,CAAT,CAAJ;;AACF,WAAOA,CAAP;AACD;;AAEDmG,EAAAA,KAAK,CAACnG,CAAD,EAAIT,GAAJ,EAAS;AACZ,WAAO,KAAK6G,IAAL,CAAUpG,CAAV,EAAaT,GAAb,EAAkB8C,KAAlB,CAAwBrC,CAAxB,CAAP;AACD;;AAEDoG,EAAAA,IAAI,CAACpG,CAAD,EAAIT,GAAJ,EAAS;AACX,SAAKmc,QAAL,CAAc1b,CAAd;;AAEA,QAAIT,GAAG,GAAG,CAAV,EAAa;AACXS,MAAAA,CAAC,GAAG,KAAK2O,MAAL,CAAY3O,CAAZ,CAAJ;AACAT,MAAAA,GAAG,GAAG,CAACA,GAAP;AACD;;AAED,QAAIA,GAAG,KAAK,CAAZ,EACE,OAAO,IAAIF,EAAJ,CAAO,CAAP,EAAU0N,KAAV,CAAgB,IAAhB,CAAP;AAEF,QAAIxN,GAAG,KAAK,CAAZ,EACE,OAAOS,CAAC,CAACmB,KAAF,EAAP;AAEF,UAAM0B,IAAI,GAAGgB,SAAS,CAACtE,GAAD,CAAtB;AAEA,QAAIc,CAAC,GAAGL,CAAR;;AAEA,SAAK,IAAIG,CAAC,GAAG0C,IAAI,GAAG,CAApB,EAAuB1C,CAAC,IAAI,CAA5B,EAA+BA,CAAC,EAAhC,EAAoC;AAClCE,MAAAA,CAAC,GAAG,KAAKgG,GAAL,CAAShG,CAAT,CAAJ;AAEA,UAAKd,GAAG,IAAIY,CAAR,GAAa,CAAjB,EACEE,CAAC,GAAG,KAAK+B,GAAL,CAAS/B,CAAT,EAAYL,CAAZ,CAAJ;AACH;;AAED,WAAOK,CAAP;AACD;;AAEDiG,EAAAA,IAAI,CAACtG,CAAD,EAAI;AACN,WAAO,KAAKmC,IAAL,CAAUnC,CAAV,EAAaA,CAAb,CAAP;AACD;;AAEDqG,EAAAA,GAAG,CAACrG,CAAD,EAAI;AACL,WAAO,KAAKoC,GAAL,CAASpC,CAAT,EAAYA,CAAZ,CAAP;AACD;;AAEDoH,EAAAA,KAAK,CAACI,CAAD,EAAI;AACP,WAAO,KAAKH,IAAL,CAAUG,CAAV,EAAanF,KAAb,CAAmBmF,CAAnB,CAAP;AACD;;AAEDH,EAAAA,IAAI,CAACG,CAAD,EAAI;AACN,SAAKkU,QAAL,CAAclU,CAAd,EADM,CAGN;;;AACA,QAAI,KAAKzD,CAAL,CAAOyH,KAAP,CAAa,CAAb,MAAoB,CAAxB,EACE,OAAO,KAAK6Q,SAAL,CAAe7U,CAAf,CAAP,CALI,CAON;;AACA,QAAI,KAAKzD,CAAL,CAAOyH,KAAP,CAAa,CAAb,MAAoB,CAAxB,EAA2B;AACzB,UAAI,KAAKiQ,GAAL,IAAY,IAAhB,EACE,OAAO,KAAKa,YAAL,CAAkB9U,CAAlB,CAAP;AACF,aAAO,KAAK+U,SAAL,CAAe/U,CAAf,CAAP;AACD,KAZK,CAcN;;;AACA,WAAO,KAAKgV,KAAL,CAAWhV,CAAX,CAAP;AACD;;AAED6U,EAAAA,SAAS,CAAC7U,CAAD,EAAI;AACX,UAAMsU,CAAC,GAAG,KAAK/X,CAAL,CAAO3C,IAAP,CAAY,CAAZ,EAAe2B,MAAf,CAAsB,CAAtB,CAAV,CADW,CACyB;;AACpC,UAAM9C,CAAC,GAAG,KAAKiG,GAAL,CAASsB,CAAT,EAAYsU,CAAZ,CAAV;AAEA,QAAI,CAAC,KAAKzV,GAAL,CAASpG,CAAT,EAAY+L,EAAZ,CAAexE,CAAf,CAAL,EACE,MAAM,IAAI0F,KAAJ,CAAU,0BAAV,CAAN;AAEF,WAAOjN,CAAP;AACD;;AAEDsc,EAAAA,SAAS,CAAC/U,CAAD,EAAI;AACX;AACA,UAAM0T,GAAG,GAAG,IAAI7b,EAAJ,CAAO,CAAP,EAAU0N,KAAV,CAAgB,IAAhB,CAAZ;AACA,UAAM+O,CAAC,GAAG,KAAK/X,CAAL,CAAOgH,KAAP,CAAa,CAAb,CAAV,CAHW,CAGgB;;AAC3B,UAAM6J,EAAE,GAAG,KAAK1T,GAAL,CAASsG,CAAT,EAAYA,CAAZ,CAAX;AACA,UAAMiV,KAAK,GAAG,KAAKvW,GAAL,CAAS0O,EAAT,EAAakH,CAAb,CAAd;AACA,UAAMY,IAAI,GAAG,KAAKta,GAAL,CAASwS,EAAT,EAAa,KAAKvO,GAAL,CAASoW,KAAT,CAAb,CAAb;AACA,UAAMxc,CAAC,GAAG,KAAKmC,GAAL,CAAS,KAAKA,GAAL,CAASqa,KAAT,EAAgBjV,CAAhB,CAAT,EAA6B,KAAKhG,IAAL,CAAUkb,IAAV,EAAgBxB,GAAhB,CAA7B,CAAV;AAEA,QAAI,CAAC,KAAK7U,GAAL,CAASpG,CAAT,EAAY+L,EAAZ,CAAexE,CAAf,CAAL,EACE,MAAM,IAAI0F,KAAJ,CAAU,0BAAV,CAAN;AAEF,WAAOjN,CAAP;AACD;;AAEDqc,EAAAA,YAAY,CAAC9U,CAAD,EAAI;AACd,UAAMsU,CAAC,GAAG,KAAK/X,CAAL,CAAO3C,IAAP,CAAY,CAAZ,EAAe2B,MAAf,CAAsB,CAAtB,CAAV,CADc,CACsB;;AACpC,UAAM9C,CAAC,GAAG,KAAKiG,GAAL,CAASsB,CAAT,EAAYsU,CAAZ,CAAV;AAEA,QAAI,KAAKzV,GAAL,CAASpG,CAAT,EAAY+L,EAAZ,CAAexE,CAAf,CAAJ,EACE,OAAOvH,CAAP;AAEF,UAAMmK,CAAC,GAAG,KAAKhI,GAAL,CAASnC,CAAT,EAAY,KAAKwb,GAAjB,CAAV;AAEA,QAAI,KAAKpV,GAAL,CAAS+D,CAAT,EAAY4B,EAAZ,CAAexE,CAAf,CAAJ,EACE,OAAO4C,CAAP;AAEF,UAAM,IAAI8C,KAAJ,CAAU,0BAAV,CAAN;AACD;;AAEDsP,EAAAA,KAAK,CAAChV,CAAD,EAAI;AACP,QAAI,KAAKzD,CAAL,CAAOgI,IAAP,CAAY,CAAZ,MAAmB,CAAnB,IAAwB,CAAC,KAAKhI,CAAL,CAAOiC,KAAP,EAA7B,EACE,MAAM,IAAIkH,KAAJ,CAAU,gBAAV,CAAN;;AAEF,YAAQ,KAAKD,MAAL,CAAYzF,CAAZ,CAAR;AACE,WAAK,CAAC,CAAN;AACE,cAAM,IAAI0F,KAAJ,CAAU,0BAAV,CAAN;;AACF,WAAK,CAAL;AACE,eAAO,IAAI7N,EAAJ,CAAO,CAAP,EAAUmS,SAAV,CAAoB,IAApB,CAAP;;AACF,WAAK,CAAL;AACE;AANJ;;AASA,UAAM0J,GAAG,GAAG,IAAI7b,EAAJ,CAAO,CAAP,EAAU0N,KAAV,CAAgB,IAAhB,CAAZ;AACA,UAAMtD,CAAC,GAAG,KAAK1F,CAAL,CAAOpC,IAAP,CAAY,CAAZ,CAAV;AACA,UAAMma,CAAC,GAAGrS,CAAC,CAAC2D,QAAF,EAAV;AAEA3D,IAAAA,CAAC,CAAC1G,MAAF,CAAS+Y,CAAT;AAEA,UAAM5T,CAAC,GAAG,IAAI7I,EAAJ,CAAO,CAAP,EAAU0N,KAAV,CAAgB,IAAhB,CAAV;;AAEA,WAAO,KAAKE,MAAL,CAAY/E,CAAZ,MAAmB,CAAC,CAA3B,EACE,KAAKzH,IAAL,CAAUyH,CAAV,EAAagT,GAAb;;AAEF,QAAIjb,CAAC,GAAG,KAAKiG,GAAL,CAASsB,CAAT,EAAYiC,CAAZ,CAAR;AACA,QAAI4E,CAAC,GAAG,KAAKnI,GAAL,CAASgC,CAAT,EAAYuB,CAAZ,CAAR;AACA,QAAIhC,CAAC,GAAG,KAAKvB,GAAL,CAASsB,CAAT,EAAYiC,CAAC,CAAC1I,KAAF,CAAQ,CAAR,EAAWgC,MAAX,CAAkB,CAAlB,CAAZ,CAAR;AACA,QAAI2B,CAAC,GAAGoX,CAAR;;AAEA,aAAS;AACP,UAAInV,CAAC,GAAG1G,CAAR;AACA,UAAI8D,CAAC,GAAG,CAAR;;AAEA,aAAO4C,CAAC,CAAC/F,GAAF,CAAMsa,GAAN,MAAe,CAAf,IAAoBnX,CAAC,GAAGW,CAA/B,EAAkC;AAChCiC,QAAAA,CAAC,GAAG,KAAKN,GAAL,CAASM,CAAT,CAAJ;AACA5C,QAAAA,CAAC,IAAI,CAAL;AACD;;AAED,UAAIA,CAAC,KAAK,CAAV,EACE;AAEF1C,MAAAA,MAAM,CAAC0C,CAAC,GAAGW,CAAL,CAAN;AAEAiC,MAAAA,CAAC,GAAG,KAAKyV,IAAL,CAAU/N,CAAV,EAAa3J,CAAC,GAAGX,CAAJ,GAAQ,CAArB,CAAJ;AACAsK,MAAAA,CAAC,GAAG,KAAKhI,GAAL,CAASM,CAAT,CAAJ;AACAc,MAAAA,CAAC,GAAG,KAAKrF,GAAL,CAASqF,CAAT,EAAYd,CAAZ,CAAJ;AACA1G,MAAAA,CAAC,GAAG,KAAKmC,GAAL,CAASnC,CAAT,EAAYoO,CAAZ,CAAJ;AACA3J,MAAAA,CAAC,GAAGX,CAAJ;AACD;;AAED,WAAO0D,CAAP;AACD;;AAEDsL,EAAAA,QAAQ,CAACrM,CAAD,EAAIG,CAAJ,EAAO;AACb,WAAO,KAAKoM,OAAL,CAAavM,CAAb,EAAgBG,CAAhB,EAAmBxE,KAAnB,CAAyBqE,CAAzB,CAAP;AACD;;AAEDuM,EAAAA,OAAO,CAACvM,CAAD,EAAIG,CAAJ,EAAO;AACZ,SAAK8U,QAAL,CAAcjV,CAAd,EAAiBG,CAAjB,EADY,CAGZ;;;AACA,QAAIA,CAAC,CAAC1D,MAAF,EAAJ,EACE,MAAM,IAAIqD,UAAJ,CAAe,iBAAf,CAAN,CALU,CAOZ;;AACA,QAAI,KAAKzC,CAAL,CAAOyH,KAAP,CAAa,CAAb,MAAoB,CAAxB,EACE,OAAO,KAAKmR,YAAL,CAAkBjW,CAAlB,EAAqBG,CAArB,CAAP,CATU,CAWZ;;AACA,QAAI,KAAK4U,GAAL,IAAY,IAAZ,IAAoB,KAAK1X,CAAL,CAAOyH,KAAP,CAAa,CAAb,MAAoB,CAA5C,EACE,OAAO,KAAKoR,YAAL,CAAkBlW,CAAlB,EAAqBG,CAArB,CAAP;AAEF,WAAO,KAAKQ,IAAL,CAAU,KAAK/B,GAAL,CAASoB,CAAT,EAAYG,CAAZ,CAAV,CAAP;AACD;;AAED8V,EAAAA,YAAY,CAACjW,CAAD,EAAIG,CAAJ,EAAO;AACjB;AACA,UAAMiV,CAAC,GAAG,KAAK/X,CAAL,CAAOpC,IAAP,CAAY,CAAZ,EAAeoB,MAAf,CAAsB,CAAtB,CAAV;AACA,UAAM8Z,EAAE,GAAG,KAAKxW,GAAL,CAASK,CAAT,CAAX;AACA,UAAMoW,EAAE,GAAG,KAAK1a,GAAL,CAASya,EAAT,EAAanW,CAAb,CAAX;AACA,UAAMqW,EAAE,GAAG,KAAK3a,GAAL,CAAS0a,EAAT,EAAaD,EAAb,CAAX;AACA,UAAMG,EAAE,GAAG,KAAK5a,GAAL,CAAS,KAAKiE,GAAL,CAASQ,CAAT,CAAT,EAAsBA,CAAtB,CAAX;AACA,UAAM3B,CAAC,GAAG,KAAKgB,GAAL,CAAS,KAAK9D,GAAL,CAAS2a,EAAT,EAAaC,EAAb,CAAT,EAA2BlB,CAA3B,CAAV;AACA,UAAMtU,CAAC,GAAG,KAAKpF,GAAL,CAAS,KAAKA,GAAL,CAAS0a,EAAT,EAAajW,CAAb,CAAT,EAA0B3B,CAA1B,CAAV;AACA,UAAMkF,CAAC,GAAG,KAAKhI,GAAL,CAASyE,CAAT,EAAY,KAAKR,GAAL,CAASmB,CAAT,CAAZ,CAAV;AAEA,QAAI4C,CAAC,CAACxJ,GAAF,CAAM8F,CAAN,MAAa,CAAjB,EACE,OAAOc,CAAP;AAEF,UAAM,IAAI0F,KAAJ,CAAU,0BAAV,CAAN;AACD;;AAED0P,EAAAA,YAAY,CAAClW,CAAD,EAAIG,CAAJ,EAAO;AACjB;AACA,UAAMiV,CAAC,GAAG,KAAK/X,CAAL,CAAOpC,IAAP,CAAY,CAAZ,EAAeoB,MAAf,CAAsB,CAAtB,CAAV;AACA,UAAMia,EAAE,GAAG,KAAK5a,GAAL,CAAS,KAAKiE,GAAL,CAASQ,CAAT,CAAT,EAAsBA,CAAtB,CAAX;AACA,UAAMoW,EAAE,GAAG,KAAK7a,GAAL,CAAS,KAAKiE,GAAL,CAAS2W,EAAT,CAAT,EAAuBnW,CAAvB,CAAX;AACA,UAAM3B,CAAC,GAAG,KAAKgB,GAAL,CAAS,KAAK9D,GAAL,CAASsE,CAAT,EAAYuW,EAAZ,CAAT,EAA0BnB,CAA1B,CAAV;AACA,UAAMtU,CAAC,GAAG,KAAKpF,GAAL,CAAS,KAAKA,GAAL,CAASsE,CAAT,EAAYsW,EAAZ,CAAT,EAA0B9X,CAA1B,CAAV;AACA,UAAMkF,CAAC,GAAG,KAAKhI,GAAL,CAASyE,CAAT,EAAY,KAAKR,GAAL,CAASmB,CAAT,CAAZ,CAAV;AAEA,QAAI4C,CAAC,CAACxJ,GAAF,CAAM8F,CAAN,MAAa,CAAjB,EACE,OAAOc,CAAP;AAEF,QAAI,KAAKhD,IAAL,CAAU4F,CAAV,EAAaxJ,GAAb,CAAiB8F,CAAjB,MAAwB,CAA5B,EACE,OAAO,KAAKtE,GAAL,CAASoF,CAAT,EAAY,KAAKiU,GAAjB,CAAP;AAEF,UAAM,IAAIvO,KAAJ,CAAU,0BAAV,CAAN;AACD;;AAED5F,EAAAA,QAAQ,CAACtH,CAAD,EAAI;AACV,QAAIkd,MAAJ;AAEA,QAAI,KAAKhD,KAAL,IAAc,KAAK0B,OAAvB,EACEsB,MAAM,GAAG,KAAKrQ,QAAL,CAAc7M,CAAd,CAAT,CADF,KAEK,IAAI,KAAK+D,CAAL,CAAOiC,KAAP,EAAJ,EACHkX,MAAM,GAAG,KAAKjQ,MAAL,CAAYjN,CAAZ,CAAT,CADG,KAGHkd,MAAM,GAAG,KAAK5P,SAAL,CAAetN,CAAf,CAAT;AAEF,WAAOmd,OAAO,CAAC,CAACD,MAAD,KAAY,EAAb,CAAd;AACD;;AAEDtT,EAAAA,IAAI,CAAC5J,CAAD,EAAIT,GAAJ,EAAS;AACX,SAAKmc,QAAL,CAAc1b,CAAd;;AACA,WAAO,KAAKyF,IAAL,CAAUzF,CAAC,CAACiK,KAAF,CAAQ1K,GAAR,CAAV,CAAP;AACD;;AAEDwK,EAAAA,GAAG,CAAC/J,CAAD,EAAIT,GAAJ,EAAS;AACV,WAAO,KAAKqK,IAAL,CAAU5J,CAAC,CAACmB,KAAF,EAAV,EAAqB5B,GAArB,CAAP;AACD;;AAEDsK,EAAAA,KAAK,CAAC7J,CAAD,EAAIT,GAAJ,EAAS;AACZ,SAAKmc,QAAL,CAAc1b,CAAd;;AAEAA,IAAAA,CAAC,CAAC8D,MAAF,CAASvE,GAAT;;AAEA,QAAIA,GAAG,IAAI,CAAX,EAAc;AACZ;AACA,aAAOS,CAAC,CAACa,IAAF,CAAO,KAAKkD,CAAZ,KAAkB,CAAzB,EACE/D,CAAC,CAACc,KAAF,CAAQd,CAAR,EAAW,KAAK+D,CAAhB;AACH,KAJD,MAIO;AACL,WAAK0B,IAAL,CAAUzF,CAAV;AACD;;AAED,WAAOA,CAAP;AACD;;AAEDgK,EAAAA,IAAI,CAAChK,CAAD,EAAIT,GAAJ,EAAS;AACX,WAAO,KAAKsK,KAAL,CAAW7J,CAAC,CAACmB,KAAF,EAAX,EAAsB5B,GAAtB,CAAP;AACD;;AAEDiF,EAAAA,IAAI,CAACxE,CAAD,EAAI;AACN,SAAK0b,QAAL,CAAc1b,CAAd;;AAEA,QAAI,CAACA,CAAC,CAACmD,MAAF,EAAL,EACEnD,CAAC,CAACc,KAAF,CAAQ,KAAKiD,CAAb,EAAgB/D,CAAhB;AAEF,WAAOA,CAAP;AACD;;AAEDuC,EAAAA,GAAG,CAACvC,CAAD,EAAI;AACL,WAAO,KAAKwE,IAAL,CAAUxE,CAAC,CAACmB,KAAF,EAAV,CAAP;AACD;;AAED6K,EAAAA,EAAE,CAAChM,CAAD,EAAIC,CAAJ,EAAO;AACP,SAAK0b,QAAL,CAAc3b,CAAd,EAAiBC,CAAjB;;AACA,WAAOD,CAAC,CAACa,IAAF,CAAOZ,CAAP,MAAc,CAArB;AACD;;AAEDgM,EAAAA,GAAG,CAACjM,CAAD,EAAIT,GAAJ,EAAS;AACV,SAAKmc,QAAL,CAAc1b,CAAd;;AAEA,QAAI,KAAK+D,CAAL,CAAOpE,MAAP,KAAkB,CAAtB,EAAyB;AACvBJ,MAAAA,GAAG,IAAI,KAAKwE,CAAL,CAAOrE,KAAP,CAAa,CAAb,CAAP;AAEA,UAAIH,GAAG,GAAG,CAAV,EACEA,GAAG,IAAI,KAAKwE,CAAL,CAAOrE,KAAP,CAAa,CAAb,CAAP;AAEF,aAAOM,CAAC,CAACyG,KAAF,CAAQlH,GAAR,MAAiB,CAAxB;AACD;;AAED,QAAIA,GAAG,GAAG,CAAV,EAAa;AACX,WAAKwE,CAAL,CAAO9C,MAAP,CAAc,CAAC1B,GAAf;;AAEA,YAAMqB,GAAG,GAAGZ,CAAC,CAACa,IAAF,CAAO,KAAKkD,CAAZ,CAAZ;;AAEA,WAAKA,CAAL,CAAOzD,MAAP,CAAc,CAACf,GAAf;;AAEA,aAAOqB,GAAG,KAAK,CAAf;AACD;;AAED,WAAOZ,CAAC,CAACyG,KAAF,CAAQlH,GAAR,MAAiB,CAAxB;AACD;;AAEDqU,EAAAA,MAAM,CAAC5T,CAAD,EAAI;AACR,WAAO,CAAC,KAAK8T,KAAL,CAAW9T,CAAX,CAAR;AACD;;AAED8T,EAAAA,KAAK,CAAC9T,CAAD,EAAI;AACP,SAAK0b,QAAL,CAAc1b,CAAd;;AACA,WAAOA,CAAC,CAACa,IAAF,CAAO,KAAKkD,CAAL,CAAOgH,KAAP,CAAa,CAAb,CAAP,KAA2B,CAAlC;AACD;;AAED/E,EAAAA,KAAK,CAAChG,CAAD,EAAI;AACP,SAAK0b,QAAL,CAAc1b,CAAd;;AACA,WAAOA,CAAC,CAACgG,KAAF,EAAP;AACD;;AAED4G,EAAAA,MAAM,CAAC5M,CAAD,EAAI;AACR,SAAK0b,QAAL,CAAc1b,CAAd;;AACA,WAAOA,CAAC,CAAC4M,MAAF,EAAP;AACD;;AAEDC,EAAAA,QAAQ,CAACtN,GAAD,EAAM;AACZ,SAAKmc,QAAL,CAAcnc,GAAd;;AAEA,QAAI,KAAKwE,CAAL,CAAO6I,MAAP,EAAJ,EACE,MAAM,IAAIM,KAAJ,CAAU,8BAAV,CAAN,CAJU,CAMZ;;AACA,UAAM4O,CAAC,GAAG,KAAK/X,CAAL,CAAOpC,IAAP,CAAY,CAAZ,EAAeoB,MAAf,CAAsB,CAAtB,CAAV,CAPY,CAOwB;;AACpC,UAAMma,MAAM,GAAG,KAAKhX,GAAL,CAAS3G,GAAT,EAAcuc,CAAd,CAAf;AACA,UAAMZ,GAAG,GAAG,IAAI7b,EAAJ,CAAO,CAAP,EAAU0N,KAAV,CAAgB,IAAhB,CAAZ;AACA,UAAM/M,CAAC,GAAGkd,MAAM,CAACxH,KAAP,EAAV;AACA,UAAMzV,CAAC,GAAGid,MAAM,CAACpH,GAAP,CAAWoF,GAAX,CAAV;AACA,UAAM9Q,CAAC,GAAG8S,MAAM,CAACpH,GAAP,CAAW,KAAKtR,IAAL,CAAU0W,GAAV,CAAX,CAAV,CAZY,CAcZ;;AACA,QAAI,CAAClb,CAAC,GAAGC,CAAJ,GAAQmK,CAAT,MAAgB,CAApB,EACE,MAAM,IAAI8C,KAAJ,CAAU,gBAAV,CAAN,CAhBU,CAkBZ;;AACA7L,IAAAA,MAAM,CAACrB,CAAC,GAAGC,CAAJ,GAAQmK,CAAR,KAAc,CAAf,CAAN,CAnBY,CAqBZ;;AACA,WAAOnK,CAAC,GAAGmK,CAAX;AACD;;AAED6C,EAAAA,MAAM,CAACjN,CAAD,EAAI;AACR,SAAK0b,QAAL,CAAc1b,CAAd;;AACA,WAAOA,CAAC,CAACiN,MAAF,CAAS,KAAKlJ,CAAd,CAAP;AACD;;AAEDuJ,EAAAA,SAAS,CAACtN,CAAD,EAAI;AACX,SAAK0b,QAAL,CAAc1b,CAAd;;AACA,WAAOA,CAAC,CAACsN,SAAF,CAAY,KAAKvJ,CAAjB,CAAP;AACD;;AAED2K,EAAAA,OAAO,CAAC1O,CAAD,EAAI;AACT,WAAO,KAAK2O,MAAL,CAAY3O,CAAZ,EAAeqC,KAAf,CAAqBrC,CAArB,CAAP;AACD;;AAED2O,EAAAA,MAAM,CAAC3O,CAAD,EAAI;AACR,SAAK0b,QAAL,CAAc1b,CAAd;;AAEA,QAAI,KAAKka,KAAT,EACE,OAAO,KAAKzU,IAAL,CAAUzF,CAAC,CAAC0U,QAAF,CAAW,KAAK3Q,CAAhB,CAAV,CAAP;AAEF,WAAO/D,CAAC,CAAC2O,MAAF,CAAS,KAAK5K,CAAd,EAAiByN,SAAjB,CAA2B,IAA3B,CAAP;AACD;;AAED3C,EAAAA,OAAO,CAAC7O,CAAD,EAAI;AACT,WAAO,KAAK8O,MAAL,CAAY9O,CAAZ,EAAeqC,KAAf,CAAqBrC,CAArB,CAAP;AACD;;AAED8O,EAAAA,MAAM,CAAC9O,CAAD,EAAI;AACR,SAAK0b,QAAL,CAAc1b,CAAd;;AAEA,QAAIA,CAAC,CAACmD,MAAF,MAAc,KAAKY,CAAL,CAAOgI,IAAP,CAAY,CAAZ,MAAmB,CAArC,EACE,MAAM,IAAIvF,UAAJ,CAAe,iBAAf,CAAN,CAJM,CAMR;;AACA,WAAO,KAAKN,GAAL,CAASlG,CAAT,EAAY,KAAK+D,CAAL,CAAOpC,IAAP,CAAY,CAAZ,CAAZ,CAAP;AACD;;AAED,GAAC7D,MAAD,IAAW;AACT,QAAI,KAAKoc,KAAT,EACE,OAAQ,SAAQ,KAAKA,KAAL,CAAWD,IAAK,GAAhC;AAEF,WAAQ,SAAQ,KAAKlW,CAAL,CAAOgN,QAAP,CAAgB,EAAhB,CAAoB,GAApC;AACD;;AA3rBO;AA8rBV;;;;;AAIA,MAAM+I,OAAN,SAAsB1I,GAAtB,CAA0B;AACxB9R,EAAAA,WAAW,CAACyE,CAAD,EAAI;AACb,UAAMA,CAAN;AAEA,SAAKmW,KAAL,GAAa,IAAb;AACA,SAAKhS,CAAL,GAAS,KAAKnE,CAAL,CAAO6C,SAAP,EAAT;AAEA,QAAK,KAAKsB,CAAL,GAAS,EAAV,KAAkB,CAAtB,EACE,KAAKA,CAAL,IAAU,KAAM,KAAKA,CAAL,GAAS,EAAzB;AAEF,SAAKxD,CAAL,GAAS,KAAKwD,CAAL,GAAS,CAAlB;AACA,SAAK1F,CAAL,GAAS,KAAKkC,CAAL,GAAS,EAAlB;AACA,SAAKzE,CAAL,GAASZ,EAAE,CAACuE,KAAH,CAAS,CAAT,EAAY,KAAKc,CAAjB,EAAoBY,GAApB,CAAwB,KAAKvB,CAA7B,CAAT;AACD;;AAEDsN,EAAAA,SAAS,CAAC9R,GAAD,EAAM;AACb,QAAIA,GAAG,CAACI,MAAJ,GAAa,KAAK6C,CAAtB,EACE,OAAO,MAAM6O,SAAN,CAAgB9R,GAAhB,CAAP;AAEF,WAAO,KAAKkG,IAAL,CAAUlG,GAAG,CAAC4B,KAAJ,EAAV,CAAP;AACD;;AAEDic,EAAAA,MAAM,CAAC9Z,CAAD,EAAI;AACR,QAAInD,CAAC,GAAG,CAAR;AACA,QAAI+D,CAAC,GAAG,KAAK1B,CAAb;;AAEA,WAAO0B,CAAC,GAAGZ,CAAC,CAAC3D,MAAb,EACE2D,CAAC,CAAC5D,KAAF,CAAQS,CAAC,EAAT,IAAemD,CAAC,CAAC5D,KAAF,CAAQwE,CAAC,EAAT,CAAf;;AAEF,QAAI/D,CAAC,KAAK,CAAV,EACEmD,CAAC,CAAC5D,KAAF,CAAQS,CAAC,EAAT,IAAe,CAAf;AAEFmD,IAAAA,CAAC,CAAC3D,MAAF,GAAWQ,CAAX;AACD;;AAEDsF,EAAAA,IAAI,CAACzF,CAAD,EAAI;AACN,UAAMuC,GAAG,GAAGvC,CAAC,CAACJ,QAAd;AAEAyB,IAAAA,MAAM,CAACrB,CAAC,CAACL,MAAF,IAAY,KAAK6C,CAAlB,CAAN;AAEAxC,IAAAA,CAAC,CAACJ,QAAF,GAAa,CAAb;AAEA,UAAM0D,CAAC,GAAGtD,CAAC,CAACoC,GAAF,CAAM,KAAKnC,CAAX,CAAV,CAPM,CASN;;AACA,SAAKmd,MAAL,CAAY9Z,CAAZ;;AAEAtD,IAAAA,CAAC,CAACc,KAAF,CAAQd,CAAR,EAAWsD,CAAC,CAAClB,GAAF,CAAM,KAAK2B,CAAX,CAAX;;AAEA,QAAI/D,CAAC,CAACa,IAAF,CAAO,KAAKkD,CAAZ,KAAkB,CAAtB,EACE/D,CAAC,CAACc,KAAF,CAAQd,CAAR,EAAW,KAAK+D,CAAhB;AAEF,QAAIxB,GAAG,IAAI,CAACvC,CAAC,CAACmD,MAAF,EAAZ,EACEnD,CAAC,CAACc,KAAF,CAAQ,KAAKiD,CAAb,EAAgB/D,CAAhB;AAEFA,IAAAA,CAAC,CAACH,GAAF,GAAQ,IAAR;AAEA,WAAOG,CAAP;AACD;;AA1DuB;AA6D1B;;;;;AAIA,MAAM+Z,IAAN,SAAmB3I,GAAnB,CAAuB;AACrB9R,EAAAA,WAAW,CAACyE,CAAD,EAAI;AACb,UAAMA,CAAN;AAEA,SAAKmW,KAAL,GAAa,IAAb;AACA,SAAKhS,CAAL,GAAS,KAAKnE,CAAL,CAAO6C,SAAP,EAAT;AAEA,QAAK,KAAKsB,CAAL,GAAS,EAAV,KAAkB,CAAtB,EACE,KAAKA,CAAL,IAAU,KAAM,KAAKA,CAAL,GAAS,EAAzB;AAEF,SAAK7H,CAAL,GAAShB,EAAE,CAACuE,KAAH,CAAS,CAAT,EAAY,KAAKsE,CAAjB,CAAT;AACA,SAAKmV,EAAL,GAAUhe,EAAE,CAACuE,KAAH,CAAS,CAAT,EAAY,KAAKsE,CAAL,GAAS,CAArB,EAAwBzC,IAAxB,CAA6B,KAAK1B,CAAlC,CAAV;AACA,SAAKuZ,EAAL,GAAU,KAAKjd,CAAL,CAAOqU,QAAP,CAAgB,KAAK3Q,CAArB,EAAwB0B,IAAxB,CAA6B,KAAK1B,CAAlC,CAAV;AACA,SAAKwZ,EAAL,GAAU,KAAKld,CAAL,CAAO+B,GAAP,CAAW,KAAKkb,EAAhB,EAAoB7b,KAApB,CAA0B,CAA1B,EAA6B6D,GAA7B,CAAiC,KAAKvB,CAAtC,CAAV;AACA,SAAKyZ,GAAL,GAAW,IAAX;AACD;;AAED,MAAI1Q,IAAJ,GAAW;AACT,WAAO,IAAP;AACD;;AAED,MAAI8O,OAAJ,GAAc;AACZ,WAAO,IAAP;AACD;;AAEDvK,EAAAA,SAAS,CAAC9R,GAAD,EAAM;AACb,WAAO,KAAKkG,IAAL,CAAUlG,GAAG,CAAC+K,KAAJ,CAAU,KAAKpC,CAAf,CAAV,CAAP;AACD;;AAEDoJ,EAAAA,WAAW,CAAC/R,GAAD,EAAM;AACf,UAAMc,CAAC,GAAG,KAAKoF,IAAL,CAAUlG,GAAG,CAAC6C,GAAJ,CAAQ,KAAKkb,EAAb,CAAV,CAAV;AACAjd,IAAAA,CAAC,CAACR,GAAF,GAAQ,IAAR;AACA,WAAOQ,CAAP;AACD;;AAED0b,EAAAA,KAAK,CAAC/b,CAAD,EAAI;AACP,WAAO,CAACA,CAAC,IAAIZ,MAAM,CAAC,KAAK8I,CAAN,CAAZ,IAAwB,KAAKsT,EAApC;AACD;;AAEDQ,EAAAA,OAAO,CAAChc,CAAD,EAAI;AACT,QAAI,KAAKwd,GAAL,KAAa,IAAjB,EACE,KAAKA,GAAL,GAAW,KAAKF,EAAL,CAAQ7G,QAAR,EAAX;AAEF,WAAQzW,CAAC,GAAG,KAAKwd,GAAV,GAAiB,KAAKhC,EAA7B;AACD;;AAEDza,EAAAA,KAAK,CAACf,CAAD,EAAIT,GAAJ,EAAS;AACZ,WAAO,KAAKkB,IAAL,CAAUT,CAAV,EAAa,KAAKqR,SAAL,CAAe,IAAIhS,EAAJ,CAAOE,GAAP,CAAf,CAAb,CAAP;AACD;;AAEDkC,EAAAA,KAAK,CAACzB,CAAD,EAAIT,GAAJ,EAAS;AACZ,WAAO,KAAKiC,IAAL,CAAUxB,CAAV,EAAa,KAAKqR,SAAL,CAAe,IAAIhS,EAAJ,CAAOE,GAAP,CAAf,CAAb,CAAP;AACD;;AAED4C,EAAAA,IAAI,CAACnC,CAAD,EAAIC,CAAJ,EAAO;AACT,WAAO,KAAKmC,GAAL,CAASpC,CAAT,EAAYC,CAAZ,EAAeoC,KAAf,CAAqBrC,CAArB,CAAP;AACD;;AAEDoC,EAAAA,GAAG,CAACpC,CAAD,EAAIC,CAAJ,EAAO;AACR,SAAK0b,QAAL,CAAc3b,CAAd,EAAiBC,CAAjB;;AAEA,QAAID,CAAC,CAACmD,MAAF,MAAclD,CAAC,CAACkD,MAAF,EAAlB,EACE,OAAO,IAAI9D,EAAJ,CAAO,CAAP,EAAUmS,SAAV,CAAoB,IAApB,CAAP;AAEF,UAAM7K,CAAC,GAAG3G,CAAC,CAACoC,GAAF,CAAMnC,CAAN,CAAV;AACA,UAAMmK,CAAC,GAAGzD,CAAC,CAAC4E,MAAF,CAAS,KAAKrD,CAAd,EAAiB9F,GAAjB,CAAqB,KAAKmb,EAA1B,EAA8BlS,OAA9B,CAAsC,KAAKnD,CAA3C,CAAV;AACA,UAAMxB,CAAC,GAAGC,CAAC,CAAClG,IAAF,CAAO2J,CAAC,CAAChI,GAAF,CAAM,KAAK2B,CAAX,CAAP,EAAsBhB,MAAtB,CAA6B,KAAKmF,CAAlC,CAAV;AAEA,QAAIxB,CAAC,CAAC7F,IAAF,CAAO,KAAKkD,CAAZ,KAAkB,CAAtB,EACE2C,CAAC,CAAC5F,KAAF,CAAQ4F,CAAR,EAAW,KAAK3C,CAAhB;AAEF,WAAO2C,CAAC,CAAC8K,SAAF,CAAY,IAAZ,CAAP;AACD;;AAEDlP,EAAAA,KAAK,CAACtC,CAAD,EAAIT,GAAJ,EAAS;AACZ,SAAKmc,QAAL,CAAc1b,CAAd;;AAEA,QAAIA,CAAC,CAACmD,MAAF,EAAJ,EACE,OAAOnD,CAAP;;AAEF,QAAIT,GAAG,KAAK,CAAZ,EAAe;AACbS,MAAAA,CAAC,CAACN,KAAF,CAAQ,CAAR,IAAa,CAAb;AACAM,MAAAA,CAAC,CAACL,MAAF,GAAW,CAAX;AACA,aAAOK,CAAP;AACD;;AAED,UAAMuC,GAAG,GAAGhD,GAAG,GAAG,CAAlB;AAEA,QAAIgD,GAAJ,EACEhD,GAAG,GAAG,CAACA,GAAP;AAEF,QAAI,KAAKwE,CAAL,CAAOpE,MAAP,KAAkB,CAAtB,EACEJ,GAAG,IAAI,KAAKwE,CAAL,CAAOrE,KAAP,CAAa,CAAb,CAAP;AAEF,UAAMmD,IAAI,GAAGgB,SAAS,CAACtE,GAAD,CAAtB,CApBY,CAsBZ;AACA;;AACA,QAAIsD,IAAI,GAAG,CAAX,EAAc;AACZ;AACA,WAAKV,IAAL,CAAUnC,CAAV,EAAa,KAAKqR,SAAL,CAAe,IAAIhS,EAAJ,CAAOE,GAAP,CAAf,CAAb;AACD,KAHD,MAGO,IAAI,CAACA,GAAG,GAAIA,GAAG,GAAG,CAAd,MAAsB,CAA1B,EAA6B;AAClC;AACA,WAAK,IAAIY,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0C,IAAI,GAAG,CAA3B,EAA8B1C,CAAC,EAA/B,EACE,KAAKM,IAAL,CAAUT,CAAV,EAAaA,CAAb;AACH,KAJM,MAIA;AACL;AACA,YAAMoK,CAAC,GAAGpK,CAAC,CAACmB,KAAF,EAAV;;AAEA,WAAK,IAAIhB,CAAC,GAAG0C,IAAI,GAAG,CAApB,EAAuB1C,CAAC,IAAI,CAA5B,EAA+BA,CAAC,EAAhC,EAAoC;AAClC,aAAKM,IAAL,CAAUT,CAAV,EAAaA,CAAb;AAEA,YAAKT,GAAG,IAAIY,CAAR,GAAa,CAAjB,EACE,KAAKM,IAAL,CAAUT,CAAV,EAAaoK,CAAb;AACH;AACF;;AAED,QAAI7H,GAAJ,EACE,KAAKiC,IAAL,CAAUxE,CAAV;AAEF,WAAOA,CAAP;AACD;;AAEDiM,EAAAA,GAAG,CAACjM,CAAD,EAAIT,GAAJ,EAAS;AACV,SAAKmc,QAAL,CAAc1b,CAAd;;AAEA,QAAIT,GAAG,KAAK,CAAZ,EACE,OAAOS,CAAC,CAACmD,MAAF,EAAP;AAEF,WAAOnD,CAAC,CAACa,IAAF,CAAO,KAAKwQ,SAAL,CAAe,IAAIhS,EAAJ,CAAOE,GAAP,CAAf,CAAP,MAAwC,CAA/C;AACD;;AAEDuU,EAAAA,KAAK,CAAC9T,CAAD,EAAI;AACP,SAAK0b,QAAL,CAAc1b,CAAd;;AACA,WAAO,KAAKsR,WAAL,CAAiBtR,CAAjB,EAAoBa,IAApB,CAAyB,KAAKkD,CAAL,CAAOgH,KAAP,CAAa,CAAb,CAAzB,KAA6C,CAApD;AACD;;AAED/E,EAAAA,KAAK,CAAChG,CAAD,EAAI;AACP,SAAK0b,QAAL,CAAc1b,CAAd;;AACA,WAAO,KAAKsR,WAAL,CAAiBtR,CAAjB,EAAoBgG,KAApB,EAAP;AACD;;AAED4G,EAAAA,MAAM,CAAC5M,CAAD,EAAI;AACR,SAAK0b,QAAL,CAAc1b,CAAd;;AACA,WAAO,KAAKsR,WAAL,CAAiBtR,CAAjB,EAAoB4M,MAApB,EAAP;AACD;;AAED+B,EAAAA,MAAM,CAAC3O,CAAD,EAAI;AACR,SAAK0b,QAAL,CAAc1b,CAAd,EADQ,CAGR;;;AACA,WAAO,KAAKyF,IAAL,CAAUzF,CAAC,CAAC0U,QAAF,CAAW,KAAK3Q,CAAhB,EAAmB3B,GAAnB,CAAuB,KAAKib,EAA5B,CAAV,CAAP;AACD;;AAxJoB;AA2JvB;;;;;AAIA,SAASI,SAAT,CAAmBvQ,KAAnB,EAA0BwQ,GAA1B,EAA+B1F,KAA/B,EAAsC;AACpC,QAAM2F,GAAG,GAAG,IAAIzQ,KAAJ,CAAUwQ,GAAV,CAAZ;AAEA,MAAIxQ,KAAK,CAAC0Q,iBAAV,EACE1Q,KAAK,CAAC0Q,iBAAN,CAAwBD,GAAxB,EAA6B3F,KAA7B;AAEF,SAAO2F,GAAP;AACD;;AAED,SAAStc,MAAT,CAAgB8W,KAAhB,EAAuB0F,OAAvB,EAAgC;AAC9B,MAAI,CAAC1F,KAAL,EAAY;AACV,UAAMuF,GAAG,GAAGG,OAAO,IAAI,mBAAvB;AACA,UAAMJ,SAAS,CAACvQ,KAAD,EAAQwQ,GAAR,EAAarc,MAAb,CAAf;AACD;AACF;;AAED,SAASX,OAAT,CAAiByX,KAAjB,EAAwB8B,IAAxB,EAA8B6D,IAA9B,EAAoC;AAClC,MAAI,CAAC3F,KAAL,EAAY;AACV,UAAMuF,GAAG,GAAI,IAAGzD,IAAK,kBAAiB6D,IAAK,GAA3C;AACA,UAAML,SAAS,CAAC9D,SAAD,EAAY+D,GAAZ,EAAiBhd,OAAjB,CAAf;AACD;AACF;;AAED,SAASkO,KAAT,CAAeuJ,KAAf,EAAsB8B,IAAtB,EAA4B;AAC1B,MAAI,CAAC9B,KAAL,EAAY;AACV,UAAMuF,GAAG,GAAI,IAAGzD,IAAK,qCAArB;AACA,UAAMwD,SAAS,CAACjX,UAAD,EAAakX,GAAb,EAAkB9O,KAAlB,CAAf;AACD;AACF;;AAED,SAAS/O,GAAT,CAAasY,KAAb,EAAoB8B,IAApB,EAA0B;AACxB,MAAI,CAAC9B,KAAL,EAAY;AACV,UAAMuF,GAAG,GAAI,IAAGzD,IAAK,gCAArB;AACA,UAAMwD,SAAS,CAAC9D,SAAD,EAAY+D,GAAZ,EAAiB7d,GAAjB,CAAf;AACD;AACF;;AAED,SAAS6S,MAAT,CAAgByF,KAAhB,EAAuB8B,IAAvB,EAA6B;AAC3B,MAAI,CAAC9B,KAAL,EAAY;AACV,UAAMuF,GAAG,GAAI,IAAGzD,IAAK,mCAArB;AACA,UAAMwD,SAAS,CAAC9D,SAAD,EAAY+D,GAAZ,EAAiBhL,MAAjB,CAAf;AACD;AACF;;AAED,SAASxP,OAAT,CAAiBiV,KAAjB,EAAwB;AACtB,MAAI,CAACA,KAAL,EAAY;AACV,UAAMuF,GAAG,GAAG,wBAAZ;AACA,UAAMD,SAAS,CAACjX,UAAD,EAAakX,GAAb,EAAkBxa,OAAlB,CAAf;AACD;AACF;;AAED,SAASyU,SAAT,CAAmBpY,GAAnB,EAAwB;AACtB,SAAOwe,MAAM,CAACC,aAAP,CAAqBze,GAArB,CAAP;AACD;;AAED,SAASyB,KAAT,CAAezB,GAAf,EAAoB;AAClB,SAAOoY,SAAS,CAACpY,GAAD,CAAT,IACAA,GAAG,IAAI,CAAC,SADR,IAEAA,GAAG,IAAI,SAFd;AAGD;;AAED,SAASiY,QAAT,CAAkBF,SAAlB,EAA6B/C,IAA7B,EAAmC;AACjC,MAAI+C,SAAS,CAAC2G,eAAd,EACE,OAAO3G,SAAS,CAAC2G,eAAV,CAA0B1J,IAA1B,CAAP;AAEF,SAAO,IAAI+C,SAAJ,CAAc/C,IAAd,CAAP;AACD;;AAED,SAASuC,OAAT,CAAiBtX,IAAjB,EAAuB;AACrB,MAAIA,IAAI,IAAI,IAAZ,EACE,OAAO,EAAP;AAEF,MAAI,OAAOA,IAAP,KAAgB,QAApB,EACE,OAAOA,IAAP;;AAEF,UAAQA,IAAR;AACE,SAAK,KAAL;AACE,aAAO,CAAP;;AACF,SAAK,KAAL;AACE,aAAO,CAAP;;AACF,SAAK,KAAL;AACE,aAAO,EAAP;;AACF,SAAK,KAAL;AACE,aAAO,EAAP;AARJ;;AAWA,SAAO,CAAP;AACD;AAED;;;;;AAIA,SAASqE,SAAT,CAAmBrB,CAAnB,EAAsB;AACpB,MAAIjC,IAAI,CAAC2d,KAAT,EACE,OAAO,KAAK3d,IAAI,CAAC2d,KAAL,CAAW1b,CAAX,CAAZ;AAEF,MAAImE,CAAC,GAAGnE,CAAR;AACA,MAAInC,CAAC,GAAG,CAAR;;AAEA,MAAIsG,CAAC,IAAI,MAAT,EAAiB;AACftG,IAAAA,CAAC,IAAI,EAAL;AACAsG,IAAAA,CAAC,MAAM,EAAP;AACD;;AAED,MAAIA,CAAC,IAAI,IAAT,EAAe;AACbtG,IAAAA,CAAC,IAAI,CAAL;AACAsG,IAAAA,CAAC,MAAM,CAAP;AACD;;AAED,MAAIA,CAAC,IAAI,GAAT,EAAc;AACZtG,IAAAA,CAAC,IAAI,CAAL;AACAsG,IAAAA,CAAC,MAAM,CAAP;AACD;;AAED,MAAIA,CAAC,IAAI,IAAT,EAAe;AACbtG,IAAAA,CAAC,IAAI,CAAL;AACAsG,IAAAA,CAAC,MAAM,CAAP;AACD;;AAED,SAAOtG,CAAC,GAAGsG,CAAX;AACD;;AAED,SAASyG,QAAT,CAAkB5K,CAAlB,EAAqB;AACnB;AACA,MAAIA,CAAC,KAAK,CAAV,EACE,OAAO,EAAP;AAEF,MAAImE,CAAC,GAAGnE,CAAR;AACA,MAAInC,CAAC,GAAG,CAAR;;AAEA,MAAI,CAACsG,CAAC,GAAG,MAAL,MAAiB,CAArB,EAAwB;AACtBtG,IAAAA,CAAC,IAAI,EAAL;AACAsG,IAAAA,CAAC,MAAM,EAAP;AACD;;AAED,MAAI,CAACA,CAAC,GAAG,IAAL,MAAe,CAAnB,EAAsB;AACpBtG,IAAAA,CAAC,IAAI,CAAL;AACAsG,IAAAA,CAAC,MAAM,CAAP;AACD;;AAED,MAAI,CAACA,CAAC,GAAG,GAAL,MAAc,CAAlB,EAAqB;AACnBtG,IAAAA,CAAC,IAAI,CAAL;AACAsG,IAAAA,CAAC,MAAM,CAAP;AACD;;AAED,MAAI,CAACA,CAAC,GAAG,GAAL,MAAc,CAAlB,EAAqB;AACnBtG,IAAAA,CAAC,IAAI,CAAL;AACAsG,IAAAA,CAAC,MAAM,CAAP;AACD;;AAED,MAAI,CAACA,CAAC,GAAG,GAAL,MAAc,CAAlB,EACEtG,CAAC,IAAI,CAAL;AAEF,SAAOA,CAAP;AACD;;AAED,SAASoY,QAAT,CAAkBJ,GAAlB,EAAuBL,KAAvB,EAA8Ba,GAA9B,EAAmC;AACjC,QAAM9W,GAAG,GAAGxB,IAAI,CAACgE,GAAL,CAAS8T,GAAG,CAAC1Y,MAAb,EAAqBkZ,GAArB,CAAZ;AAEA,MAAIxY,CAAC,GAAG,CAAR;AACA,MAAImN,CAAC,GAAG,CAAR;;AAEA,OAAK,IAAIrN,CAAC,GAAG6X,KAAb,EAAoB7X,CAAC,GAAG4B,GAAxB,EAA6B5B,CAAC,EAA9B,EAAkC;AAChC,UAAMiK,CAAC,GAAGiO,GAAG,CAACE,UAAJ,CAAepY,CAAf,IAAoB,EAA9B;AAEAE,IAAAA,CAAC,KAAK,CAAN;AAEA,QAAIJ,CAAJ;;AAEA,QAAImK,CAAC,IAAI,EAAL,IAAWA,CAAC,IAAI,EAApB,EAAwB;AACtB;AACAnK,MAAAA,CAAC,GAAGmK,CAAC,GAAG,EAAJ,GAAS,GAAb;AACD,KAHD,MAGO,IAAIA,CAAC,IAAI,EAAL,IAAWA,CAAC,IAAI,EAApB,EAAwB;AAC7B;AACAnK,MAAAA,CAAC,GAAGmK,CAAC,GAAG,EAAJ,GAAS,GAAb;AACD,KAHM,MAGA;AACL;AACAnK,MAAAA,CAAC,GAAGmK,CAAJ;AACD;;AAED/J,IAAAA,CAAC,IAAIJ,CAAL;AACAuN,IAAAA,CAAC,IAAIvN,CAAL;AACD;;AAED,MAAIuN,CAAC,GAAG,CAAC,EAAT,EACE,MAAM,IAAIN,KAAJ,CAAU,iBAAV,CAAN;AAEF,SAAO7M,CAAP;AACD;;AAED,SAASyY,SAAT,CAAmBT,GAAnB,EAAwBL,KAAxB,EAA+Ba,GAA/B,EAAoCzW,GAApC,EAAyC;AACvC,QAAML,GAAG,GAAGxB,IAAI,CAACgE,GAAL,CAAS8T,GAAG,CAAC1Y,MAAb,EAAqBkZ,GAArB,CAAZ;AAEA,MAAIxY,CAAC,GAAG,CAAR;;AAEA,OAAK,IAAIF,CAAC,GAAG6X,KAAb,EAAoB7X,CAAC,GAAG4B,GAAxB,EAA6B5B,CAAC,EAA9B,EAAkC;AAChC,UAAMiK,CAAC,GAAGiO,GAAG,CAACE,UAAJ,CAAepY,CAAf,IAAoB,EAA9B;AAEAE,IAAAA,CAAC,IAAI+B,GAAL;AAEA,QAAInC,CAAJ;;AAEA,QAAImK,CAAC,IAAI,EAAT,EAAa;AACX;AACAnK,MAAAA,CAAC,GAAGmK,CAAC,GAAG,EAAJ,GAAS,GAAb;AACD,KAHD,MAGO,IAAIA,CAAC,IAAI,EAAT,EAAa;AAClB;AACAnK,MAAAA,CAAC,GAAGmK,CAAC,GAAG,EAAJ,GAAS,GAAb;AACD,KAHM,MAGA;AACL;AACAnK,MAAAA,CAAC,GAAGmK,CAAJ;AACD;;AAED,QAAIA,CAAC,GAAG,CAAJ,IAASA,CAAC,GAAG,GAAb,IAAoBnK,CAAC,IAAImC,GAA7B,EACE,MAAM,IAAI8K,KAAJ,CAAU,iBAAV,CAAN;AAEF7M,IAAAA,CAAC,IAAIJ,CAAL;AACD;;AAED,SAAOI,CAAP;AACD;AAED;;;;;AAIA,SAAS4b,MAAT,CAAgBzU,CAAhB,EAAmBsU,CAAnB,EAAsB/X,CAAtB,EAAyB;AACvB;AACA,QAAMoY,GAAG,GAAG,IAAIzZ,KAAJ,CAAUxD,QAAV,CAAZ;AAEAid,EAAAA,GAAG,CAAC,CAAD,CAAH,GAASC,IAAI,CAAC5U,CAAD,EAAIvI,SAAS,GAAG,CAAhB,EAAmB8E,CAAnB,CAAb;AACAoY,EAAAA,GAAG,CAAC,CAAD,CAAH,GAASA,GAAG,CAAC,CAAD,CAAH,GAAS3U,CAAlB;;AAEA,OAAK,IAAIrH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjB,QAApB,EAA8BiB,CAAC,EAA/B,EACEgc,GAAG,CAAChc,CAAD,CAAH,GAAUgc,GAAG,CAAChc,CAAC,GAAG,CAAL,CAAH,GAAaqH,CAAd,GAAmBzD,CAA5B;;AAEF,MAAI5D,CAAC,GAAG2b,CAAC,CAAClV,SAAF,EAAR;AACA,MAAIvG,CAAC,GAAGjB,MAAM,CAAC,CAAD,CAAd;;AAEA,SAAOe,CAAC,IAAIlB,SAAZ,EAAuB;AACrB,UAAMwM,GAAG,GAAGtL,CAAC,GAAGlB,SAAhB;AACA,UAAM4D,IAAI,GAAGiZ,CAAC,CAACjZ,IAAF,CAAO4I,GAAP,EAAYxM,SAAZ,CAAb;;AAEA,QAAI4D,IAAI,GAAG3D,QAAX,EAAqB;AACnBmB,MAAAA,CAAC,GAAIA,CAAC,GAAGA,CAAL,GAAU0D,CAAd;AACA5D,MAAAA,CAAC,IAAI,CAAL;AACA;AACD;;AAEDE,IAAAA,CAAC,GAAG+b,IAAI,CAAC/b,CAAD,EAAIpB,SAAJ,EAAe8E,CAAf,CAAR;AACA1D,IAAAA,CAAC,GAAIA,CAAC,GAAG8b,GAAG,CAACtZ,IAAI,GAAG,CAAC3D,QAAT,CAAR,GAA8B6E,CAAlC;AACA5D,IAAAA,CAAC,GAAGsL,GAAJ;AACD;;AAED,MAAItL,CAAC,GAAG,CAAR,EAAW;AACT,UAAM0C,IAAI,GAAGiZ,CAAC,CAACjZ,IAAF,CAAO,CAAP,EAAU1C,CAAV,CAAb;;AAEA,WAAOA,CAAC,EAAR,EAAY;AACVE,MAAAA,CAAC,GAAIA,CAAC,GAAGA,CAAL,GAAU0D,CAAd;AAEA,UAAKlB,IAAI,IAAI1C,CAAT,GAAc,CAAlB,EACEE,CAAC,GAAIA,CAAC,GAAGmH,CAAL,GAAUzD,CAAd;AACH;AACF;;AAED,SAAO1D,CAAP;AACD;;AAED,SAAS+b,IAAT,CAAc5U,CAAd,EAAiBU,CAAjB,EAAoBnE,CAApB,EAAuB;AACrB,OAAK,IAAI5D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG+H,CAApB,EAAuB/H,CAAC,EAAxB,EACEqH,CAAC,GAAIA,CAAC,GAAGA,CAAL,GAAUzD,CAAd;;AACF,SAAOyD,CAAP;AACD;AAED;;;;;AAIA,SAASxF,UAAT,CAAoBmc,IAApB,EAA0B5e,GAA1B,EAA+BsC,GAA/B,EAAoC;AAClC,QAAME,GAAG,GAAGoc,IAAI,CAACxe,MAAL,GAAcJ,GAAG,CAACI,MAA9B;AAEAkC,EAAAA,GAAG,CAACjC,QAAJ,GAAeue,IAAI,CAACve,QAAL,GAAgBL,GAAG,CAACK,QAAnC;;AACAiC,EAAAA,GAAG,CAACzB,MAAJ,CAAW2B,GAAX;;AACAF,EAAAA,GAAG,CAAClC,MAAJ,GAAaoC,GAAb,CALkC,CAOlC;AACA;;AACA,QAAM/B,CAAC,GAAGme,IAAI,CAACze,KAAL,CAAW,CAAX,CAAV;AACA,QAAMO,CAAC,GAAGV,GAAG,CAACG,KAAJ,CAAU,CAAV,CAAV;AACA,QAAMW,CAAC,GAAGL,CAAC,GAAGC,CAAd;AACA,QAAMwC,EAAE,GAAGpC,CAAC,GAAG,SAAf;AAEA,MAAIH,KAAK,GAAIG,CAAC,GAAG,SAAL,GAAkB,CAA9B;AACA,MAAIqE,CAAC,GAAG,CAAR;AAEA7C,EAAAA,GAAG,CAACnC,KAAJ,CAAU,CAAV,IAAe+C,EAAf;;AAEA,SAAOiC,CAAC,GAAG7C,GAAG,CAAClC,MAAJ,GAAa,CAAxB,EAA2B+E,CAAC,EAA5B,EAAgC;AAC9B;AACA;AACA;AACA;AACA,QAAIyF,MAAM,GAAGjK,KAAK,KAAK,EAAvB;AACA,QAAIke,KAAK,GAAGle,KAAK,GAAG,SAApB;AAEA,UAAMqE,GAAG,GAAGhE,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYkE,CAAC,GAAGyZ,IAAI,CAACxe,MAAT,GAAkB,CAA9B,CAAZ;AACA,UAAMa,GAAG,GAAGD,IAAI,CAACgE,GAAL,CAASG,CAAT,EAAYnF,GAAG,CAACI,MAAJ,GAAa,CAAzB,CAAZ;;AAEA,SAAK,IAAIuE,CAAC,GAAGK,GAAb,EAAkBL,CAAC,IAAI1D,GAAvB,EAA4B0D,CAAC,EAA7B,EAAiC;AAC/B,YAAM/D,CAAC,GAAGuE,CAAC,GAAGR,CAAd;AACA,YAAMlE,CAAC,GAAGme,IAAI,CAACze,KAAL,CAAWS,CAAX,CAAV;AACA,YAAMF,CAAC,GAAGV,GAAG,CAACG,KAAJ,CAAUwE,CAAV,CAAV;AACA,YAAM7D,CAAC,GAAGL,CAAC,GAAGC,CAAJ,GAAQme,KAAlB;AAEAjU,MAAAA,MAAM,IAAK9J,CAAC,GAAG,SAAL,GAAkB,CAA5B;AACA+d,MAAAA,KAAK,GAAG/d,CAAC,GAAG,SAAZ;AACD;;AAEDwB,IAAAA,GAAG,CAACnC,KAAJ,CAAUgF,CAAV,IAAe0Z,KAAK,GAAG,CAAvB;AACAle,IAAAA,KAAK,GAAGiK,MAAM,GAAG,CAAjB;AACD;;AAED,MAAIjK,KAAK,KAAK,CAAd,EACE2B,GAAG,CAACnC,KAAJ,CAAUgF,CAAV,IAAexE,KAAK,GAAG,CAAvB,CADF,KAGE2B,GAAG,CAAClC,MAAJ,IAAc,CAAd;AAEF,SAAOkC,GAAG,CAACP,MAAJ,EAAP;AACD;;AAED,SAASW,QAAT,CAAkBkc,IAAlB,EAAwB5e,GAAxB,EAA6BsC,GAA7B,EAAkC;AAChC,QAAME,GAAG,GAAGoc,IAAI,CAACxe,MAAL,GAAcJ,GAAG,CAACI,MAA9B;AAEAkC,EAAAA,GAAG,CAACjC,QAAJ,GAAeue,IAAI,CAACve,QAAL,GAAgBL,GAAG,CAACK,QAAnC;;AACAiC,EAAAA,GAAG,CAACzB,MAAJ,CAAW2B,GAAX;;AACAF,EAAAA,GAAG,CAAClC,MAAJ,GAAaoC,GAAb;AAEA,MAAI7B,KAAK,GAAG,CAAZ;AACA,MAAIme,OAAO,GAAG,CAAd;AACA,MAAI3Z,CAAC,GAAG,CAAR;;AAEA,SAAOA,CAAC,GAAG7C,GAAG,CAAClC,MAAJ,GAAa,CAAxB,EAA2B+E,CAAC,EAA5B,EAAgC;AAC9B;AACA;AACA;AACA;AACA,QAAIyF,MAAM,GAAGkU,OAAb;AAEAA,IAAAA,OAAO,GAAG,CAAV;AAEA,QAAID,KAAK,GAAGle,KAAK,GAAG,SAApB;AAEA,UAAMqE,GAAG,GAAGhE,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYkE,CAAC,GAAGyZ,IAAI,CAACxe,MAAT,GAAkB,CAA9B,CAAZ;AACA,UAAMa,GAAG,GAAGD,IAAI,CAACgE,GAAL,CAASG,CAAT,EAAYnF,GAAG,CAACI,MAAJ,GAAa,CAAzB,CAAZ;;AAEA,SAAK,IAAIuE,CAAC,GAAGK,GAAb,EAAkBL,CAAC,IAAI1D,GAAvB,EAA4B0D,CAAC,EAA7B,EAAiC;AAC/B,YAAM/D,CAAC,GAAGuE,CAAC,GAAGR,CAAd;AACA,YAAMlE,CAAC,GAAGme,IAAI,CAACze,KAAL,CAAWS,CAAX,CAAV;AACA,YAAMF,CAAC,GAAGV,GAAG,CAACG,KAAJ,CAAUwE,CAAV,CAAV;AACA,YAAM7D,CAAC,GAAGL,CAAC,GAAGC,CAAd;AAEA,UAAIwC,EAAE,GAAGpC,CAAC,GAAG,SAAb;AAEA8J,MAAAA,MAAM,GAAIA,MAAM,IAAK9J,CAAC,GAAG,SAAL,GAAkB,CAAtB,CAAP,GAAmC,CAA5C;AACAoC,MAAAA,EAAE,GAAIA,EAAE,GAAG2b,KAAN,GAAe,CAApB;AACAA,MAAAA,KAAK,GAAG3b,EAAE,GAAG,SAAb;AACA0H,MAAAA,MAAM,GAAIA,MAAM,IAAI1H,EAAE,KAAK,EAAX,CAAP,GAAyB,CAAlC;AAEA4b,MAAAA,OAAO,IAAIlU,MAAM,KAAK,EAAtB;AACAA,MAAAA,MAAM,IAAI,SAAV;AACD;;AAEDtI,IAAAA,GAAG,CAACnC,KAAJ,CAAUgF,CAAV,IAAe0Z,KAAf;AACAle,IAAAA,KAAK,GAAGiK,MAAR;AACAA,IAAAA,MAAM,GAAGkU,OAAT;AACD;;AAED,MAAIne,KAAK,KAAK,CAAd,EACE2B,GAAG,CAACnC,KAAJ,CAAUgF,CAAV,IAAexE,KAAf,CADF,KAGE2B,GAAG,CAAClC,MAAJ,IAAc,CAAd;AAEF,SAAOkC,GAAG,CAACP,MAAJ,EAAP;AACD;;AAED,SAASY,UAAT,CAAoBsF,CAApB,EAAuBC,CAAvB,EAA0B5F,GAA1B,EAA+B;AAC7B;AACA,MAAI,CAAC1C,UAAD,IAAeqI,CAAC,CAAC7H,MAAF,GAAW8H,CAAC,CAAC9H,MAAb,GAAsB,QAAzC,EACE,OAAOsC,QAAQ,CAACuF,CAAD,EAAIC,CAAJ,EAAO5F,GAAP,CAAf;AAEF,QAAMyc,IAAI,GAAGlf,MAAM,CAAC,CAAD,CAAnB;AACA,QAAM8K,IAAI,GAAG9K,MAAM,CAAC,SAAD,CAAnB;AACA,QAAMwE,KAAK,GAAGxE,MAAM,CAAC,EAAD,CAApB;AAEA,MAAIoO,CAAC,GAAGhG,CAAC,CAACiP,QAAF,KAAehP,CAAC,CAACgP,QAAF,EAAvB;AAEA,QAAMlU,GAAG,GAAIiL,CAAC,GAAG8Q,IAAL,GAAa,CAAzB;AAEA,MAAI/b,GAAJ,EACEiL,CAAC,GAAG,CAACA,CAAL;AAEF,MAAIrN,CAAC,GAAG,CAAR;;AAEA,SAAOqN,CAAC,GAAG8Q,IAAX,EAAiB;AACfzc,IAAAA,GAAG,CAACnC,KAAJ,CAAUS,CAAC,EAAX,IAAiB4d,MAAM,CAACvQ,CAAC,GAAGtD,IAAL,CAAvB;AACAsD,IAAAA,CAAC,KAAK5J,KAAN;AACD;;AAED,MAAIzD,CAAC,KAAK,CAAV,EACE0B,GAAG,CAACnC,KAAJ,CAAUS,CAAC,EAAX,IAAiB,CAAjB;AAEF0B,EAAAA,GAAG,CAAClC,MAAJ,GAAaQ,CAAb;AACA0B,EAAAA,GAAG,CAACjC,QAAJ,GAAe2C,GAAf;AAEA,SAAOV,GAAP;AACD;;AAED,SAASC,WAAT,CAAqBqc,IAArB,EAA2B5e,GAA3B,EAAgCsC,GAAhC,EAAqC;AACnC,QAAM7B,CAAC,GAAGme,IAAI,CAACze,KAAf;AACA,QAAMO,CAAC,GAAGV,GAAG,CAACG,KAAd;AACA,QAAM6e,CAAC,GAAG1c,GAAG,CAACnC,KAAd;AACA,QAAM8e,EAAE,GAAGxe,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAMye,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAG3e,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAM4e,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAG9e,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAM+e,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAGjf,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAMkf,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAGpf,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAMqf,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAGvf,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAMwf,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAG1f,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAM2f,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAG7f,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAM8f,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAGhgB,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAMigB,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAGngB,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAMogB,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAGrgB,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAMsgB,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAGxgB,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAMygB,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAG3gB,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAM4gB,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAG9gB,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAM+gB,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAGjhB,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAMkhB,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAGphB,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAMqhB,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAGvhB,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAMwhB,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAG1hB,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAM2hB,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAG7hB,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAM8hB,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AACA,QAAMG,EAAE,GAAGhiB,CAAC,CAAC,CAAD,CAAD,GAAO,CAAlB;AACA,QAAMiiB,GAAG,GAAGD,EAAE,GAAG,MAAjB;AACA,QAAME,GAAG,GAAGF,EAAE,KAAK,EAAnB;AAEA,MAAI7X,CAAC,GAAG,CAAR;AACA,MAAI3H,EAAJ,EAAQ2f,GAAR,EAAa1e,EAAb;AAEA7B,EAAAA,GAAG,CAACjC,QAAJ,GAAeue,IAAI,CAACve,QAAL,GAAgBL,GAAG,CAACK,QAAnC;;AACAiC,EAAAA,GAAG,CAACzB,MAAJ,CAAW,EAAX;;AACAyB,EAAAA,GAAG,CAAClC,MAAJ,GAAa,EAAb;AAEA;;AACA8C,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAe8B,GAAf,CAAL;AACA6B,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAe+B,GAAf,CAAN;AACA4B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAe6B,GAAf,CAAP,GAA8B,CAApC;AACA7c,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAe8B,GAAf,CAAL;AAEA,MAAI6B,EAAE,GAAI,CAAEjY,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAArD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6BC,EAAE,KAAK,EAApC,CAAD,GAA4C,CAAhD;AACAA,EAAAA,EAAE,IAAI,SAAN;AAEA;;AACA5f,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAe2B,GAAf,CAAL;AACA6B,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAe4B,GAAf,CAAN;AACA4B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAe0B,GAAf,CAAP,GAA8B,CAApC;AACA7c,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAe2B,GAAf,CAAL;AACA/d,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAeiC,GAAf,CAAN,GAA6B,CAAlC;AACA0B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAekC,GAAf,CAAP,GAA8B,CAApC;AACAyB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAegC,GAAf,CAAP,GAA8B,CAApC;AACAhd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAeiC,GAAf,CAAN,GAA6B,CAAlC;AAEA,MAAI2B,EAAE,GAAI,CAAElY,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAArD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6BE,EAAE,KAAK,EAApC,CAAD,GAA4C,CAAhD;AACAA,EAAAA,EAAE,IAAI,SAAN;AAEA;;AACA7f,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAewB,GAAf,CAAL;AACA6B,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAeyB,GAAf,CAAN;AACA4B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAeuB,GAAf,CAAP,GAA8B,CAApC;AACA7c,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAewB,GAAf,CAAL;AACA/d,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAe8B,GAAf,CAAN,GAA6B,CAAlC;AACA0B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAe+B,GAAf,CAAP,GAA8B,CAApC;AACAyB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAe6B,GAAf,CAAP,GAA8B,CAApC;AACAhd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAe8B,GAAf,CAAN,GAA6B,CAAlC;AACAle,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAeoC,GAAf,CAAN,GAA6B,CAAlC;AACAuB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAeqC,GAAf,CAAP,GAA8B,CAApC;AACAsB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAemC,GAAf,CAAP,GAA8B,CAApC;AACAnd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAeoC,GAAf,CAAN,GAA6B,CAAlC;AAEA,MAAIyB,EAAE,GAAI,CAAEnY,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAArD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6BG,EAAE,KAAK,EAApC,CAAD,GAA4C,CAAhD;AACAA,EAAAA,EAAE,IAAI,SAAN;AAEA;;AACA9f,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAeqB,GAAf,CAAL;AACA6B,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAesB,GAAf,CAAN;AACA4B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAeoB,GAAf,CAAP,GAA8B,CAApC;AACA7c,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAeqB,GAAf,CAAL;AACA/d,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAe2B,GAAf,CAAN,GAA6B,CAAlC;AACA0B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAe4B,GAAf,CAAP,GAA8B,CAApC;AACAyB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAe0B,GAAf,CAAP,GAA8B,CAApC;AACAhd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAe2B,GAAf,CAAN,GAA6B,CAAlC;AACAle,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAeiC,GAAf,CAAN,GAA6B,CAAlC;AACAuB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAekC,GAAf,CAAP,GAA8B,CAApC;AACAsB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAegC,GAAf,CAAP,GAA8B,CAApC;AACAnd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAeiC,GAAf,CAAN,GAA6B,CAAlC;AACAre,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAeuC,GAAf,CAAN,GAA6B,CAAlC;AACAoB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAewC,GAAf,CAAP,GAA8B,CAApC;AACAmB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAesC,GAAf,CAAP,GAA8B,CAApC;AACAtd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAeuC,GAAf,CAAN,GAA6B,CAAlC;AAEA,MAAIuB,EAAE,GAAI,CAAEpY,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAArD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6BI,EAAE,KAAK,EAApC,CAAD,GAA4C,CAAhD;AACAA,EAAAA,EAAE,IAAI,SAAN;AAEA;;AACA/f,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAekB,GAAf,CAAL;AACA6B,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAemB,GAAf,CAAN;AACA4B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAeiB,GAAf,CAAP,GAA8B,CAApC;AACA7c,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAekB,GAAf,CAAL;AACA/d,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAewB,GAAf,CAAN,GAA6B,CAAlC;AACA0B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAeyB,GAAf,CAAP,GAA8B,CAApC;AACAyB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAeuB,GAAf,CAAP,GAA8B,CAApC;AACAhd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAewB,GAAf,CAAN,GAA6B,CAAlC;AACAle,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAe8B,GAAf,CAAN,GAA6B,CAAlC;AACAuB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAe+B,GAAf,CAAP,GAA8B,CAApC;AACAsB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAe6B,GAAf,CAAP,GAA8B,CAApC;AACAnd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAe8B,GAAf,CAAN,GAA6B,CAAlC;AACAre,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAeoC,GAAf,CAAN,GAA6B,CAAlC;AACAoB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAeqC,GAAf,CAAP,GAA8B,CAApC;AACAmB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAemC,GAAf,CAAP,GAA8B,CAApC;AACAtd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAeoC,GAAf,CAAN,GAA6B,CAAlC;AACAxe,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAe0C,GAAf,CAAN,GAA6B,CAAlC;AACAiB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAe2C,GAAf,CAAP,GAA8B,CAApC;AACAgB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAeyC,GAAf,CAAP,GAA8B,CAApC;AACAzd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAe0C,GAAf,CAAN,GAA6B,CAAlC;AAEA,MAAIqB,EAAE,GAAI,CAAErY,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAArD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6BK,EAAE,KAAK,EAApC,CAAD,GAA4C,CAAhD;AACAA,EAAAA,EAAE,IAAI,SAAN;AAEA;;AACAhgB,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAee,GAAf,CAAL;AACA6B,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAegB,GAAf,CAAN;AACA4B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAec,GAAf,CAAP,GAA8B,CAApC;AACA7c,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAee,GAAf,CAAL;AACA/d,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAeqB,GAAf,CAAN,GAA6B,CAAlC;AACA0B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAesB,GAAf,CAAP,GAA8B,CAApC;AACAyB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAeoB,GAAf,CAAP,GAA8B,CAApC;AACAhd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAeqB,GAAf,CAAN,GAA6B,CAAlC;AACAle,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAe2B,GAAf,CAAN,GAA6B,CAAlC;AACAuB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAe4B,GAAf,CAAP,GAA8B,CAApC;AACAsB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAe0B,GAAf,CAAP,GAA8B,CAApC;AACAnd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAe2B,GAAf,CAAN,GAA6B,CAAlC;AACAre,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAeiC,GAAf,CAAN,GAA6B,CAAlC;AACAoB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAekC,GAAf,CAAP,GAA8B,CAApC;AACAmB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAegC,GAAf,CAAP,GAA8B,CAApC;AACAtd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAeiC,GAAf,CAAN,GAA6B,CAAlC;AACAxe,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAeuC,GAAf,CAAN,GAA6B,CAAlC;AACAiB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAewC,GAAf,CAAP,GAA8B,CAApC;AACAgB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAesC,GAAf,CAAP,GAA8B,CAApC;AACAzd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAeuC,GAAf,CAAN,GAA6B,CAAlC;AACA3e,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAe6C,GAAf,CAAN,GAA6B,CAAlC;AACAc,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAe8C,GAAf,CAAP,GAA8B,CAApC;AACAa,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAe4C,GAAf,CAAP,GAA8B,CAApC;AACA5d,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAe6C,GAAf,CAAN,GAA6B,CAAlC;AAEA,MAAImB,EAAE,GAAI,CAAEtY,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAArD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6BM,EAAE,KAAK,EAApC,CAAD,GAA4C,CAAhD;AACAA,EAAAA,EAAE,IAAI,SAAN;AAEA;;AACAjgB,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAeY,GAAf,CAAL;AACA6B,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAea,GAAf,CAAN;AACA4B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAeW,GAAf,CAAP,GAA8B,CAApC;AACA7c,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAeY,GAAf,CAAL;AACA/d,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAekB,GAAf,CAAN,GAA6B,CAAlC;AACA0B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAemB,GAAf,CAAP,GAA8B,CAApC;AACAyB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAeiB,GAAf,CAAP,GAA8B,CAApC;AACAhd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAekB,GAAf,CAAN,GAA6B,CAAlC;AACAle,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAewB,GAAf,CAAN,GAA6B,CAAlC;AACAuB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAeyB,GAAf,CAAP,GAA8B,CAApC;AACAsB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAeuB,GAAf,CAAP,GAA8B,CAApC;AACAnd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAewB,GAAf,CAAN,GAA6B,CAAlC;AACAre,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAe8B,GAAf,CAAN,GAA6B,CAAlC;AACAoB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAe+B,GAAf,CAAP,GAA8B,CAApC;AACAmB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAe6B,GAAf,CAAP,GAA8B,CAApC;AACAtd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAe8B,GAAf,CAAN,GAA6B,CAAlC;AACAxe,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAeoC,GAAf,CAAN,GAA6B,CAAlC;AACAiB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAeqC,GAAf,CAAP,GAA8B,CAApC;AACAgB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAemC,GAAf,CAAP,GAA8B,CAApC;AACAzd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAeoC,GAAf,CAAN,GAA6B,CAAlC;AACA3e,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAe0C,GAAf,CAAN,GAA6B,CAAlC;AACAc,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAe2C,GAAf,CAAP,GAA8B,CAApC;AACAa,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAeyC,GAAf,CAAP,GAA8B,CAApC;AACA5d,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAe0C,GAAf,CAAN,GAA6B,CAAlC;AACA9e,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAegD,GAAf,CAAN,GAA6B,CAAlC;AACAW,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAeiD,GAAf,CAAP,GAA8B,CAApC;AACAU,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAe+C,GAAf,CAAP,GAA8B,CAApC;AACA/d,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAegD,GAAf,CAAN,GAA6B,CAAlC;AAEA,MAAIiB,EAAE,GAAI,CAAEvY,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAArD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6BO,EAAE,KAAK,EAApC,CAAD,GAA4C,CAAhD;AACAA,EAAAA,EAAE,IAAI,SAAN;AAEA;;AACAlgB,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAeS,GAAf,CAAL;AACA6B,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAeU,GAAf,CAAN;AACA4B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAeQ,GAAf,CAAP,GAA8B,CAApC;AACA7c,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAeS,GAAf,CAAL;AACA/d,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAee,GAAf,CAAN,GAA6B,CAAlC;AACA0B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAegB,GAAf,CAAP,GAA8B,CAApC;AACAyB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAec,GAAf,CAAP,GAA8B,CAApC;AACAhd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAee,GAAf,CAAN,GAA6B,CAAlC;AACAle,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAeqB,GAAf,CAAN,GAA6B,CAAlC;AACAuB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAesB,GAAf,CAAP,GAA8B,CAApC;AACAsB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAeoB,GAAf,CAAP,GAA8B,CAApC;AACAnd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAeqB,GAAf,CAAN,GAA6B,CAAlC;AACAre,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAe2B,GAAf,CAAN,GAA6B,CAAlC;AACAoB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAe4B,GAAf,CAAP,GAA8B,CAApC;AACAmB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAe0B,GAAf,CAAP,GAA8B,CAApC;AACAtd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAe2B,GAAf,CAAN,GAA6B,CAAlC;AACAxe,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAeiC,GAAf,CAAN,GAA6B,CAAlC;AACAiB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAekC,GAAf,CAAP,GAA8B,CAApC;AACAgB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAegC,GAAf,CAAP,GAA8B,CAApC;AACAzd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAeiC,GAAf,CAAN,GAA6B,CAAlC;AACA3e,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAeuC,GAAf,CAAN,GAA6B,CAAlC;AACAc,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAewC,GAAf,CAAP,GAA8B,CAApC;AACAa,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAesC,GAAf,CAAP,GAA8B,CAApC;AACA5d,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAeuC,GAAf,CAAN,GAA6B,CAAlC;AACA9e,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAe6C,GAAf,CAAN,GAA6B,CAAlC;AACAW,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAe8C,GAAf,CAAP,GAA8B,CAApC;AACAU,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAe4C,GAAf,CAAP,GAA8B,CAApC;AACA/d,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAe6C,GAAf,CAAN,GAA6B,CAAlC;AACAjf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAemD,GAAf,CAAN,GAA6B,CAAlC;AACAQ,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAeoD,GAAf,CAAP,GAA8B,CAApC;AACAO,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAekD,GAAf,CAAP,GAA8B,CAApC;AACAle,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAemD,GAAf,CAAN,GAA6B,CAAlC;AAEA,MAAIe,EAAE,GAAI,CAAExY,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAArD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6BQ,EAAE,KAAK,EAApC,CAAD,GAA4C,CAAhD;AACAA,EAAAA,EAAE,IAAI,SAAN;AAEA;;AACAngB,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAeM,GAAf,CAAL;AACA6B,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAeO,GAAf,CAAN;AACA4B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAeK,GAAf,CAAP,GAA8B,CAApC;AACA7c,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAeM,GAAf,CAAL;AACA/d,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAeY,GAAf,CAAN,GAA6B,CAAlC;AACA0B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAea,GAAf,CAAP,GAA8B,CAApC;AACAyB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAeW,GAAf,CAAP,GAA8B,CAApC;AACAhd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAeY,GAAf,CAAN,GAA6B,CAAlC;AACAle,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAekB,GAAf,CAAN,GAA6B,CAAlC;AACAuB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAemB,GAAf,CAAP,GAA8B,CAApC;AACAsB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAeiB,GAAf,CAAP,GAA8B,CAApC;AACAnd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAekB,GAAf,CAAN,GAA6B,CAAlC;AACAre,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAewB,GAAf,CAAN,GAA6B,CAAlC;AACAoB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAeyB,GAAf,CAAP,GAA8B,CAApC;AACAmB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAeuB,GAAf,CAAP,GAA8B,CAApC;AACAtd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAewB,GAAf,CAAN,GAA6B,CAAlC;AACAxe,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAe8B,GAAf,CAAN,GAA6B,CAAlC;AACAiB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAe+B,GAAf,CAAP,GAA8B,CAApC;AACAgB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAe6B,GAAf,CAAP,GAA8B,CAApC;AACAzd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAe8B,GAAf,CAAN,GAA6B,CAAlC;AACA3e,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAeoC,GAAf,CAAN,GAA6B,CAAlC;AACAc,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAeqC,GAAf,CAAP,GAA8B,CAApC;AACAa,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAemC,GAAf,CAAP,GAA8B,CAApC;AACA5d,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAeoC,GAAf,CAAN,GAA6B,CAAlC;AACA9e,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAe0C,GAAf,CAAN,GAA6B,CAAlC;AACAW,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAe2C,GAAf,CAAP,GAA8B,CAApC;AACAU,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAeyC,GAAf,CAAP,GAA8B,CAApC;AACA/d,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAe0C,GAAf,CAAN,GAA6B,CAAlC;AACAjf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAegD,GAAf,CAAN,GAA6B,CAAlC;AACAQ,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAeiD,GAAf,CAAP,GAA8B,CAApC;AACAO,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAe+C,GAAf,CAAP,GAA8B,CAApC;AACAle,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAegD,GAAf,CAAN,GAA6B,CAAlC;AACApf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAesD,GAAf,CAAN,GAA6B,CAAlC;AACAK,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAeuD,GAAf,CAAP,GAA8B,CAApC;AACAI,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAeqD,GAAf,CAAP,GAA8B,CAApC;AACAre,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAesD,GAAf,CAAN,GAA6B,CAAlC;AAEA,MAAIa,EAAE,GAAI,CAAEzY,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAArD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6BS,EAAE,KAAK,EAApC,CAAD,GAA4C,CAAhD;AACAA,EAAAA,EAAE,IAAI,SAAN;AAEA;;AACApgB,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAeG,GAAf,CAAL;AACA6B,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAeI,GAAf,CAAN;AACA4B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAeE,GAAf,CAAP,GAA8B,CAApC;AACA7c,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAeG,GAAf,CAAL;AACA/d,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAeS,GAAf,CAAN,GAA6B,CAAlC;AACA0B,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAeU,GAAf,CAAP,GAA8B,CAApC;AACAyB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAeQ,GAAf,CAAP,GAA8B,CAApC;AACAhd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAeS,GAAf,CAAN,GAA6B,CAAlC;AACAle,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAee,GAAf,CAAN,GAA6B,CAAlC;AACAuB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAegB,GAAf,CAAP,GAA8B,CAApC;AACAsB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAec,GAAf,CAAP,GAA8B,CAApC;AACAnd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAee,GAAf,CAAN,GAA6B,CAAlC;AACAre,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAeqB,GAAf,CAAN,GAA6B,CAAlC;AACAoB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAesB,GAAf,CAAP,GAA8B,CAApC;AACAmB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAeoB,GAAf,CAAP,GAA8B,CAApC;AACAtd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAeqB,GAAf,CAAN,GAA6B,CAAlC;AACAxe,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAe2B,GAAf,CAAN,GAA6B,CAAlC;AACAiB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAe4B,GAAf,CAAP,GAA8B,CAApC;AACAgB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAe0B,GAAf,CAAP,GAA8B,CAApC;AACAzd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAe2B,GAAf,CAAN,GAA6B,CAAlC;AACA3e,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAeiC,GAAf,CAAN,GAA6B,CAAlC;AACAc,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAekC,GAAf,CAAP,GAA8B,CAApC;AACAa,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAegC,GAAf,CAAP,GAA8B,CAApC;AACA5d,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAeiC,GAAf,CAAN,GAA6B,CAAlC;AACA9e,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAeuC,GAAf,CAAN,GAA6B,CAAlC;AACAW,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAewC,GAAf,CAAP,GAA8B,CAApC;AACAU,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAesC,GAAf,CAAP,GAA8B,CAApC;AACA/d,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAeuC,GAAf,CAAN,GAA6B,CAAlC;AACAjf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAe6C,GAAf,CAAN,GAA6B,CAAlC;AACAQ,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAe8C,GAAf,CAAP,GAA8B,CAApC;AACAO,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAe4C,GAAf,CAAP,GAA8B,CAApC;AACAle,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAe6C,GAAf,CAAN,GAA6B,CAAlC;AACApf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAemD,GAAf,CAAN,GAA6B,CAAlC;AACAK,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAeoD,GAAf,CAAP,GAA8B,CAApC;AACAI,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAekD,GAAf,CAAP,GAA8B,CAApC;AACAre,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAemD,GAAf,CAAN,GAA6B,CAAlC;AACAvf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAeyD,GAAf,CAAN,GAA6B,CAAlC;AACAE,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsc,GAAV,EAAe0D,GAAf,CAAP,GAA8B,CAApC;AACAC,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAewD,GAAf,CAAP,GAA8B,CAApC;AACAxe,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUuc,GAAV,EAAeyD,GAAf,CAAN,GAA6B,CAAlC;AAEA,MAAIW,EAAE,GAAI,CAAE1Y,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAArD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6BU,EAAE,KAAK,EAApC,CAAD,GAA4C,CAAhD;AACAA,EAAAA,EAAE,IAAI,SAAN;AAEA;;AACArgB,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAeM,GAAf,CAAL;AACA0B,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAeO,GAAf,CAAN;AACAyB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAeK,GAAf,CAAP,GAA8B,CAApC;AACAhd,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAeM,GAAf,CAAL;AACAle,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAeY,GAAf,CAAN,GAA6B,CAAlC;AACAuB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAea,GAAf,CAAP,GAA8B,CAApC;AACAsB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAeW,GAAf,CAAP,GAA8B,CAApC;AACAnd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAeY,GAAf,CAAN,GAA6B,CAAlC;AACAre,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAekB,GAAf,CAAN,GAA6B,CAAlC;AACAoB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAemB,GAAf,CAAP,GAA8B,CAApC;AACAmB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAeiB,GAAf,CAAP,GAA8B,CAApC;AACAtd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAekB,GAAf,CAAN,GAA6B,CAAlC;AACAxe,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAewB,GAAf,CAAN,GAA6B,CAAlC;AACAiB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAeyB,GAAf,CAAP,GAA8B,CAApC;AACAgB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAeuB,GAAf,CAAP,GAA8B,CAApC;AACAzd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAewB,GAAf,CAAN,GAA6B,CAAlC;AACA3e,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAe8B,GAAf,CAAN,GAA6B,CAAlC;AACAc,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAe+B,GAAf,CAAP,GAA8B,CAApC;AACAa,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAe6B,GAAf,CAAP,GAA8B,CAApC;AACA5d,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAe8B,GAAf,CAAN,GAA6B,CAAlC;AACA9e,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAeoC,GAAf,CAAN,GAA6B,CAAlC;AACAW,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAeqC,GAAf,CAAP,GAA8B,CAApC;AACAU,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAemC,GAAf,CAAP,GAA8B,CAApC;AACA/d,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAeoC,GAAf,CAAN,GAA6B,CAAlC;AACAjf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAe0C,GAAf,CAAN,GAA6B,CAAlC;AACAQ,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAe2C,GAAf,CAAP,GAA8B,CAApC;AACAO,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAeyC,GAAf,CAAP,GAA8B,CAApC;AACAle,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAe0C,GAAf,CAAN,GAA6B,CAAlC;AACApf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAegD,GAAf,CAAN,GAA6B,CAAlC;AACAK,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAeiD,GAAf,CAAP,GAA8B,CAApC;AACAI,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAe+C,GAAf,CAAP,GAA8B,CAApC;AACAre,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAegD,GAAf,CAAN,GAA6B,CAAlC;AACAvf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAesD,GAAf,CAAN,GAA6B,CAAlC;AACAE,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyc,GAAV,EAAeuD,GAAf,CAAP,GAA8B,CAApC;AACAC,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAeqD,GAAf,CAAP,GAA8B,CAApC;AACAxe,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU0c,GAAV,EAAesD,GAAf,CAAN,GAA6B,CAAlC;AAEA,MAAIY,GAAG,GAAI,CAAE3Y,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAAtD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6BW,GAAG,KAAK,EAArC,CAAD,GAA6C,CAAjD;AACAA,EAAAA,GAAG,IAAI,SAAP;AAEA;;AACAtgB,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAeS,GAAf,CAAL;AACAuB,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAeU,GAAf,CAAN;AACAsB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAeQ,GAAf,CAAP,GAA8B,CAApC;AACAnd,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAeS,GAAf,CAAL;AACAre,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAee,GAAf,CAAN,GAA6B,CAAlC;AACAoB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAegB,GAAf,CAAP,GAA8B,CAApC;AACAmB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAec,GAAf,CAAP,GAA8B,CAApC;AACAtd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAee,GAAf,CAAN,GAA6B,CAAlC;AACAxe,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAeqB,GAAf,CAAN,GAA6B,CAAlC;AACAiB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAesB,GAAf,CAAP,GAA8B,CAApC;AACAgB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAeoB,GAAf,CAAP,GAA8B,CAApC;AACAzd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAeqB,GAAf,CAAN,GAA6B,CAAlC;AACA3e,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAe2B,GAAf,CAAN,GAA6B,CAAlC;AACAc,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAe4B,GAAf,CAAP,GAA8B,CAApC;AACAa,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAe0B,GAAf,CAAP,GAA8B,CAApC;AACA5d,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAe2B,GAAf,CAAN,GAA6B,CAAlC;AACA9e,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAeiC,GAAf,CAAN,GAA6B,CAAlC;AACAW,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAekC,GAAf,CAAP,GAA8B,CAApC;AACAU,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAegC,GAAf,CAAP,GAA8B,CAApC;AACA/d,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAeiC,GAAf,CAAN,GAA6B,CAAlC;AACAjf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAeuC,GAAf,CAAN,GAA6B,CAAlC;AACAQ,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAewC,GAAf,CAAP,GAA8B,CAApC;AACAO,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAesC,GAAf,CAAP,GAA8B,CAApC;AACAle,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAeuC,GAAf,CAAN,GAA6B,CAAlC;AACApf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAe6C,GAAf,CAAN,GAA6B,CAAlC;AACAK,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAe8C,GAAf,CAAP,GAA8B,CAApC;AACAI,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAe4C,GAAf,CAAP,GAA8B,CAApC;AACAre,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAe6C,GAAf,CAAN,GAA6B,CAAlC;AACAvf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAemD,GAAf,CAAN,GAA6B,CAAlC;AACAE,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4c,GAAV,EAAeoD,GAAf,CAAP,GAA8B,CAApC;AACAC,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAekD,GAAf,CAAP,GAA8B,CAApC;AACAxe,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU6c,GAAV,EAAemD,GAAf,CAAN,GAA6B,CAAlC;AAEA,MAAIa,GAAG,GAAI,CAAE5Y,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAAtD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6BY,GAAG,KAAK,EAArC,CAAD,GAA6C,CAAjD;AACAA,EAAAA,GAAG,IAAI,SAAP;AAEA;;AACAvgB,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAeY,GAAf,CAAL;AACAoB,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAea,GAAf,CAAN;AACAmB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAeW,GAAf,CAAP,GAA8B,CAApC;AACAtd,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAeY,GAAf,CAAL;AACAxe,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAekB,GAAf,CAAN,GAA6B,CAAlC;AACAiB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAemB,GAAf,CAAP,GAA8B,CAApC;AACAgB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAeiB,GAAf,CAAP,GAA8B,CAApC;AACAzd,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAekB,GAAf,CAAN,GAA6B,CAAlC;AACA3e,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAewB,GAAf,CAAN,GAA6B,CAAlC;AACAc,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAeyB,GAAf,CAAP,GAA8B,CAApC;AACAa,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAeuB,GAAf,CAAP,GAA8B,CAApC;AACA5d,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAewB,GAAf,CAAN,GAA6B,CAAlC;AACA9e,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAe8B,GAAf,CAAN,GAA6B,CAAlC;AACAW,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAe+B,GAAf,CAAP,GAA8B,CAApC;AACAU,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAe6B,GAAf,CAAP,GAA8B,CAApC;AACA/d,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAe8B,GAAf,CAAN,GAA6B,CAAlC;AACAjf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAeoC,GAAf,CAAN,GAA6B,CAAlC;AACAQ,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAeqC,GAAf,CAAP,GAA8B,CAApC;AACAO,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAemC,GAAf,CAAP,GAA8B,CAApC;AACAle,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAeoC,GAAf,CAAN,GAA6B,CAAlC;AACApf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAe0C,GAAf,CAAN,GAA6B,CAAlC;AACAK,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAe2C,GAAf,CAAP,GAA8B,CAApC;AACAI,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAeyC,GAAf,CAAP,GAA8B,CAApC;AACAre,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAe0C,GAAf,CAAN,GAA6B,CAAlC;AACAvf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAegD,GAAf,CAAN,GAA6B,CAAlC;AACAE,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+c,GAAV,EAAeiD,GAAf,CAAP,GAA8B,CAApC;AACAC,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAe+C,GAAf,CAAP,GAA8B,CAApC;AACAxe,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUgd,GAAV,EAAegD,GAAf,CAAN,GAA6B,CAAlC;AAEA,MAAIc,GAAG,GAAI,CAAE7Y,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAAtD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6Ba,GAAG,KAAK,EAArC,CAAD,GAA6C,CAAjD;AACAA,EAAAA,GAAG,IAAI,SAAP;AAEA;;AACAxgB,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAee,GAAf,CAAL;AACAiB,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAegB,GAAf,CAAN;AACAgB,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAec,GAAf,CAAP,GAA8B,CAApC;AACAzd,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAee,GAAf,CAAL;AACA3e,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAeqB,GAAf,CAAN,GAA6B,CAAlC;AACAc,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAesB,GAAf,CAAP,GAA8B,CAApC;AACAa,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAeoB,GAAf,CAAP,GAA8B,CAApC;AACA5d,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAeqB,GAAf,CAAN,GAA6B,CAAlC;AACA9e,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAe2B,GAAf,CAAN,GAA6B,CAAlC;AACAW,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAe4B,GAAf,CAAP,GAA8B,CAApC;AACAU,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAe0B,GAAf,CAAP,GAA8B,CAApC;AACA/d,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAe2B,GAAf,CAAN,GAA6B,CAAlC;AACAjf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAeiC,GAAf,CAAN,GAA6B,CAAlC;AACAQ,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAekC,GAAf,CAAP,GAA8B,CAApC;AACAO,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAegC,GAAf,CAAP,GAA8B,CAApC;AACAle,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAeiC,GAAf,CAAN,GAA6B,CAAlC;AACApf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAeuC,GAAf,CAAN,GAA6B,CAAlC;AACAK,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAewC,GAAf,CAAP,GAA8B,CAApC;AACAI,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAesC,GAAf,CAAP,GAA8B,CAApC;AACAre,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAeuC,GAAf,CAAN,GAA6B,CAAlC;AACAvf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAe6C,GAAf,CAAN,GAA6B,CAAlC;AACAE,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUkd,GAAV,EAAe8C,GAAf,CAAP,GAA8B,CAApC;AACAC,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAe4C,GAAf,CAAP,GAA8B,CAApC;AACAxe,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUmd,GAAV,EAAe6C,GAAf,CAAN,GAA6B,CAAlC;AAEA,MAAIe,GAAG,GAAI,CAAE9Y,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAAtD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6Bc,GAAG,KAAK,EAArC,CAAD,GAA6C,CAAjD;AACAA,EAAAA,GAAG,IAAI,SAAP;AAEA;;AACAzgB,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAekB,GAAf,CAAL;AACAc,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAemB,GAAf,CAAN;AACAa,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAeiB,GAAf,CAAP,GAA8B,CAApC;AACA5d,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAekB,GAAf,CAAL;AACA9e,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAewB,GAAf,CAAN,GAA6B,CAAlC;AACAW,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAeyB,GAAf,CAAP,GAA8B,CAApC;AACAU,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAeuB,GAAf,CAAP,GAA8B,CAApC;AACA/d,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAewB,GAAf,CAAN,GAA6B,CAAlC;AACAjf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAe8B,GAAf,CAAN,GAA6B,CAAlC;AACAQ,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAe+B,GAAf,CAAP,GAA8B,CAApC;AACAO,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAe6B,GAAf,CAAP,GAA8B,CAApC;AACAle,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAe8B,GAAf,CAAN,GAA6B,CAAlC;AACApf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAeoC,GAAf,CAAN,GAA6B,CAAlC;AACAK,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAeqC,GAAf,CAAP,GAA8B,CAApC;AACAI,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAemC,GAAf,CAAP,GAA8B,CAApC;AACAre,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAeoC,GAAf,CAAN,GAA6B,CAAlC;AACAvf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAe0C,GAAf,CAAN,GAA6B,CAAlC;AACAE,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUqd,GAAV,EAAe2C,GAAf,CAAP,GAA8B,CAApC;AACAC,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAeyC,GAAf,CAAP,GAA8B,CAApC;AACAxe,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUsd,GAAV,EAAe0C,GAAf,CAAN,GAA6B,CAAlC;AAEA,MAAIgB,GAAG,GAAI,CAAE/Y,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAAtD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6Be,GAAG,KAAK,EAArC,CAAD,GAA6C,CAAjD;AACAA,EAAAA,GAAG,IAAI,SAAP;AAEA;;AACA1gB,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAeqB,GAAf,CAAL;AACAW,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAesB,GAAf,CAAN;AACAU,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAeoB,GAAf,CAAP,GAA8B,CAApC;AACA/d,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAeqB,GAAf,CAAL;AACAjf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAe2B,GAAf,CAAN,GAA6B,CAAlC;AACAQ,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAe4B,GAAf,CAAP,GAA8B,CAApC;AACAO,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAe0B,GAAf,CAAP,GAA8B,CAApC;AACAle,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAe2B,GAAf,CAAN,GAA6B,CAAlC;AACApf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAeiC,GAAf,CAAN,GAA6B,CAAlC;AACAK,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAekC,GAAf,CAAP,GAA8B,CAApC;AACAI,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAegC,GAAf,CAAP,GAA8B,CAApC;AACAre,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAeiC,GAAf,CAAN,GAA6B,CAAlC;AACAvf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAeuC,GAAf,CAAN,GAA6B,CAAlC;AACAE,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUwd,GAAV,EAAewC,GAAf,CAAP,GAA8B,CAApC;AACAC,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAesC,GAAf,CAAP,GAA8B,CAApC;AACAxe,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUyd,GAAV,EAAeuC,GAAf,CAAN,GAA6B,CAAlC;AAEA,MAAIiB,GAAG,GAAI,CAAEhZ,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAAtD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6BgB,GAAG,KAAK,EAArC,CAAD,GAA6C,CAAjD;AACAA,EAAAA,GAAG,IAAI,SAAP;AAEA;;AACA3gB,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAewB,GAAf,CAAL;AACAQ,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAeyB,GAAf,CAAN;AACAO,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAeuB,GAAf,CAAP,GAA8B,CAApC;AACAle,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAewB,GAAf,CAAL;AACApf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAe8B,GAAf,CAAN,GAA6B,CAAlC;AACAK,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAe+B,GAAf,CAAP,GAA8B,CAApC;AACAI,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAe6B,GAAf,CAAP,GAA8B,CAApC;AACAre,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAe8B,GAAf,CAAN,GAA6B,CAAlC;AACAvf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAeoC,GAAf,CAAN,GAA6B,CAAlC;AACAE,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU2d,GAAV,EAAeqC,GAAf,CAAP,GAA8B,CAApC;AACAC,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAemC,GAAf,CAAP,GAA8B,CAApC;AACAxe,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU4d,GAAV,EAAeoC,GAAf,CAAN,GAA6B,CAAlC;AAEA,MAAIkB,GAAG,GAAI,CAAEjZ,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAAtD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6BiB,GAAG,KAAK,EAArC,CAAD,GAA6C,CAAjD;AACAA,EAAAA,GAAG,IAAI,SAAP;AAEA;;AACA5gB,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAe2B,GAAf,CAAL;AACAK,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAe4B,GAAf,CAAN;AACAI,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAe0B,GAAf,CAAP,GAA8B,CAApC;AACAre,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAe2B,GAAf,CAAL;AACAvf,EAAAA,EAAE,GAAIA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAeiC,GAAf,CAAN,GAA6B,CAAlC;AACAE,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU8d,GAAV,EAAekC,GAAf,CAAP,GAA8B,CAApC;AACAC,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAegC,GAAf,CAAP,GAA8B,CAApC;AACAxe,EAAAA,EAAE,GAAIA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAU+d,GAAV,EAAeiC,GAAf,CAAN,GAA6B,CAAlC;AAEA,MAAImB,GAAG,GAAI,CAAElZ,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAAtD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6BkB,GAAG,KAAK,EAArC,CAAD,GAA6C,CAAjD;AACAA,EAAAA,GAAG,IAAI,SAAP;AAEA;;AACA7gB,EAAAA,EAAE,GAAGlC,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAe8B,GAAf,CAAL;AACAE,EAAAA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUie,GAAV,EAAe+B,GAAf,CAAN;AACAC,EAAAA,GAAG,GAAIA,GAAG,GAAG7hB,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAe6B,GAAf,CAAP,GAA8B,CAApC;AACAxe,EAAAA,EAAE,GAAGnD,IAAI,CAAC4B,IAAL,CAAUke,GAAV,EAAe8B,GAAf,CAAL;AAEA,MAAIoB,GAAG,GAAI,CAAEnZ,CAAC,GAAG3H,EAAL,GAAW,CAAZ,KAAkB,CAAC2f,GAAG,GAAG,MAAP,KAAkB,EAApC,CAAD,GAA4C,CAAtD;AACAhY,EAAAA,CAAC,GAAI,CAAE1G,EAAE,IAAI0e,GAAG,KAAK,EAAZ,CAAH,GAAsB,CAAvB,KAA6BmB,GAAG,KAAK,EAArC,CAAD,GAA6C,CAAjD;AACAA,EAAAA,GAAG,IAAI,SAAP;AAEAhF,EAAAA,CAAC,CAAC,CAAD,CAAD,GAAO8D,EAAP;AACA9D,EAAAA,CAAC,CAAC,CAAD,CAAD,GAAO+D,EAAP;AACA/D,EAAAA,CAAC,CAAC,CAAD,CAAD,GAAOgE,EAAP;AACAhE,EAAAA,CAAC,CAAC,CAAD,CAAD,GAAOiE,EAAP;AACAjE,EAAAA,CAAC,CAAC,CAAD,CAAD,GAAOkE,EAAP;AACAlE,EAAAA,CAAC,CAAC,CAAD,CAAD,GAAOmE,EAAP;AACAnE,EAAAA,CAAC,CAAC,CAAD,CAAD,GAAOoE,EAAP;AACApE,EAAAA,CAAC,CAAC,CAAD,CAAD,GAAOqE,EAAP;AACArE,EAAAA,CAAC,CAAC,CAAD,CAAD,GAAOsE,EAAP;AACAtE,EAAAA,CAAC,CAAC,CAAD,CAAD,GAAOuE,EAAP;AACAvE,EAAAA,CAAC,CAAC,EAAD,CAAD,GAAQwE,GAAR;AACAxE,EAAAA,CAAC,CAAC,EAAD,CAAD,GAAQyE,GAAR;AACAzE,EAAAA,CAAC,CAAC,EAAD,CAAD,GAAQ0E,GAAR;AACA1E,EAAAA,CAAC,CAAC,EAAD,CAAD,GAAQ2E,GAAR;AACA3E,EAAAA,CAAC,CAAC,EAAD,CAAD,GAAQ4E,GAAR;AACA5E,EAAAA,CAAC,CAAC,EAAD,CAAD,GAAQ6E,GAAR;AACA7E,EAAAA,CAAC,CAAC,EAAD,CAAD,GAAQ8E,GAAR;AACA9E,EAAAA,CAAC,CAAC,EAAD,CAAD,GAAQ+E,GAAR;AACA/E,EAAAA,CAAC,CAAC,EAAD,CAAD,GAAQgF,GAAR;;AAEA,MAAInZ,CAAC,KAAK,CAAV,EAAa;AACXmU,IAAAA,CAAC,CAAC,EAAD,CAAD,GAAQnU,CAAR;AACAvI,IAAAA,GAAG,CAAClC,MAAJ,IAAc,CAAd;AACD,GAjmBkC,CAmmBnC;;;AACA,SAAOkC,GAAP;AACD,C,CAED;;;AACA,IAAI,CAACtB,IAAI,CAAC4B,IAAV,EACEL,WAAW,GAAGE,UAAd;AAEF;;;;AAIA3C,EAAE,CAAC+R,GAAH,GAASA,GAAT;AAEAoS,MAAM,CAACC,OAAP,GAAiBpkB,EAAjB","sourcesContent":["/*!\n * bn.js - big numbers for bcrypto\n * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).\n * https://github.com/bcoin-org/bcrypto\n *\n * Parts of this software are based on indutny/bn.js:\n *   Copyright (c) 2015, Fedor Indutny (MIT License).\n *   https://github.com/indutny/bn.js\n *\n * Parts of this software are based on golang/go:\n *   Copyright (c) 2009, The Go Authors. All rights reserved.\n *   https://github.com/golang/go\n *\n * Parts of this software are based on openssl/openssl:\n *   Copyright (c) 1998-2018, The OpenSSL Project (Apache License v2.0).\n *   Copyright (c) 1995-1998, Eric A. Young, Tim J. Hudson. All rights reserved.\n *   https://github.com/openssl/openssl\n *\n * Parts of this software are based on libgmp:\n *   Copyright (c) 1991-1997, 1999-2014, Free Software Foundation, Inc.\n *   https://gmplib.org/\n *\n * Parts of this software are based on v8/v8:\n *   Copyright (c) 2017, The V8 Project Authors (BSD-Style License).\n *   https://github.com/v8/v8\n *\n * Resources:\n *   https://github.com/indutny/bn.js/blob/master/lib/bn.js\n *   https://github.com/indutny/miller-rabin/blob/master/lib/mr.js\n *   https://github.com/golang/go/blob/master/src/math/big/int.go\n *   https://github.com/golang/go/blob/master/src/math/big/nat.go\n *   https://github.com/golang/go/blob/master/src/math/big/prime.go\n *   https://github.com/openssl/openssl/tree/master/crypto/bn\n *   https://github.com/openssl/openssl/blob/master/crypto/bn/bn_kron.c\n *   https://github.com/gnutls/nettle/blob/master/mini-gmp.c\n *   https://github.com/v8/v8/blob/master/src/objects/bigint.cc\n */\n\n/* eslint valid-typeof: \"off\" */\n\n'use strict';\n\nconst {custom} = require('../internal/custom');\n\n/*\n * Constants\n */\n\nconst zeros = [\n  '',\n  '0',\n  '00',\n  '000',\n  '0000',\n  '00000',\n  '000000',\n  '0000000',\n  '00000000',\n  '000000000',\n  '0000000000',\n  '00000000000',\n  '000000000000',\n  '0000000000000',\n  '00000000000000',\n  '000000000000000',\n  '0000000000000000',\n  '00000000000000000',\n  '000000000000000000',\n  '0000000000000000000',\n  '00000000000000000000',\n  '000000000000000000000',\n  '0000000000000000000000',\n  '00000000000000000000000',\n  '000000000000000000000000',\n  '0000000000000000000000000'\n];\n\nconst groupSizes = [\n  0x00, 0x19, 0x10, 0x0c, 0x0b, 0x0a,\n  0x09, 0x08, 0x08, 0x07, 0x07, 0x07,\n  0x07, 0x06, 0x06, 0x06, 0x06, 0x06,\n  0x06, 0x06, 0x05, 0x05, 0x05, 0x05,\n  0x05, 0x05, 0x05, 0x05, 0x05, 0x05,\n  0x05, 0x05, 0x05, 0x05, 0x05, 0x05\n];\n\nconst groupBases = [\n  0x00000000, 0x02000000, 0x0290d741, 0x01000000,\n  0x02e90edd, 0x039aa400, 0x0267bf47, 0x01000000,\n  0x0290d741, 0x00989680, 0x012959c3, 0x0222c000,\n  0x03bd7765, 0x0072e440, 0x00adcea1, 0x01000000,\n  0x01704f61, 0x0206fc40, 0x02cddcf9, 0x03d09000,\n  0x003e5185, 0x004ea360, 0x006235f7, 0x00798000,\n  0x009502f9, 0x00b54ba0, 0x00daf26b, 0x01069c00,\n  0x0138f9ad, 0x0172c9e0, 0x01b4d89f, 0x02000000,\n  0x025528a1, 0x02b54a20, 0x03216b93, 0x039aa400\n];\n\nconst primes = {\n  p192: null,\n  p224: null,\n  p521: null,\n  k256: null,\n  p25519: null,\n  p448: null\n};\n\nconst modes = {\n  NONE: 0,\n  QUO: 1,\n  REM: 2,\n  BOTH: 3,\n  EUCLID: 4,\n  ALL: 7\n};\n\nconst WND_WIDTH = 4;\nconst WND_SIZE = 1 << (WND_WIDTH - 1);\n\nconst HAS_BIGINT = typeof BigInt === 'function';\n\n/**\n * BN\n */\n\nclass BN {\n  constructor(num, base, endian) {\n    this.words = [0];\n    this.length = 1;\n    this.negative = 0;\n    this.red = null;\n    this.from(num, base, endian);\n  }\n\n  /*\n   * Addition Engine\n   */\n\n  _iadd(a, b) {\n    let carry = 0;\n    let i = 0;\n\n    // a.length > b.length\n    if (a.length < b.length)\n      [a, b] = [b, a];\n\n    if (a !== this)\n      this._alloc(a.length);\n\n    for (; i < b.length; i++) {\n      const r = (a.words[i] | 0) + (b.words[i] | 0) + carry;\n\n      this.words[i] = r & 0x3ffffff;\n\n      carry = r >>> 26;\n    }\n\n    for (; carry !== 0 && i < a.length; i++) {\n      const r = (a.words[i] | 0) + carry;\n\n      this.words[i] = r & 0x3ffffff;\n\n      carry = r >>> 26;\n    }\n\n    this.length = a.length;\n\n    if (carry !== 0) {\n      this._alloc(this.length + 1);\n      this.words[this.length++] = carry;\n    } else if (a !== this) {\n      // Copy the rest of the words.\n      for (; i < a.length; i++)\n        this.words[i] = a.words[i];\n    }\n\n    // Note: we shouldn't need to strip here.\n    return this;\n  }\n\n  _iaddn(num) {\n    this.words[0] += num;\n\n    if (this.words[0] < 0x4000000)\n      return this;\n\n    // Carry.\n    let i = 0;\n\n    this._alloc(this.length + 1);\n\n    this.words[this.length] = 0;\n\n    for (; i < this.length && this.words[i] >= 0x4000000; i++) {\n      this.words[i] -= 0x4000000;\n      this.words[i + 1] += 1;\n    }\n\n    this.length = Math.max(this.length, i + 1);\n\n    // Note: we shouldn't need to strip here.\n    return this;\n  }\n\n  /*\n   * Addition\n   */\n\n  iadd(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    if (this.negative === num.negative) {\n      // x + y == x + y\n      // (-x) + (-y) == -(x + y)\n      this._iadd(this, num);\n    } else {\n      // x + (-y) == x - y == -(y - x)\n      // (-x) + y == y - x == -(x - y)\n      const cmp = this.ucmp(num);\n\n      // x + (-x) == (-x) + x == 0\n      if (cmp === 0) {\n        this.words[0] = 0;\n        this.length = 1;\n        this.negative = 0;\n        return this;\n      }\n\n      if (cmp < 0) {\n        this._isub(num, this);\n        this.negative ^= 1;\n      } else {\n        this._isub(this, num);\n      }\n    }\n\n    return this;\n  }\n\n  iaddn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n\n    const negative = (num < 0) | 0;\n\n    if (negative)\n      num = -num;\n\n    if (this.negative === negative) {\n      // x + y == x + y\n      // (-x) + (-y) == -(x + y)\n      this._iaddn(num);\n    } else {\n      // x + (-y) == x - y == -(y - x)\n      // (-x) + y == y - x == -(x - y)\n      if (this.length === 1 && this.words[0] < num) {\n        this.words[0] = num - this.words[0];\n        this.negative ^= 1;\n      } else {\n        this._isubn(num);\n      }\n    }\n\n    return this;\n  }\n\n  add(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    if (num.length > this.length)\n      return num.clone().iadd(this);\n\n    return this.clone().iadd(num);\n  }\n\n  addn(num) {\n    return this.clone().iaddn(num);\n  }\n\n  /*\n   * Subtraction Engine\n   */\n\n  _isub(a, b) {\n    let carry = 0;\n    let i = 0;\n\n    // a > b\n    assert(a.length >= b.length);\n\n    if (a !== this)\n      this._alloc(a.length);\n\n    for (; i < b.length; i++) {\n      const r = (a.words[i] | 0) - (b.words[i] | 0) + carry;\n\n      carry = r >> 26;\n\n      this.words[i] = r & 0x3ffffff;\n    }\n\n    for (; carry !== 0 && i < a.length; i++) {\n      const r = (a.words[i] | 0) + carry;\n\n      carry = r >> 26;\n\n      this.words[i] = r & 0x3ffffff;\n    }\n\n    assert(carry === 0);\n\n    // Copy rest of the words.\n    if (a !== this) {\n      for (; i < a.length; i++)\n        this.words[i] = a.words[i];\n    }\n\n    this.length = Math.max(this.length, i);\n\n    return this._strip();\n  }\n\n  _isubn(num) {\n    this.words[0] -= num;\n\n    if (this.words[0] >= 0)\n      return this._normalize();\n\n    assert(this.length !== 1);\n\n    // Carry.\n    this._alloc(this.length + 1);\n\n    for (let i = 0; i < this.length && this.words[i] < 0; i++) {\n      this.words[i] += 0x4000000;\n      this.words[i + 1] -= 1;\n    }\n\n    this.words[this.length] = 0;\n\n    return this._strip();\n  }\n\n  /*\n   * Subtraction\n   */\n\n  isub(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    if (this.negative !== num.negative) {\n      // x - (-y) == x + y\n      // (-x) - y == -(x + y)\n      this._iadd(this, num);\n    } else {\n      // x - y == x - y == -(y - x)\n      // (-x) - (-y) == y - x == -(x - y)\n      const cmp = this.ucmp(num);\n\n      // x - x == 0\n      if (cmp === 0) {\n        this.words[0] = 0;\n        this.length = 1;\n        this.negative = 0;\n        return this;\n      }\n\n      if (cmp < 0) {\n        this._isub(num, this);\n        this.negative ^= 1;\n      } else {\n        this._isub(this, num);\n      }\n    }\n\n    return this;\n  }\n\n  isubn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n\n    const negative = (num < 0) | 0;\n\n    if (negative)\n      num = -num;\n\n    if (this.negative !== negative) {\n      // x - (-y) == x + y\n      // (-x) - y == -(x + y)\n      this._iaddn(num);\n    } else {\n      // x - y == x - y == -(y - x)\n      // (-x) - (-y) == y - x == -(x - y)\n      if (this.length === 1 && this.words[0] < num) {\n        this.words[0] = num - this.words[0];\n        this.negative ^= 1;\n      } else {\n        this._isubn(num);\n      }\n    }\n\n    return this;\n  }\n\n  sub(num) {\n    return this.clone().isub(num);\n  }\n\n  subn(num) {\n    return this.clone().isubn(num);\n  }\n\n  /*\n   * Multiplication Engine\n   */\n\n  _mul(num, out) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    enforce(BN.isBN(out), 'out', 'bignum');\n\n    if (this.length === 10 && num.length === 10)\n      return comb10MulTo(this, num, out);\n\n    const len = this.length + num.length;\n\n    if (len < 63)\n      return smallMulTo(this, num, out);\n\n    if (len < 1024)\n      return bigMulTo(this, num, out);\n\n    return jumboMulTo(this, num, out);\n  }\n\n  /*\n   * Multiplication\n   */\n\n  imul(num) {\n    return this.mul(num)._move(this);\n  }\n\n  imuln(num) {\n    enforce(isSMI(num), 'num', 'smi');\n\n    const neg = (num < 0) | 0;\n\n    if (neg)\n      num = -num;\n\n    // Carry.\n    let carry = 0;\n\n    for (let i = 0; i < this.length; i++) {\n      const w = this.words[i] * num;\n      const lo = (w & 0x3ffffff) + (carry & 0x3ffffff);\n\n      carry >>= 26;\n      carry += (w / 0x4000000) | 0;\n      carry += lo >>> 26;\n\n      this.words[i] = lo & 0x3ffffff;\n    }\n\n    this.negative ^= neg;\n\n    if (carry !== 0) {\n      this._alloc(this.length + 1);\n      this.words[this.length++] = carry;\n    } else {\n      this._strip();\n    }\n\n    return this;\n  }\n\n  mul(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    const len = this.length + num.length;\n    const out = new BN();\n\n    out.words = new Array(len);\n\n    for (let i = 0; i < len; i ++)\n      out.words[i] = 0;\n\n    return this._mul(num, out);\n  }\n\n  muln(num) {\n    return this.clone().imuln(num);\n  }\n\n  /*\n   * Multiplication + Shift\n   */\n\n  mulShift(num, bits) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    enforce((bits >>> 0) === bits, 'bits', 'uint32');\n\n    const r = this.mul(num);\n    const b = r.utestn(bits - 1);\n\n    r.iushrn(bits);\n\n    if (this.negative ^ num.negative)\n      return r.isubn(b);\n\n    return r.iaddn(b);\n  }\n\n  /*\n   * Division Engine\n   */\n\n  _div(num, flags) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    assert((flags & modes.ALL) === flags);\n    assert(flags !== modes.NONE);\n\n    const a = this;\n    const b = num;\n\n    nonzero(!b.isZero());\n\n    if (a.isZero())\n      return [new BN(0), new BN(0)];\n\n    const as = a.negative;\n    const bs = b.negative;\n\n    a.negative = 0;\n    b.negative = 0;\n\n    let q = null;\n    let r = null;\n\n    if (a.ucmp(b) < 0) {\n      if (flags & modes.QUO)\n        q = new BN(0);\n\n      if (flags & modes.REM)\n        r = a.clone();\n    } else if (b.length === 1) {\n      if (flags & modes.QUO)\n        q = a.quon(b.words[0]);\n\n      if (flags & modes.REM)\n        r = a.remn(b.words[0]);\n    } else {\n      [q, r] = a._wordDiv(b, flags);\n    }\n\n    a.negative = as;\n    b.negative = bs;\n\n    if (flags & modes.QUO) {\n      q.negative = a.negative ^ b.negative;\n      q._normalize();\n    }\n\n    if (flags & modes.REM) {\n      r.negative = a.negative;\n      r._normalize();\n    }\n\n    if (flags & modes.EUCLID) {\n      if (flags & modes.QUO) {\n        assert((flags & modes.REM) !== 0);\n\n        if (r.negative !== 0) {\n          if (b.negative !== 0)\n            q.iaddn(1);\n          else\n            q.isubn(1);\n        }\n      }\n\n      if (flags & modes.REM) {\n        if (r.negative !== 0) {\n          if (b.negative !== 0)\n            r.isub(b);\n          else\n            r.iadd(b);\n        }\n      }\n    }\n\n    return [q, r];\n  }\n\n  _wordDiv(num, flags) {\n    let a = this.clone();\n    let b = num;\n    let q = null;\n    let hi;\n\n    // Normalize.\n    const word = b.words[b.length - 1] | 0;\n    const shift = 26 - countBits(word);\n\n    if (shift !== 0) {\n      b = b.clone();\n\n      a.iushln(shift);\n      b.iushln(shift);\n\n      hi = b.words[b.length - 1] | 0;\n    } else {\n      hi = word;\n    }\n\n    // Initialize quotient.\n    const m = a.length - b.length;\n\n    assert(m >= 0);\n\n    if (flags & modes.QUO) {\n      q = new BN(0);\n      q.length = m + 1;\n      q.words = new Array(q.length);\n\n      for (let i = 0; i < q.length; i++)\n        q.words[i] = 0;\n    }\n\n    // Diff.\n    const d = a.clone();\n\n    d._ishlnsubmul(b, 1, m);\n\n    if (d.negative === 0) {\n      if (q)\n        q.words[m] = 1;\n\n      a = d;\n    }\n\n    // Divide.\n    for (let j = m - 1; j >= 0; j--) {\n      const ahi = a.words[b.length + j];\n      const alo = a.words[b.length + j - 1];\n      const quo = ((ahi * 0x4000000 + alo) / hi) | 0;\n\n      let qj = Math.min(quo, 0x3ffffff);\n\n      a._ishlnsubmul(b, qj, j);\n\n      while (a.negative !== 0) {\n        qj -= 1;\n        a.negative = 0;\n        a._ishlnsubmul(b, 1, j);\n        a.ineg();\n      }\n\n      if (q)\n        q.words[j] = qj;\n    }\n\n    // Strip.\n    if (q)\n      q._strip();\n\n    // Denormalize.\n    // Note: we shouldn't need to strip `a` here.\n    if ((flags & modes.REM) && shift !== 0)\n      a.iushrn(shift);\n\n    return [q, a];\n  }\n\n  _ishlnsubmul(num, mul, shift) {\n    let carry = 0;\n    let i = 0;\n\n    this._expand(num.length + shift);\n\n    for (; i < num.length; i++) {\n      const k = (this.words[i + shift] | 0) + carry;\n      const r = num.words[i] * mul;\n      const w = k - (r & 0x3ffffff);\n\n      carry = (w >> 26) - ((r / 0x4000000) | 0);\n\n      this.words[i + shift] = w & 0x3ffffff;\n    }\n\n    for (; i < this.length - shift; i++) {\n      const w = (this.words[i + shift] | 0) + carry;\n\n      carry = w >> 26;\n\n      this.words[i + shift] = w & 0x3ffffff;\n    }\n\n    if (carry === 0)\n      return this._strip();\n\n    // Subtraction overflow.\n    assert(carry === -1);\n\n    carry = 0;\n\n    for (let i = 0; i < this.length; i++) {\n      const w = -(this.words[i] | 0) + carry;\n\n      carry = w >> 26;\n\n      this.words[i] = w & 0x3ffffff;\n    }\n\n    this.negative = 1;\n\n    return this._strip();\n  }\n\n  /*\n   * Truncation Division + Modulo\n   */\n\n  quorem(num) {\n    return this._div(num, modes.BOTH);\n  }\n\n  /*\n   * Truncation Division\n   */\n\n  iquo(num) {\n    return this.quo(num)._move(this);\n  }\n\n  iquon(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    nonzero(num !== 0);\n\n    const neg = (num < 0) | 0;\n\n    if (neg)\n      num = -num;\n\n    let carry = 0;\n\n    for (let i = this.length - 1; i >= 0; i--) {\n      const w = (this.words[i] | 0) + carry * 0x4000000;\n\n      this.words[i] = (w / num) | 0;\n\n      carry = w % num;\n    }\n\n    this.negative ^= neg;\n\n    return this._strip();\n  }\n\n  quo(num) {\n    return this._div(num, modes.QUO)[0];\n  }\n\n  quon(num) {\n    return this.clone().iquon(num);\n  }\n\n  /*\n   * Truncation Modulo\n   */\n\n  irem(num) {\n    return this.rem(num)._move(this);\n  }\n\n  iremn(num) {\n    let m = this.remrn(num);\n\n    if (m < 0)\n      m = -m;\n\n    this.words[0] = m;\n    this.length = 1;\n\n    return this._normalize();\n  }\n\n  rem(num) {\n    return this._div(num, modes.REM)[1];\n  }\n\n  remn(num) {\n    return this.clone().iremn(num);\n  }\n\n  remrn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    nonzero(num !== 0);\n\n    if (num < 0)\n      num = -num;\n\n    const p = (1 << 26) % num;\n\n    let acc = 0;\n\n    for (let i = this.length - 1; i >= 0; i--)\n      acc = (p * acc + (this.words[i] | 0)) % num;\n\n    return this.negative !== 0 ? (-acc | 0) : acc;\n  }\n\n  /*\n   * Euclidean Division + Modulo\n   */\n\n  divmod(num) {\n    return this._div(num, modes.BOTH | modes.EUCLID);\n  }\n\n  /*\n   * Euclidean Division\n   */\n\n  idiv(num) {\n    return this.div(num)._move(this);\n  }\n\n  idivn(num) {\n    if (this.negative === 0)\n      return this.iquon(num);\n\n    const r = this.remrn(num);\n\n    this.iquon(num);\n\n    if (r < 0) {\n      if (num < 0)\n        this.iaddn(1);\n      else\n        this.isubn(1);\n    }\n\n    return this;\n  }\n\n  div(num) {\n    return this._div(num, modes.BOTH | modes.EUCLID)[0];\n  }\n\n  divn(num) {\n    return this.clone().idivn(num);\n  }\n\n  /*\n   * Euclidean Modulo\n   */\n\n  imod(num) {\n    if (this.ucmp(num) < 0) {\n      if (this.negative !== 0) {\n        this._isub(num, this);\n        this.negative = 0;\n      }\n      return this;\n    }\n\n    return this.mod(num)._move(this);\n  }\n\n  imodn(num) {\n    this.words[0] = this.modrn(num);\n    this.length = 1;\n    this.negative = 0;\n    return this;\n  }\n\n  mod(num) {\n    return this._div(num, modes.REM | modes.EUCLID)[1];\n  }\n\n  modn(num) {\n    return this.clone().imodn(num);\n  }\n\n  modrn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n\n    let r = this.remrn(num);\n\n    if (r < 0) {\n      if (num < 0)\n        r -= num;\n      else\n        r += num;\n    }\n\n    return r;\n  }\n\n  /*\n   * Round Division\n   */\n\n  divRound(num) {\n    const [q, r] = this.quorem(num);\n\n    // Fast case - exact division.\n    if (r.isZero())\n      return q;\n\n    const bit = num.words[0] & 1;\n\n    num.iushrn(1);\n\n    const cmp = r.ucmp(num);\n\n    num.iushln(1);\n\n    num.words[0] |= bit;\n\n    // Round down.\n    if (cmp < 0 || (num.isOdd() && cmp === 0))\n      return q;\n\n    // Round up.\n    if (this.negative ^ num.negative)\n      return q.isubn(1);\n\n    return q.iaddn(1);\n  }\n\n  /*\n   * Exponentiation\n   */\n\n  ipow(num) {\n    return this.pow(num)._move(this);\n  }\n\n  ipown(num) {\n    return this.pown(num)._move(this);\n  }\n\n  pow(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    let b = countBits(num.words[num.length - 1]);\n    let r = new BN(1);\n\n    for (let i = num.length - 1; i >= 0; i--) {\n      const word = num.words[i];\n\n      for (let j = b - 1; j >= 0; j--) {\n        r = r.sqr();\n\n        if ((word >> j) & 1)\n          r = r.mul(this);\n      }\n\n      b = 26;\n    }\n\n    return r;\n  }\n\n  pown(num) {\n    enforce(isSMI(num), 'num', 'smi');\n\n    if (num < 0)\n      num = -num;\n\n    if (num === 0)\n      return new BN(1);\n\n    if (num === 1)\n      return this.clone();\n\n    const bits = countBits(num);\n\n    let r = this;\n\n    for (let i = bits - 2; i >= 0; i--) {\n      r = r.sqr();\n\n      if ((num >> i) & 1)\n        r = r.mul(this);\n    }\n\n    return r;\n  }\n\n  isqr() {\n    return this.imul(this);\n  }\n\n  sqr() {\n    return this.mul(this);\n  }\n\n  /*\n   * Roots Engine\n   */\n\n  _rootrem(pow, rem) {\n    enforce((pow >>> 0) === pow, 'num', 'uint32');\n\n    if (pow === 0)\n      throw new RangeError('Zeroth root.');\n\n    if (~pow & this.negative)\n      throw new RangeError('Negative with even root.');\n\n    if (this.ucmpn(1) <= 0)\n      return [this.clone(), new BN(0)];\n\n    let u = new BN(0);\n    let t = BN.shift(1, this.bitLength() / pow + 1 | 0);\n    let v, r;\n\n    if (this.negative !== 0)\n      t.ineg();\n\n    if (pow === 2) {\n      do {\n        u = t;\n        t = this.quo(u);\n        t.iadd(u);\n        t.iushrn(1);\n      } while (t.ucmp(u) < 0);\n    } else {\n      do {\n        u = t;\n        t = u.pown(pow - 1);\n        t = this.quo(t);\n        v = u.muln(pow - 1);\n        t.iadd(v);\n        t = t.quon(pow);\n      } while (t.ucmp(u) < 0);\n    }\n\n    if (rem) {\n      t = u.pown(pow);\n      r = this.sub(t);\n    }\n\n    return [u, r];\n  }\n\n  /*\n   * Roots\n   */\n\n  rootrem(pow) {\n    return this._rootrem(pow, 1);\n  }\n\n  iroot(pow) {\n    return this.root(pow)._move(this);\n  }\n\n  root(pow) {\n    return this._rootrem(pow, 0)[0];\n  }\n\n  isPower(pow) {\n    enforce((pow >>> 0) === pow, 'num', 'uint32');\n\n    if (pow === 0 || (~pow & this.negative))\n      return false;\n\n    const [, r] = this.rootrem(pow);\n\n    return r.sign() === 0;\n  }\n\n  sqrtrem() {\n    return this.rootrem(2);\n  }\n\n  isqrt() {\n    return this.sqrt()._move(this);\n  }\n\n  sqrt() {\n    return this.root(2);\n  }\n\n  isSquare() {\n    return this.isPower(2);\n  }\n\n  /*\n   * AND\n   */\n\n  iand(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    let x = this;\n    let y = num;\n\n    if (x === y)\n      return x;\n\n    if ((x.negative | y.negative) === 0)\n      return x.iuand(y);\n\n    if ((x.negative & y.negative) === 1) {\n      // (-x) & (-y) == ~(x-1) & ~(y-1)\n      //             == ~((x-1) | (y-1))\n      //             == -(((x-1) | (y-1)) + 1)\n      x.iaddn(1);\n      y.iaddn(1);\n      x.iuor(y);\n      x.isubn(1);\n      y.isubn(1);\n      return x;\n    }\n\n    // Assume x is the positive number.\n    if (x.negative !== 0)\n      [x, y] = [y.clone(), x];\n\n    // x & (-y) == x & ~(y-1)\n    //          == x & ~(y-1)\n    const width = x.bitLength();\n\n    y.iaddn(1);\n    y.inotn(width);\n    x.iuand(y);\n    y.inotn(width);\n    y.isubn(1);\n\n    return x._move(this);\n  }\n\n  iandn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n\n    if ((this.negative | (num < 0)) !== 0)\n      return this.iand(new BN(num));\n\n    this.words[0] &= num;\n    this.length = 1;\n\n    return this;\n  }\n\n  and(num) {\n    return this.clone().iand(num);\n  }\n\n  andn(num) {\n    return this.clone().iandn(num);\n  }\n\n  andrn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n\n    if ((this.negative | (num < 0)) !== 0) {\n      const n = this.iand(new BN(num));\n\n      if (n.length > 1)\n        throw new RangeError('Number exceeds 26 bits.');\n\n      return n.negative !== 0 ? -n.words[0] : n.words[0];\n    }\n\n    return this.words[0] & num;\n  }\n\n  /*\n   * Unsigned AND\n   */\n\n  iuand(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    this.length = Math.min(this.length, num.length);\n\n    for (let i = 0; i < this.length; i++)\n      this.words[i] &= num.words[i];\n\n    return this._strip();\n  }\n\n  iuandn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n\n    this.words[0] &= Math.abs(num);\n    this.length = 1;\n\n    return this._normalize();\n  }\n\n  uand(num) {\n    return this.clone().iuand(num);\n  }\n\n  uandn(num) {\n    return this.clone().iuandn(num);\n  }\n\n  uandrn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n\n    const n = this.words[0] & Math.abs(num);\n\n    return this.negative !== 0 ? (-n | 0) : n;\n  }\n\n  /*\n   * OR\n   */\n\n  ior(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    let x = this;\n    let y = num;\n\n    if (x === y)\n      return x;\n\n    if ((x.negative | y.negative) === 0)\n      return x.iuor(y);\n\n    if ((x.negative & y.negative) === 1) {\n      // (-x) | (-y) == ~(x-1) | ~(y-1)\n      //             == ~((x-1) & (y-1))\n      //             == -(((x-1) & (y-1)) + 1)\n      x.iaddn(1);\n      y.iaddn(1);\n      x.iuand(y);\n      x.isubn(1);\n      y.isubn(1);\n      return x;\n    }\n\n    // Assume x is the positive number.\n    y = y.clone();\n\n    if (x.negative !== 0)\n      [x, y] = [y, x];\n\n    // x | (-y) == x | ~(y-1)\n    //          == ~((y-1) & ~x)\n    //          == -(((y-1) & ~x) + 1)\n    y.iaddn(1);\n    x.inotn(y.bitLength());\n    y.iuand(x);\n    y.isubn(1);\n\n    return y._move(this);\n  }\n\n  iorn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n\n    if ((this.negative | (num < 0)) !== 0)\n      return this.ior(new BN(num));\n\n    this.words[0] |= num;\n\n    return this;\n  }\n\n  or(num) {\n    return this.clone().ior(num);\n  }\n\n  orn(num) {\n    return this.clone().iorn(num);\n  }\n\n  /*\n   * Unsigned OR\n   */\n\n  iuor(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    this._expand(num.length);\n\n    for (let i = 0; i < num.length; i++)\n      this.words[i] |= num.words[i];\n\n    // Note: we shouldn't need to strip here.\n    return this;\n  }\n\n  iuorn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n\n    this.words[0] |= Math.abs(num);\n\n    return this;\n  }\n\n  uor(num) {\n    return this.clone().iuor(num);\n  }\n\n  uorn(num) {\n    return this.clone().iuorn(num);\n  }\n\n  /*\n   * XOR\n   */\n\n  ixor(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    let x = this;\n    let y = num;\n\n    if (x === y) {\n      x.words[0] = 0;\n      x.length = 1;\n      x.negative = 0;\n      return x;\n    }\n\n    if ((x.negative | y.negative) === 0)\n      return x.iuxor(y);\n\n    if ((x.negative & y.negative) === 1) {\n      // (-x) ^ (-y) == ~(x-1) ^ ~(y-1)\n      //             == (x-1) ^ (y-1)\n      x.iaddn(1);\n      y.iaddn(1);\n      x.iuxor(y);\n      x.ineg();\n      y.isubn(1);\n      return x;\n    }\n\n    // Assume x is the positive number.\n    if (x.negative !== 0)\n      [x, y] = [y.clone(), x];\n\n    // x ^ (-y) == x ^ ~(y-1)\n    //          == ~(x ^ (y-1))\n    //          == -((x ^ (y-1)) + 1)\n    y.iaddn(1);\n    x.iuxor(y);\n    x.iaddn(1);\n    x.ineg();\n    y.isubn(1);\n\n    return x._move(this);\n  }\n\n  ixorn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n\n    if ((this.negative | (num < 0)) !== 0)\n      return this.ixor(new BN(num));\n\n    this.words[0] ^= num;\n\n    return this;\n  }\n\n  xor(num) {\n    return this.clone().ixor(num);\n  }\n\n  xorn(num) {\n    return this.clone().ixorn(num);\n  }\n\n  /*\n   * Unsigned XOR\n   */\n\n  iuxor(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    let a = this;\n    let b = num;\n\n    if (a.length < b.length)\n      [a, b] = [b, a];\n\n    let i = 0;\n\n    for (; i < b.length; i++)\n      this.words[i] = a.words[i] ^ b.words[i];\n\n    if (a !== this) {\n      this._alloc(a.length);\n\n      for (; i < a.length; i++)\n        this.words[i] = a.words[i];\n    }\n\n    this.length = a.length;\n\n    return this._strip();\n  }\n\n  iuxorn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n\n    this.words[0] ^= Math.abs(num);\n\n    return this._normalize();\n  }\n\n  uxor(num) {\n    return this.clone().iuxor(num);\n  }\n\n  uxorn(num) {\n    return this.clone().iuxorn(num);\n  }\n\n  /*\n   * NOT\n   */\n\n  inot() {\n    if (this.negative !== 0) {\n      // ~(-x) == ~(~(x-1)) == x-1\n      this.ineg().isubn(1);\n    } else {\n      // ~x == -x-1 == -(x+1)\n      this.iaddn(1).ineg();\n    }\n    return this;\n  }\n\n  not() {\n    return this.clone().inot();\n  }\n\n  inotn(width) {\n    enforce((width >>> 0) === width, 'width', 'uint32');\n\n    const r = width % 26;\n\n    let s = Math.ceil(width / 26);\n    let i = 0;\n\n    // Extend the buffer with leading zeroes.\n    this._expand(s);\n\n    if (r > 0)\n      s -= 1;\n\n    // Handle complete words.\n    for (; i < s; i++)\n      this.words[i] ^= 0x3ffffff;\n\n    // Handle the residue.\n    if (r > 0)\n      this.words[i] ^= (1 << r) - 1;\n\n    // And remove leading zeroes.\n    return this._strip();\n  }\n\n  notn(width) {\n    return this.clone().inotn(width);\n  }\n\n  /*\n   * Left Shift\n   */\n\n  ishl(num) {\n    enforce(BN.isBN(num), 'bits', 'bignum');\n    enforce(num.bitLength() <= 32, 'bits', 'uint32');\n    return this.ishln(num.toNumber());\n  }\n\n  ishln(bits) {\n    return this.iushln(bits);\n  }\n\n  shl(num) {\n    return this.clone().ishl(num);\n  }\n\n  shln(bits) {\n    return this.clone().ishln(bits);\n  }\n\n  /*\n   * Unsigned Left Shift\n   */\n\n  iushl(num) {\n    enforce(BN.isBN(num), 'bits', 'bignum');\n    enforce(num.bitLength() <= 32, 'bits', 'uint32');\n    return this.iushln(num.toNumber());\n  }\n\n  iushln(bits) {\n    enforce((bits >>> 0) === bits, 'bits', 'uint32');\n\n    const r = bits % 26;\n    const s = (bits - r) / 26;\n    const mask = ((1 << r) - 1) << (26 - r);\n\n    if (r !== 0) {\n      let carry = 0;\n\n      for (let i = 0; i < this.length; i++) {\n        const ncarry = this.words[i] & mask;\n        const c = ((this.words[i] | 0) - ncarry) << r;\n\n        this.words[i] = c | carry;\n\n        carry = ncarry >>> (26 - r);\n      }\n\n      if (carry !== 0) {\n        this._alloc(this.length + 1);\n        this.words[this.length++] = carry;\n      }\n    }\n\n    if (s !== 0) {\n      this._alloc(this.length + s);\n\n      for (let i = this.length - 1; i >= 0; i--)\n        this.words[i + s] = this.words[i];\n\n      for (let i = 0; i < s; i++)\n        this.words[i] = 0;\n\n      this.length += s;\n    }\n\n    return this._strip();\n  }\n\n  ushl(num) {\n    return this.clone().iushl(num);\n  }\n\n  ushln(bits) {\n    return this.clone().iushln(bits);\n  }\n\n  /*\n   * Right Shift Engine\n   */\n\n  _split(bits, output) {\n    const r = bits % 26;\n    const s = Math.min((bits - r) / 26, this.length);\n    const mask = (1 << r) - 1;\n\n    // Extended mode, copy masked part.\n    if (output) {\n      output._alloc(s);\n\n      for (let i = 0; i < s; i++)\n        output.words[i] = this.words[i];\n\n      output.length = s;\n    }\n\n    if (s === 0) {\n      // No-op, we should not move anything at all.\n    } else if (this.length > s) {\n      this.length -= s;\n      for (let i = 0; i < this.length; i++)\n        this.words[i] = this.words[i + s];\n    } else {\n      this.words[0] = 0;\n      this.length = 1;\n    }\n\n    let carry = 0;\n\n    if (r !== 0) {\n      for (let i = this.length - 1; i >= 0; i--) {\n        const word = this.words[i] | 0;\n\n        this.words[i] = (carry << (26 - r)) | (word >>> r);\n\n        carry = word & mask;\n      }\n    }\n\n    // Push carried bits as a mask.\n    if (output) {\n      if (carry !== 0) {\n        output._alloc(output.length + 1);\n        output.words[output.length++] = carry;\n      } else {\n        if (output.length === 0)\n          output.words[output.length++] = 0;\n\n        output._strip();\n      }\n    }\n\n    return this._strip();\n  }\n\n  /*\n   * Right Shift\n   */\n\n  ishr(num) {\n    enforce(BN.isBN(num), 'bits', 'bignum');\n    enforce(num.bitLength() <= 32, 'bits', 'uint32');\n    return this.ishrn(num.toNumber());\n  }\n\n  ishrn(bits) {\n    enforce((bits >>> 0) === bits, 'bits', 'uint32');\n\n    if (this.negative !== 0) {\n      // (-x) >> y == ~(x-1) >> y\n      //           == ~((x-1) >> y)\n      //           == -(((x-1) >> y) + 1)\n      this.iaddn(1);\n      this.iushrn(bits);\n      this.isubn(1);\n      return this;\n    }\n\n    return this.iushrn(bits);\n  }\n\n  shr(num) {\n    return this.clone().ishr(num);\n  }\n\n  shrn(bits) {\n    return this.clone().ishrn(bits);\n  }\n\n  /*\n   * Unsigned Right Shift\n   */\n\n  iushr(num) {\n    enforce(BN.isBN(num), 'bits', 'bignum');\n    enforce(num.bitLength() <= 32, 'bits', 'uint32');\n    return this.iushrn(num.toNumber());\n  }\n\n  iushrn(bits) {\n    enforce((bits >>> 0) === bits, 'bits', 'uint32');\n    return this._split(bits, null);\n  }\n\n  ushr(num) {\n    return this.clone().iushr(num);\n  }\n\n  ushrn(bits) {\n    return this.clone().iushrn(bits);\n  }\n\n  /*\n   * Bit Manipulation\n   */\n\n  setn(bit, val) {\n    enforce((bit >>> 0) === bit, 'bit', 'uint32');\n\n    if (this.negative !== 0) {\n      this.iaddn(1);\n      this.usetn(bit, !val);\n      this.isubn(1);\n      return this;\n    }\n\n    return this.usetn(bit, val);\n  }\n\n  usetn(bit, val) {\n    enforce((bit >>> 0) === bit, 'bit', 'uint32');\n\n    const r = bit % 26;\n    const s = (bit - r) / 26;\n\n    this._expand(s + 1);\n\n    if (val)\n      this.words[s] |= (1 << r);\n    else\n      this.words[s] &= ~(1 << r);\n\n    return this._strip();\n  }\n\n  testn(bit) {\n    enforce((bit >>> 0) === bit, 'bit', 'uint32');\n\n    const r = bit % 26;\n    const s = (bit - r) / 26;\n\n    // Fast case: bit is much higher than all existing words.\n    if (this.length <= s)\n      return this.negative;\n\n    // Check bit and return.\n    const w = this.words[s];\n    const val = (w >> r) & 1;\n\n    if (this.negative !== 0) {\n      if (r > 0 && (w & ((1 << r) - 1)))\n        return val ^ 1;\n\n      let j = s;\n\n      while (j--) {\n        if (this.words[j] > 0)\n          return val ^ 1;\n      }\n    }\n\n    return val;\n  }\n\n  utestn(bit) {\n    enforce((bit >>> 0) === bit, 'bit', 'uint32');\n\n    const r = bit % 26;\n    const s = (bit - r) / 26;\n\n    // Fast case: bit is much higher than all existing words.\n    if (this.length <= s)\n      return 0;\n\n    // Check bit and return.\n    return (this.words[s] >> r) & 1;\n  }\n\n  imaskn(bits) {\n    enforce((bits >>> 0) === bits, 'bits', 'uint32');\n\n    if (this.negative !== 0) {\n      this.iaddn(1);\n      this.inotn(bits + 1);\n      this.ineg();\n    }\n\n    return this.iumaskn(bits);\n  }\n\n  maskn(bits) {\n    return this.clone().imaskn(bits);\n  }\n\n  iumaskn(bits) {\n    enforce((bits >>> 0) === bits, 'bits', 'uint32');\n\n    const r = bits % 26;\n\n    let s = (bits - r) / 26;\n\n    if (this.length <= s)\n      return this;\n\n    if (r !== 0)\n      s += 1;\n\n    this.length = Math.min(s, this.length);\n\n    if (r !== 0)\n      this.words[this.length - 1] &= (1 << r) - 1;\n\n    if (this.length === 0)\n      this.words[this.length++] = 0;\n\n    return this._strip();\n  }\n\n  umaskn(bits) {\n    return this.clone().iumaskn(bits);\n  }\n\n  andln(num) {\n    return this.words[0] & num;\n  }\n\n  bit(pos) {\n    return this.utestn(pos);\n  }\n\n  bits(pos, width) {\n    enforce((pos >>> 0) === pos, 'pos', 'uint32');\n    enforce((width >>> 0) === width, 'width', 'uint32');\n    enforce(width <= 26, 'width', 'width');\n\n    const shift = pos % 26;\n    const index = (pos - shift) / 26;\n\n    if (index >= this.length)\n      return 0;\n\n    let bits = (this.words[index] >> shift) & ((1 << width) - 1);\n\n    if (shift + width > 26 && index + 1 < this.length) {\n      const more = shift + width - 26;\n      const next = this.words[index + 1] & ((1 << more) - 1);\n\n      bits |= next << (26 - shift);\n    }\n\n    return bits;\n  }\n\n  /*\n   * Negation\n   */\n\n  ineg() {\n    if (!this.isZero())\n      this.negative ^= 1;\n\n    return this;\n  }\n\n  neg() {\n    return this.clone().ineg();\n  }\n\n  iabs() {\n    this.negative = 0;\n    return this;\n  }\n\n  abs() {\n    return this.clone().iabs();\n  }\n\n  /*\n   * Comparison\n   */\n\n  cmp(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    if (this.negative !== num.negative)\n      return num.negative - this.negative;\n\n    const res = this.ucmp(num);\n\n    if (this.negative !== 0)\n      return -res | 0;\n\n    return res;\n  }\n\n  cmpn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n\n    const negative = (num < 0) | 0;\n\n    if (this.negative !== negative)\n      return negative - this.negative;\n\n    const res = this.ucmpn(num);\n\n    if (this.negative !== 0)\n      return -res | 0;\n\n    return res;\n  }\n\n  eq(num) {\n    return this.cmp(num) === 0;\n  }\n\n  eqn(num) {\n    return this.cmpn(num) === 0;\n  }\n\n  gt(num) {\n    return this.cmp(num) > 0;\n  }\n\n  gtn(num) {\n    return this.cmpn(num) > 0;\n  }\n\n  gte(num) {\n    return this.cmp(num) >= 0;\n  }\n\n  gten(num) {\n    return this.cmpn(num) >= 0;\n  }\n\n  lt(num) {\n    return this.cmp(num) < 0;\n  }\n\n  ltn(num) {\n    return this.cmpn(num) < 0;\n  }\n\n  lte(num) {\n    return this.cmp(num) <= 0;\n  }\n\n  lten(num) {\n    return this.cmpn(num) <= 0;\n  }\n\n  sign() {\n    if (this.negative !== 0)\n      return -1;\n\n    if (this.length === 1 && this.words[0] === 0)\n      return 0;\n\n    return 1;\n  }\n\n  isZero() {\n    return this.length === 1 && this.words[0] === 0;\n  }\n\n  isNeg() {\n    return this.negative !== 0;\n  }\n\n  isPos() {\n    return this.negative === 0;\n  }\n\n  isOdd() {\n    return (this.words[0] & 1) === 1;\n  }\n\n  isEven() {\n    return (this.words[0] & 1) === 0;\n  }\n\n  /*\n   * Unsigned Comparison\n   */\n\n  ucmp(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    if (this.length < num.length)\n      return -1;\n\n    if (this.length > num.length)\n      return 1;\n\n    for (let i = this.length - 1; i >= 0; i--) {\n      const a = this.words[i] | 0;\n      const b = num.words[i] | 0;\n\n      if (a === b)\n        continue;\n\n      return (a > b) - (a < b);\n    }\n\n    return 0;\n  }\n\n  ucmpn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n\n    if (this.length > 1)\n      return 1;\n\n    const w = this.words[0] | 0;\n\n    if (num < 0)\n      num = -num;\n\n    return (w > num) - (w < num);\n  }\n\n  /*\n   * Number Theoretic Functions\n   */\n\n  legendre(num) {\n    const red = HAS_BIGINT ? BN.red(num) : BN.mont(num);\n    return this.toRed(red).redLegendre();\n  }\n\n  jacobi(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    if (num.isZero() || num.isEven())\n      throw new Error('jacobi: `num` must be odd.');\n\n    let a = this._cloneNormal();\n    let b = num.clone();\n    let j = 1;\n\n    if (b.isNeg()) {\n      if (a.isNeg())\n        j = -1;\n      b.ineg();\n    }\n\n    for (;;) {\n      if (b.cmpn(1) === 0)\n        return j;\n\n      if (a.isZero())\n        return 0;\n\n      a.imod(b);\n\n      if (a.isZero())\n        return 0;\n\n      const s = a.zeroBits();\n\n      if (s & 1) {\n        const bmod8 = b.andln(7);\n\n        if (bmod8 === 3 || bmod8 === 5)\n          j = -j;\n      }\n\n      const c = a.iushrn(s);\n\n      if (b.andln(3) === 3 && c.andln(3) === 3)\n        j = -j;\n\n      a = b;\n      b = c;\n    }\n  }\n\n  kronecker(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    const table = [\n      0,  1, 0, -1,\n      0, -1, 0,  1\n    ];\n\n    let a = this._cloneNormal();\n    let b = num.clone();\n    let s = 1;\n\n    if (b.isZero())\n      return a.ucmpn(1) === 0 ? s : 0;\n\n    if (!a.isOdd() && !b.isOdd())\n      return 0;\n\n    const z = b.zeroBits();\n\n    b.iushrn(z);\n\n    if (z & 1)\n      s = table[a.andln(7)];\n\n    if (b.isNeg()) {\n      if (a.isNeg())\n        s = -s;\n      b.ineg();\n    }\n\n    for (;;) {\n      if (a.isZero())\n        return b.cmpn(1) === 0 ? s : 0;\n\n      const z = a.zeroBits();\n\n      a.iushrn(z);\n\n      if (z & 1)\n        s *= table[b.andln(7)];\n\n      const w = a.words[0] ^ (a.negative * 0x3ffffff);\n\n      if (w & b.words[0] & 2)\n        s = -s;\n\n      b.imod(a);\n\n      [a, b] = [b, a];\n\n      b.negative = 0;\n    }\n  }\n\n  igcd(num) {\n    return this.gcd(num)._move(this);\n  }\n\n  gcd(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    if (this.isZero())\n      return num.abs();\n\n    if (num.isZero())\n      return this.abs();\n\n    let a = this.clone();\n    let b = num.clone();\n\n    a.negative = 0;\n    b.negative = 0;\n\n    // Remove common factor of two.\n    const shift = a._factor2(b);\n\n    if (shift !== 0) {\n      a.iushrn(shift);\n      b.iushrn(shift);\n    }\n\n    for (;;) {\n      const az = a.zeroBits();\n      const bz = b.zeroBits();\n\n      if (az !== 0)\n        a.iushrn(az);\n\n      if (bz !== 0)\n        b.iushrn(bz);\n\n      const cmp = a.ucmp(b);\n\n      if (cmp < 0) {\n        // a > b\n        [a, b] = [b, a];\n      } else if (cmp === 0 || b.ucmpn(1) === 0) {\n        // Break if a == b.\n        // Break if b == 1 to avoid repeated subtraction.\n        break;\n      }\n\n      a._isub(a, b);\n    }\n\n    return b.iushln(shift);\n  }\n\n  ilcm(num) {\n    return this.lcm(num)._move(this);\n  }\n\n  lcm(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    if (this.isZero() || num.isZero())\n      return new BN(0);\n\n    return this.quo(this.gcd(num)).mul(num).iabs();\n  }\n\n  egcd(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    if (this.isZero()) {\n      return [\n        new BN(0),\n        new BN(num.sign()),\n        num.abs()\n      ];\n    }\n\n    if (num.isZero()) {\n      return [\n        new BN(this.sign()),\n        new BN(0),\n        this.abs()\n      ];\n    }\n\n    const x = this.clone();\n    const y = num.clone();\n\n    x.negative = 0;\n    y.negative = 0;\n\n    // A * x + B * y = x\n    const A = new BN(1);\n    const B = new BN(0);\n\n    // C * x + D * y = y\n    const C = new BN(0);\n    const D = new BN(1);\n\n    // Remove common factor of two.\n    const g = x._factor2(y);\n\n    if (g !== 0) {\n      x.iushrn(g);\n      y.iushrn(g);\n    }\n\n    const yp = y.clone();\n    const xp = x.clone();\n\n    while (!x.isZero()) {\n      let i = 0;\n\n      for (let im = 1; (x.words[0] & im) === 0 && i < 26; im <<= 1)\n        i += 1;\n\n      if (i > 0) {\n        x.iushrn(i);\n\n        while (i > 0) {\n          if (A.isOdd() || B.isOdd()) {\n            A.iadd(yp);\n            B.isub(xp);\n          }\n\n          A.iushrn(1);\n          B.iushrn(1);\n\n          i -= 1;\n        }\n      }\n\n      let j = 0;\n\n      for (let jm = 1; (y.words[0] & jm) === 0 && j < 26; jm <<= 1)\n        j += 1;\n\n      if (j > 0) {\n        y.iushrn(j);\n\n        while (j > 0) {\n          if (C.isOdd() || D.isOdd()) {\n            C.iadd(yp);\n            D.isub(xp);\n          }\n\n          C.iushrn(1);\n          D.iushrn(1);\n\n          j -= 1;\n        }\n      }\n\n      if (x.cmp(y) >= 0) {\n        x.isub(y);\n        A.isub(C);\n        B.isub(D);\n      } else {\n        y.isub(x);\n        C.isub(A);\n        D.isub(B);\n      }\n    }\n\n    if (this.negative !== 0)\n      C.ineg();\n\n    if (num.negative !== 0)\n      D.ineg();\n\n    return [C, D, y.iushln(g)];\n  }\n\n  iinvert(num) {\n    return this.invert(num)._move(this);\n  }\n\n  invert(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    range(num.sign() > 0, 'invert');\n\n    if (num.cmpn(1) === 0)\n      throw new RangeError('Not invertible.');\n\n    const [s,, g] = this.egcd(num);\n\n    if (g.cmpn(1) !== 0)\n      throw new RangeError('Not invertible.');\n\n    return s.imod(num);\n  }\n\n  ifermat(num) {\n    return this.fermat(num)._move(this);\n  }\n\n  fermat(num) {\n    const red = HAS_BIGINT ? BN.red(num) : BN.mont(num);\n    return this.toRed(red).redFermat().fromRed();\n  }\n\n  ipowm(y, m, mont) {\n    return this.powm(y, m, mont)._move(this);\n  }\n\n  powm(y, m, mont) {\n    const red = !HAS_BIGINT && mont ? BN.mont(m) : BN.red(m);\n    return this.toRed(red).redPow(y).fromRed();\n  }\n\n  ipowmn(y, m, mont) {\n    return this.powmn(y, m, mont)._move(this);\n  }\n\n  powmn(y, m, mont) {\n    const red = mont ? BN.mont(m) : BN.red(m);\n    return this.toRed(red).redPown(y).fromRed();\n  }\n\n  isqrtm(p) {\n    return this.sqrtm(p)._move(this);\n  }\n\n  sqrtm(p) {\n    enforce(BN.isBN(p), 'p', 'bignum');\n\n    let red;\n\n    if (p.andln(3) === 3 || p.andln(7) === 5) {\n      // Probably not worth the setup.\n      red = BN.red(p);\n    } else {\n      red = BN.mont(p);\n    }\n\n    return this.toRed(red).redSqrt().fromRed();\n  }\n\n  isqrtpq(p, q) {\n    return this.sqrtpq(p, q)._move(this);\n  }\n\n  sqrtpq(p, q) {\n    const sp = this.sqrtm(p);\n    const sq = this.sqrtm(q);\n    const [mp, mq] = p.egcd(q);\n    const lhs = sq.mul(mp).mul(p);\n    const rhs = sp.mul(mq).mul(q);\n    const n = p.mul(q);\n\n    return lhs.iadd(rhs).imod(n);\n  }\n\n  /*\n   * Primality Testing\n   */\n\n  isPrime(rng, reps, limit) {\n    enforce((reps >>> 0) === reps, 'reps', 'uint32');\n\n    if (!this.isPrimeMR(rng, reps + 1, true))\n      return false;\n\n    if (!this.isPrimeLucas(limit))\n      return false;\n\n    return true;\n  }\n\n  isPrimeMR(rng, reps, force2 = false) {\n    enforce((reps >>> 0) === reps, 'reps', 'uint32');\n    enforce(reps > 0, 'reps', 'integer');\n    enforce(typeof force2 === 'boolean', 'force2', 'boolean');\n\n    const n = this;\n\n    if (n.cmpn(7) < 0) {\n      return n.cmpn(2) === 0\n          || n.cmpn(3) === 0\n          || n.cmpn(5) === 0;\n    }\n\n    if (n.isEven())\n      return false;\n\n    const nm1 = n.subn(1);\n    const nm3 = nm1.subn(2);\n    const k = nm1.zeroBits();\n    const q = nm1.ushrn(k);\n\n    const red = BN.red(n);\n    const rnm1 = nm1.toRed(red);\n    const rone = new BN(1).toRed(red);\n\nnext:\n    for (let i = 0; i < reps; i++) {\n      let x;\n\n      if (i === reps - 1 && force2) {\n        x = new BN(2);\n      } else {\n        x = BN.random(rng, 0, nm3);\n        x.iaddn(2);\n      }\n\n      let y = x.toRed(red).redPow(q);\n\n      if (y.cmp(rone) === 0 || y.cmp(rnm1) === 0)\n        continue;\n\n      for (let j = 1; j < k; j++) {\n        y = y.redSqr();\n\n        if (y.cmp(rnm1) === 0)\n          continue next;\n\n        if (y.cmp(rone) === 0)\n          return false;\n      }\n\n      return false;\n    }\n\n    return true;\n  }\n\n  isPrimeLucas(limit = 0) {\n    enforce((limit >>> 0) === limit, 'limit', 'uint32');\n\n    const n = this;\n\n    // Ignore 0 and 1.\n    if (n.cmpn(1) <= 0)\n      return false;\n\n    // Two is the only even prime.\n    if (n.isEven())\n      return n.cmpn(2) === 0;\n\n    let p = 3;\n\n    for (;;) {\n      if (p > 10000) {\n        // Thought to be impossible.\n        throw new Error(`Cannot find (D/n) = -1 for ${n.toString(10)}.`);\n      }\n\n      if (limit !== 0 && p > limit) {\n        // Optional DoS limit.\n        return false;\n      }\n\n      const d = new BN(p * p - 4);\n      const j = d.jacobi(n);\n\n      if (j === -1)\n        break;\n\n      if (j === 0)\n        return n.cmpn(p + 2) === 0;\n\n      if (p === 40) {\n        if (n.isSquare())\n          return false;\n      }\n\n      p += 1;\n    }\n\n    const s = n.addn(1);\n    const r = s.zeroBits();\n    const nm2 = n.subn(2);\n\n    let x = new BN(2);\n    let y = new BN(p);\n\n    s.iushrn(r);\n\n    for (let i = s.bitLength(); i >= 0; i--) {\n      if (s.utestn(i)) {\n        x = x.mul(y).iadd(n).isubn(p).imod(n);\n        y = y.sqr().iadd(nm2).imod(n);\n      } else {\n        y = y.mul(x).iadd(n).isubn(p).imod(n);\n        x = x.sqr().iadd(nm2).imod(n);\n      }\n    }\n\n    if (x.cmpn(2) === 0 || x.cmp(nm2) === 0) {\n      let a = x.muln(p);\n      let b = y.ushln(1);\n\n      if (a.cmp(b) < 0)\n        [a, b] = [b, a];\n\n      if (a.isub(b).imod(n).isZero())\n        return true;\n    }\n\n    for (let t = 0; t < r - 1; t++) {\n      if (x.isZero())\n        return true;\n\n      if (x.cmpn(2) === 0)\n        return false;\n\n      x = x.sqr().isubn(2).imod(n);\n    }\n\n    return false;\n  }\n\n  /*\n   * Twos Complement\n   */\n\n  toTwos(width) {\n    if (this.negative !== 0)\n      return this.abs().inotn(width).iaddn(1);\n\n    return this.clone();\n  }\n\n  fromTwos(width) {\n    enforce((width >>> 0) === width, 'width', 'uint32');\n    range(width > 0, 'width');\n\n    if (this.testn(width - 1))\n      return this.notn(width).iaddn(1).ineg();\n\n    return this.clone();\n  }\n\n  /*\n   * Reduction Context\n   */\n\n  toRed(ctx) {\n    enforce(ctx instanceof Red, 'ctx', 'reduction context');\n\n    if (this.red)\n      throw new Error('Already in reduction context.');\n\n    return ctx.convertTo(this);\n  }\n\n  fromRed() {\n    red(this.red, 'fromRed');\n    return this.red.convertFrom(this);\n  }\n\n  forceRed(ctx) {\n    enforce(ctx instanceof Red, 'ctx', 'reduction context');\n\n    if (this.red) {\n      if (!ctx.m.eq(this.red.m) || ctx.mont !== this.red.mont)\n        throw new Error('Already in reduction context.');\n    } else {\n      range(this.negative === 0, 'red');\n      range(this.ucmp(ctx.m) < 0, 'red');\n    }\n\n    return this.clone()._forceRed(ctx);\n  }\n\n  redIAdd(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redIAdd');\n    return this.red.iadd(this, num);\n  }\n\n  redAdd(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redAdd');\n    return this.red.add(this, num);\n  }\n\n  redIAddn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redIAddn');\n    return this.red.iaddn(this, num);\n  }\n\n  redAddn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redAddn');\n    return this.red.addn(this, num);\n  }\n\n  redISub(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redISub');\n    return this.red.isub(this, num);\n  }\n\n  redSub(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redSub');\n    return this.red.sub(this, num);\n  }\n\n  redISubn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redISubn');\n    return this.red.isubn(this, num);\n  }\n\n  redSubn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redSubn');\n    return this.red.subn(this, num);\n  }\n\n  redIMul(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redIMul');\n    return this.red.imul(this, num);\n  }\n\n  redMul(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redMul');\n    return this.red.mul(this, num);\n  }\n\n  redIMuln(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redIMuln');\n    return this.red.imuln(this, num);\n  }\n\n  redMuln(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redMuln');\n    return this.red.muln(this, num);\n  }\n\n  redIDiv(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redIDiv');\n    return this.red.idiv(this, num);\n  }\n\n  redDiv(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redDiv');\n    return this.red.div(this, num);\n  }\n\n  redIDivn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redIDivn');\n    return this.red.idivn(this, num);\n  }\n\n  redDivn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redDivn');\n    return this.red.divn(this, num);\n  }\n\n  redIPow(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redIPow');\n    nonred(!num.red, 'redIPow');\n    return this.red.ipow(this, num);\n  }\n\n  redPow(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redPow');\n    nonred(!num.red, 'redPow');\n    return this.red.pow(this, num);\n  }\n\n  redIPown(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redIPown');\n    return this.red.ipown(this, num);\n  }\n\n  redPown(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redPown');\n    return this.red.pown(this, num);\n  }\n\n  redISqr() {\n    red(this.red, 'redISqr');\n    return this.red.isqr(this);\n  }\n\n  redSqr() {\n    red(this.red, 'redSqr');\n    return this.red.sqr(this);\n  }\n\n  redISqrt() {\n    red(this.red, 'redISqrt');\n    return this.red.isqrt(this);\n  }\n\n  redSqrt() {\n    red(this.red, 'redSqrt');\n    return this.red.sqrt(this);\n  }\n\n  redIDivSqrt(v) {\n    red(this.red, 'redIDivSqrt');\n    return this.red.idivsqrt(this, v);\n  }\n\n  redDivSqrt(v) {\n    red(this.red, 'redDivSqrt');\n    return this.red.divsqrt(this, v);\n  }\n\n  redIsSquare() {\n    red(this.red, 'redIsSquare');\n    return this.red.isSquare(this);\n  }\n\n  redIShl(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redIShl');\n    nonred(!num.red, 'redIShl');\n    return this.red.ishl(this, num);\n  }\n\n  redShl(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redShl');\n    nonred(!num.red, 'redShl');\n    return this.red.shl(this, num);\n  }\n\n  redIShln(num) {\n    enforce((num >>> 0) === num, 'num', 'uint32');\n    red(this.red, 'redIShln');\n    return this.red.ishln(this, num);\n  }\n\n  redShln(num) {\n    enforce((num >>> 0) === num, 'num', 'uint32');\n    red(this.red, 'redShln');\n    return this.red.shln(this, num);\n  }\n\n  redINeg() {\n    red(this.red, 'redINeg');\n    return this.red.ineg(this);\n  }\n\n  redNeg() {\n    red(this.red, 'redNeg');\n    return this.red.neg(this);\n  }\n\n  redEq(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n    red(this.red, 'redEq');\n    return this.red.eq(this, num);\n  }\n\n  redEqn(num) {\n    enforce(isSMI(num), 'num', 'smi');\n    red(this.red, 'redEqn');\n    return this.red.eqn(this, num);\n  }\n\n  redIsHigh() {\n    red(this.red, 'redIsHigh');\n    return this.red.isHigh(this);\n  }\n\n  redIsLow() {\n    red(this.red, 'redIsLow');\n    return this.red.isLow(this);\n  }\n\n  redIsOdd() {\n    red(this.red, 'redIsOdd');\n    return this.red.isOdd(this);\n  }\n\n  redIsEven() {\n    red(this.red, 'redIsEven');\n    return this.red.isEven(this);\n  }\n\n  redLegendre() {\n    red(this.red, 'redLegendre');\n    return this.red.legendre(this);\n  }\n\n  redJacobi() {\n    red(this.red, 'redJacobi');\n    return this.red.jacobi(this);\n  }\n\n  redKronecker() {\n    red(this.red, 'redKronecker');\n    return this.red.kronecker(this);\n  }\n\n  redIInvert() {\n    red(this.red, 'redIInvert');\n    return this.red.iinvert(this);\n  }\n\n  redInvert() {\n    red(this.red, 'redInvert');\n    return this.red.invert(this);\n  }\n\n  redIFermat() {\n    red(this.red, 'redIFermat');\n    return this.red.ifermat(this);\n  }\n\n  redFermat() {\n    red(this.red, 'redFermat');\n    return this.red.fermat(this);\n  }\n\n  /*\n   * Internal\n   */\n\n  _move(dest) {\n    dest.words = this.words;\n    dest.length = this.length;\n    dest.negative = this.negative;\n    dest.red = this.red;\n    return dest;\n  }\n\n  _alloc(size) {\n    while (this.words.length < size)\n      this.words.push(0);\n\n    return this;\n  }\n\n  _expand(size) {\n    this._alloc(size);\n\n    while (this.length < size)\n      this.words[this.length++] = 0;\n\n    return this;\n  }\n\n  _strip() {\n    while (this.length > 1 && this.words[this.length - 1] === 0)\n      this.length -= 1;\n\n    return this._normalize();\n  }\n\n  _normalize() {\n    assert(this.length > 0);\n\n    // -0 = 0\n    if (this.length === 1 && this.words[0] === 0)\n      this.negative = 0;\n\n    return this;\n  }\n\n  _check() {\n    // We never have a zero length number.\n    assert(this.length > 0);\n\n    // Cannot exceed array bounds.\n    assert(this.length <= this.words.length);\n\n    if (this.length === 1) {\n      // Must be normalized.\n      if (this.words[0] === 0)\n        assert(this.negative === 0);\n      return this;\n    }\n\n    // Must be stripped.\n    assert(this.words[this.length - 1] !== 0);\n\n    return this;\n  }\n\n  _invertp(p) {\n    enforce(BN.isBN(p), 'p', 'bignum');\n    assert(this.negative === 0);\n    assert(p.sign() > 0);\n\n    if (this.isZero() || p.cmpn(1) === 0)\n      throw new RangeError('Not invertible.');\n\n    const a = this.clone();\n    const b = p.clone();\n    const x1 = new BN(1);\n    const x2 = new BN(0);\n    const delta = b.clone();\n\n    while (a.cmpn(1) > 0 && b.cmpn(1) > 0) {\n      let i = 0;\n\n      for (let im = 1; (a.words[0] & im) === 0 && i < 26; im <<= 1)\n        i += 1;\n\n      if (i > 0) {\n        a.iushrn(i);\n\n        while (i > 0) {\n          if (x1.isOdd())\n            x1.iadd(delta);\n\n          x1.iushrn(1);\n\n          i -= 1;\n        }\n      }\n\n      let j = 0;\n\n      for (let jm = 1; (b.words[0] & jm) === 0 && j < 26; jm <<= 1)\n        j += 1;\n\n      if (j > 0) {\n        b.iushrn(j);\n\n        while (j > 0) {\n          if (x2.isOdd())\n            x2.iadd(delta);\n\n          x2.iushrn(1);\n\n          j -= 1;\n        }\n      }\n\n      if (a.cmp(b) >= 0) {\n        a.isub(b);\n        x1.isub(x2);\n      } else {\n        b.isub(a);\n        x2.isub(x1);\n      }\n    }\n\n    // Quick reduction (typically +/- 2P).\n    const res = a.cmpn(1) === 0 ? x1 : x2;\n\n    if (res.ucmp(p) >= 0) {\n      res._isub(res, p);\n\n      if (res.ucmp(p) >= 0)\n        res._isub(res, p);\n    }\n\n    if (res.isNeg())\n      res.iadd(p);\n\n    return res;\n  }\n\n  _factor2(num) {\n    // Find common factor of two.\n    // Expects inputs to be non-zero.\n    if ((this.words[0] | num.words[0]) & 1)\n      return 0;\n\n    const len = Math.min(this.length, num.length);\n\n    let r = 0;\n\n    for (let i = 0; i < len; i++) {\n      const b = zeroBits(this.words[i] | num.words[i]);\n\n      r += b;\n\n      if (b !== 26)\n        break;\n    }\n\n    return r;\n  }\n\n  _cloneNormal() {\n    return this.red ? this.fromRed() : this.clone();\n  }\n\n  _forceRed(ctx) {\n    this.red = ctx;\n    return this;\n  }\n\n  /*\n   * Helpers\n   */\n\n  clone() {\n    const copy = new BN();\n\n    copy.words = new Array(this.length);\n\n    for (let i = 0; i < this.length; i++)\n      copy.words[i] = this.words[i];\n\n    copy.length = this.length;\n    copy.negative = this.negative;\n    copy.red = this.red;\n\n    return copy;\n  }\n\n  inject(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    this._alloc(num.length);\n\n    for (let i = 0; i < num.length; i++)\n      this.words[i] = num.words[i];\n\n    this.length = num.length;\n    this.negative = num.negative;\n    this.red = num.red;\n\n    return this;\n  }\n\n  set(num, endian) {\n    return this.fromNumber(num, endian);\n  }\n\n  swap(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    const x = this;\n    const y = num;\n\n    [x.words, y.words] = [y.words, x.words];\n    [x.length, y.length] = [y.length, x.length];\n    [x.negative, y.negative] = [y.negative, x.negative];\n    [x.red, y.red] = [y.red, x.red];\n\n    return x;\n  }\n\n  reverse() {\n    const neg = this.negative;\n\n    this.fromBuffer(this.toBuffer('be'), 'le');\n    this.negative = neg;\n\n    return this;\n  }\n\n  byteLength() {\n    return Math.ceil(this.bitLength() / 8);\n  }\n\n  bitLength() {\n    const w = this.words[this.length - 1];\n    const hi = countBits(w);\n    return (this.length - 1) * 26 + hi;\n  }\n\n  zeroBits() {\n    if (this.isZero())\n      return 0;\n\n    if (this.isOdd())\n      return 0;\n\n    let r = 0;\n\n    for (let i = 0; i < this.length; i++) {\n      const b = zeroBits(this.words[i]);\n\n      r += b;\n\n      if (b !== 26)\n        break;\n    }\n\n    return r;\n  }\n\n  isSafe() {\n    if (this.length <= 2)\n      return true;\n\n    if (this.length === 3 && this.words[2] === 0x01)\n      return true;\n\n    return false;\n  }\n\n  word(pos) {\n    enforce((pos >>> 0) === pos, 'pos', 'uint32');\n\n    if (pos >= this.length)\n      return 0;\n\n    return this.words[pos];\n  }\n\n  [custom]() {\n    let prefix = 'BN';\n\n    if (this.red)\n      prefix = 'BN-R';\n\n    return `<${prefix}: ${this.toString(10)}>`;\n  }\n\n  /*\n   * Constant Time\n   */\n\n  csign() {\n    return this.negative * -2 + 1 - this.czero();\n  }\n\n  czero() {\n    const zword = (this.words[0] - 1) >>> 31;\n    return ((this.length - 2) >>> 31) & zword;\n  }\n\n  cneg() {\n    return this.negative;\n  }\n\n  cpos() {\n    return this.negative ^ 1;\n  }\n\n  ceq(num) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    // Assumes `num` is the \"constant size\"\n    // parameter. Note that constant size\n    // doesn't necessarily mean secret.\n    let z = 0;\n\n    for (let i = 0; i < num.length; i++)\n      z |= this.words[i % this.length] ^ num.words[i];\n\n    z |= this.length ^ num.length;\n    z |= this.negative ^ num.negative;\n\n    return (z - 1) >>> 31;\n  }\n\n  ceqn(num) {\n    const neg = (num >> 31) & 1;\n    const word = ((num | 0) * (-neg | 1)) & 0x3ffffff;\n\n    let z = 0;\n\n    z |= this.words[0] ^ word;\n    z |= this.length ^ 1;\n    z |= this.negative ^ neg;\n\n    return (z - 1) >>> 31;\n  }\n\n  cswap(num, flag) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    const x = this;\n    const y = num;\n    const cond = ((flag >> 31) | (-flag >> 31)) & 1;\n    const mask = -cond & 0x3ffffff;\n\n    x._alloc(y.words.length);\n    y._alloc(x.words.length);\n\n    for (let i = 0; i < x.words.length; i++) {\n      const word = (x.words[i] ^ y.words[i]) & mask;\n\n      x.words[i] ^= word;\n      y.words[i] ^= word;\n    }\n\n    const length = (x.length ^ y.length) & mask;\n    const negative = (x.negative ^ y.negative) & mask;\n\n    x.length ^= length;\n    y.length ^= length;\n\n    x.negative ^= negative;\n    y.negative ^= negative;\n\n    return this;\n  }\n\n  cinject(num, flag) {\n    enforce(BN.isBN(num), 'num', 'bignum');\n\n    const x = this;\n    const y = num;\n    const cond = ((flag >> 31) | (-flag >> 31)) & 1;\n    const mask0 = (cond - 1) & 0x3ffffff;\n    const mask1 = ~(cond - 1) & 0x3ffffff;\n\n    x._alloc(y.length);\n\n    for (let i = 0; i < y.length; i++)\n      x.words[i] = (x.words[i] & mask0) | (y.words[i] & mask1);\n\n    x.length = (x.length & mask0) | (y.length & mask1);\n    x.negative = (x.negative & mask0) | (y.negative & mask1);\n\n    return this;\n  }\n\n  cset(num, flag) {\n    const cond = ((flag >> 31) | (-flag >> 31)) & 1;\n    const mask0 = (cond - 1) & 0x3ffffff;\n    const mask1 = ~(cond - 1) & 0x3ffffff;\n    const neg = (num >> 31) & 1;\n    const word = ((num | 0) * (-neg | 1)) & 0x3ffffff;\n\n    this.words[0] = (this.words[0] & mask0) | (word & mask1);\n    this.length = (this.length & mask0) | (1 & mask1);\n    this.negative = (this.negative & mask0) | (neg & mask1);\n\n    return this;\n  }\n\n  /*\n   * Conversion\n   */\n\n  toNumber() {\n    let num = this.words[0];\n\n    if (this.length === 2) {\n      num += this.words[1] * 0x4000000;\n    } else if (this.length === 3 && this.words[2] === 0x01) {\n      // Note: at this stage it is known that the top bit is set.\n      num += 0x10000000000000 + (this.words[1] * 0x4000000);\n    } else if (this.length > 2) {\n      throw new RangeError('Number can only safely store up to 53 bits.');\n    }\n\n    return this.negative !== 0 ? -num : num;\n  }\n\n  toDouble() {\n    let num = 0;\n\n    for (let i = this.length - 1; i >= 0; i--)\n      num = (num * 0x4000000) + this.words[i];\n\n    return this.negative !== 0 ? -num : num;\n  }\n\n  valueOf() {\n    return this.toDouble();\n  }\n\n  toBigInt() {\n    if (!HAS_BIGINT)\n      throw new Error('BigInt is not supported!');\n\n    const s52 = BigInt(52);\n    const s26 = BigInt(26);\n\n    let i = this.length - 1;\n    let num = BigInt(0);\n\n    for (; i >= 1; i -= 2) {\n      const hi = this.words[i] * 0x4000000;\n      const lo = this.words[i - 1];\n\n      num = (num << s52) | BigInt(hi + lo);\n    }\n\n    if (i >= 0)\n      num = (num << s26) | BigInt(this.words[0]);\n\n    return this.negative !== 0 ? -num : num;\n  }\n\n  toBool() {\n    return !this.isZero();\n  }\n\n  toString(base, padding) {\n    base = getBase(base);\n\n    if (padding == null)\n      padding = 0;\n\n    if (padding === 0)\n      padding = 1;\n\n    enforce((base >>> 0) === base, 'base', 'uint32');\n    enforce((padding >>> 0) === padding, 'padding', 'uint32');\n\n    if (base < 2 || base > 36)\n      throw new RangeError('Base ranges between 2 and 36.');\n\n    this._check();\n\n    if (base === 16) {\n      let out = '';\n      let off = 0;\n      let carry = 0;\n\n      for (let i = 0; i < this.length; i++) {\n        const w = this.words[i];\n        const word = (((w << off) | carry) & 0xffffff).toString(16);\n\n        carry = (w >>> (24 - off)) & 0xffffff;\n\n        if (carry !== 0 || i !== this.length - 1)\n          out = zeros[6 - word.length] + word + out;\n        else\n          out = word + out;\n\n        off += 2;\n\n        if (off >= 26) {\n          off -= 26;\n          i -= 1;\n        }\n      }\n\n      if (carry !== 0)\n        out = carry.toString(16) + out;\n\n      while (out.length % padding !== 0)\n        out = '0' + out;\n\n      if (this.negative !== 0)\n        out = '-' + out;\n\n      return out;\n    }\n\n    const groupSize = groupSizes[base - 1];\n    const groupBase = groupBases[base - 1];\n    const c = this.clone();\n\n    let out = '';\n\n    c.negative = 0;\n\n    while (!c.isZero()) {\n      const r = c.remrn(groupBase).toString(base);\n\n      c.iquon(groupBase);\n\n      if (!c.isZero())\n        out = zeros[groupSize - r.length] + r + out;\n      else\n        out = r + out;\n    }\n\n    if (this.isZero())\n      out = '0';\n\n    while (out.length % padding !== 0)\n      out = '0' + out;\n\n    if (this.negative !== 0)\n      out = '-' + out;\n\n    return out;\n  }\n\n  toJSON() {\n    return this.toString(16, 2);\n  }\n\n  toArray(endian, length) {\n    return this.toArrayLike(Array, endian, length);\n  }\n\n  toBuffer(endian, length) {\n    return this.toArrayLike(Buffer, endian, length);\n  }\n\n  toArrayLike(ArrayType, endian, length) {\n    if (endian == null)\n      endian = 'be';\n\n    if (length == null)\n      length = 0;\n\n    enforce(typeof ArrayType === 'function', 'ArrayType', 'function');\n    enforce(endian === 'be' || endian === 'le', 'endian', 'endianness');\n    enforce((length >>> 0) === length, 'length', 'uint32');\n\n    this._check();\n\n    const bytes = this.byteLength();\n    const size = length || Math.max(1, bytes);\n\n    if (bytes > size)\n      throw new RangeError('Byte array longer than desired length.');\n\n    const res = allocate(ArrayType, size);\n\n    // See: https://github.com/indutny/bn.js/pull/222\n    if (endian === 'be') {\n      let pos = res.length - 1;\n      let carry = 0;\n\n      for (let i = 0; i < this.length; i++) {\n        const shift = (i & 3) << 1;\n        const word = (this.words[i] << shift) | carry;\n\n        res[pos--] = word & 0xff;\n\n        if (pos >= 0)\n          res[pos--] = (word >>> 8) & 0xff;\n\n        if (pos >= 0)\n          res[pos--] = (word >>> 16) & 0xff;\n\n        if (shift === 6) {\n          if (pos >= 0)\n            res[pos--] = (word >>> 24) & 0xff;\n\n          carry = 0;\n        } else {\n          carry = word >>> 24;\n        }\n      }\n\n      if (pos >= 0) {\n        res[pos--] = carry;\n\n        while (pos >= 0)\n          res[pos--] = 0;\n\n        carry = 0;\n      }\n\n      assert(carry === 0);\n    } else {\n      let pos = 0;\n      let carry = 0;\n\n      for (let i = 0; i < this.length; i++) {\n        const shift = (i & 3) << 1;\n        const word = (this.words[i] << shift) | carry;\n\n        res[pos++] = word & 0xff;\n\n        if (pos < res.length)\n          res[pos++] = (word >>> 8) & 0xff;\n\n        if (pos < res.length)\n          res[pos++] = (word >>> 16) & 0xff;\n\n        if (shift === 6) {\n          if (pos < res.length)\n            res[pos++] = (word >>> 24) & 0xff;\n\n          carry = 0;\n        } else {\n          carry = word >>> 24;\n        }\n      }\n\n      if (pos < res.length) {\n        res[pos++] = carry;\n\n        while (pos < res.length)\n          res[pos++] = 0;\n\n        carry = 0;\n      }\n\n      assert(carry === 0);\n    }\n\n    return res;\n  }\n\n  encode(endian, length) {\n    return this.toBuffer(endian, length);\n  }\n\n  /*\n   * Instantiation\n   */\n\n  of(num, endian) {\n    return this.fromNumber(num, endian);\n  }\n\n  fromNumber(num, endian) {\n    if (endian == null)\n      endian = 'be';\n\n    enforce(isInteger(num), 'num', 'integer');\n    enforce(endian === 'be' || endian === 'le', 'endian', 'endianness');\n\n    const neg = (num < 0) | 0;\n\n    if (neg)\n      num = -num;\n\n    if (num < 0x4000000) {\n      this.words[0] = num & 0x3ffffff;\n      this.length = 1;\n    } else if (num < 0x10000000000000) {\n      this.words = [\n        num & 0x3ffffff,\n        (num / 0x4000000) & 0x3ffffff\n      ];\n      this.length = 2;\n    } else {\n      this.words = [\n        num & 0x3ffffff,\n        (num / 0x4000000) & 0x3ffffff,\n        1\n      ];\n      this.length = 3;\n    }\n\n    this.negative = neg;\n\n    if (endian === 'le')\n      this.reverse();\n\n    return this;\n  }\n\n  fromDouble(num, endian) {\n    if (endian == null)\n      endian = 'be';\n\n    enforce(typeof num === 'number', 'num', 'double');\n    enforce(endian === 'be' || endian === 'le', 'endian', 'endianness');\n\n    if (!isFinite(num))\n      num = 0;\n\n    const neg = (num <= -1) | 0;\n\n    if (num < 0)\n      num = -num;\n\n    num = Math.floor(num);\n\n    this.words = [];\n\n    while (num > 0) {\n      const lo = num % 0x4000000;\n      const hi = (num - lo) / 0x4000000;\n\n      this.words.push(lo);\n\n      num = hi;\n    }\n\n    if (this.words.length === 0)\n      this.words.push(0);\n\n    this.length = this.words.length;\n    this.negative = neg;\n\n    if (endian === 'le')\n      this.reverse();\n\n    return this;\n  }\n\n  fromBigInt(num, endian) {\n    if (endian == null)\n      endian = 'be';\n\n    enforce(typeof num === 'bigint', 'num', 'bigint');\n    enforce(endian === 'be' || endian === 'le', 'endian', 'endianness');\n\n    if (!HAS_BIGINT)\n      throw new Error('BigInt is not supported!');\n\n    // You know the implementation has a\n    // problem when strings are twice\n    // as fast as bigints.\n    const start = (num < BigInt(0)) | 0;\n\n    this._fromHex(num.toString(16), start);\n    this.negative = start;\n\n    if (endian === 'le')\n      this.reverse();\n\n    return this;\n  }\n\n  fromBool(value) {\n    enforce(typeof value === 'boolean', 'value', 'boolean');\n\n    this.words[0] = value | 0;\n    this.length = 1;\n    this.negative = 0;\n\n    return this;\n  }\n\n  fromString(str, base, endian) {\n    if (base === 'le' || base === 'be')\n      [base, endian] = [endian, base];\n\n    base = getBase(base);\n\n    if (endian == null)\n      endian = 'be';\n\n    enforce(typeof str === 'string', 'string', 'string');\n    enforce((base >>> 0) === base, 'base', 'uint32');\n    enforce(endian === 'be' || endian === 'le', 'endian', 'endianness');\n\n    if (base < 2 || base > 36)\n      throw new Error('Base ranges between 2 and 36.');\n\n    str = str.replace(/\\s+/g, '');\n\n    let start = 0;\n\n    if (str.length > 0 && str.charCodeAt(0) === 0x2d)\n      start = 1;\n\n    if (base === 16)\n      this._fromHex(str, start);\n    else\n      this._fromBase(str, base, start);\n\n    this.negative = start;\n\n    this._normalize();\n\n    if (endian === 'le')\n      this.reverse();\n\n    return this;\n  }\n\n  _fromHex(str, start) {\n    this.length = Math.max(2, Math.ceil((str.length - start) / 6));\n    this.words = new Array(this.length);\n\n    for (let i = 0; i < this.length; i++)\n      this.words[i] = 0;\n\n    // Scan 24-bit chunks and add them to the number.\n    let off = 0;\n    let i = str.length - 6;\n    let j = 0;\n\n    for (; i >= start; i -= 6) {\n      const w = parseHex(str, i, i + 6);\n\n      this.words[j] |= (w << off) & 0x3ffffff;\n\n      // `0x3fffff` is intentional here, 26bits max shift + 24bit hex limb.\n      this.words[j + 1] |= (w >>> (26 - off)) & 0x3fffff;\n\n      off += 24;\n\n      if (off >= 26) {\n        off -= 26;\n        j += 1;\n      }\n    }\n\n    if (i + 6 !== start) {\n      const w = parseHex(str, start, i + 6);\n\n      this.words[j] |= (w << off) & 0x3ffffff;\n      this.words[j + 1] |= (w >>> (26 - off)) & 0x3fffff;\n    }\n\n    return this._strip();\n  }\n\n  _fromBase(str, base, start) {\n    // Initialize as zero.\n    this.words[0] = 0;\n    this.length = 1;\n    this.negative = 0;\n\n    // Find length of limb in base.\n    let limbLen = 0;\n    let limbPow = 1;\n\n    for (; limbPow <= 0x3ffffff; limbPow *= base)\n      limbLen += 1;\n\n    limbLen -= 1;\n    limbPow = (limbPow / base) | 0;\n\n    const total = str.length - start;\n    const mod = total % limbLen;\n    const end = Math.min(total, total - mod) + start;\n\n    let i = start;\n\n    for (; i < end; i += limbLen) {\n      const word = parseBase(str, i, i + limbLen, base);\n\n      this.imuln(limbPow);\n      this._iaddn(word);\n    }\n\n    if (mod !== 0) {\n      const pow = Math.pow(base, mod);\n      const word = parseBase(str, i, str.length, base);\n\n      this.imuln(pow);\n      this._iaddn(word);\n    }\n\n    return this;\n  }\n\n  fromJSON(json) {\n    if (BN.isBN(json)) {\n      if (json.red)\n        return json.fromRed();\n\n      return json.clone();\n    }\n\n    if (Array.isArray(json)) {\n      for (const chunk of json)\n        enforce(typeof chunk === 'string', 'chunk', 'string');\n\n      json = json.join('');\n    }\n\n    return this.fromString(json, 16);\n  }\n\n  fromBN(num) {\n    return this.inject(num);\n  }\n\n  fromArray(data, endian) {\n    enforce(Array.isArray(data), 'data', 'array');\n    return this.fromArrayLike(data, endian);\n  }\n\n  fromBuffer(data, endian) {\n    enforce(Buffer.isBuffer(data), 'data', 'buffer');\n    return this.fromArrayLike(data, endian);\n  }\n\n  fromArrayLike(data, endian) {\n    if (endian == null)\n      endian = 'be';\n\n    enforce(data && (data.length >>> 0) === data.length, 'data', 'array-like');\n    enforce(endian === 'be' || endian === 'le', 'endian', 'endianness');\n\n    if (data.length === 0) {\n      this.words[0] = 0;\n      this.length = 1;\n      this.negative = 0;\n      return this;\n    }\n\n    this.length = Math.max(2, Math.ceil(data.length / 3));\n    this.words = new Array(this.length);\n    this.negative = 0;\n\n    for (let i = 0; i < this.length; i++)\n      this.words[i] = 0;\n\n    const left = data.length % 3;\n\n    let off = 0;\n    let j = 0;\n    let w = 0;\n\n    if (endian === 'be') {\n      for (let i = data.length - 1; i >= 2; i -= 3) {\n        const w = data[i] | (data[i - 1] << 8) | (data[i - 2] << 16);\n\n        this.words[j] |= (w << off) & 0x3ffffff;\n        this.words[j + 1] = (w >>> (26 - off)) & 0x3ffffff;\n\n        off += 24;\n\n        if (off >= 26) {\n          off -= 26;\n          j += 1;\n        }\n      }\n\n      switch (left) {\n        case 2:\n          w = data[1] | (data[0] << 8);\n          break;\n        case 1:\n          w = data[0];\n          break;\n      }\n    } else {\n      const len = data.length - left;\n\n      for (let i = 0; i < len; i += 3) {\n        const w = data[i] | (data[i + 1] << 8) | (data[i + 2] << 16);\n\n        this.words[j] |= (w << off) & 0x3ffffff;\n        this.words[j + 1] = (w >>> (26 - off)) & 0x3ffffff;\n\n        off += 24;\n\n        if (off >= 26) {\n          off -= 26;\n          j += 1;\n        }\n      }\n\n      switch (left) {\n        case 2:\n          w = data[len] | (data[len + 1] << 8);\n          break;\n        case 1:\n          w = data[len];\n          break;\n      }\n    }\n\n    if (left > 0) {\n      this.words[j] |= (w << off) & 0x3ffffff;\n      this.words[j + 1] = (w >>> (26 - off)) & 0x3ffffff;\n    }\n\n    return this._strip();\n  }\n\n  decode(data, endian) {\n    return this.fromBuffer(data, endian);\n  }\n\n  from(num, base, endian) {\n    if (num == null)\n      return this;\n\n    if (base === 'le' || base === 'be')\n      [base, endian] = [endian, base];\n\n    if (typeof num === 'number')\n      return this.fromNumber(num, endian);\n\n    if (typeof num === 'bigint')\n      return this.fromBigInt(num, endian);\n\n    if (typeof num === 'string')\n      return this.fromString(num, base, endian);\n\n    if (typeof num === 'object') {\n      if (BN.isBN(num))\n        return this.fromBN(num, endian);\n\n      if ((num.length >>> 0) === num.length)\n        return this.fromArrayLike(num, endian);\n    }\n\n    if (typeof num === 'boolean')\n      return this.fromBool(num);\n\n    throw new TypeError('Non-numeric object passed to BN.');\n  }\n\n  /*\n   * Static Methods\n   */\n\n  static min(...args) {\n    let min = null;\n\n    for (const num of args) {\n      enforce(BN.isBN(num), 'num', 'bignum');\n\n      if (!min || num.cmp(min) < 0)\n        min = num;\n    }\n\n    return min || new BN(0);\n  }\n\n  static max(...args) {\n    let max = null;\n\n    for (const num of args) {\n      enforce(BN.isBN(num), 'num', 'bignum');\n\n      if (!max || num.cmp(max) > 0)\n        max = num;\n    }\n\n    return max || new BN(0);\n  }\n\n  static cmp(a, b) {\n    enforce(BN.isBN(a), 'a', 'bignum');\n    return a.cmp(b);\n  }\n\n  static ucmp(a, b) {\n    enforce(BN.isBN(a), 'a', 'bignum');\n    return a.ucmp(b);\n  }\n\n  static red(num) {\n    return new Red(num);\n  }\n\n  static barrett(num) {\n    return new Barrett(num);\n  }\n\n  static mont(num) {\n    return new Mont(num);\n  }\n\n  static _prime(name) {\n    if (primes[name])\n      return primes[name];\n\n    let prime;\n\n    if (name === 'p192')\n      prime = new P192();\n    else if (name === 'p224')\n      prime = new P224();\n    else if (name === 'p521')\n      prime = new P521();\n    else if (name === 'k256')\n      prime = new K256();\n    else if (name === 'p25519')\n      prime = new P25519();\n    else if (name === 'p448')\n      prime = new P448();\n    else\n      throw new Error(`Unknown prime: \"${name}\".`);\n\n    primes[name] = prime;\n\n    return prime;\n  }\n\n  static prime(name) {\n    return BN._prime(name).p.clone();\n  }\n\n  static pow(num, exp) {\n    if (num === 2)\n      return BN.shift(1, exp);\n\n    return new BN().fromNumber(num).pown(exp);\n  }\n\n  static shift(num, bits) {\n    if (num === 1)\n      return new BN(0).usetn(bits, 1);\n\n    return new BN().fromNumber(num).ishln(bits);\n  }\n\n  static mask(bits) {\n    return BN.shift(1, bits).isubn(1);\n  }\n\n  static randomBits(rng, bits) {\n    enforce(rng != null, 'rng', 'rng');\n    enforce((bits >>> 0) === bits, 'bits', 'uint32');\n\n    if (typeof rng === 'object') {\n      enforce(typeof rng.randomBytes === 'function', 'rng', 'rng');\n\n      const size = (bits + 7) >>> 3;\n      const total = size * 8;\n      const bytes = rng.randomBytes(size);\n\n      enforce(Buffer.isBuffer(bytes), 'bytes', 'buffer');\n\n      if (bytes.length !== size)\n        throw new RangeError('Invalid number of bytes returned from RNG.');\n\n      const num = BN.fromBuffer(bytes);\n\n      if (total > bits)\n        num.iushrn(total - bits);\n\n      return num;\n    }\n\n    enforce(typeof rng === 'function', 'rng', 'rng');\n\n    const num = rng(bits);\n\n    enforce(BN.isBN(num), 'num', 'bignum');\n    range(num.negative === 0, 'RNG');\n    nonred(!num.red, 'RNG');\n\n    if (num.bitLength() > bits)\n      throw new RangeError('Invalid number of bits returned from RNG.');\n\n    return num;\n  }\n\n  static random(rng, min, max) {\n    min = BN.cast(min, 16);\n    max = BN.cast(max, 16);\n\n    if (min.cmp(max) > 0)\n      throw new RangeError('Minimum cannot be greater than maximum.');\n\n    const space = max.sub(min).iabs();\n    const bits = space.bitLength();\n\n    if (bits === 0)\n      return min.clone();\n\n    for (;;) {\n      const num = BN.randomBits(rng, bits);\n\n      // Maximum is _exclusive_!\n      if (num.cmp(space) >= 0)\n        continue;\n\n      // Minimum is _inclusive_!\n      num.iadd(min);\n\n      return num;\n    }\n  }\n\n  static of(num, endian) {\n    return new BN().of(num, endian);\n  }\n\n  static fromNumber(num, endian) {\n    return new BN().fromNumber(num, endian);\n  }\n\n  static fromDouble(num, endian) {\n    return new BN().fromDouble(num, endian);\n  }\n\n  static fromBigInt(num, endian) {\n    return new BN().fromBigInt(num, endian);\n  }\n\n  static fromBool(value) {\n    return new BN().fromBool(value);\n  }\n\n  static fromString(str, base, endian) {\n    return new BN().fromString(str, base, endian);\n  }\n\n  static fromJSON(json) {\n    return new BN().fromJSON(json);\n  }\n\n  static fromBN(num) {\n    return new BN().fromBN(num);\n  }\n\n  static fromArray(data, endian) {\n    return new BN().fromArray(data, endian);\n  }\n\n  static fromBuffer(data, endian) {\n    return new BN().fromBuffer(data, endian);\n  }\n\n  static fromArrayLike(data, endian) {\n    return new BN().fromArrayLike(data, endian);\n  }\n\n  static decode(data, endian) {\n    return new BN().decode(data, endian);\n  }\n\n  static from(num, base, endian) {\n    return new BN().from(num, base, endian);\n  }\n\n  static cast(num, base, endian) {\n    if (BN.isBN(num))\n      return num;\n\n    return new BN(num, base, endian);\n  }\n\n  static isBN(obj) {\n    return obj instanceof BN;\n  }\n}\n\n/*\n * Static\n */\n\nBN.BN = BN;\nBN.wordSize = 26;\nBN.native = 0;\n\n/**\n * Prime\n */\n\nclass Prime {\n  constructor(name, p) {\n    // P = 2^N - K\n    this.name = name;\n    this.p = new BN(p, 16);\n    this.n = this.p.bitLength();\n    this.k = BN.shift(1, this.n).isub(this.p);\n    this.lo = this.p.clone();\n    this.one = this.p.clone();\n  }\n\n  ireduce(num) {\n    // Assumes that `num` is less than `P^2`:\n    // num = HI * (2^N - K) + HI * K + LO = HI * K + LO (mod P)\n    const neg = num.negative !== 0;\n\n    // Track bits.\n    let bits = num.bitLength();\n\n    // Must be less than P^2.\n    assert(bits <= this.n * 2);\n\n    // Ensure positive.\n    num.negative = 0;\n\n    // Reduce.\n    while (bits > this.n) {\n      // lo = num & ((1 << n) - 1)\n      // num = num >> n\n      this.split(num, this.lo);\n\n      // num = num * K\n      this.imulK(num);\n\n      // num = num + lo\n      num._iadd(num, this.lo);\n\n      // bits = bitlen(num)\n      bits = num.bitLength();\n    }\n\n    // Final reduction.\n    const cmp = bits < this.n ? -1 : num.ucmp(this.p);\n\n    if (cmp === 0) {\n      num.words[0] = 0;\n      num.length = 1;\n    } else if (cmp > 0) {\n      num._isub(num, this.p);\n    } else {\n      // Note: we shouldn't need to strip here.\n    }\n\n    // Adjust sign.\n    if (neg && !num.isZero())\n      num._isub(this.p, num);\n\n    return num;\n  }\n\n  split(input, out) {\n    input._split(this.n, out);\n  }\n\n  imulK(num) {\n    return num.imul(this.k);\n  }\n}\n\n/**\n * P192\n */\n\nclass P192 extends Prime {\n  constructor() {\n    // 2^192 - 2^64 - 1 (= 3 mod 4)\n    super('p192', 'ffffffff ffffffff ffffffff fffffffe'\n                + 'ffffffff ffffffff');\n  }\n\n  imulK(num) {\n    // K = 0x10000000000000001\n    // K = 2^64 + 1\n    const one = this.one.inject(num);\n    return num.iushln(64)._iadd(num, one);\n  }\n}\n\n/**\n * P224\n */\n\nclass P224 extends Prime {\n  constructor() {\n    // 2^224 - 2^96 + 1 (no congruence)\n    super('p224', 'ffffffff ffffffff ffffffff ffffffff'\n                + '00000000 00000000 00000001');\n  }\n\n  imulK(num) {\n    // K = 0xffffffffffffffffffffffff\n    // K = 2^96 - 1\n    const one = this.one.inject(num);\n    return num.iushln(96)._isub(num, one);\n  }\n}\n\n/**\n * P521\n */\n\nclass P521 extends Prime {\n  constructor() {\n    // 2^521 - 1 (= 3 mod 4)\n    super('p521', '000001ff ffffffff ffffffff ffffffff'\n                + 'ffffffff ffffffff ffffffff ffffffff'\n                + 'ffffffff ffffffff ffffffff ffffffff'\n                + 'ffffffff ffffffff ffffffff ffffffff'\n                + 'ffffffff');\n  }\n\n  imulK(num) {\n    // K = 0x01\n    return num;\n  }\n}\n\n/**\n * K256\n */\n\nclass K256 extends Prime {\n  constructor() {\n    // 2^256 - 2^32 - 977 (= 3 mod 4)\n    super('k256', 'ffffffff ffffffff ffffffff ffffffff'\n                + 'ffffffff ffffffff fffffffe fffffc2f');\n  }\n\n  split(input, output) {\n    // 256 = 9 * 26 + 22\n    const mask = 0x3fffff;\n    const len = Math.min(input.length, 9);\n\n    output._alloc(len + 1);\n\n    for (let i = 0; i < len; i++)\n      output.words[i] = input.words[i];\n\n    output.length = len;\n\n    if (input.length <= 9) {\n      output._strip();\n      input.words[0] = 0;\n      input.length = 1;\n      return;\n    }\n\n    // Shift by 9 limbs.\n    let prev = input.words[9];\n    let i = 10;\n\n    output.words[output.length++] = prev & mask;\n    output._strip();\n\n    for (; i < input.length; i++) {\n      const next = input.words[i] | 0;\n\n      input.words[i - 10] = ((next & mask) << 4) | (prev >>> 22);\n\n      prev = next;\n    }\n\n    prev >>>= 22;\n\n    input.words[i - 10] = prev;\n\n    if (prev === 0 && input.length > 10)\n      input.length -= 10;\n    else\n      input.length -= 9;\n\n    input._strip(); // Unsure if we need this.\n  }\n\n  imulK(num) {\n    // K = 0x1000003d1 = [0x40, 0x3d1]\n    // K = 2^32 + 977\n    num._expand(num.length + 2);\n\n    // Bounded at: 0x40 * 0x3ffffff + 0x3d0 = 0x100000390\n    let lo = 0;\n\n    for (let i = 0; i < num.length; i++) {\n      const w = num.words[i];\n\n      lo += w * 0x3d1;\n\n      num.words[i] = lo & 0x3ffffff;\n\n      lo = w * 0x40 + Math.floor(lo / 0x4000000);\n    }\n\n    // Fast length reduction.\n    if (num.words[num.length - 1] === 0) {\n      num.length -= 1;\n      if (num.words[num.length - 1] === 0)\n        num.length -= 1;\n    }\n\n    // Note: we shouldn't need to strip here.\n    return num;\n  }\n}\n\n/**\n * P25519\n */\n\nclass P25519 extends Prime {\n  constructor() {\n    // 2^255 - 19 (= 5 mod 8)\n    super('p25519', '7fffffff ffffffff ffffffff ffffffff'\n                  + 'ffffffff ffffffff ffffffff ffffffed');\n  }\n\n  imulK(num) {\n    // K = 0x13\n    let carry = 0;\n\n    for (let i = 0; i < num.length; i++) {\n      const w = num.words[i] * 0x13 + carry;\n\n      carry = w >>> 26;\n\n      num.words[i] = w & 0x3ffffff;\n    }\n\n    if (carry !== 0) {\n      num._alloc(num.length + 1);\n      num.words[num.length++] = carry;\n    }\n\n    // Note: we shouldn't need to strip here.\n    return num;\n  }\n}\n\n/**\n * P448\n */\n\nclass P448 extends Prime {\n  constructor() {\n    // 2^448 - 2^224 - 1 (= 3 mod 4)\n    super('p448', 'ffffffff ffffffff ffffffff ffffffff'\n                + 'ffffffff ffffffff fffffffe ffffffff'\n                + 'ffffffff ffffffff ffffffff ffffffff'\n                + 'ffffffff ffffffff');\n  }\n\n  imulK(num) {\n    // K = 0x100000000000000000000000000000000000000000000000000000001\n    // K = 2^224 + 1\n    const one = this.one.inject(num);\n    return num.iushln(224)._iadd(num, one);\n  }\n}\n\n/**\n * Reduction Engine\n */\n\nclass Red {\n  constructor(m) {\n    let prime = null;\n\n    if (typeof m === 'string') {\n      prime = BN._prime(m);\n      m = prime.p;\n    }\n\n    enforce(BN.isBN(m), 'm', 'bignum');\n    nonred(!m.red, 'reduction');\n    range(m.sign() > 0, 'reduction');\n\n    this.m = m;\n    this.prime = prime;\n    this.mb = null;\n    this.sm1 = null;\n  }\n\n  _verify1(a) {\n    range(a.negative === 0, 'red');\n    red(a.red != null, 'red');\n  }\n\n  _verify2(a, b) {\n    range((a.negative | b.negative) === 0, 'red');\n    red(a.red != null && a.red === b.red, 'red');\n  }\n\n  get mont() {\n    return false;\n  }\n\n  get coprime() {\n    return false;\n  }\n\n  precompute() {\n    // Precompute `sqrt(-1)` for primes congruent to 5 mod 8.\n    if (this.sm1 === null && this.m.andln(7) === 5) {\n      const x = new BN(2).toRed(this);\n      const e = this.m.subn(1).iushrn(2);\n\n      // sqrt(-1) = 2^((p - 1) / 4) mod p\n      this.sm1 = this.pow(x, e);\n    }\n\n    return this;\n  }\n\n  convertTo(num) {\n    const res = num.mod(this.m);\n    res.red = this;\n    return res;\n  }\n\n  convertFrom(num) {\n    const res = num.clone();\n    res.red = null;\n    return res;\n  }\n\n  intTo(a) {\n    return a;\n  }\n\n  intFrom(a) {\n    return a;\n  }\n\n  imod(a) {\n    if (this.prime)\n      return this.prime.ireduce(a)._forceRed(this);\n\n    return a.imod(this.m)._forceRed(this);\n  }\n\n  iadd(a, b) {\n    this._verify2(a, b);\n\n    a._iadd(a, b);\n\n    if (a.ucmp(this.m) >= 0)\n      a._isub(a, this.m);\n\n    return a;\n  }\n\n  add(a, b) {\n    if (a.length < b.length)\n      return this.iadd(b.clone(), a);\n\n    return this.iadd(a.clone(), b);\n  }\n\n  iaddn(a, num) {\n    this._verify1(a);\n\n    if (num < 0)\n      return this.isubn(a, -num);\n\n    if (this.m.length === 1)\n      num %= this.m.words[0];\n\n    a._iaddn(num);\n\n    if (a.ucmp(this.m) >= 0)\n      a._isub(a, this.m);\n\n    return a;\n  }\n\n  addn(a, num) {\n    return this.iaddn(a.clone(), num);\n  }\n\n  isub(a, b) {\n    this._verify2(a, b);\n\n    //  0: a - a mod m == 0\n    // -1: a - b mod m == m - (b - a)\n    // +1: a - b mod m == a - b\n    const cmp = a.ucmp(b);\n\n    if (cmp === 0) {\n      a.words[0] = 0;\n      a.length = 1;\n      return a;\n    }\n\n    if (cmp < 0) {\n      a._isub(b, a);\n      a._isub(this.m, a);\n    } else {\n      a._isub(a, b);\n    }\n\n    return a;\n  }\n\n  sub(a, b) {\n    return this.isub(a.clone(), b);\n  }\n\n  isubn(a, num) {\n    this._verify1(a);\n\n    if (num < 0)\n      return this.iaddn(a, -num);\n\n    if (this.m.length === 1)\n      num %= this.m.words[0];\n\n    //  <: a - b mod m == m - (b - a)\n    // >=: a - b mod m == a - b\n    if (a.length === 1 && a.words[0] < num) {\n      a.words[0] = num - a.words[0];\n      a._isub(this.m, a);\n    } else {\n      a._isubn(num);\n    }\n\n    return a;\n  }\n\n  subn(a, num) {\n    return this.isubn(a.clone(), num);\n  }\n\n  imul(a, b) {\n    this._verify2(a, b);\n    return this.imod(a.imul(b));\n  }\n\n  mul(a, b) {\n    this._verify2(a, b);\n    return this.imod(a.mul(b));\n  }\n\n  imuln(a, num) {\n    this._verify1(a);\n\n    if (a.isZero())\n      return a;\n\n    if (num === 0) {\n      a.words[0] = 0;\n      a.length = 1;\n      return a;\n    }\n\n    const neg = num < 0;\n\n    if (neg)\n      num = -num;\n\n    if (this.m.length === 1)\n      num %= this.m.words[0];\n\n    a.imuln(num);\n\n    if (num <= 16) {\n      // Quick reduction.\n      while (a.ucmp(this.m) >= 0)\n        a._isub(a, this.m);\n    } else {\n      this.imod(a);\n    }\n\n    if (neg)\n      this.ineg(a);\n\n    return a;\n  }\n\n  muln(a, num) {\n    return this.imuln(a.clone(), num);\n  }\n\n  idiv(a, b) {\n    return this.div(a, b)._move(a);\n  }\n\n  div(a, b) {\n    return this.mul(a, this.invert(b));\n  }\n\n  idivn(a, num) {\n    return this.divn(a, num)._move(a);\n  }\n\n  divn(a, num) {\n    return this.div(a, this.convertTo(new BN(num)));\n  }\n\n  ipow(a, num) {\n    return this.pow(a, num)._move(a);\n  }\n\n  pow(a, num) {\n    this._verify1(a);\n\n    if (num.isNeg())\n      a = this.invert(a);\n\n    // Small exponent.\n    if (num.length === 1)\n      return this.pown(a, num.words[0]);\n\n    // Call out to BigInt.\n    if (HAS_BIGINT && !this.prime)\n      return this.powInt(a, num);\n\n    // Otherwise, a BN implementation.\n    return this.powNum(a, num);\n  }\n\n  powNum(a, num) {\n    // Sliding window.\n    const wnd = new Array(WND_SIZE);\n\n    wnd[0] = this.sqrn(a, WND_WIDTH - 1);\n    wnd[1] = this.mul(wnd[0], a);\n\n    for (let i = 2; i < WND_SIZE; i++)\n      wnd[i] = this.mul(wnd[i - 1], a);\n\n    let i = num.bitLength();\n    let r = new BN(1).toRed(this);\n\n    while (i >= WND_WIDTH) {\n      const pos = i - WND_WIDTH;\n      const bits = num.bits(pos, WND_WIDTH);\n\n      if (bits < WND_SIZE) {\n        r = this.sqr(r);\n        i -= 1;\n        continue;\n      }\n\n      r = this.sqrn(r, WND_WIDTH);\n      r = this.mul(r, wnd[bits & ~WND_SIZE]);\n      i = pos;\n    }\n\n    if (i > 0) {\n      const bits = num.bits(0, i);\n\n      while (i--) {\n        r = this.sqr(r);\n\n        if ((bits >> i) & 1)\n          r = this.mul(r, a);\n      }\n    }\n\n    return r;\n  }\n\n  powInt(a, num) {\n    if (this.mb === null)\n      this.mb = this.m.toBigInt();\n\n    const x = this.intFrom(a.toBigInt());\n    const y = powInt(x, num, this.mb);\n    const z = this.intTo(y);\n\n    return BN.fromBigInt(z)._forceRed(this);\n  }\n\n  sqrn(a, n) {\n    for (let i = 0; i < n; i++)\n      a = this.sqr(a);\n    return a;\n  }\n\n  ipown(a, num) {\n    return this.pown(a, num)._move(a);\n  }\n\n  pown(a, num) {\n    this._verify1(a);\n\n    if (num < 0) {\n      a = this.invert(a);\n      num = -num;\n    }\n\n    if (num === 0)\n      return new BN(1).toRed(this);\n\n    if (num === 1)\n      return a.clone();\n\n    const bits = countBits(num);\n\n    let r = a;\n\n    for (let i = bits - 2; i >= 0; i--) {\n      r = this.sqr(r);\n\n      if ((num >> i) & 1)\n        r = this.mul(r, a);\n    }\n\n    return r;\n  }\n\n  isqr(a) {\n    return this.imul(a, a);\n  }\n\n  sqr(a) {\n    return this.mul(a, a);\n  }\n\n  isqrt(x) {\n    return this.sqrt(x)._move(x);\n  }\n\n  sqrt(x) {\n    this._verify1(x);\n\n    // Fast case (p = 3 mod 4).\n    if (this.m.andln(3) === 3)\n      return this.sqrt3mod4(x);\n\n    // Fast case (p = 5 mod 8).\n    if (this.m.andln(7) === 5) {\n      if (this.sm1 != null)\n        return this.sqrt5mod8sm1(x);\n      return this.sqrt5mod8(x);\n    }\n\n    // Slow case (Tonelli-Shanks).\n    return this.sqrt0(x);\n  }\n\n  sqrt3mod4(x) {\n    const e = this.m.addn(1).iushrn(2); // (p + 1) / 4\n    const b = this.pow(x, e);\n\n    if (!this.sqr(b).eq(x))\n      throw new Error('X is not a square mod P.');\n\n    return b;\n  }\n\n  sqrt5mod8(x) {\n    // Atkin's Algorithm.\n    const one = new BN(1).toRed(this);\n    const e = this.m.ushrn(3); // (p - 5) / 8\n    const x2 = this.add(x, x);\n    const alpha = this.pow(x2, e);\n    const beta = this.mul(x2, this.sqr(alpha));\n    const b = this.mul(this.mul(alpha, x), this.isub(beta, one));\n\n    if (!this.sqr(b).eq(x))\n      throw new Error('X is not a square mod P.');\n\n    return b;\n  }\n\n  sqrt5mod8sm1(x) {\n    const e = this.m.addn(3).iushrn(3); // (p + 3) / 8\n    const b = this.pow(x, e);\n\n    if (this.sqr(b).eq(x))\n      return b;\n\n    const c = this.mul(b, this.sm1);\n\n    if (this.sqr(c).eq(x))\n      return c;\n\n    throw new Error('X is not a square mod P.');\n  }\n\n  sqrt0(x) {\n    if (this.m.cmpn(1) === 0 || !this.m.isOdd())\n      throw new Error('Invalid prime.');\n\n    switch (this.jacobi(x)) {\n      case -1:\n        throw new Error('X is not a square mod P.');\n      case 0:\n        return new BN(0)._forceRed(this);\n      case 1:\n        break;\n    }\n\n    const one = new BN(1).toRed(this);\n    const s = this.m.subn(1);\n    const e = s.zeroBits();\n\n    s.iushrn(e);\n\n    const n = new BN(2).toRed(this);\n\n    while (this.jacobi(n) !== -1)\n      this.iadd(n, one);\n\n    let b = this.pow(x, s);\n    let g = this.pow(n, s);\n    let y = this.pow(x, s.iaddn(1).iushrn(1));\n    let k = e;\n\n    for (;;) {\n      let t = b;\n      let m = 0;\n\n      while (t.cmp(one) !== 0 && m < k) {\n        t = this.sqr(t);\n        m += 1;\n      }\n\n      if (m === 0)\n        break;\n\n      assert(m < k);\n\n      t = this.sqrn(g, k - m - 1);\n      g = this.sqr(t);\n      y = this.mul(y, t);\n      b = this.mul(b, g);\n      k = m;\n    }\n\n    return y;\n  }\n\n  idivsqrt(u, v) {\n    return this.divsqrt(u, v)._move(u);\n  }\n\n  divsqrt(u, v) {\n    this._verify2(u, v);\n\n    // v = 0\n    if (v.isZero())\n      throw new RangeError('Not invertible.');\n\n    // p = 3 mod 4\n    if (this.m.andln(3) === 3)\n      return this.divsqrt3mod4(u, v);\n\n    // p = 5 mod 8\n    if (this.sm1 != null && this.m.andln(7) === 5)\n      return this.divsqrt5mod8(u, v);\n\n    return this.sqrt(this.div(u, v));\n  }\n\n  divsqrt3mod4(u, v) {\n    // x = u^3 * v * (u^5 * v^3)^((p - 3) / 4) mod p\n    const e = this.m.subn(3).iushrn(2);\n    const u2 = this.sqr(u);\n    const u3 = this.mul(u2, u);\n    const u5 = this.mul(u3, u2);\n    const v3 = this.mul(this.sqr(v), v);\n    const p = this.pow(this.mul(u5, v3), e);\n    const x = this.mul(this.mul(u3, v), p);\n    const c = this.mul(v, this.sqr(x));\n\n    if (c.cmp(u) === 0)\n      return x;\n\n    throw new Error('X is not a square mod P.');\n  }\n\n  divsqrt5mod8(u, v) {\n    // x = u * v^3 * (u * v^7)^((p - 5) / 8) mod p\n    const e = this.m.subn(5).iushrn(3);\n    const v3 = this.mul(this.sqr(v), v);\n    const v7 = this.mul(this.sqr(v3), v);\n    const p = this.pow(this.mul(u, v7), e);\n    const x = this.mul(this.mul(u, v3), p);\n    const c = this.mul(v, this.sqr(x));\n\n    if (c.cmp(u) === 0)\n      return x;\n\n    if (this.ineg(c).cmp(u) === 0)\n      return this.mul(x, this.sm1);\n\n    throw new Error('X is not a square mod P.');\n  }\n\n  isSquare(a) {\n    let symbol;\n\n    if (this.prime || this.coprime)\n      symbol = this.legendre(a);\n    else if (this.m.isOdd())\n      symbol = this.jacobi(a);\n    else\n      symbol = this.kronecker(a);\n\n    return Boolean(~symbol >>> 31);\n  }\n\n  ishl(a, num) {\n    this._verify1(a);\n    return this.imod(a.iushl(num));\n  }\n\n  shl(a, num) {\n    return this.ishl(a.clone(), num);\n  }\n\n  ishln(a, num) {\n    this._verify1(a);\n\n    a.iushln(num);\n\n    if (num <= 4) {\n      // Quick reduction.\n      while (a.ucmp(this.m) >= 0)\n        a._isub(a, this.m);\n    } else {\n      this.imod(a);\n    }\n\n    return a;\n  }\n\n  shln(a, num) {\n    return this.ishln(a.clone(), num);\n  }\n\n  ineg(a) {\n    this._verify1(a);\n\n    if (!a.isZero())\n      a._isub(this.m, a);\n\n    return a;\n  }\n\n  neg(a) {\n    return this.ineg(a.clone());\n  }\n\n  eq(a, b) {\n    this._verify2(a, b);\n    return a.ucmp(b) === 0;\n  }\n\n  eqn(a, num) {\n    this._verify1(a);\n\n    if (this.m.length === 1) {\n      num %= this.m.words[0];\n\n      if (num < 0)\n        num += this.m.words[0];\n\n      return a.ucmpn(num) === 0;\n    }\n\n    if (num < 0) {\n      this.m._isubn(-num);\n\n      const cmp = a.ucmp(this.m);\n\n      this.m._iaddn(-num);\n\n      return cmp === 0;\n    }\n\n    return a.ucmpn(num) === 0;\n  }\n\n  isHigh(a) {\n    return !this.isLow(a);\n  }\n\n  isLow(a) {\n    this._verify1(a);\n    return a.ucmp(this.m.ushrn(1)) <= 0;\n  }\n\n  isOdd(a) {\n    this._verify1(a);\n    return a.isOdd();\n  }\n\n  isEven(a) {\n    this._verify1(a);\n    return a.isEven();\n  }\n\n  legendre(num) {\n    this._verify1(num);\n\n    if (this.m.isEven())\n      throw new Error('legendre: `num` must be odd.');\n\n    // Euler's criterion.\n    const e = this.m.subn(1).iushrn(1); // (p - 1) / 2\n    const symbol = this.pow(num, e);\n    const one = new BN(1).toRed(this);\n    const a = symbol.czero();\n    const b = symbol.ceq(one);\n    const c = symbol.ceq(this.ineg(one));\n\n    // Must be one of these.\n    if ((a | b | c) === 0)\n      throw new Error('Invalid prime.');\n\n    // Cannot be multiple.\n    assert(a + b + c === 1);\n\n    // 0, 1, or -1.\n    return b - c;\n  }\n\n  jacobi(a) {\n    this._verify1(a);\n    return a.jacobi(this.m);\n  }\n\n  kronecker(a) {\n    this._verify1(a);\n    return a.kronecker(this.m);\n  }\n\n  iinvert(a) {\n    return this.invert(a)._move(a);\n  }\n\n  invert(a) {\n    this._verify1(a);\n\n    if (this.prime)\n      return this.imod(a._invertp(this.m));\n\n    return a.invert(this.m)._forceRed(this);\n  }\n\n  ifermat(a) {\n    return this.fermat(a)._move(a);\n  }\n\n  fermat(a) {\n    this._verify1(a);\n\n    if (a.isZero() || this.m.cmpn(1) === 0)\n      throw new RangeError('Not invertible.');\n\n    // Invert using fermat's little theorem.\n    return this.pow(a, this.m.subn(2));\n  }\n\n  [custom]() {\n    if (this.prime)\n      return `<Red: ${this.prime.name}>`;\n\n    return `<Red: ${this.m.toString(10)}>`;\n  }\n}\n\n/**\n * Barrett Engine\n */\n\nclass Barrett extends Red {\n  constructor(m) {\n    super(m);\n\n    this.prime = null;\n    this.n = this.m.bitLength();\n\n    if ((this.n % 26) !== 0)\n      this.n += 26 - (this.n % 26);\n\n    this.k = this.n * 2;\n    this.w = this.k / 26;\n    this.b = BN.shift(1, this.k).div(this.m);\n  }\n\n  convertTo(num) {\n    if (num.length > this.w)\n      return super.convertTo(num);\n\n    return this.imod(num.clone());\n  }\n\n  _shift(q) {\n    let i = 0;\n    let j = this.w;\n\n    while (j < q.length)\n      q.words[i++] = q.words[j++];\n\n    if (i === 0)\n      q.words[i++] = 0;\n\n    q.length = i;\n  }\n\n  imod(a) {\n    const neg = a.negative;\n\n    assert(a.length <= this.w);\n\n    a.negative = 0;\n\n    const q = a.mul(this.b);\n\n    // Shift right by `k` bits.\n    this._shift(q);\n\n    a._isub(a, q.mul(this.m));\n\n    if (a.ucmp(this.m) >= 0)\n      a._isub(a, this.m);\n\n    if (neg && !a.isZero())\n      a._isub(this.m, a);\n\n    a.red = this;\n\n    return a;\n  }\n}\n\n/**\n * Montgomery Engine\n */\n\nclass Mont extends Red {\n  constructor(m) {\n    super(m);\n\n    this.prime = null;\n    this.n = this.m.bitLength();\n\n    if ((this.n % 26) !== 0)\n      this.n += 26 - (this.n % 26);\n\n    this.r = BN.shift(1, this.n);\n    this.r2 = BN.shift(1, this.n * 2).imod(this.m);\n    this.ri = this.r._invertp(this.m).imod(this.m);\n    this.mi = this.r.mul(this.ri).isubn(1).div(this.m);\n    this.rib = null;\n  }\n\n  get mont() {\n    return true;\n  }\n\n  get coprime() {\n    return true;\n  }\n\n  convertTo(num) {\n    return this.imod(num.ushln(this.n));\n  }\n\n  convertFrom(num) {\n    const r = this.imod(num.mul(this.ri));\n    r.red = null;\n    return r;\n  }\n\n  intTo(a) {\n    return (a << BigInt(this.n)) % this.mb;\n  }\n\n  intFrom(a) {\n    if (this.rib === null)\n      this.rib = this.ri.toBigInt();\n\n    return (a * this.rib) % this.mb;\n  }\n\n  iaddn(a, num) {\n    return this.iadd(a, this.convertTo(new BN(num)));\n  }\n\n  isubn(a, num) {\n    return this.isub(a, this.convertTo(new BN(num)));\n  }\n\n  imul(a, b) {\n    return this.mul(a, b)._move(a);\n  }\n\n  mul(a, b) {\n    this._verify2(a, b);\n\n    if (a.isZero() || b.isZero())\n      return new BN(0)._forceRed(this);\n\n    const t = a.mul(b);\n    const c = t.umaskn(this.n).mul(this.mi).iumaskn(this.n);\n    const u = t.iadd(c.mul(this.m)).iushrn(this.n);\n\n    if (u.ucmp(this.m) >= 0)\n      u._isub(u, this.m);\n\n    return u._forceRed(this);\n  }\n\n  imuln(a, num) {\n    this._verify1(a);\n\n    if (a.isZero())\n      return a;\n\n    if (num === 0) {\n      a.words[0] = 0;\n      a.length = 1;\n      return a;\n    }\n\n    const neg = num < 0;\n\n    if (neg)\n      num = -num;\n\n    if (this.m.length === 1)\n      num %= this.m.words[0];\n\n    const bits = countBits(num);\n\n    // Potentially compute with additions.\n    // This avoids an expensive division.\n    if (bits > 5) {\n      // Slow case (num > 31).\n      this.imul(a, this.convertTo(new BN(num)));\n    } else if ((num & (num - 1)) === 0) {\n      // Optimize for powers of two.\n      for (let i = 0; i < bits - 1; i++)\n        this.iadd(a, a);\n    } else {\n      // Multiply left to right.\n      const c = a.clone();\n\n      for (let i = bits - 2; i >= 0; i--) {\n        this.iadd(a, a);\n\n        if ((num >> i) & 1)\n          this.iadd(a, c);\n      }\n    }\n\n    if (neg)\n      this.ineg(a);\n\n    return a;\n  }\n\n  eqn(a, num) {\n    this._verify1(a);\n\n    if (num === 0)\n      return a.isZero();\n\n    return a.ucmp(this.convertTo(new BN(num))) === 0;\n  }\n\n  isLow(a) {\n    this._verify1(a);\n    return this.convertFrom(a).ucmp(this.m.ushrn(1)) <= 0;\n  }\n\n  isOdd(a) {\n    this._verify1(a);\n    return this.convertFrom(a).isOdd();\n  }\n\n  isEven(a) {\n    this._verify1(a);\n    return this.convertFrom(a).isEven();\n  }\n\n  invert(a) {\n    this._verify1(a);\n\n    // (AR)^-1 * R^2 = (A^-1 * R^-1) * R^2 = A^-1 * R\n    return this.imod(a._invertp(this.m).mul(this.r2));\n  }\n}\n\n/*\n * Helpers\n */\n\nfunction makeError(Error, msg, start) {\n  const err = new Error(msg);\n\n  if (Error.captureStackTrace)\n    Error.captureStackTrace(err, start);\n\n  return err;\n}\n\nfunction assert(value, message) {\n  if (!value) {\n    const msg = message || 'Assertion failed.';\n    throw makeError(Error, msg, assert);\n  }\n}\n\nfunction enforce(value, name, type) {\n  if (!value) {\n    const msg = `\"${name}\" must be a(n) ${type}.`;\n    throw makeError(TypeError, msg, enforce);\n  }\n}\n\nfunction range(value, name) {\n  if (!value) {\n    const msg = `\"${name}\" only works with positive numbers.`;\n    throw makeError(RangeError, msg, range);\n  }\n}\n\nfunction red(value, name) {\n  if (!value) {\n    const msg = `\"${name}\" only works with red numbers.`;\n    throw makeError(TypeError, msg, red);\n  }\n}\n\nfunction nonred(value, name) {\n  if (!value) {\n    const msg = `\"${name}\" only works with normal numbers.`;\n    throw makeError(TypeError, msg, nonred);\n  }\n}\n\nfunction nonzero(value) {\n  if (!value) {\n    const msg = 'Cannot divide by zero.';\n    throw makeError(RangeError, msg, nonzero);\n  }\n}\n\nfunction isInteger(num) {\n  return Number.isSafeInteger(num);\n}\n\nfunction isSMI(num) {\n  return isInteger(num)\n      && num >= -0x3ffffff\n      && num <= 0x3ffffff;\n}\n\nfunction allocate(ArrayType, size) {\n  if (ArrayType.allocUnsafeSlow)\n    return ArrayType.allocUnsafeSlow(size);\n\n  return new ArrayType(size);\n}\n\nfunction getBase(base) {\n  if (base == null)\n    return 10;\n\n  if (typeof base === 'number')\n    return base;\n\n  switch (base) {\n    case 'bin':\n      return 2;\n    case 'oct':\n      return 8;\n    case 'dec':\n      return 10;\n    case 'hex':\n      return 16;\n  }\n\n  return 0;\n}\n\n/*\n * Internal\n */\n\nfunction countBits(w) {\n  if (Math.clz32)\n    return 32 - Math.clz32(w);\n\n  let t = w;\n  let r = 0;\n\n  if (t >= 0x1000) {\n    r += 13;\n    t >>>= 13;\n  }\n\n  if (t >= 0x40) {\n    r += 7;\n    t >>>= 7;\n  }\n\n  if (t >= 0x8) {\n    r += 4;\n    t >>>= 4;\n  }\n\n  if (t >= 0x02) {\n    r += 2;\n    t >>>= 2;\n  }\n\n  return r + t;\n}\n\nfunction zeroBits(w) {\n  // Shortcut.\n  if (w === 0)\n    return 26;\n\n  let t = w;\n  let r = 0;\n\n  if ((t & 0x1fff) === 0) {\n    r += 13;\n    t >>>= 13;\n  }\n\n  if ((t & 0x7f) === 0) {\n    r += 7;\n    t >>>= 7;\n  }\n\n  if ((t & 0xf) === 0) {\n    r += 4;\n    t >>>= 4;\n  }\n\n  if ((t & 0x3) === 0) {\n    r += 2;\n    t >>>= 2;\n  }\n\n  if ((t & 0x1) === 0)\n    r += 1;\n\n  return r;\n}\n\nfunction parseHex(str, start, end) {\n  const len = Math.min(str.length, end);\n\n  let r = 0;\n  let z = 0;\n\n  for (let i = start; i < len; i++) {\n    const c = str.charCodeAt(i) - 48;\n\n    r <<= 4;\n\n    let b;\n\n    if (c >= 49 && c <= 54) {\n      // 'a' - 'f'\n      b = c - 49 + 0xa;\n    } else if (c >= 17 && c <= 22) {\n      // 'A' - 'F'\n      b = c - 17 + 0xa;\n    } else {\n      // '0' - '9'\n      b = c;\n    }\n\n    r |= b;\n    z |= b;\n  }\n\n  if (z & ~15)\n    throw new Error('Invalid string.');\n\n  return r;\n}\n\nfunction parseBase(str, start, end, mul) {\n  const len = Math.min(str.length, end);\n\n  let r = 0;\n\n  for (let i = start; i < len; i++) {\n    const c = str.charCodeAt(i) - 48;\n\n    r *= mul;\n\n    let b;\n\n    if (c >= 49) {\n      // 'a'\n      b = c - 49 + 0xa;\n    } else if (c >= 17) {\n      // 'A'\n      b = c - 17 + 0xa;\n    } else {\n      // '0' - '9'\n      b = c;\n    }\n\n    if (c < 0 || c > 207 || b >= mul)\n      throw new Error('Invalid string.');\n\n    r += b;\n  }\n\n  return r;\n}\n\n/*\n * Exponentiation (bigint)\n */\n\nfunction powInt(x, e, m) {\n  // Sliding window.\n  const wnd = new Array(WND_SIZE);\n\n  wnd[0] = sqrn(x, WND_WIDTH - 1, m);\n  wnd[1] = wnd[0] * x;\n\n  for (let i = 2; i < WND_SIZE; i++)\n    wnd[i] = (wnd[i - 1] * x) % m;\n\n  let i = e.bitLength();\n  let r = BigInt(1);\n\n  while (i >= WND_WIDTH) {\n    const pos = i - WND_WIDTH;\n    const bits = e.bits(pos, WND_WIDTH);\n\n    if (bits < WND_SIZE) {\n      r = (r * r) % m;\n      i -= 1;\n      continue;\n    }\n\n    r = sqrn(r, WND_WIDTH, m);\n    r = (r * wnd[bits & ~WND_SIZE]) % m;\n    i = pos;\n  }\n\n  if (i > 0) {\n    const bits = e.bits(0, i);\n\n    while (i--) {\n      r = (r * r) % m;\n\n      if ((bits >> i) & 1)\n        r = (r * x) % m;\n    }\n  }\n\n  return r;\n}\n\nfunction sqrn(x, n, m) {\n  for (let i = 0; i < n; i++)\n    x = (x * x) % m;\n  return x;\n}\n\n/*\n * Multiplication\n */\n\nfunction smallMulTo(self, num, out) {\n  const len = self.length + num.length;\n\n  out.negative = self.negative ^ num.negative;\n  out._alloc(len);\n  out.length = len;\n\n  // Peel one iteration (compiler can't\n  // do it, because of code complexity).\n  const a = self.words[0];\n  const b = num.words[0];\n  const r = a * b;\n  const lo = r & 0x3ffffff;\n\n  let carry = (r / 0x4000000) | 0;\n  let k = 1;\n\n  out.words[0] = lo;\n\n  for (; k < out.length - 1; k++) {\n    // Sum all words with the same\n    // `i + j = k` and accumulate\n    // `ncarry`, note that ncarry\n    // could be >= 0x3ffffff.\n    let ncarry = carry >>> 26;\n    let rword = carry & 0x3ffffff;\n\n    const min = Math.max(0, k - self.length + 1);\n    const max = Math.min(k, num.length - 1);\n\n    for (let j = min; j <= max; j++) {\n      const i = k - j;\n      const a = self.words[i];\n      const b = num.words[j];\n      const r = a * b + rword;\n\n      ncarry += (r / 0x4000000) | 0;\n      rword = r & 0x3ffffff;\n    }\n\n    out.words[k] = rword | 0;\n    carry = ncarry | 0;\n  }\n\n  if (carry !== 0)\n    out.words[k] = carry | 0;\n  else\n    out.length -= 1;\n\n  return out._strip();\n}\n\nfunction bigMulTo(self, num, out) {\n  const len = self.length + num.length;\n\n  out.negative = self.negative ^ num.negative;\n  out._alloc(len);\n  out.length = len;\n\n  let carry = 0;\n  let hncarry = 0;\n  let k = 0;\n\n  for (; k < out.length - 1; k++) {\n    // Sum all words with the same\n    // `i + j = k` and accumulate\n    // `ncarry`, note that ncarry\n    // could be >= 0x3ffffff.\n    let ncarry = hncarry;\n\n    hncarry = 0;\n\n    let rword = carry & 0x3ffffff;\n\n    const min = Math.max(0, k - self.length + 1);\n    const max = Math.min(k, num.length - 1);\n\n    for (let j = min; j <= max; j++) {\n      const i = k - j;\n      const a = self.words[i];\n      const b = num.words[j];\n      const r = a * b;\n\n      let lo = r & 0x3ffffff;\n\n      ncarry = (ncarry + ((r / 0x4000000) | 0)) | 0;\n      lo = (lo + rword) | 0;\n      rword = lo & 0x3ffffff;\n      ncarry = (ncarry + (lo >>> 26)) | 0;\n\n      hncarry += ncarry >>> 26;\n      ncarry &= 0x3ffffff;\n    }\n\n    out.words[k] = rword;\n    carry = ncarry;\n    ncarry = hncarry;\n  }\n\n  if (carry !== 0)\n    out.words[k] = carry;\n  else\n    out.length -= 1;\n\n  return out._strip();\n}\n\nfunction jumboMulTo(x, y, out) {\n  // v8 has a 2147483519 bit max (~256mb).\n  if (!HAS_BIGINT || x.length + y.length > 82595519)\n    return bigMulTo(x, y, out);\n\n  const zero = BigInt(0);\n  const mask = BigInt(0x3ffffff);\n  const shift = BigInt(26);\n\n  let z = x.toBigInt() * y.toBigInt();\n\n  const neg = (z < zero) | 0;\n\n  if (neg)\n    z = -z;\n\n  let i = 0;\n\n  while (z > zero) {\n    out.words[i++] = Number(z & mask);\n    z >>= shift;\n  }\n\n  if (i === 0)\n    out.words[i++] = 0;\n\n  out.length = i;\n  out.negative = neg;\n\n  return out;\n}\n\nfunction comb10MulTo(self, num, out) {\n  const a = self.words;\n  const b = num.words;\n  const o = out.words;\n  const a0 = a[0] | 0;\n  const al0 = a0 & 0x1fff;\n  const ah0 = a0 >>> 13;\n  const a1 = a[1] | 0;\n  const al1 = a1 & 0x1fff;\n  const ah1 = a1 >>> 13;\n  const a2 = a[2] | 0;\n  const al2 = a2 & 0x1fff;\n  const ah2 = a2 >>> 13;\n  const a3 = a[3] | 0;\n  const al3 = a3 & 0x1fff;\n  const ah3 = a3 >>> 13;\n  const a4 = a[4] | 0;\n  const al4 = a4 & 0x1fff;\n  const ah4 = a4 >>> 13;\n  const a5 = a[5] | 0;\n  const al5 = a5 & 0x1fff;\n  const ah5 = a5 >>> 13;\n  const a6 = a[6] | 0;\n  const al6 = a6 & 0x1fff;\n  const ah6 = a6 >>> 13;\n  const a7 = a[7] | 0;\n  const al7 = a7 & 0x1fff;\n  const ah7 = a7 >>> 13;\n  const a8 = a[8] | 0;\n  const al8 = a8 & 0x1fff;\n  const ah8 = a8 >>> 13;\n  const a9 = a[9] | 0;\n  const al9 = a9 & 0x1fff;\n  const ah9 = a9 >>> 13;\n  const b0 = b[0] | 0;\n  const bl0 = b0 & 0x1fff;\n  const bh0 = b0 >>> 13;\n  const b1 = b[1] | 0;\n  const bl1 = b1 & 0x1fff;\n  const bh1 = b1 >>> 13;\n  const b2 = b[2] | 0;\n  const bl2 = b2 & 0x1fff;\n  const bh2 = b2 >>> 13;\n  const b3 = b[3] | 0;\n  const bl3 = b3 & 0x1fff;\n  const bh3 = b3 >>> 13;\n  const b4 = b[4] | 0;\n  const bl4 = b4 & 0x1fff;\n  const bh4 = b4 >>> 13;\n  const b5 = b[5] | 0;\n  const bl5 = b5 & 0x1fff;\n  const bh5 = b5 >>> 13;\n  const b6 = b[6] | 0;\n  const bl6 = b6 & 0x1fff;\n  const bh6 = b6 >>> 13;\n  const b7 = b[7] | 0;\n  const bl7 = b7 & 0x1fff;\n  const bh7 = b7 >>> 13;\n  const b8 = b[8] | 0;\n  const bl8 = b8 & 0x1fff;\n  const bh8 = b8 >>> 13;\n  const b9 = b[9] | 0;\n  const bl9 = b9 & 0x1fff;\n  const bh9 = b9 >>> 13;\n\n  let c = 0;\n  let lo, mid, hi;\n\n  out.negative = self.negative ^ num.negative;\n  out._alloc(20);\n  out.length = 19;\n\n  /* k = 0 */\n  lo = Math.imul(al0, bl0);\n  mid = Math.imul(al0, bh0);\n  mid = (mid + Math.imul(ah0, bl0)) | 0;\n  hi = Math.imul(ah0, bh0);\n\n  let w0 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w0 >>> 26)) | 0;\n  w0 &= 0x3ffffff;\n\n  /* k = 1 */\n  lo = Math.imul(al1, bl0);\n  mid = Math.imul(al1, bh0);\n  mid = (mid + Math.imul(ah1, bl0)) | 0;\n  hi = Math.imul(ah1, bh0);\n  lo = (lo + Math.imul(al0, bl1)) | 0;\n  mid = (mid + Math.imul(al0, bh1)) | 0;\n  mid = (mid + Math.imul(ah0, bl1)) | 0;\n  hi = (hi + Math.imul(ah0, bh1)) | 0;\n\n  let w1 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w1 >>> 26)) | 0;\n  w1 &= 0x3ffffff;\n\n  /* k = 2 */\n  lo = Math.imul(al2, bl0);\n  mid = Math.imul(al2, bh0);\n  mid = (mid + Math.imul(ah2, bl0)) | 0;\n  hi = Math.imul(ah2, bh0);\n  lo = (lo + Math.imul(al1, bl1)) | 0;\n  mid = (mid + Math.imul(al1, bh1)) | 0;\n  mid = (mid + Math.imul(ah1, bl1)) | 0;\n  hi = (hi + Math.imul(ah1, bh1)) | 0;\n  lo = (lo + Math.imul(al0, bl2)) | 0;\n  mid = (mid + Math.imul(al0, bh2)) | 0;\n  mid = (mid + Math.imul(ah0, bl2)) | 0;\n  hi = (hi + Math.imul(ah0, bh2)) | 0;\n\n  let w2 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w2 >>> 26)) | 0;\n  w2 &= 0x3ffffff;\n\n  /* k = 3 */\n  lo = Math.imul(al3, bl0);\n  mid = Math.imul(al3, bh0);\n  mid = (mid + Math.imul(ah3, bl0)) | 0;\n  hi = Math.imul(ah3, bh0);\n  lo = (lo + Math.imul(al2, bl1)) | 0;\n  mid = (mid + Math.imul(al2, bh1)) | 0;\n  mid = (mid + Math.imul(ah2, bl1)) | 0;\n  hi = (hi + Math.imul(ah2, bh1)) | 0;\n  lo = (lo + Math.imul(al1, bl2)) | 0;\n  mid = (mid + Math.imul(al1, bh2)) | 0;\n  mid = (mid + Math.imul(ah1, bl2)) | 0;\n  hi = (hi + Math.imul(ah1, bh2)) | 0;\n  lo = (lo + Math.imul(al0, bl3)) | 0;\n  mid = (mid + Math.imul(al0, bh3)) | 0;\n  mid = (mid + Math.imul(ah0, bl3)) | 0;\n  hi = (hi + Math.imul(ah0, bh3)) | 0;\n\n  let w3 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w3 >>> 26)) | 0;\n  w3 &= 0x3ffffff;\n\n  /* k = 4 */\n  lo = Math.imul(al4, bl0);\n  mid = Math.imul(al4, bh0);\n  mid = (mid + Math.imul(ah4, bl0)) | 0;\n  hi = Math.imul(ah4, bh0);\n  lo = (lo + Math.imul(al3, bl1)) | 0;\n  mid = (mid + Math.imul(al3, bh1)) | 0;\n  mid = (mid + Math.imul(ah3, bl1)) | 0;\n  hi = (hi + Math.imul(ah3, bh1)) | 0;\n  lo = (lo + Math.imul(al2, bl2)) | 0;\n  mid = (mid + Math.imul(al2, bh2)) | 0;\n  mid = (mid + Math.imul(ah2, bl2)) | 0;\n  hi = (hi + Math.imul(ah2, bh2)) | 0;\n  lo = (lo + Math.imul(al1, bl3)) | 0;\n  mid = (mid + Math.imul(al1, bh3)) | 0;\n  mid = (mid + Math.imul(ah1, bl3)) | 0;\n  hi = (hi + Math.imul(ah1, bh3)) | 0;\n  lo = (lo + Math.imul(al0, bl4)) | 0;\n  mid = (mid + Math.imul(al0, bh4)) | 0;\n  mid = (mid + Math.imul(ah0, bl4)) | 0;\n  hi = (hi + Math.imul(ah0, bh4)) | 0;\n\n  let w4 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w4 >>> 26)) | 0;\n  w4 &= 0x3ffffff;\n\n  /* k = 5 */\n  lo = Math.imul(al5, bl0);\n  mid = Math.imul(al5, bh0);\n  mid = (mid + Math.imul(ah5, bl0)) | 0;\n  hi = Math.imul(ah5, bh0);\n  lo = (lo + Math.imul(al4, bl1)) | 0;\n  mid = (mid + Math.imul(al4, bh1)) | 0;\n  mid = (mid + Math.imul(ah4, bl1)) | 0;\n  hi = (hi + Math.imul(ah4, bh1)) | 0;\n  lo = (lo + Math.imul(al3, bl2)) | 0;\n  mid = (mid + Math.imul(al3, bh2)) | 0;\n  mid = (mid + Math.imul(ah3, bl2)) | 0;\n  hi = (hi + Math.imul(ah3, bh2)) | 0;\n  lo = (lo + Math.imul(al2, bl3)) | 0;\n  mid = (mid + Math.imul(al2, bh3)) | 0;\n  mid = (mid + Math.imul(ah2, bl3)) | 0;\n  hi = (hi + Math.imul(ah2, bh3)) | 0;\n  lo = (lo + Math.imul(al1, bl4)) | 0;\n  mid = (mid + Math.imul(al1, bh4)) | 0;\n  mid = (mid + Math.imul(ah1, bl4)) | 0;\n  hi = (hi + Math.imul(ah1, bh4)) | 0;\n  lo = (lo + Math.imul(al0, bl5)) | 0;\n  mid = (mid + Math.imul(al0, bh5)) | 0;\n  mid = (mid + Math.imul(ah0, bl5)) | 0;\n  hi = (hi + Math.imul(ah0, bh5)) | 0;\n\n  let w5 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w5 >>> 26)) | 0;\n  w5 &= 0x3ffffff;\n\n  /* k = 6 */\n  lo = Math.imul(al6, bl0);\n  mid = Math.imul(al6, bh0);\n  mid = (mid + Math.imul(ah6, bl0)) | 0;\n  hi = Math.imul(ah6, bh0);\n  lo = (lo + Math.imul(al5, bl1)) | 0;\n  mid = (mid + Math.imul(al5, bh1)) | 0;\n  mid = (mid + Math.imul(ah5, bl1)) | 0;\n  hi = (hi + Math.imul(ah5, bh1)) | 0;\n  lo = (lo + Math.imul(al4, bl2)) | 0;\n  mid = (mid + Math.imul(al4, bh2)) | 0;\n  mid = (mid + Math.imul(ah4, bl2)) | 0;\n  hi = (hi + Math.imul(ah4, bh2)) | 0;\n  lo = (lo + Math.imul(al3, bl3)) | 0;\n  mid = (mid + Math.imul(al3, bh3)) | 0;\n  mid = (mid + Math.imul(ah3, bl3)) | 0;\n  hi = (hi + Math.imul(ah3, bh3)) | 0;\n  lo = (lo + Math.imul(al2, bl4)) | 0;\n  mid = (mid + Math.imul(al2, bh4)) | 0;\n  mid = (mid + Math.imul(ah2, bl4)) | 0;\n  hi = (hi + Math.imul(ah2, bh4)) | 0;\n  lo = (lo + Math.imul(al1, bl5)) | 0;\n  mid = (mid + Math.imul(al1, bh5)) | 0;\n  mid = (mid + Math.imul(ah1, bl5)) | 0;\n  hi = (hi + Math.imul(ah1, bh5)) | 0;\n  lo = (lo + Math.imul(al0, bl6)) | 0;\n  mid = (mid + Math.imul(al0, bh6)) | 0;\n  mid = (mid + Math.imul(ah0, bl6)) | 0;\n  hi = (hi + Math.imul(ah0, bh6)) | 0;\n\n  let w6 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w6 >>> 26)) | 0;\n  w6 &= 0x3ffffff;\n\n  /* k = 7 */\n  lo = Math.imul(al7, bl0);\n  mid = Math.imul(al7, bh0);\n  mid = (mid + Math.imul(ah7, bl0)) | 0;\n  hi = Math.imul(ah7, bh0);\n  lo = (lo + Math.imul(al6, bl1)) | 0;\n  mid = (mid + Math.imul(al6, bh1)) | 0;\n  mid = (mid + Math.imul(ah6, bl1)) | 0;\n  hi = (hi + Math.imul(ah6, bh1)) | 0;\n  lo = (lo + Math.imul(al5, bl2)) | 0;\n  mid = (mid + Math.imul(al5, bh2)) | 0;\n  mid = (mid + Math.imul(ah5, bl2)) | 0;\n  hi = (hi + Math.imul(ah5, bh2)) | 0;\n  lo = (lo + Math.imul(al4, bl3)) | 0;\n  mid = (mid + Math.imul(al4, bh3)) | 0;\n  mid = (mid + Math.imul(ah4, bl3)) | 0;\n  hi = (hi + Math.imul(ah4, bh3)) | 0;\n  lo = (lo + Math.imul(al3, bl4)) | 0;\n  mid = (mid + Math.imul(al3, bh4)) | 0;\n  mid = (mid + Math.imul(ah3, bl4)) | 0;\n  hi = (hi + Math.imul(ah3, bh4)) | 0;\n  lo = (lo + Math.imul(al2, bl5)) | 0;\n  mid = (mid + Math.imul(al2, bh5)) | 0;\n  mid = (mid + Math.imul(ah2, bl5)) | 0;\n  hi = (hi + Math.imul(ah2, bh5)) | 0;\n  lo = (lo + Math.imul(al1, bl6)) | 0;\n  mid = (mid + Math.imul(al1, bh6)) | 0;\n  mid = (mid + Math.imul(ah1, bl6)) | 0;\n  hi = (hi + Math.imul(ah1, bh6)) | 0;\n  lo = (lo + Math.imul(al0, bl7)) | 0;\n  mid = (mid + Math.imul(al0, bh7)) | 0;\n  mid = (mid + Math.imul(ah0, bl7)) | 0;\n  hi = (hi + Math.imul(ah0, bh7)) | 0;\n\n  let w7 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w7 >>> 26)) | 0;\n  w7 &= 0x3ffffff;\n\n  /* k = 8 */\n  lo = Math.imul(al8, bl0);\n  mid = Math.imul(al8, bh0);\n  mid = (mid + Math.imul(ah8, bl0)) | 0;\n  hi = Math.imul(ah8, bh0);\n  lo = (lo + Math.imul(al7, bl1)) | 0;\n  mid = (mid + Math.imul(al7, bh1)) | 0;\n  mid = (mid + Math.imul(ah7, bl1)) | 0;\n  hi = (hi + Math.imul(ah7, bh1)) | 0;\n  lo = (lo + Math.imul(al6, bl2)) | 0;\n  mid = (mid + Math.imul(al6, bh2)) | 0;\n  mid = (mid + Math.imul(ah6, bl2)) | 0;\n  hi = (hi + Math.imul(ah6, bh2)) | 0;\n  lo = (lo + Math.imul(al5, bl3)) | 0;\n  mid = (mid + Math.imul(al5, bh3)) | 0;\n  mid = (mid + Math.imul(ah5, bl3)) | 0;\n  hi = (hi + Math.imul(ah5, bh3)) | 0;\n  lo = (lo + Math.imul(al4, bl4)) | 0;\n  mid = (mid + Math.imul(al4, bh4)) | 0;\n  mid = (mid + Math.imul(ah4, bl4)) | 0;\n  hi = (hi + Math.imul(ah4, bh4)) | 0;\n  lo = (lo + Math.imul(al3, bl5)) | 0;\n  mid = (mid + Math.imul(al3, bh5)) | 0;\n  mid = (mid + Math.imul(ah3, bl5)) | 0;\n  hi = (hi + Math.imul(ah3, bh5)) | 0;\n  lo = (lo + Math.imul(al2, bl6)) | 0;\n  mid = (mid + Math.imul(al2, bh6)) | 0;\n  mid = (mid + Math.imul(ah2, bl6)) | 0;\n  hi = (hi + Math.imul(ah2, bh6)) | 0;\n  lo = (lo + Math.imul(al1, bl7)) | 0;\n  mid = (mid + Math.imul(al1, bh7)) | 0;\n  mid = (mid + Math.imul(ah1, bl7)) | 0;\n  hi = (hi + Math.imul(ah1, bh7)) | 0;\n  lo = (lo + Math.imul(al0, bl8)) | 0;\n  mid = (mid + Math.imul(al0, bh8)) | 0;\n  mid = (mid + Math.imul(ah0, bl8)) | 0;\n  hi = (hi + Math.imul(ah0, bh8)) | 0;\n\n  let w8 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w8 >>> 26)) | 0;\n  w8 &= 0x3ffffff;\n\n  /* k = 9 */\n  lo = Math.imul(al9, bl0);\n  mid = Math.imul(al9, bh0);\n  mid = (mid + Math.imul(ah9, bl0)) | 0;\n  hi = Math.imul(ah9, bh0);\n  lo = (lo + Math.imul(al8, bl1)) | 0;\n  mid = (mid + Math.imul(al8, bh1)) | 0;\n  mid = (mid + Math.imul(ah8, bl1)) | 0;\n  hi = (hi + Math.imul(ah8, bh1)) | 0;\n  lo = (lo + Math.imul(al7, bl2)) | 0;\n  mid = (mid + Math.imul(al7, bh2)) | 0;\n  mid = (mid + Math.imul(ah7, bl2)) | 0;\n  hi = (hi + Math.imul(ah7, bh2)) | 0;\n  lo = (lo + Math.imul(al6, bl3)) | 0;\n  mid = (mid + Math.imul(al6, bh3)) | 0;\n  mid = (mid + Math.imul(ah6, bl3)) | 0;\n  hi = (hi + Math.imul(ah6, bh3)) | 0;\n  lo = (lo + Math.imul(al5, bl4)) | 0;\n  mid = (mid + Math.imul(al5, bh4)) | 0;\n  mid = (mid + Math.imul(ah5, bl4)) | 0;\n  hi = (hi + Math.imul(ah5, bh4)) | 0;\n  lo = (lo + Math.imul(al4, bl5)) | 0;\n  mid = (mid + Math.imul(al4, bh5)) | 0;\n  mid = (mid + Math.imul(ah4, bl5)) | 0;\n  hi = (hi + Math.imul(ah4, bh5)) | 0;\n  lo = (lo + Math.imul(al3, bl6)) | 0;\n  mid = (mid + Math.imul(al3, bh6)) | 0;\n  mid = (mid + Math.imul(ah3, bl6)) | 0;\n  hi = (hi + Math.imul(ah3, bh6)) | 0;\n  lo = (lo + Math.imul(al2, bl7)) | 0;\n  mid = (mid + Math.imul(al2, bh7)) | 0;\n  mid = (mid + Math.imul(ah2, bl7)) | 0;\n  hi = (hi + Math.imul(ah2, bh7)) | 0;\n  lo = (lo + Math.imul(al1, bl8)) | 0;\n  mid = (mid + Math.imul(al1, bh8)) | 0;\n  mid = (mid + Math.imul(ah1, bl8)) | 0;\n  hi = (hi + Math.imul(ah1, bh8)) | 0;\n  lo = (lo + Math.imul(al0, bl9)) | 0;\n  mid = (mid + Math.imul(al0, bh9)) | 0;\n  mid = (mid + Math.imul(ah0, bl9)) | 0;\n  hi = (hi + Math.imul(ah0, bh9)) | 0;\n\n  let w9 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w9 >>> 26)) | 0;\n  w9 &= 0x3ffffff;\n\n  /* k = 10 */\n  lo = Math.imul(al9, bl1);\n  mid = Math.imul(al9, bh1);\n  mid = (mid + Math.imul(ah9, bl1)) | 0;\n  hi = Math.imul(ah9, bh1);\n  lo = (lo + Math.imul(al8, bl2)) | 0;\n  mid = (mid + Math.imul(al8, bh2)) | 0;\n  mid = (mid + Math.imul(ah8, bl2)) | 0;\n  hi = (hi + Math.imul(ah8, bh2)) | 0;\n  lo = (lo + Math.imul(al7, bl3)) | 0;\n  mid = (mid + Math.imul(al7, bh3)) | 0;\n  mid = (mid + Math.imul(ah7, bl3)) | 0;\n  hi = (hi + Math.imul(ah7, bh3)) | 0;\n  lo = (lo + Math.imul(al6, bl4)) | 0;\n  mid = (mid + Math.imul(al6, bh4)) | 0;\n  mid = (mid + Math.imul(ah6, bl4)) | 0;\n  hi = (hi + Math.imul(ah6, bh4)) | 0;\n  lo = (lo + Math.imul(al5, bl5)) | 0;\n  mid = (mid + Math.imul(al5, bh5)) | 0;\n  mid = (mid + Math.imul(ah5, bl5)) | 0;\n  hi = (hi + Math.imul(ah5, bh5)) | 0;\n  lo = (lo + Math.imul(al4, bl6)) | 0;\n  mid = (mid + Math.imul(al4, bh6)) | 0;\n  mid = (mid + Math.imul(ah4, bl6)) | 0;\n  hi = (hi + Math.imul(ah4, bh6)) | 0;\n  lo = (lo + Math.imul(al3, bl7)) | 0;\n  mid = (mid + Math.imul(al3, bh7)) | 0;\n  mid = (mid + Math.imul(ah3, bl7)) | 0;\n  hi = (hi + Math.imul(ah3, bh7)) | 0;\n  lo = (lo + Math.imul(al2, bl8)) | 0;\n  mid = (mid + Math.imul(al2, bh8)) | 0;\n  mid = (mid + Math.imul(ah2, bl8)) | 0;\n  hi = (hi + Math.imul(ah2, bh8)) | 0;\n  lo = (lo + Math.imul(al1, bl9)) | 0;\n  mid = (mid + Math.imul(al1, bh9)) | 0;\n  mid = (mid + Math.imul(ah1, bl9)) | 0;\n  hi = (hi + Math.imul(ah1, bh9)) | 0;\n\n  let w10 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w10 >>> 26)) | 0;\n  w10 &= 0x3ffffff;\n\n  /* k = 11 */\n  lo = Math.imul(al9, bl2);\n  mid = Math.imul(al9, bh2);\n  mid = (mid + Math.imul(ah9, bl2)) | 0;\n  hi = Math.imul(ah9, bh2);\n  lo = (lo + Math.imul(al8, bl3)) | 0;\n  mid = (mid + Math.imul(al8, bh3)) | 0;\n  mid = (mid + Math.imul(ah8, bl3)) | 0;\n  hi = (hi + Math.imul(ah8, bh3)) | 0;\n  lo = (lo + Math.imul(al7, bl4)) | 0;\n  mid = (mid + Math.imul(al7, bh4)) | 0;\n  mid = (mid + Math.imul(ah7, bl4)) | 0;\n  hi = (hi + Math.imul(ah7, bh4)) | 0;\n  lo = (lo + Math.imul(al6, bl5)) | 0;\n  mid = (mid + Math.imul(al6, bh5)) | 0;\n  mid = (mid + Math.imul(ah6, bl5)) | 0;\n  hi = (hi + Math.imul(ah6, bh5)) | 0;\n  lo = (lo + Math.imul(al5, bl6)) | 0;\n  mid = (mid + Math.imul(al5, bh6)) | 0;\n  mid = (mid + Math.imul(ah5, bl6)) | 0;\n  hi = (hi + Math.imul(ah5, bh6)) | 0;\n  lo = (lo + Math.imul(al4, bl7)) | 0;\n  mid = (mid + Math.imul(al4, bh7)) | 0;\n  mid = (mid + Math.imul(ah4, bl7)) | 0;\n  hi = (hi + Math.imul(ah4, bh7)) | 0;\n  lo = (lo + Math.imul(al3, bl8)) | 0;\n  mid = (mid + Math.imul(al3, bh8)) | 0;\n  mid = (mid + Math.imul(ah3, bl8)) | 0;\n  hi = (hi + Math.imul(ah3, bh8)) | 0;\n  lo = (lo + Math.imul(al2, bl9)) | 0;\n  mid = (mid + Math.imul(al2, bh9)) | 0;\n  mid = (mid + Math.imul(ah2, bl9)) | 0;\n  hi = (hi + Math.imul(ah2, bh9)) | 0;\n\n  let w11 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w11 >>> 26)) | 0;\n  w11 &= 0x3ffffff;\n\n  /* k = 12 */\n  lo = Math.imul(al9, bl3);\n  mid = Math.imul(al9, bh3);\n  mid = (mid + Math.imul(ah9, bl3)) | 0;\n  hi = Math.imul(ah9, bh3);\n  lo = (lo + Math.imul(al8, bl4)) | 0;\n  mid = (mid + Math.imul(al8, bh4)) | 0;\n  mid = (mid + Math.imul(ah8, bl4)) | 0;\n  hi = (hi + Math.imul(ah8, bh4)) | 0;\n  lo = (lo + Math.imul(al7, bl5)) | 0;\n  mid = (mid + Math.imul(al7, bh5)) | 0;\n  mid = (mid + Math.imul(ah7, bl5)) | 0;\n  hi = (hi + Math.imul(ah7, bh5)) | 0;\n  lo = (lo + Math.imul(al6, bl6)) | 0;\n  mid = (mid + Math.imul(al6, bh6)) | 0;\n  mid = (mid + Math.imul(ah6, bl6)) | 0;\n  hi = (hi + Math.imul(ah6, bh6)) | 0;\n  lo = (lo + Math.imul(al5, bl7)) | 0;\n  mid = (mid + Math.imul(al5, bh7)) | 0;\n  mid = (mid + Math.imul(ah5, bl7)) | 0;\n  hi = (hi + Math.imul(ah5, bh7)) | 0;\n  lo = (lo + Math.imul(al4, bl8)) | 0;\n  mid = (mid + Math.imul(al4, bh8)) | 0;\n  mid = (mid + Math.imul(ah4, bl8)) | 0;\n  hi = (hi + Math.imul(ah4, bh8)) | 0;\n  lo = (lo + Math.imul(al3, bl9)) | 0;\n  mid = (mid + Math.imul(al3, bh9)) | 0;\n  mid = (mid + Math.imul(ah3, bl9)) | 0;\n  hi = (hi + Math.imul(ah3, bh9)) | 0;\n\n  let w12 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w12 >>> 26)) | 0;\n  w12 &= 0x3ffffff;\n\n  /* k = 13 */\n  lo = Math.imul(al9, bl4);\n  mid = Math.imul(al9, bh4);\n  mid = (mid + Math.imul(ah9, bl4)) | 0;\n  hi = Math.imul(ah9, bh4);\n  lo = (lo + Math.imul(al8, bl5)) | 0;\n  mid = (mid + Math.imul(al8, bh5)) | 0;\n  mid = (mid + Math.imul(ah8, bl5)) | 0;\n  hi = (hi + Math.imul(ah8, bh5)) | 0;\n  lo = (lo + Math.imul(al7, bl6)) | 0;\n  mid = (mid + Math.imul(al7, bh6)) | 0;\n  mid = (mid + Math.imul(ah7, bl6)) | 0;\n  hi = (hi + Math.imul(ah7, bh6)) | 0;\n  lo = (lo + Math.imul(al6, bl7)) | 0;\n  mid = (mid + Math.imul(al6, bh7)) | 0;\n  mid = (mid + Math.imul(ah6, bl7)) | 0;\n  hi = (hi + Math.imul(ah6, bh7)) | 0;\n  lo = (lo + Math.imul(al5, bl8)) | 0;\n  mid = (mid + Math.imul(al5, bh8)) | 0;\n  mid = (mid + Math.imul(ah5, bl8)) | 0;\n  hi = (hi + Math.imul(ah5, bh8)) | 0;\n  lo = (lo + Math.imul(al4, bl9)) | 0;\n  mid = (mid + Math.imul(al4, bh9)) | 0;\n  mid = (mid + Math.imul(ah4, bl9)) | 0;\n  hi = (hi + Math.imul(ah4, bh9)) | 0;\n\n  let w13 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w13 >>> 26)) | 0;\n  w13 &= 0x3ffffff;\n\n  /* k = 14 */\n  lo = Math.imul(al9, bl5);\n  mid = Math.imul(al9, bh5);\n  mid = (mid + Math.imul(ah9, bl5)) | 0;\n  hi = Math.imul(ah9, bh5);\n  lo = (lo + Math.imul(al8, bl6)) | 0;\n  mid = (mid + Math.imul(al8, bh6)) | 0;\n  mid = (mid + Math.imul(ah8, bl6)) | 0;\n  hi = (hi + Math.imul(ah8, bh6)) | 0;\n  lo = (lo + Math.imul(al7, bl7)) | 0;\n  mid = (mid + Math.imul(al7, bh7)) | 0;\n  mid = (mid + Math.imul(ah7, bl7)) | 0;\n  hi = (hi + Math.imul(ah7, bh7)) | 0;\n  lo = (lo + Math.imul(al6, bl8)) | 0;\n  mid = (mid + Math.imul(al6, bh8)) | 0;\n  mid = (mid + Math.imul(ah6, bl8)) | 0;\n  hi = (hi + Math.imul(ah6, bh8)) | 0;\n  lo = (lo + Math.imul(al5, bl9)) | 0;\n  mid = (mid + Math.imul(al5, bh9)) | 0;\n  mid = (mid + Math.imul(ah5, bl9)) | 0;\n  hi = (hi + Math.imul(ah5, bh9)) | 0;\n\n  let w14 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w14 >>> 26)) | 0;\n  w14 &= 0x3ffffff;\n\n  /* k = 15 */\n  lo = Math.imul(al9, bl6);\n  mid = Math.imul(al9, bh6);\n  mid = (mid + Math.imul(ah9, bl6)) | 0;\n  hi = Math.imul(ah9, bh6);\n  lo = (lo + Math.imul(al8, bl7)) | 0;\n  mid = (mid + Math.imul(al8, bh7)) | 0;\n  mid = (mid + Math.imul(ah8, bl7)) | 0;\n  hi = (hi + Math.imul(ah8, bh7)) | 0;\n  lo = (lo + Math.imul(al7, bl8)) | 0;\n  mid = (mid + Math.imul(al7, bh8)) | 0;\n  mid = (mid + Math.imul(ah7, bl8)) | 0;\n  hi = (hi + Math.imul(ah7, bh8)) | 0;\n  lo = (lo + Math.imul(al6, bl9)) | 0;\n  mid = (mid + Math.imul(al6, bh9)) | 0;\n  mid = (mid + Math.imul(ah6, bl9)) | 0;\n  hi = (hi + Math.imul(ah6, bh9)) | 0;\n\n  let w15 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w15 >>> 26)) | 0;\n  w15 &= 0x3ffffff;\n\n  /* k = 16 */\n  lo = Math.imul(al9, bl7);\n  mid = Math.imul(al9, bh7);\n  mid = (mid + Math.imul(ah9, bl7)) | 0;\n  hi = Math.imul(ah9, bh7);\n  lo = (lo + Math.imul(al8, bl8)) | 0;\n  mid = (mid + Math.imul(al8, bh8)) | 0;\n  mid = (mid + Math.imul(ah8, bl8)) | 0;\n  hi = (hi + Math.imul(ah8, bh8)) | 0;\n  lo = (lo + Math.imul(al7, bl9)) | 0;\n  mid = (mid + Math.imul(al7, bh9)) | 0;\n  mid = (mid + Math.imul(ah7, bl9)) | 0;\n  hi = (hi + Math.imul(ah7, bh9)) | 0;\n\n  let w16 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w16 >>> 26)) | 0;\n  w16 &= 0x3ffffff;\n\n  /* k = 17 */\n  lo = Math.imul(al9, bl8);\n  mid = Math.imul(al9, bh8);\n  mid = (mid + Math.imul(ah9, bl8)) | 0;\n  hi = Math.imul(ah9, bh8);\n  lo = (lo + Math.imul(al8, bl9)) | 0;\n  mid = (mid + Math.imul(al8, bh9)) | 0;\n  mid = (mid + Math.imul(ah8, bl9)) | 0;\n  hi = (hi + Math.imul(ah8, bh9)) | 0;\n\n  let w17 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w17 >>> 26)) | 0;\n  w17 &= 0x3ffffff;\n\n  /* k = 18 */\n  lo = Math.imul(al9, bl9);\n  mid = Math.imul(al9, bh9);\n  mid = (mid + Math.imul(ah9, bl9)) | 0;\n  hi = Math.imul(ah9, bh9);\n\n  let w18 = (((c + lo) | 0) + ((mid & 0x1fff) << 13)) | 0;\n  c = (((hi + (mid >>> 13)) | 0) + (w18 >>> 26)) | 0;\n  w18 &= 0x3ffffff;\n\n  o[0] = w0;\n  o[1] = w1;\n  o[2] = w2;\n  o[3] = w3;\n  o[4] = w4;\n  o[5] = w5;\n  o[6] = w6;\n  o[7] = w7;\n  o[8] = w8;\n  o[9] = w9;\n  o[10] = w10;\n  o[11] = w11;\n  o[12] = w12;\n  o[13] = w13;\n  o[14] = w14;\n  o[15] = w15;\n  o[16] = w16;\n  o[17] = w17;\n  o[18] = w18;\n\n  if (c !== 0) {\n    o[19] = c;\n    out.length += 1;\n  }\n\n  // Note: we shouldn't need to strip here.\n  return out;\n}\n\n// Polyfill comb.\nif (!Math.imul)\n  comb10MulTo = smallMulTo;\n\n/*\n * Expose\n */\n\nBN.Red = Red;\n\nmodule.exports = BN;\n"]},"metadata":{},"sourceType":"script"}