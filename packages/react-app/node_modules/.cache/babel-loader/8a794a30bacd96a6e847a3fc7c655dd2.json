{"ast":null,"code":"var _jsxFileName = \"/Users/yenerkaraca/Documents/GitHub/eth-app/packages/react-app/src/App.js\";\nimport React, { useCallback, useEffect, useState } from \"react\";\nimport { useDropzone } from \"react-dropzone\";\nimport { ethers } from \"ethers\";\nimport IPFS from \"ipfs\";\nimport logo from \"./ethereumLogo.png\";\nimport { addresses, abis } from \"@project/contracts\";\nimport \"./App.css\";\nconst ZERO_ADDRESS = \"0x0000000000000000000000000000000000000000000000000000000000000000\";\nlet node;\nconst defaultProvider = new ethers.providers.Web3Provider(window.ethereum);\nconst ipfsContract = new ethers.Contract(addresses.ipfs, abis.ipfs, defaultProvider);\nvar storageContract;\nconsole.log(addresses.ipfs);\n\nasync function initIpfs() {\n  node = await IPFS.create();\n  const version = await node.version();\n  console.log(\"IPFS Node Version:\", version.version);\n}\n\nasync function readCurrentUserFile() {\n  const result = await ipfsContract.userFiles(defaultProvider.getSigner().getAddress());\n  console.log({\n    result\n  });\n  const accounts = await window.ethereum.request({\n    method: 'eth_requestAccounts'\n  });\n  const account = accounts[0]; //metamask current account\n\n  return result;\n}\n\nasync function getaccount() {\n  const accounts = await window.ethereum.request({\n    method: 'eth_requestAccounts'\n  });\n  Object.values(accounts);\n  const account = JSON.stringify(accounts[0]);\n  console.log(\"FUNC\");\n  console.log({\n    account\n  });\n  return account;\n}\n\nfunction App() {\n  const [ipfsHash, setIpfsHash] = useState(\"\");\n  useEffect(() => {\n    initIpfs();\n    window.ethereum.enable();\n  }, []);\n  useEffect(() => {\n    async function readFile() {\n      const file = await readCurrentUserFile();\n      if (file !== ZERO_ADDRESS) setIpfsHash(file);\n    }\n\n    readFile();\n  }, []);\n  const [accountHash, setAccountHash] = useState(\"\");\n  useEffect(() => {\n    window.ethereum.enable();\n  }, []);\n  useEffect(() => {\n    async function readFile() {\n      const file1 = await getaccount();\n      if (file1 !== ZERO_ADDRESS) setAccountHash(file1);\n    }\n\n    readFile();\n  }, []);\n\n  async function setFile(hash) {\n    const ipfsWithSigner = ipfsContract.connect(defaultProvider.getSigner());\n    const tx = await ipfsWithSigner.setFile(hash);\n    console.log({\n      tx\n    });\n    setIpfsHash(hash);\n    ipfsWithSigner.store(hash);\n  }\n\n  function SetContract() {\n    storageContract = new ethers.Contract(itemInput2, abis.storage, defaultProvider);\n    console.log(itemInput2);\n    console.log(abis.storage);\n    console.log(storageContract);\n\n    try {\n      if (itemInput2 == \"\") throw \"Empty! Enter Smart Contract Hash.\";\n      if (isNaN(itemInput2)) throw \"Not a number! Enter Smart Contract Hash.\";\n    } catch (err) {\n      console.log(err);\n      document.getElementById(\"text-box\").innerHTML = err;\n    }\n\n    return storageContract;\n  }\n\n  async function Buyer() {\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      await storageWithSigner.buyerUpload(ipfsHash, itemInput);\n    } catch (err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message;\n    }\n  }\n\n  async function Seller() {\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      await storageWithSigner.sellerUpload(ipfsHash);\n    } catch (err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message;\n    }\n  }\n\n  async function Extend() {\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      await storageWithSigner.ExtendTime(itemInput1);\n    } catch (err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message;\n    }\n  }\n\n  async function status() {\n    var status_array = [\"ON\", \"BUYER_UPLOADED\", \"SELLER_UPLOADED\", \"DOC_OK\", \"DOC_DEFECT\", \"DOC_REJECTED\"];\n\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      var statust = await storageWithSigner.getStatus();\n      document.getElementById(\"text-box1\").innerHTML = status_array[statust];\n      return;\n    } catch (err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message;\n    }\n  }\n\n  async function time() {\n    var time_array = [\"ON_TIME\", \"OUT_OF_TIME\"];\n\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      var timet = await storageWithSigner.getTimeStatus();\n      document.getElementById(\"text-box2\").innerHTML = time_array[timet];\n      return;\n    } catch (err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message;\n    }\n  }\n\n  async function compliancetrue() {\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      await storageWithSigner.setCompliance(true);\n    } catch (err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message;\n    }\n  }\n\n  async function compliancefalse() {\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      await storageWithSigner.setCompliance(false);\n    } catch (err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message;\n    }\n  }\n\n  async function waivetrue() {\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      await storageWithSigner.waiveDiscrepancies(true);\n    } catch (err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message;\n    }\n  }\n\n  async function waivefalse() {\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      await storageWithSigner.waiveDiscrepancies(false);\n    } catch (err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message;\n    }\n  }\n\n  async function destroy() {\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      await storageWithSigner.destroycontract(false);\n    } catch (err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message;\n    }\n  }\n\n  async function checkbalance() {\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      var balance = await storageWithSigner.check_Contract_Balance();\n      document.getElementById(\"text-box3\").innerHTML = balance;\n    } catch (err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message;\n    }\n  }\n\n  async function getContractFile() {\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      var contractfile = await storageWithSigner.See_Doc_Hash(itemInput3);\n      document.getElementById(\"myAnchor\").innerHTML = \"See Contract File\";\n      document.getElementById(\"myAnchor\").href = `https://ipfs.io/ipfs/${contractfile}`;\n      document.getElementById(\"myAnchor\").target = \"_blank\";\n    } catch (err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message;\n    }\n  }\n\n  console.log(ipfsHash);\n  const uploadFile = useCallback(async file => {\n    const files = [{\n      path: file.name + file.path,\n      content: file\n    }];\n\n    for await (const result of node.add(files)) {\n      await setFile(result.cid.string);\n    }\n  }, []);\n  const onDrop = useCallback(acceptedFiles => {\n    uploadFile(acceptedFiles[0]);\n  }, [uploadFile]);\n  const {\n    getRootProps,\n    getInputProps,\n    isDragActive\n  } = useDropzone({\n    multiple: false,\n    onDrop\n  });\n  const [itemInput, setItemInput] = useState(\"\");\n  console.log(itemInput);\n  const [itemInput1, setItemInput1] = useState(\"\");\n  console.log(itemInput1);\n  const [itemInput2, setItemInput2] = useState(\"\");\n  console.log(itemInput2);\n  const [itemInput3, setItemInput3] = useState(\"\");\n  console.log(itemInput3);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"App\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 392,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"header\", {\n    className: \"App-header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"text-box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 395,\n      columnNumber: 7\n    }\n  }, \"Smart Contract: \", /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    placeholder: \"Contract Hash\",\n    value: itemInput2,\n    onChange: e => setItemInput2(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 396,\n      columnNumber: 27\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: SetContract,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 9\n    }\n  }, \"Set\")), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 399,\n      columnNumber: 7\n    }\n  }, \" \", /*#__PURE__*/React.createElement(\"button\", {\n    onClick: status,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 399,\n      columnNumber: 13\n    }\n  }, \"See Current Status\"), \" \", /*#__PURE__*/React.createElement(\"button\", {\n    onClick: time,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 399,\n      columnNumber: 66\n    }\n  }, \"See Current Time\"), \" \", /*#__PURE__*/React.createElement(\"button\", {\n    onClick: checkbalance,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 399,\n      columnNumber: 115\n    }\n  }, \"Check Balance\"), \" \"), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"text-box1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 401,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"text-box2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 402,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"text-box3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 403,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", Object.assign({}, getRootProps(), {\n    style: {\n      cursor: \"pointer\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 406,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"img\", {\n    src: logo,\n    className: \"App-logo\",\n    alt: \"react-logo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 407,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", Object.assign({}, getInputProps(), {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 408,\n      columnNumber: 11\n    }\n  })), isDragActive ? /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 410,\n      columnNumber: 13\n    }\n  }, \"Drop the files here ...\") : /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 412,\n      columnNumber: 13\n    }\n  }, \"Drag 'n' drop some files here to upload to IPFS (or click the logo)\")), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 418,\n      columnNumber: 9\n    }\n  }, ipfsHash !== \"\" ? /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 13\n    }\n  }, \"Current IPFS Hash: \", /*#__PURE__*/React.createElement(\"mark\", {\n    className: \"mark-red\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 35\n    }\n  }, \"\\\"\", ipfsHash, \"\\\"\")) : \"\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 425,\n      columnNumber: 9\n    }\n  }, \"Current User Hash:\", /*#__PURE__*/React.createElement(\"mark\", {\n    className: \"mark-yellow\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 425,\n      columnNumber: 32\n    }\n  }, accountHash)), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 426,\n      columnNumber: 9\n    }\n  }, ipfsHash !== \"\" ? /*#__PURE__*/React.createElement(\"a\", {\n    href: `https://ipfs.io/ipfs/${ipfsHash}`,\n    target: \"_blank\",\n    rel: \"noopener noreferrer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 428,\n      columnNumber: 13\n    }\n  }, \"See current user file\") : \"No user file set yet\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 440,\n      columnNumber: 9\n    }\n  }, \"Buyer Sets Time and Uploads to The Smart Contract: \", /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    placeholder: \"Enter Time\",\n    value: itemInput,\n    onChange: e => setItemInput(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 441,\n      columnNumber: 61\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: Buyer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 442,\n      columnNumber: 10\n    }\n  }, \"Buyer Upload\")), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 444,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 447,\n      columnNumber: 9\n    }\n  }, \"Buyer Extends Time:\", /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    placeholder: \"Enter Time\",\n    value: itemInput1,\n    onChange: e => setItemInput1(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 449,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: Extend,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 452,\n      columnNumber: 9\n    }\n  }, \"Buyer Extend\")), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 454,\n      columnNumber: 10\n    }\n  }, \"Seller Uploads to The Smart Contract: \", /*#__PURE__*/React.createElement(\"button\", {\n    onClick: Seller,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 454,\n      columnNumber: 53\n    }\n  }, \"Seller Upload\")), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 456,\n      columnNumber: 10\n    }\n  }, \"Smart Contract Files: \", /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    placeholder: \"Enter Hash\",\n    value: itemInput3,\n    onChange: e => setItemInput3(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 457,\n      columnNumber: 33\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: getContractFile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 458,\n      columnNumber: 9\n    }\n  }, \"See Contract Files\")), /*#__PURE__*/React.createElement(\"a\", {\n    id: \"myAnchor\",\n    href: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 460,\n      columnNumber: 10\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 461,\n      columnNumber: 10\n    }\n  }, \"Fintech Set Compliance or Destroy Contract:  \", /*#__PURE__*/React.createElement(\"button\", {\n    onClick: compliancetrue,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 462,\n      columnNumber: 57\n    }\n  }, \"Compliance\"), \"  \", /*#__PURE__*/React.createElement(\"button\", {\n    onClick: compliancefalse,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 462,\n      columnNumber: 111\n    }\n  }, \"No Compliance\"), \" \", /*#__PURE__*/React.createElement(\"button\", {\n    onClick: destroy,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 462,\n      columnNumber: 168\n    }\n  }, \"Destroy Contract\")), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 464,\n      columnNumber: 10\n    }\n  }, \"Buyer Waives or Terminates:  \", /*#__PURE__*/React.createElement(\"button\", {\n    onClick: waivetrue,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 465,\n      columnNumber: 41\n    }\n  }, \"Waive Discrepancies\"), \"  \", /*#__PURE__*/React.createElement(\"button\", {\n    onClick: waivefalse,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 465,\n      columnNumber: 99\n    }\n  }, \"Terminate The Contract\"))));\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/yenerkaraca/Documents/GitHub/eth-app/packages/react-app/src/App.js"],"names":["React","useCallback","useEffect","useState","useDropzone","ethers","IPFS","logo","addresses","abis","ZERO_ADDRESS","node","defaultProvider","providers","Web3Provider","window","ethereum","ipfsContract","Contract","ipfs","storageContract","console","log","initIpfs","create","version","readCurrentUserFile","result","userFiles","getSigner","getAddress","accounts","request","method","account","getaccount","Object","values","JSON","stringify","App","ipfsHash","setIpfsHash","enable","readFile","file","accountHash","setAccountHash","file1","setFile","hash","ipfsWithSigner","connect","tx","store","SetContract","itemInput2","storage","isNaN","err","document","getElementById","innerHTML","Buyer","storageWithSigner","buyerUpload","itemInput","message","Seller","sellerUpload","Extend","ExtendTime","itemInput1","status","status_array","statust","getStatus","time","time_array","timet","getTimeStatus","compliancetrue","setCompliance","compliancefalse","waivetrue","waiveDiscrepancies","waivefalse","destroy","destroycontract","checkbalance","balance","check_Contract_Balance","getContractFile","contractfile","See_Doc_Hash","itemInput3","href","target","uploadFile","files","path","name","content","add","cid","string","onDrop","acceptedFiles","getRootProps","getInputProps","isDragActive","multiple","setItemInput","setItemInput1","setItemInput2","setItemInput3","e","value","cursor"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useState } from \"react\";\nimport { useDropzone } from \"react-dropzone\";\nimport { ethers } from \"ethers\";\nimport IPFS from \"ipfs\";\n\nimport logo from \"./ethereumLogo.png\";\nimport { addresses, abis } from \"@project/contracts\";\n\nimport \"./App.css\";\n\nconst ZERO_ADDRESS =\n  \"0x0000000000000000000000000000000000000000000000000000000000000000\";\n\nlet node;\n \nconst defaultProvider = new ethers.providers.Web3Provider(window.ethereum);\nconst ipfsContract = new ethers.Contract(\n  addresses.ipfs,\n  abis.ipfs,\n  defaultProvider\n);\nvar storageContract;\nconsole.log( addresses.ipfs);\n\nasync function initIpfs() {\n  node = await IPFS.create();\n  const version = await node.version();\n  console.log(\"IPFS Node Version:\", version.version);\n}\n\nasync function readCurrentUserFile() {\n  const result = await ipfsContract.userFiles(\n    defaultProvider.getSigner().getAddress()\n    \n  \n  );\n  console.log({ result });\n \n  const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });\n  const account = accounts[0];//metamask current account\n\n  \n  return result;\n}\nasync function getaccount(){\n  const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });\n  Object.values(accounts);\n  const account =JSON.stringify(accounts[0]);\n  console.log(\"FUNC\");\n\n  console.log({ account });\n\nreturn account\n}\n\n\nfunction App() {\n  const [ipfsHash, setIpfsHash] = useState(\"\");\n  useEffect(() => {\n    initIpfs();\n    window.ethereum.enable();\n  }, []);\n\n  useEffect(() => {\n    async function readFile() {\n      const file = await readCurrentUserFile();\n\n      if (file !== ZERO_ADDRESS) setIpfsHash(file);\n    }\n    readFile();\n  }, []);\n\n\n  const [accountHash, setAccountHash] = useState(\"\");\n  useEffect(() => {\n    window.ethereum.enable();\n  }, []);\n\n  useEffect(() => {\n    async function readFile() {\n      const file1 = await getaccount();\n\n      if (file1 !== ZERO_ADDRESS) setAccountHash(file1);\n    }\n     \n    readFile();\n  }, []);\n\n\n\n  async function setFile(hash) {\n    const ipfsWithSigner = ipfsContract.connect(defaultProvider.getSigner());\n    const tx = await ipfsWithSigner.setFile(hash);\n    console.log({ tx });\n\n    setIpfsHash(hash);\n    \n    ipfsWithSigner.store(hash);\n\n  \n  }\n\n   function SetContract() {\n    storageContract = new ethers.Contract(itemInput2, abis.storage, defaultProvider);\n    console.log(itemInput2);\n    console.log(abis.storage);\n    console.log(storageContract);\n\n      \n    try {\n      if(itemInput2== \"\") throw \"Empty! Enter Smart Contract Hash.\";\n      if(isNaN(itemInput2)) throw \"Not a number! Enter Smart Contract Hash.\";\n      \n    }\n    catch(err) {\n      console.log(err);\n      document.getElementById(\"text-box\").innerHTML = err\n    }\n     \n    return storageContract;\n  \n  }\n\n\n  async function Buyer() {\n\n  \n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      await storageWithSigner.buyerUpload(ipfsHash,itemInput);\n      \n    }\n    catch(err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message\n    }\n    \n  \n  }\n\n\n  async function Seller() {\n\n\n    \n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      await storageWithSigner.sellerUpload(ipfsHash);\n      \n    }\n    catch(err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message\n    }\n    \n  \n  }\n\n  async function Extend() {\n\n\n\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      await storageWithSigner.ExtendTime(itemInput1);\n      \n    }\n    catch(err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message\n    }\n    \n  \n  }\n\n\n  async function status() {\n\n    var status_array=[\"ON\", \"BUYER_UPLOADED\", \"SELLER_UPLOADED\", \"DOC_OK\", \"DOC_DEFECT\", \"DOC_REJECTED\"];\n\n\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n\n      var statust = await storageWithSigner.getStatus();\n\n      document.getElementById(\"text-box1\").innerHTML = status_array[statust]\n      return \n      \n    }\n    catch(err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message\n    }\n    \n    \n  \n  }\n\n\n  async function time() {\n\n    var time_array=[\"ON_TIME\", \"OUT_OF_TIME\"];\n\n\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n\n      var timet = await storageWithSigner.getTimeStatus();\n\n      document.getElementById(\"text-box2\").innerHTML = time_array[timet]\n      return \n      \n    }\n    catch(err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message\n    }\n    \n    \n  \n  }\n\n\n  async function compliancetrue() {\n\n\n\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      await storageWithSigner.setCompliance(true);\n      \n    }\n    catch(err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message\n    }\n    \n  \n  }\n\n  async function compliancefalse() {\n\n\n\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      await storageWithSigner.setCompliance(false);\n      \n    }\n    catch(err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message\n    }\n    \n  \n  }\n\n  async function waivetrue() {\n\n\n\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      await storageWithSigner.waiveDiscrepancies(true);\n      \n    }\n    catch(err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message\n    }\n    \n  \n  }\n\n  async function waivefalse() {\n\n\n\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      await storageWithSigner.waiveDiscrepancies(false);\n      \n    }\n    catch(err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message\n    }\n    \n  \n  }\n  \n  async function destroy() {\n\n\n\n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n      await storageWithSigner.destroycontract(false);\n      \n    }\n    catch(err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message\n    }\n    \n  \n  }\n\n  async function checkbalance() {\n\n    \n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n\n      var balance = await storageWithSigner.check_Contract_Balance();\n      document.getElementById(\"text-box3\").innerHTML =balance;\n\n    }\n    catch(err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message\n    }\n\n       \n  \n  }\n\n  \n\n  async function getContractFile() {\n\n    \n    try {\n      const storageWithSigner = storageContract.connect(defaultProvider.getSigner());\n\n      var contractfile = await storageWithSigner.See_Doc_Hash(itemInput3);\n      document.getElementById(\"myAnchor\").innerHTML =\"See Contract File\";\n      document.getElementById(\"myAnchor\").href = `https://ipfs.io/ipfs/${contractfile}`;\n      document.getElementById(\"myAnchor\").target = \"_blank\";\n      \n    }\n    catch(err) {\n      console.log(err.message);\n      document.getElementById(\"text-box\").innerHTML = err.message\n    }\n\n       \n  \n  }\n  \n  console.log(ipfsHash);\n  \n\n  const uploadFile = useCallback(async (file) => {\n    const files = [\n      {\n        path: file.name + file.path,\n        content: file,\n      },\n    ];\n\n    for await (const result of node.add(files)) {\n      await setFile(result.cid.string);\n    }\n  }, []);\n\n  const onDrop = useCallback(\n    (acceptedFiles) => {\n      uploadFile(acceptedFiles[0]);\n    },\n    [uploadFile]\n  );\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    multiple: false,\n    onDrop,\n  });\n\n  const [itemInput, setItemInput] = useState(\"\");\n  console.log(itemInput);\n  const [itemInput1, setItemInput1] = useState(\"\");\n  console.log(itemInput1);\n  const [itemInput2, setItemInput2] = useState(\"\");\n  console.log(itemInput2);\n  const [itemInput3, setItemInput3] = useState(\"\");\n  console.log(itemInput3);\n\n  \n\n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n      <div id=\"text-box\"></div>\n      <div>\n          Smart Contract: <input type=\"text\" placeholder=\"Contract Hash\" value={itemInput2} onChange={e => setItemInput2(e.target.value)}/>\n        <button onClick={SetContract}>Set</button>\n      </div>\n      <div> <button onClick={status}>See Current Status</button> <button onClick={time}>See Current Time</button> <button onClick={checkbalance}>Check Balance</button> </div>\n      \n      <div id=\"text-box1\"></div>\n      <div id=\"text-box2\"></div>\n      <div id=\"text-box3\"></div>\n\n\n        <div {...getRootProps()} style={{ cursor: \"pointer\" }}>\n          <img src={logo} className=\"App-logo\" alt=\"react-logo\" />\n          <input {...getInputProps()} />\n          {isDragActive ? (\n            <p>Drop the files here ...</p>\n          ) : (\n            <p>\n              Drag 'n' drop some files here to upload to IPFS (or click the\n              logo)\n            </p>\n          )}\n        </div>\n        <div>\n          {ipfsHash !== \"\" ? (   \n            <p>Current IPFS Hash: <mark className=\"mark-red\">\"{ipfsHash}\"</mark></p>\n            ) : (\n              \"\"\n            )}\n        </div>  \n        <div>Current User Hash:<mark className=\"mark-yellow\">{accountHash}</mark></div>\n        <div>\n          {ipfsHash !== \"\" ? (\n            <a\n              href={`https://ipfs.io/ipfs/${ipfsHash}`}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              See current user file \n            </a>\n          ) : (\n            \"No user file set yet\"\n          )}\n\n        </div>\n        <div>\n         Buyer Sets Time and Uploads to The Smart Contract: <input type=\"text\" placeholder=\"Enter Time\" value={itemInput} onChange={e => setItemInput(e.target.value)}/>\n         <button onClick={Buyer}>Buyer Upload</button>\n        </div>\n        <div></div>\n      \n\n        <div>\n        Buyer Extends Time:\n        <input type=\"text\" placeholder=\"Enter Time\" value={itemInput1} onChange={e => setItemInput1(e.target.value)}\n       \n        />\n        <button onClick={Extend}>Buyer Extend</button>\n       </div>\n         <div>Seller Uploads to The Smart Contract: <button onClick={Seller}>Seller Upload</button>\n         </div>\n         <div>\n          Smart Contract Files: <input type=\"text\" placeholder=\"Enter Hash\" value={itemInput3} onChange={e => setItemInput3(e.target.value)}/>\n        <button onClick={getContractFile}>See Contract Files</button>\n         </div>\n         <a id=\"myAnchor\" href=\"\"></a>\n         <div>\n           Fintech Set Compliance or Destroy Contract:  <button onClick={compliancetrue}>Compliance</button>  <button onClick={compliancefalse}>No Compliance</button> <button onClick={destroy}>Destroy Contract</button>\n         </div>\n         <div>\n           Buyer Waives or Terminates:  <button onClick={waivetrue}>Waive Discrepancies</button>  <button onClick={waivefalse}>Terminate The Contract</button> \n         </div>\n\n\n\n      </header>\n\n    </div>\n  );\n \n  \n}\n\nexport default App;\n\n\n"]},"metadata":{},"sourceType":"module"}