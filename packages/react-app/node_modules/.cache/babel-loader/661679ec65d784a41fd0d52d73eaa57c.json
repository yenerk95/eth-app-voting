{"ast":null,"code":"'use strict';\n\nconst {\n  Buffer\n} = require('buffer');\n\nconst Message = require('../../message');\n\nconst utils = require('../../utils');\n\nmodule.exports = dht => {\n  const log = utils.logger(dht.peerId, 'rpc:find-node');\n  /**\n   * Process `FindNode` DHT messages.\n   *\n   * @param {PeerId} peerId\n   * @param {Message} msg\n   * @returns {Promise<Message>}\n   */\n\n  return async function findNode(peerId, msg) {\n    log('start');\n    let closer;\n\n    if (msg.key.equals(dht.peerId.id)) {\n      closer = [{\n        id: dht.peerId\n      }];\n    } else {\n      closer = await dht._betterPeersToQuery(msg, peerId);\n    }\n\n    const response = new Message(msg.type, Buffer.alloc(0), msg.clusterLevel);\n\n    if (closer.length > 0) {\n      response.closerPeers = closer;\n    } else {\n      log('handle FindNode %s: could not find anything', peerId.toB58String());\n    }\n\n    return response;\n  };\n};","map":{"version":3,"sources":["/Users/yenerkaraca/Documents/GitHub/eth-app/node_modules/libp2p-kad-dht/src/rpc/handlers/find-node.js"],"names":["Buffer","require","Message","utils","module","exports","dht","log","logger","peerId","findNode","msg","closer","key","equals","id","_betterPeersToQuery","response","type","alloc","clusterLevel","length","closerPeers","toB58String"],"mappings":"AAAA;;AAEA,MAAM;AAAEA,EAAAA;AAAF,IAAaC,OAAO,CAAC,QAAD,CAA1B;;AACA,MAAMC,OAAO,GAAGD,OAAO,CAAC,eAAD,CAAvB;;AACA,MAAME,KAAK,GAAGF,OAAO,CAAC,aAAD,CAArB;;AAEAG,MAAM,CAACC,OAAP,GAAkBC,GAAD,IAAS;AACxB,QAAMC,GAAG,GAAGJ,KAAK,CAACK,MAAN,CAAaF,GAAG,CAACG,MAAjB,EAAyB,eAAzB,CAAZ;AAEA;;;;;;;;AAOA,SAAO,eAAeC,QAAf,CAAyBD,MAAzB,EAAiCE,GAAjC,EAAsC;AAC3CJ,IAAAA,GAAG,CAAC,OAAD,CAAH;AAEA,QAAIK,MAAJ;;AACA,QAAID,GAAG,CAACE,GAAJ,CAAQC,MAAR,CAAeR,GAAG,CAACG,MAAJ,CAAWM,EAA1B,CAAJ,EAAmC;AACjCH,MAAAA,MAAM,GAAG,CAAC;AACRG,QAAAA,EAAE,EAAET,GAAG,CAACG;AADA,OAAD,CAAT;AAGD,KAJD,MAIO;AACLG,MAAAA,MAAM,GAAG,MAAMN,GAAG,CAACU,mBAAJ,CAAwBL,GAAxB,EAA6BF,MAA7B,CAAf;AACD;;AAED,UAAMQ,QAAQ,GAAG,IAAIf,OAAJ,CAAYS,GAAG,CAACO,IAAhB,EAAsBlB,MAAM,CAACmB,KAAP,CAAa,CAAb,CAAtB,EAAuCR,GAAG,CAACS,YAA3C,CAAjB;;AAEA,QAAIR,MAAM,CAACS,MAAP,GAAgB,CAApB,EAAuB;AACrBJ,MAAAA,QAAQ,CAACK,WAAT,GAAuBV,MAAvB;AACD,KAFD,MAEO;AACLL,MAAAA,GAAG,CAAC,6CAAD,EAAgDE,MAAM,CAACc,WAAP,EAAhD,CAAH;AACD;;AAED,WAAON,QAAP;AACD,GArBD;AAsBD,CAhCD","sourcesContent":["'use strict'\n\nconst { Buffer } = require('buffer')\nconst Message = require('../../message')\nconst utils = require('../../utils')\n\nmodule.exports = (dht) => {\n  const log = utils.logger(dht.peerId, 'rpc:find-node')\n\n  /**\n   * Process `FindNode` DHT messages.\n   *\n   * @param {PeerId} peerId\n   * @param {Message} msg\n   * @returns {Promise<Message>}\n   */\n  return async function findNode (peerId, msg) {\n    log('start')\n\n    let closer\n    if (msg.key.equals(dht.peerId.id)) {\n      closer = [{\n        id: dht.peerId\n      }]\n    } else {\n      closer = await dht._betterPeersToQuery(msg, peerId)\n    }\n\n    const response = new Message(msg.type, Buffer.alloc(0), msg.clusterLevel)\n\n    if (closer.length > 0) {\n      response.closerPeers = closer\n    } else {\n      log('handle FindNode %s: could not find anything', peerId.toB58String())\n    }\n\n    return response\n  }\n}\n"]},"metadata":{},"sourceType":"script"}